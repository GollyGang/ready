<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>Ready: gui/prefs.cpp Source File</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />

<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  <td id="projectlogo"><img alt="Logo" src="logo.png"/></td>
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">Ready
   &#160;<span id="projectnumber">0.5</span>
   </div>
   <div id="projectbrief">A cross-platform implementation of various reaction-diffusion systems.</div>
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.8.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="dir_11bc0974ce736ce9a6fadebbeb7a8314.html">gui</a>      </li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<div class="title">prefs.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="prefs_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/*  Copyright 2011, 2012 The Ready Bunch</span>
<a name="l00002"></a>00002 <span class="comment"></span>
<a name="l00003"></a>00003 <span class="comment">    This file is part of Ready.</span>
<a name="l00004"></a>00004 <span class="comment"></span>
<a name="l00005"></a>00005 <span class="comment">    Ready is free software: you can redistribute it and/or modify</span>
<a name="l00006"></a>00006 <span class="comment">    it under the terms of the GNU General Public License as published by</span>
<a name="l00007"></a>00007 <span class="comment">    the Free Software Foundation, either version 3 of the License, or</span>
<a name="l00008"></a>00008 <span class="comment">    (at your option) any later version.</span>
<a name="l00009"></a>00009 <span class="comment"></span>
<a name="l00010"></a>00010 <span class="comment">    Ready is distributed in the hope that it will be useful,</span>
<a name="l00011"></a>00011 <span class="comment">    but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<a name="l00012"></a>00012 <span class="comment">    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the</span>
<a name="l00013"></a>00013 <span class="comment">    GNU General Public License for more details.</span>
<a name="l00014"></a>00014 <span class="comment"></span>
<a name="l00015"></a>00015 <span class="comment">    You should have received a copy of the GNU General Public License</span>
<a name="l00016"></a>00016 <span class="comment">    along with Ready. If not, see &lt;http://www.gnu.org/licenses/&gt;.         */</span>
<a name="l00017"></a>00017 
<a name="l00018"></a>00018 <span class="comment">// wxWidgets:</span>
<a name="l00019"></a>00019 <span class="preprocessor">#include &quot;wx/wxprec.h&quot;</span>           <span class="comment">// for compilers that support precompilation</span>
<a name="l00020"></a>00020 <span class="preprocessor">#ifndef WX_PRECOMP</span>
<a name="l00021"></a>00021 <span class="preprocessor"></span><span class="preprocessor">  #include &quot;wx/wx.h&quot;</span>               <span class="comment">// for all others include the necessary headers</span>
<a name="l00022"></a>00022 <span class="preprocessor">#endif</span>
<a name="l00023"></a>00023 <span class="preprocessor"></span><span class="preprocessor">#include &lt;wx/stdpaths.h&gt;</span>         <span class="comment">// for wxStandardPaths</span>
<a name="l00024"></a>00024 <span class="preprocessor">#include &lt;wx/filename.h&gt;</span>         <span class="comment">// for wxFileName</span>
<a name="l00025"></a>00025 <span class="preprocessor">#include &lt;wx/propdlg.h&gt;</span>          <span class="comment">// for wxPropertySheetDialog</span>
<a name="l00026"></a>00026 <span class="preprocessor">#include &lt;wx/bookctrl.h&gt;</span>         <span class="comment">// for wxBookCtrlBase</span>
<a name="l00027"></a>00027 <span class="preprocessor">#include &lt;wx/notebook.h&gt;</span>         <span class="comment">// for wxNotebookEvent</span>
<a name="l00028"></a>00028 <span class="preprocessor">#include &lt;wx/spinctrl.h&gt;</span>         <span class="comment">// for wxSpinCtrl</span>
<a name="l00029"></a>00029 <span class="preprocessor">#if wxUSE_TOOLTIPS</span>
<a name="l00030"></a>00030 <span class="preprocessor"></span><span class="preprocessor">    #include &lt;wx/tooltip.h&gt;</span>      <span class="comment">// for wxToolTip</span>
<a name="l00031"></a>00031 <span class="preprocessor">#endif</span>
<a name="l00032"></a>00032 <span class="preprocessor"></span>
<a name="l00033"></a>00033 <span class="comment">// local:</span>
<a name="l00034"></a>00034 <span class="preprocessor">#include &quot;<a class="code" href="IDs_8hpp.html">IDs.hpp</a>&quot;</span>               <span class="comment">// for MAX_RECENT, etc</span>
<a name="l00035"></a>00035 <span class="preprocessor">#include &quot;<a class="code" href="app_8hpp.html">app.hpp</a>&quot;</span>               <span class="comment">// for wxGetApp</span>
<a name="l00036"></a>00036 <span class="preprocessor">#include &quot;<a class="code" href="frame_8hpp.html">frame.hpp</a>&quot;</span>             <span class="comment">// for MyFrame</span>
<a name="l00037"></a>00037 <span class="preprocessor">#include &quot;<a class="code" href="utils_8hpp.html">utils.hpp</a>&quot;</span>             <span class="comment">// for STR</span>
<a name="l00038"></a>00038 <span class="preprocessor">#include &quot;<a class="code" href="wxutils_8hpp.html">wxutils.hpp</a>&quot;</span>           <span class="comment">// for Warning, Fatal, Beep</span>
<a name="l00039"></a>00039 <span class="preprocessor">#include &quot;<a class="code" href="prefs_8hpp.html">prefs.hpp</a>&quot;</span>
<a name="l00040"></a>00040 
<a name="l00041"></a>00041 <span class="comment">// -----------------------------------------------------------------------------</span>
<a name="l00042"></a>00042 
<a name="l00043"></a>00043 <span class="comment">// Ready&#39;s preferences file is a simple text file.  It&#39;s initially created in</span>
<a name="l00044"></a>00044 <span class="comment">// a user-specific data directory (datadir) but we look in the application</span>
<a name="l00045"></a>00045 <span class="comment">// directory (readydir) first because this makes uninstalling simple and allows</span>
<a name="l00046"></a>00046 <span class="comment">// multiple copies/versions of the app to have separate preferences.</span>
<a name="l00047"></a>00047 
<a name="l00048"></a><a class="code" href="prefs_8cpp.html#affe07b3e664c212da7b1732908dd3fba">00048</a> <span class="keyword">const</span> wxString <a class="code" href="prefs_8cpp.html#affe07b3e664c212da7b1732908dd3fba">PREFS_NAME</a> = wxT(<span class="stringliteral">&quot;ReadyPrefs&quot;</span>);
<a name="l00049"></a>00049 
<a name="l00050"></a><a class="code" href="prefs_8cpp.html#ab9caae868f071ef53f59a17b995b45ec">00050</a> wxString <a class="code" href="prefs_8cpp.html#ab9caae868f071ef53f59a17b995b45ec">prefspath</a>;              <span class="comment">// full path to prefs file</span>
<a name="l00051"></a><a class="code" href="prefs_8cpp.html#a8bf37d7016c72a6f4df10b194849371a">00051</a> wxString <a class="code" href="prefs_8cpp.html#a8bf37d7016c72a6f4df10b194849371a">choosedir</a>;              <span class="comment">// directory used by Choose File button</span>
<a name="l00052"></a>00052 
<a name="l00053"></a>00053 <span class="comment">// location of supplied pattern collection (relative to app)</span>
<a name="l00054"></a><a class="code" href="prefs_8cpp.html#a8d853814b27b21dc32810f161cd6a6d0">00054</a> <span class="keyword">const</span> wxString <a class="code" href="prefs_8cpp.html#a8d853814b27b21dc32810f161cd6a6d0">PATT_DIR</a> = wxT(<span class="stringliteral">&quot;Patterns&quot;</span>);
<a name="l00055"></a>00055 
<a name="l00056"></a><a class="code" href="prefs_8cpp.html#a8f18c82361263ce84f69cb17db9dfe9a">00056</a> <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="prefs_8cpp.html#a8f18c82361263ce84f69cb17db9dfe9a">PREFS_VERSION</a> = 2;     <span class="comment">// increment if necessary due to changes in syntax/semantics</span>
<a name="l00057"></a><a class="code" href="prefs_8hpp.html#af6fe256936340f78df9e04549496d809">00057</a> <span class="keywordtype">int</span> <a class="code" href="prefs_8cpp.html#af6fe256936340f78df9e04549496d809">currversion</a> = <a class="code" href="prefs_8cpp.html#a8f18c82361263ce84f69cb17db9dfe9a">PREFS_VERSION</a>; <span class="comment">// might be changed by prefs_version</span>
<a name="l00058"></a><a class="code" href="prefs_8cpp.html#aad1b9da94bf263a8ea6e237c6207c12a">00058</a> <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="prefs_8cpp.html#aad1b9da94bf263a8ea6e237c6207c12a">PREF_LINE_SIZE</a> = 5000; <span class="comment">// must be quite long for storing file paths</span>
<a name="l00059"></a>00059 
<a name="l00060"></a><a class="code" href="prefs_8cpp.html#a7328da96cb977523dc8ca977be1c4963">00060</a> <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="prefs_8cpp.html#a7328da96cb977523dc8ca977be1c4963">minmainwd</a> = 200;       <span class="comment">// main window&#39;s minimum width</span>
<a name="l00061"></a><a class="code" href="prefs_8cpp.html#ad39746c614087b9de8d0dbc68bc14816">00061</a> <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="prefs_8cpp.html#ad39746c614087b9de8d0dbc68bc14816">minmainht</a> = 100;       <span class="comment">// main window&#39;s minimum height</span>
<a name="l00062"></a>00062 
<a name="l00063"></a><a class="code" href="prefs_8hpp.html#aa3af5b468230e51f15091c9f1410b2c4">00063</a> wxString <a class="code" href="prefs_8cpp.html#aa3af5b468230e51f15091c9f1410b2c4">readydir</a>;               <span class="comment">// directory containing app</span>
<a name="l00064"></a><a class="code" href="prefs_8hpp.html#ab560d022c77858352411b140714050db">00064</a> wxString <a class="code" href="prefs_8cpp.html#ab560d022c77858352411b140714050db">datadir</a>;                <span class="comment">// directory for user-specific data</span>
<a name="l00065"></a><a class="code" href="prefs_8hpp.html#a3edf5a81e7705cff70d24652da075f4f">00065</a> wxString <a class="code" href="prefs_8cpp.html#a3edf5a81e7705cff70d24652da075f4f">tempdir</a>;                <span class="comment">// directory for temporary data</span>
<a name="l00066"></a><a class="code" href="prefs_8hpp.html#af8401ddad0a73df36c378eac775654cd">00066</a> wxString <a class="code" href="prefs_8cpp.html#af8401ddad0a73df36c378eac775654cd">patterndir</a>;             <span class="comment">// directory for supplied patterns</span>
<a name="l00067"></a><a class="code" href="prefs_8hpp.html#ab452266aeee4716a62c33d520df9ba7f">00067</a> wxString <a class="code" href="prefs_8cpp.html#ab452266aeee4716a62c33d520df9ba7f">recordingdir</a>;           <span class="comment">// directory for recording images</span>
<a name="l00068"></a>00068 
<a name="l00069"></a>00069 <span class="comment">// initialize exported preferences:</span>
<a name="l00070"></a>00070 
<a name="l00071"></a><a class="code" href="prefs_8hpp.html#a26b11189d93fef33172f1a2a1d174188">00071</a> <span class="keywordtype">int</span> <a class="code" href="prefs_8cpp.html#a26b11189d93fef33172f1a2a1d174188">mainx</a> = 30;                  <span class="comment">// main window&#39;s initial location</span>
<a name="l00072"></a><a class="code" href="prefs_8hpp.html#a8b015efaa4cb16287077ac74b60ad67a">00072</a> <span class="keywordtype">int</span> <a class="code" href="prefs_8cpp.html#a8b015efaa4cb16287077ac74b60ad67a">mainy</a> = 40;
<a name="l00073"></a><a class="code" href="prefs_8hpp.html#a7b08ad54bec54f213c5ed4c1d8749548">00073</a> <span class="keywordtype">int</span> <a class="code" href="prefs_8cpp.html#a7b08ad54bec54f213c5ed4c1d8749548">mainwd</a> = 1000;               <span class="comment">// main window&#39;s initial size</span>
<a name="l00074"></a><a class="code" href="prefs_8hpp.html#afd8ee1110367c04cc21e2219607b7a7b">00074</a> <span class="keywordtype">int</span> <a class="code" href="prefs_8cpp.html#afd8ee1110367c04cc21e2219607b7a7b">mainht</a> = 800;
<a name="l00075"></a><a class="code" href="prefs_8hpp.html#a8ae3f893c3d94492fdf3191dbd5c89f5">00075</a> <span class="keywordtype">bool</span> <a class="code" href="prefs_8cpp.html#a8ae3f893c3d94492fdf3191dbd5c89f5">maximize</a> = <span class="keyword">false</span>;           <span class="comment">// maximize main window?</span>
<a name="l00076"></a><a class="code" href="prefs_8hpp.html#a9c5a9f65dc02b9e7ed8abef92565e5fa">00076</a> wxString <a class="code" href="prefs_8cpp.html#a9c5a9f65dc02b9e7ed8abef92565e5fa">auilayout</a> = wxT(<span class="stringliteral">&quot;&quot;</span>);    <span class="comment">// wxAUI layout info</span>
<a name="l00077"></a><a class="code" href="prefs_8hpp.html#a0de6a378ca700dd877cab59c65ba2f7b">00077</a> <span class="keywordtype">int</span> <a class="code" href="prefs_8cpp.html#a0de6a378ca700dd877cab59c65ba2f7b">opencl_platform</a> = 0;         <span class="comment">// current OpenCL platform</span>
<a name="l00078"></a><a class="code" href="prefs_8hpp.html#a11d0cbab21425e351638f4bf2cc72874">00078</a> <span class="keywordtype">int</span> <a class="code" href="prefs_8cpp.html#a11d0cbab21425e351638f4bf2cc72874">opencl_device</a> = 0;           <span class="comment">// current OpenCL device</span>
<a name="l00079"></a><a class="code" href="prefs_8hpp.html#af219299ebad47daa6631415a8b41345a">00079</a> <span class="keywordtype">int</span> <a class="code" href="prefs_8cpp.html#af219299ebad47daa6631415a8b41345a">debuglevel</a> = 0;              <span class="comment">// for displaying debug info if &gt; 0</span>
<a name="l00080"></a>00080 <span class="preprocessor">#ifdef __WXMAC__</span>
<a name="l00081"></a>00081 <span class="preprocessor"></span>    <span class="keywordtype">int</span> <a class="code" href="prefs_8cpp.html#a7af6ffef487690c55989fafb52cad837">infofontsize</a> = 12;       <span class="comment">// font size in Mac info pane</span>
<a name="l00082"></a>00082     <span class="keywordtype">int</span> <a class="code" href="prefs_8cpp.html#a4632890b2d4f7c0ecb125a0b924fae2f">helpfontsize</a> = 12;       <span class="comment">// font size in Mac help pane</span>
<a name="l00083"></a>00083 <span class="preprocessor">#else</span>
<a name="l00084"></a><a class="code" href="prefs_8hpp.html#a7af6ffef487690c55989fafb52cad837">00084</a> <span class="preprocessor"></span>    <span class="keywordtype">int</span> <a class="code" href="prefs_8cpp.html#a7af6ffef487690c55989fafb52cad837">infofontsize</a> = 10;       <span class="comment">// font size in Win/Linux info pane</span>
<a name="l00085"></a><a class="code" href="prefs_8hpp.html#a4632890b2d4f7c0ecb125a0b924fae2f">00085</a>     <span class="keywordtype">int</span> <a class="code" href="prefs_8cpp.html#a4632890b2d4f7c0ecb125a0b924fae2f">helpfontsize</a> = 10;       <span class="comment">// font size in Win/Linux help pane</span>
<a name="l00086"></a>00086 <span class="preprocessor">#endif</span>
<a name="l00087"></a><a class="code" href="prefs_8hpp.html#a3fe8c36e5972115938dc8a7abc55be62">00087</a> <span class="preprocessor"></span><span class="keywordtype">int</span> <a class="code" href="prefs_8cpp.html#a3fe8c36e5972115938dc8a7abc55be62">textdlgwd</a> = 500;             <span class="comment">// width of multi-line text dialog</span>
<a name="l00088"></a><a class="code" href="prefs_8hpp.html#a0b9937fefba071008390e6e3149bdb11">00088</a> <span class="keywordtype">int</span> <a class="code" href="prefs_8cpp.html#a0b9937fefba071008390e6e3149bdb11">textdlght</a> = 300;             <span class="comment">// height of multi-line text dialog</span>
<a name="l00089"></a><a class="code" href="prefs_8hpp.html#af831ab3ffe0ee800c61d7a73b2873ce3">00089</a> <span class="keywordtype">bool</span> <a class="code" href="prefs_8cpp.html#af831ab3ffe0ee800c61d7a73b2873ce3">showtips</a> = <span class="keyword">true</span>;            <span class="comment">// show button tips?</span>
<a name="l00090"></a><a class="code" href="prefs_8hpp.html#a12fa8d7d57fa0c4eab03e55cb31d3ca1">00090</a> <span class="keywordtype">bool</span> <a class="code" href="prefs_8cpp.html#a12fa8d7d57fa0c4eab03e55cb31d3ca1">repaint_to_erase</a> = <span class="keyword">false</span>;   <span class="comment">// whether painting over the current color reverts to low</span>
<a name="l00091"></a><a class="code" href="prefs_8hpp.html#a68723f2f0bf26bff2564c1af8aa80d22">00091</a> <span class="keywordtype">bool</span> <a class="code" href="prefs_8cpp.html#a68723f2f0bf26bff2564c1af8aa80d22">allowbeep</a> = <span class="keyword">true</span>;           <span class="comment">// okay to play beep sound?</span>
<a name="l00092"></a><a class="code" href="prefs_8hpp.html#af99b0c2f2338ed759034777927bd3101">00092</a> <span class="keywordtype">bool</span> <a class="code" href="prefs_8cpp.html#af99b0c2f2338ed759034777927bd3101">askonnew</a> = <span class="keyword">true</span>;            <span class="comment">// ask to save changes before creating new pattern?</span>
<a name="l00093"></a><a class="code" href="prefs_8hpp.html#aac5614bb4154327f09ed8d29bec54d0b">00093</a> <span class="keywordtype">bool</span> <a class="code" href="prefs_8cpp.html#aac5614bb4154327f09ed8d29bec54d0b">askonload</a> = <span class="keyword">true</span>;           <span class="comment">// ask to save changes before loading pattern file?</span>
<a name="l00094"></a><a class="code" href="prefs_8hpp.html#a0498f5ccb6ca073727aa39f77e82660b">00094</a> <span class="keywordtype">bool</span> <a class="code" href="prefs_8cpp.html#a0498f5ccb6ca073727aa39f77e82660b">askonquit</a> = <span class="keyword">true</span>;           <span class="comment">// ask to save changes before quitting app?</span>
<a name="l00095"></a><a class="code" href="prefs_8hpp.html#adc6c83c9ee4250d0b1f2b2b9f33fa777">00095</a> wxString <a class="code" href="prefs_8cpp.html#adc6c83c9ee4250d0b1f2b2b9f33fa777">opensavedir</a>;            <span class="comment">// directory for Open/Save Pattern dialogs</span>
<a name="l00096"></a><a class="code" href="prefs_8hpp.html#aecf1f655ef78e68e956e57878e7ea48d">00096</a> wxString <a class="code" href="prefs_8cpp.html#aecf1f655ef78e68e956e57878e7ea48d">screenshotdir</a>;          <span class="comment">// directory for Save Screenshot dialog</span>
<a name="l00097"></a><a class="code" href="prefs_8hpp.html#a91188f84b92fb18a365b824f1d78c07f">00097</a> wxString <a class="code" href="prefs_8cpp.html#a91188f84b92fb18a365b824f1d78c07f">userdir</a>;                <span class="comment">// directory for user&#39;s patterns</span>
<a name="l00098"></a><a class="code" href="prefs_8hpp.html#a3a8c57e4e1beb747c341e067dc8869bf">00098</a> wxString <a class="code" href="prefs_8cpp.html#a3a8c57e4e1beb747c341e067dc8869bf">texteditor</a>;             <span class="comment">// path of user&#39;s preferred text editor</span>
<a name="l00099"></a><a class="code" href="prefs_8hpp.html#ae5246b1632294beb0e04a2942722d304">00099</a> wxMenu* <a class="code" href="prefs_8cpp.html#ae5246b1632294beb0e04a2942722d304">patternSubMenu</a> = NULL;   <span class="comment">// submenu of recent pattern files</span>
<a name="l00100"></a><a class="code" href="prefs_8hpp.html#a17a3671114d042df36485b7cf3a80840">00100</a> <span class="keywordtype">int</span> <a class="code" href="prefs_8cpp.html#a17a3671114d042df36485b7cf3a80840">numpatterns</a> = 0;             <span class="comment">// current number of recent pattern files</span>
<a name="l00101"></a><a class="code" href="prefs_8hpp.html#af74247065dccdcbc74c5e1b8dc09e01c">00101</a> <span class="keywordtype">int</span> <a class="code" href="prefs_8cpp.html#af74247065dccdcbc74c5e1b8dc09e01c">maxpatterns</a> = 20;            <span class="comment">// maximum number of recent pattern files (1..MAX_RECENT)</span>
<a name="l00102"></a><a class="code" href="prefs_8hpp.html#ae204d3ec12d9c681259496320dfe1e00">00102</a> <span class="keywordtype">int</span> <a class="code" href="prefs_8cpp.html#ae204d3ec12d9c681259496320dfe1e00">current_brush_size</a> = 1;      <span class="comment">// small, medium or large brush</span>
<a name="l00103"></a>00103 
<a name="l00104"></a>00104 <span class="comment">// local (ie. non-exported) globals:</span>
<a name="l00105"></a>00105 
<a name="l00106"></a>00106 <span class="comment">// set of modifier keys (note that MSVC didn&#39;t like MK_*)</span>
<a name="l00107"></a><a class="code" href="prefs_8cpp.html#aaca2c4e8c2dbb1214dde1c0bb46dbe2f">00107</a> <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="prefs_8cpp.html#aaca2c4e8c2dbb1214dde1c0bb46dbe2f">mk_CMD</a>     = 1;        <span class="comment">// command key on Mac, control key on Win/Linux</span>
<a name="l00108"></a><a class="code" href="prefs_8cpp.html#a635b91d441a7f0e6575bc522e0307cc8">00108</a> <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="prefs_8cpp.html#a635b91d441a7f0e6575bc522e0307cc8">mk_ALT</a>     = 2;        <span class="comment">// option key on Mac</span>
<a name="l00109"></a><a class="code" href="prefs_8cpp.html#a438c6e768372ad8199c47855d968ed12">00109</a> <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="prefs_8cpp.html#a438c6e768372ad8199c47855d968ed12">mk_SHIFT</a>   = 4;
<a name="l00110"></a>00110 <span class="preprocessor">#ifdef __WXMAC__</span>
<a name="l00111"></a>00111 <span class="preprocessor"></span><span class="keyword">const</span> <span class="keywordtype">int</span> mk_CTRL    = 8;        <span class="comment">// control key is separate modifier on Mac</span>
<a name="l00112"></a>00112 <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="prefs_8cpp.html#a91ac701426603f585619c7a4be1b3f6d">MAX_MODS</a>   = 16;
<a name="l00113"></a>00113 <span class="preprocessor">#else</span>
<a name="l00114"></a><a class="code" href="prefs_8cpp.html#a91ac701426603f585619c7a4be1b3f6d">00114</a> <span class="preprocessor"></span><span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="prefs_8cpp.html#a91ac701426603f585619c7a4be1b3f6d">MAX_MODS</a>   = 8;
<a name="l00115"></a>00115 <span class="preprocessor">#endif</span>
<a name="l00116"></a>00116 <span class="preprocessor"></span>
<a name="l00117"></a>00117 <span class="comment">// WXK_* key codes like WXK_F1 have values &gt; 300, so to minimize the</span>
<a name="l00118"></a>00118 <span class="comment">// size of the keyaction table (see below) we use our own internal</span>
<a name="l00119"></a>00119 <span class="comment">// key codes for function keys and other special keys</span>
<a name="l00120"></a><a class="code" href="prefs_8cpp.html#abd58106b96c7d4b3d163d720bd599541">00120</a> <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="prefs_8cpp.html#abd58106b96c7d4b3d163d720bd599541">IK_NULL</a>       = 0;     <span class="comment">// probably best never to use this</span>
<a name="l00121"></a><a class="code" href="prefs_8cpp.html#abe22f9c221bffb446bd16099e41d31f3">00121</a> <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="prefs_8cpp.html#abe22f9c221bffb446bd16099e41d31f3">IK_HOME</a>       = 1;
<a name="l00122"></a><a class="code" href="prefs_8cpp.html#a743cc0cdc56e37adbb08fc2af9c13be8">00122</a> <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="prefs_8cpp.html#a743cc0cdc56e37adbb08fc2af9c13be8">IK_END</a>        = 2;
<a name="l00123"></a><a class="code" href="prefs_8cpp.html#aec8db367cc791fb5c99a3b2e38a4ddf6">00123</a> <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="prefs_8cpp.html#aec8db367cc791fb5c99a3b2e38a4ddf6">IK_PAGEUP</a>     = 3;
<a name="l00124"></a><a class="code" href="prefs_8cpp.html#ad1a5458044bdc32ff93d96f086fa2bfd">00124</a> <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="prefs_8cpp.html#ad1a5458044bdc32ff93d96f086fa2bfd">IK_PAGEDOWN</a>   = 4;
<a name="l00125"></a><a class="code" href="prefs_8cpp.html#a1537daf825956aab4039bbab9baa0140">00125</a> <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="prefs_8cpp.html#a1537daf825956aab4039bbab9baa0140">IK_HELP</a>       = 5;
<a name="l00126"></a><a class="code" href="prefs_8cpp.html#a0d7f15108fcb879fdc3c7921d6578585">00126</a> <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="prefs_8cpp.html#a0d7f15108fcb879fdc3c7921d6578585">IK_INSERT</a>     = 6;
<a name="l00127"></a><a class="code" href="prefs_8cpp.html#a5967a8cb9b042e85495977f9ad95e6ef">00127</a> <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="prefs_8cpp.html#a5967a8cb9b042e85495977f9ad95e6ef">IK_DELETE</a>     = 8;     <span class="comment">// treat delete like backspace (consistent with GSF_dokey)</span>
<a name="l00128"></a><a class="code" href="prefs_8cpp.html#aec1ea857bc767cc31b24c0e635f42828">00128</a> <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="prefs_8cpp.html#aec1ea857bc767cc31b24c0e635f42828">IK_TAB</a>        = 9;
<a name="l00129"></a><a class="code" href="prefs_8cpp.html#a7379baccbdc0bc2eb69d5ace888b3337">00129</a> <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="prefs_8cpp.html#a7379baccbdc0bc2eb69d5ace888b3337">IK_RETURN</a>     = 13;
<a name="l00130"></a><a class="code" href="prefs_8cpp.html#a98d88c87a65d184c1f501d6062789915">00130</a> <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="prefs_8cpp.html#a98d88c87a65d184c1f501d6062789915">IK_LEFT</a>       = 28;
<a name="l00131"></a><a class="code" href="prefs_8cpp.html#a3aa147d88645e5235409e3ace208c9f9">00131</a> <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="prefs_8cpp.html#a3aa147d88645e5235409e3ace208c9f9">IK_RIGHT</a>      = 29;
<a name="l00132"></a><a class="code" href="prefs_8cpp.html#aa8222f0c05ece7f3c908487b5775cd69">00132</a> <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="prefs_8cpp.html#aa8222f0c05ece7f3c908487b5775cd69">IK_UP</a>         = 30;
<a name="l00133"></a><a class="code" href="prefs_8cpp.html#a1707b12fb040d96287b8578d835d868f">00133</a> <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="prefs_8cpp.html#a1707b12fb040d96287b8578d835d868f">IK_DOWN</a>       = 31;
<a name="l00134"></a><a class="code" href="prefs_8cpp.html#a57c7c8d5358f3abaee3223dd89a7274b">00134</a> <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="prefs_8cpp.html#a57c7c8d5358f3abaee3223dd89a7274b">IK_F1</a>         = <span class="charliteral">&#39;A&#39;</span>;   <span class="comment">// we use shift+a for the real A, etc</span>
<a name="l00135"></a><a class="code" href="prefs_8cpp.html#acb38cd3bfb018984d09e861607eb737b">00135</a> <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="prefs_8cpp.html#acb38cd3bfb018984d09e861607eb737b">IK_F24</a>        = <span class="charliteral">&#39;X&#39;</span>;
<a name="l00136"></a><a class="code" href="prefs_8cpp.html#a85c7a27ef78976422a68cf49a99bd589">00136</a> <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="prefs_8cpp.html#a85c7a27ef78976422a68cf49a99bd589">MAX_KEYCODES</a>  = 128;
<a name="l00137"></a>00137 
<a name="l00138"></a>00138 <span class="comment">// names of the non-displayable keys we currently support;</span>
<a name="l00139"></a>00139 <span class="comment">// note that these names can be used in menu item accelerator strings</span>
<a name="l00140"></a>00140 <span class="comment">// so they must match legal wx names (listed in wxMenu::Append docs)</span>
<a name="l00141"></a><a class="code" href="prefs_8cpp.html#a17e778db891c6f7af059a304bdae4c1e">00141</a> <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="prefs_8cpp.html#a17e778db891c6f7af059a304bdae4c1e">NK_HOME</a>[]    = <span class="stringliteral">&quot;Home&quot;</span>;
<a name="l00142"></a><a class="code" href="prefs_8cpp.html#adc814fa2c8c13c085ddaa4fb06d963b1">00142</a> <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="prefs_8cpp.html#adc814fa2c8c13c085ddaa4fb06d963b1">NK_END</a>[]     = <span class="stringliteral">&quot;End&quot;</span>;
<a name="l00143"></a><a class="code" href="prefs_8cpp.html#a838b9bb86001b6fd1cb684a32c4d4be6">00143</a> <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="prefs_8cpp.html#a838b9bb86001b6fd1cb684a32c4d4be6">NK_PGUP</a>[]    = <span class="stringliteral">&quot;PgUp&quot;</span>;
<a name="l00144"></a><a class="code" href="prefs_8cpp.html#a65899dabf9d10827b1d04186ede6d96f">00144</a> <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="prefs_8cpp.html#a65899dabf9d10827b1d04186ede6d96f">NK_PGDN</a>[]    = <span class="stringliteral">&quot;PgDn&quot;</span>;
<a name="l00145"></a><a class="code" href="prefs_8cpp.html#ab984d5104fb7d6099ad625c91bdf7a2c">00145</a> <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="prefs_8cpp.html#ab984d5104fb7d6099ad625c91bdf7a2c">NK_HELP</a>[]    = <span class="stringliteral">&quot;Help&quot;</span>;
<a name="l00146"></a><a class="code" href="prefs_8cpp.html#a5295ec9f3627911411a16979e25ddf27">00146</a> <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="prefs_8cpp.html#a5295ec9f3627911411a16979e25ddf27">NK_INSERT</a>[]  = <span class="stringliteral">&quot;Insert&quot;</span>;
<a name="l00147"></a><a class="code" href="prefs_8cpp.html#ab8fb90af2ccf1dad92336c2c0eeef6f4">00147</a> <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="prefs_8cpp.html#ab8fb90af2ccf1dad92336c2c0eeef6f4">NK_DELETE</a>[]  = <span class="stringliteral">&quot;Delete&quot;</span>;
<a name="l00148"></a><a class="code" href="prefs_8cpp.html#a4cf00ed212021171783c0dea82ab6608">00148</a> <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="prefs_8cpp.html#a4cf00ed212021171783c0dea82ab6608">NK_TAB</a>[]     = <span class="stringliteral">&quot;Tab&quot;</span>;
<a name="l00149"></a>00149 <span class="preprocessor">#ifdef __WXMSW__</span>
<a name="l00150"></a>00150 <span class="preprocessor"></span>    <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="prefs_8cpp.html#ae506d008a73b81b02862fdf6db1a9bbc">NK_RETURN</a>[]  = <span class="stringliteral">&quot;Enter&quot;</span>;
<a name="l00151"></a>00151 <span class="preprocessor">#else</span>
<a name="l00152"></a><a class="code" href="prefs_8cpp.html#ae506d008a73b81b02862fdf6db1a9bbc">00152</a> <span class="preprocessor"></span>    <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="prefs_8cpp.html#ae506d008a73b81b02862fdf6db1a9bbc">NK_RETURN</a>[]  = <span class="stringliteral">&quot;Return&quot;</span>;
<a name="l00153"></a>00153 <span class="preprocessor">#endif</span>
<a name="l00154"></a><a class="code" href="prefs_8cpp.html#a25608bd6d505c19798746fe9f2b50f34">00154</a> <span class="preprocessor"></span><span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="prefs_8cpp.html#a25608bd6d505c19798746fe9f2b50f34">NK_LEFT</a>[]    = <span class="stringliteral">&quot;Left&quot;</span>;
<a name="l00155"></a><a class="code" href="prefs_8cpp.html#aa03501e2b8578995cb932ad67ebeb643">00155</a> <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="prefs_8cpp.html#aa03501e2b8578995cb932ad67ebeb643">NK_RIGHT</a>[]   = <span class="stringliteral">&quot;Right&quot;</span>;
<a name="l00156"></a><a class="code" href="prefs_8cpp.html#ad0bca97c467815f1721168a787c570d8">00156</a> <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="prefs_8cpp.html#ad0bca97c467815f1721168a787c570d8">NK_UP</a>[]      = <span class="stringliteral">&quot;Up&quot;</span>;
<a name="l00157"></a><a class="code" href="prefs_8cpp.html#a8ec194f0aebf19a367c709639a324ff4">00157</a> <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="prefs_8cpp.html#a8ec194f0aebf19a367c709639a324ff4">NK_DOWN</a>[]    = <span class="stringliteral">&quot;Down&quot;</span>;
<a name="l00158"></a><a class="code" href="prefs_8cpp.html#ae0c7e720904f522bf38aaae4798febfe">00158</a> <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="prefs_8cpp.html#ae0c7e720904f522bf38aaae4798febfe">NK_SPACE</a>[]   = <span class="stringliteral">&quot;Space&quot;</span>;
<a name="l00159"></a>00159 
<a name="l00160"></a><a class="code" href="prefs_8cpp.html#aff336a15d7bde7902105a8a59ed27133">00160</a> <span class="keyword">const</span> <a class="code" href="structaction__info.html">action_info</a> <a class="code" href="prefs_8cpp.html#aff336a15d7bde7902105a8a59ed27133">nullaction</a> = { <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62aa3c06bc7e4d652a970cab72026c6fed1">DO_NOTHING</a>, wxEmptyString };
<a name="l00161"></a>00161 
<a name="l00162"></a>00162 <span class="comment">// table for converting key combinations into actions</span>
<a name="l00163"></a><a class="code" href="prefs_8cpp.html#a80aa533787fc069d8f5aaa0eb4139655">00163</a> <a class="code" href="structaction__info.html">action_info</a> <a class="code" href="prefs_8cpp.html#a80aa533787fc069d8f5aaa0eb4139655">keyaction</a>[<a class="code" href="prefs_8cpp.html#a85c7a27ef78976422a68cf49a99bd589">MAX_KEYCODES</a>][<a class="code" href="prefs_8cpp.html#a91ac701426603f585619c7a4be1b3f6d">MAX_MODS</a>] = { { nullaction } };
<a name="l00164"></a>00164 
<a name="l00165"></a>00165 <span class="comment">// strings for setting menu item accelerators</span>
<a name="l00166"></a><a class="code" href="prefs_8cpp.html#a53b624a5d80e5a337965fd3952ce80b9">00166</a> wxString <a class="code" href="prefs_8cpp.html#a53b624a5d80e5a337965fd3952ce80b9">accelerator</a>[<a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a802dd62e3c2fc79809df7b338c095865">MAX_ACTIONS</a>];
<a name="l00167"></a>00167 
<a name="l00168"></a>00168 <span class="comment">// -----------------------------------------------------------------------------</span>
<a name="l00169"></a>00169 
<a name="l00170"></a><a class="code" href="prefs_8cpp.html#a6947434df6c6efa4e866e0e8667b1096">00170</a> <span class="keywordtype">bool</span> <a class="code" href="prefs_8cpp.html#a6947434df6c6efa4e866e0e8667b1096">ConvertKeyAndModifiers</a>(<span class="keywordtype">int</span> wxkey, <span class="keywordtype">int</span> wxmods, <span class="keywordtype">int</span>* newkey, <span class="keywordtype">int</span>* newmods)
<a name="l00171"></a>00171 {
<a name="l00172"></a>00172     <span class="comment">// first convert given wx modifiers (set by wxKeyEvent::GetModifiers)</span>
<a name="l00173"></a>00173     <span class="comment">// to a corresponding set of mk_* values</span>
<a name="l00174"></a>00174     <span class="keywordtype">int</span> ourmods = 0;
<a name="l00175"></a>00175     <span class="keywordflow">if</span> (wxmods &amp; wxMOD_CMD)       ourmods |= <a class="code" href="prefs_8cpp.html#aaca2c4e8c2dbb1214dde1c0bb46dbe2f">mk_CMD</a>;
<a name="l00176"></a>00176     <span class="keywordflow">if</span> (wxmods &amp; wxMOD_ALT)       ourmods |= <a class="code" href="prefs_8cpp.html#a635b91d441a7f0e6575bc522e0307cc8">mk_ALT</a>;
<a name="l00177"></a>00177     <span class="keywordflow">if</span> (wxmods &amp; wxMOD_SHIFT)     ourmods |= <a class="code" href="prefs_8cpp.html#a438c6e768372ad8199c47855d968ed12">mk_SHIFT</a>;
<a name="l00178"></a>00178 <span class="preprocessor">#ifdef __WXMAC__</span>
<a name="l00179"></a>00179 <span class="preprocessor"></span>    <span class="keywordflow">if</span> (wxmods &amp; wxMOD_CONTROL)   ourmods |= mk_CTRL;
<a name="l00180"></a>00180 <span class="preprocessor">#endif</span>
<a name="l00181"></a>00181 <span class="preprocessor"></span>
<a name="l00182"></a>00182     <span class="comment">// now convert given wx key code to corresponding IK_* code</span>
<a name="l00183"></a>00183     <span class="keywordtype">int</span> ourkey;
<a name="l00184"></a>00184     <span class="keywordflow">if</span> (wxkey &gt;= <span class="charliteral">&#39;A&#39;</span> &amp;&amp; wxkey &lt;= <span class="charliteral">&#39;Z&#39;</span>) {
<a name="l00185"></a>00185         <span class="comment">// convert A..Z to shift+a..shift+z so we can use A..X</span>
<a name="l00186"></a>00186         <span class="comment">// for our internal function keys (IK_F1 to IK_F24)</span>
<a name="l00187"></a>00187         ourkey = wxkey + 32;
<a name="l00188"></a>00188         ourmods |= <a class="code" href="prefs_8cpp.html#a438c6e768372ad8199c47855d968ed12">mk_SHIFT</a>;
<a name="l00189"></a>00189 
<a name="l00190"></a>00190     }
<a name="l00191"></a>00191     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (wxkey &gt;= WXK_F1 &amp;&amp; wxkey &lt;= WXK_F24) {
<a name="l00192"></a>00192         <span class="comment">// convert wx function key code to IK_F1..IK_F24</span>
<a name="l00193"></a>00193         ourkey = <a class="code" href="prefs_8cpp.html#a57c7c8d5358f3abaee3223dd89a7274b">IK_F1</a> + (wxkey - WXK_F1);
<a name="l00194"></a>00194 
<a name="l00195"></a>00195     }
<a name="l00196"></a>00196     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (wxkey &gt;= WXK_NUMPAD0 &amp;&amp; wxkey &lt;= WXK_NUMPAD9) {
<a name="l00197"></a>00197         <span class="comment">// treat numpad digits like ordinary digits</span>
<a name="l00198"></a>00198         ourkey = <span class="charliteral">&#39;0&#39;</span> + (wxkey - WXK_NUMPAD0);
<a name="l00199"></a>00199 
<a name="l00200"></a>00200     }
<a name="l00201"></a>00201     <span class="keywordflow">else</span> {
<a name="l00202"></a>00202         <span class="keywordflow">switch</span> (wxkey) {
<a name="l00203"></a>00203             <span class="keywordflow">case</span> WXK_HOME:          ourkey = <a class="code" href="prefs_8cpp.html#abe22f9c221bffb446bd16099e41d31f3">IK_HOME</a>; <span class="keywordflow">break</span>;
<a name="l00204"></a>00204             <span class="keywordflow">case</span> WXK_END:           ourkey = <a class="code" href="prefs_8cpp.html#a743cc0cdc56e37adbb08fc2af9c13be8">IK_END</a>; <span class="keywordflow">break</span>;
<a name="l00205"></a>00205             <span class="keywordflow">case</span> WXK_PAGEUP:        ourkey = <a class="code" href="prefs_8cpp.html#aec8db367cc791fb5c99a3b2e38a4ddf6">IK_PAGEUP</a>; <span class="keywordflow">break</span>;
<a name="l00206"></a>00206             <span class="keywordflow">case</span> WXK_PAGEDOWN:      ourkey = <a class="code" href="prefs_8cpp.html#ad1a5458044bdc32ff93d96f086fa2bfd">IK_PAGEDOWN</a>; <span class="keywordflow">break</span>;
<a name="l00207"></a>00207             <span class="keywordflow">case</span> WXK_HELP:          ourkey = <a class="code" href="prefs_8cpp.html#a1537daf825956aab4039bbab9baa0140">IK_HELP</a>; <span class="keywordflow">break</span>;
<a name="l00208"></a>00208             <span class="keywordflow">case</span> WXK_INSERT:        ourkey = <a class="code" href="prefs_8cpp.html#a0d7f15108fcb879fdc3c7921d6578585">IK_INSERT</a>; <span class="keywordflow">break</span>;
<a name="l00209"></a>00209             <span class="keywordflow">case</span> WXK_BACK:          <span class="comment">// treat backspace like delete</span>
<a name="l00210"></a>00210             <span class="keywordflow">case</span> WXK_DELETE:        ourkey = <a class="code" href="prefs_8cpp.html#a5967a8cb9b042e85495977f9ad95e6ef">IK_DELETE</a>; <span class="keywordflow">break</span>;
<a name="l00211"></a>00211             <span class="keywordflow">case</span> WXK_TAB:           ourkey = <a class="code" href="prefs_8cpp.html#aec1ea857bc767cc31b24c0e635f42828">IK_TAB</a>; <span class="keywordflow">break</span>;
<a name="l00212"></a>00212             <span class="keywordflow">case</span> WXK_NUMPAD_ENTER:  <span class="comment">// treat enter like return</span>
<a name="l00213"></a>00213             <span class="keywordflow">case</span> WXK_RETURN:        ourkey = <a class="code" href="prefs_8cpp.html#a7379baccbdc0bc2eb69d5ace888b3337">IK_RETURN</a>; <span class="keywordflow">break</span>;
<a name="l00214"></a>00214             <span class="keywordflow">case</span> WXK_LEFT:          ourkey = <a class="code" href="prefs_8cpp.html#a98d88c87a65d184c1f501d6062789915">IK_LEFT</a>; <span class="keywordflow">break</span>;
<a name="l00215"></a>00215             <span class="keywordflow">case</span> WXK_RIGHT:         ourkey = <a class="code" href="prefs_8cpp.html#a3aa147d88645e5235409e3ace208c9f9">IK_RIGHT</a>; <span class="keywordflow">break</span>;
<a name="l00216"></a>00216             <span class="keywordflow">case</span> WXK_UP:            ourkey = <a class="code" href="prefs_8cpp.html#aa8222f0c05ece7f3c908487b5775cd69">IK_UP</a>; <span class="keywordflow">break</span>;
<a name="l00217"></a>00217             <span class="keywordflow">case</span> WXK_DOWN:          ourkey = <a class="code" href="prefs_8cpp.html#a1707b12fb040d96287b8578d835d868f">IK_DOWN</a>; <span class="keywordflow">break</span>;
<a name="l00218"></a>00218             <span class="keywordflow">case</span> WXK_ADD:           ourkey = <span class="charliteral">&#39;+&#39;</span>; <span class="keywordflow">break</span>;
<a name="l00219"></a>00219             <span class="keywordflow">case</span> WXK_SUBTRACT:      ourkey = <span class="charliteral">&#39;-&#39;</span>; <span class="keywordflow">break</span>;
<a name="l00220"></a>00220             <span class="keywordflow">case</span> WXK_DIVIDE:        ourkey = <span class="charliteral">&#39;/&#39;</span>; <span class="keywordflow">break</span>;
<a name="l00221"></a>00221             <span class="keywordflow">case</span> WXK_MULTIPLY:      ourkey = <span class="charliteral">&#39;*&#39;</span>; <span class="keywordflow">break</span>;
<a name="l00222"></a>00222             <span class="keywordflow">default</span>:                ourkey = wxkey;
<a name="l00223"></a>00223         }
<a name="l00224"></a>00224     }
<a name="l00225"></a>00225 
<a name="l00226"></a>00226     <span class="keywordflow">if</span> (ourkey &lt; 0 || ourkey &gt;= <a class="code" href="prefs_8cpp.html#a85c7a27ef78976422a68cf49a99bd589">MAX_KEYCODES</a>) <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00227"></a>00227 
<a name="l00228"></a>00228     *newkey = ourkey;
<a name="l00229"></a>00229     *newmods = ourmods;
<a name="l00230"></a>00230     <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00231"></a>00231 }
<a name="l00232"></a>00232 
<a name="l00233"></a>00233 <span class="comment">// -----------------------------------------------------------------------------</span>
<a name="l00234"></a>00234 
<a name="l00235"></a><a class="code" href="prefs_8hpp.html#aa1d8959483b0edb6c9a4b08d52793ce0">00235</a> <a class="code" href="structaction__info.html">action_info</a> <a class="code" href="prefs_8cpp.html#a3c4b979a2ad1be1b0c006967843ee58d">FindAction</a>(<span class="keywordtype">int</span> wxkey, <span class="keywordtype">int</span> wxmods)
<a name="l00236"></a>00236 {
<a name="l00237"></a>00237     <span class="comment">// convert given wx key code and modifier set to our internal values</span>
<a name="l00238"></a>00238     <span class="comment">// and return the corresponding action</span>
<a name="l00239"></a>00239     <span class="keywordtype">int</span> ourkey, ourmods;
<a name="l00240"></a>00240     <span class="keywordflow">if</span> ( <a class="code" href="prefs_8cpp.html#a6947434df6c6efa4e866e0e8667b1096">ConvertKeyAndModifiers</a>(wxkey, wxmods, &amp;ourkey, &amp;ourmods) ) {
<a name="l00241"></a>00241         <span class="keywordflow">return</span> keyaction[ourkey][ourmods];
<a name="l00242"></a>00242     }
<a name="l00243"></a>00243     <span class="keywordflow">else</span> {
<a name="l00244"></a>00244         <span class="keywordflow">return</span> <a class="code" href="prefs_8cpp.html#aff336a15d7bde7902105a8a59ed27133">nullaction</a>;
<a name="l00245"></a>00245     }
<a name="l00246"></a>00246 }
<a name="l00247"></a>00247 
<a name="l00248"></a>00248 <span class="comment">// -----------------------------------------------------------------------------</span>
<a name="l00249"></a>00249 
<a name="l00250"></a><a class="code" href="prefs_8cpp.html#a561f8734ac9b2da848da296a0ce2a8e2">00250</a> <span class="keywordtype">void</span> <a class="code" href="prefs_8cpp.html#a561f8734ac9b2da848da296a0ce2a8e2">AddDefaultKeyActions</a>()
<a name="l00251"></a>00251 {
<a name="l00252"></a>00252     <span class="comment">// File menu</span>
<a name="l00253"></a>00253     keyaction[(int)<span class="charliteral">&#39;n&#39;</span>][<a class="code" href="prefs_8cpp.html#aaca2c4e8c2dbb1214dde1c0bb46dbe2f">mk_CMD</a>].<span class="keywordtype">id</span> =    <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a0a8b90d6d06556d673ffab3fe7bd765a">DO_NEWPATT</a>;
<a name="l00254"></a>00254     keyaction[(int)<span class="charliteral">&#39;o&#39;</span>][<a class="code" href="prefs_8cpp.html#aaca2c4e8c2dbb1214dde1c0bb46dbe2f">mk_CMD</a>].<span class="keywordtype">id</span> =    <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a13b814442bb726fc27e2e46d75f68903">DO_OPENPATT</a>;
<a name="l00255"></a>00255     keyaction[(int)<span class="charliteral">&#39;s&#39;</span>][<a class="code" href="prefs_8cpp.html#aaca2c4e8c2dbb1214dde1c0bb46dbe2f">mk_CMD</a>].<span class="keywordtype">id</span> =    <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62ac14c985dfcd45cba2f41c72260d29ffe">DO_SAVE</a>;
<a name="l00256"></a>00256     keyaction[<a class="code" href="prefs_8cpp.html#a57c7c8d5358f3abaee3223dd89a7274b">IK_F1</a>+2][0].<a class="code" href="structaction__info.html#aa8aa631cd84cd7672b7870e1af6e6863">id</a> =          <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a8031583e5967eecb9ddf9d6a25962e5d">DO_SCREENSHOT</a>;
<a name="l00257"></a>00257 <span class="preprocessor">#ifdef __WXMSW__</span>
<a name="l00258"></a>00258 <span class="preprocessor"></span>    <span class="comment">// Windows does not support ctrl+non-alphanumeric</span>
<a name="l00259"></a>00259 <span class="preprocessor">#else</span>
<a name="l00260"></a>00260 <span class="preprocessor"></span>    keyaction[(int)<span class="charliteral">&#39;,&#39;</span>][<a class="code" href="prefs_8cpp.html#aaca2c4e8c2dbb1214dde1c0bb46dbe2f">mk_CMD</a>].<span class="keywordtype">id</span> =    <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a9df6720475a3f3e52740a0250774dee2">DO_PREFS</a>;
<a name="l00261"></a>00261 <span class="preprocessor">#endif</span>
<a name="l00262"></a>00262 <span class="preprocessor"></span>    keyaction[(int)<span class="charliteral">&#39;,&#39;</span>][0].<span class="keywordtype">id</span> =         <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a9df6720475a3f3e52740a0250774dee2">DO_PREFS</a>;
<a name="l00263"></a>00263     keyaction[(int)<span class="charliteral">&#39;q&#39;</span>][<a class="code" href="prefs_8cpp.html#aaca2c4e8c2dbb1214dde1c0bb46dbe2f">mk_CMD</a>].<span class="keywordtype">id</span> =    <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a0d23c152db0c24154c6a13303a6151a4">DO_QUIT</a>;
<a name="l00264"></a>00264 
<a name="l00265"></a>00265     <span class="comment">// Edit menu</span>
<a name="l00266"></a>00266     keyaction[(int)<span class="charliteral">&#39;z&#39;</span>][<a class="code" href="prefs_8cpp.html#aaca2c4e8c2dbb1214dde1c0bb46dbe2f">mk_CMD</a>].<span class="keywordtype">id</span> =    <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a833eea9a56c8e57c791f512d2a536f97">DO_UNDO</a>;
<a name="l00267"></a>00267 <span class="preprocessor">#ifdef __WXMAC__</span>
<a name="l00268"></a>00268 <span class="preprocessor"></span>    keyaction[(int)<span class="charliteral">&#39;z&#39;</span>][<a class="code" href="prefs_8cpp.html#a438c6e768372ad8199c47855d968ed12">mk_SHIFT</a>+<a class="code" href="prefs_8cpp.html#aaca2c4e8c2dbb1214dde1c0bb46dbe2f">mk_CMD</a>].<span class="keywordtype">id</span> = <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a56d64e915e9ea79e9fecf08ddc904103">DO_REDO</a>;
<a name="l00269"></a>00269 <span class="preprocessor">#else</span>
<a name="l00270"></a>00270 <span class="preprocessor"></span>    keyaction[(int)<span class="charliteral">&#39;y&#39;</span>][<a class="code" href="prefs_8cpp.html#aaca2c4e8c2dbb1214dde1c0bb46dbe2f">mk_CMD</a>].<span class="keywordtype">id</span> =    <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a56d64e915e9ea79e9fecf08ddc904103">DO_REDO</a>;
<a name="l00271"></a>00271 <span class="preprocessor">#endif</span>
<a name="l00272"></a>00272 <span class="preprocessor"></span>    keyaction[(int)<span class="charliteral">&#39;x&#39;</span>][<a class="code" href="prefs_8cpp.html#aaca2c4e8c2dbb1214dde1c0bb46dbe2f">mk_CMD</a>].<span class="keywordtype">id</span> =    <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a86e6bb0ed1ed8e2b71aeee759d04f751">DO_CUT</a>;
<a name="l00273"></a>00273     keyaction[(int)<span class="charliteral">&#39;c&#39;</span>][<a class="code" href="prefs_8cpp.html#aaca2c4e8c2dbb1214dde1c0bb46dbe2f">mk_CMD</a>].<span class="keywordtype">id</span> =    <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a66ab504cb136ee10d90b5041b69b1072">DO_COPY</a>;
<a name="l00274"></a>00274     keyaction[(int)<span class="charliteral">&#39;v&#39;</span>][<a class="code" href="prefs_8cpp.html#aaca2c4e8c2dbb1214dde1c0bb46dbe2f">mk_CMD</a>].<span class="keywordtype">id</span> =    <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a57db23febf9d70735b2d5429f9322921">DO_PASTE</a>;
<a name="l00275"></a>00275     keyaction[(int)<span class="charliteral">&#39;a&#39;</span>][<a class="code" href="prefs_8cpp.html#aaca2c4e8c2dbb1214dde1c0bb46dbe2f">mk_CMD</a>].<span class="keywordtype">id</span> =    <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a5e89d8bab01100c776f98476f132750c">DO_SELALL</a>;
<a name="l00276"></a>00276 
<a name="l00277"></a>00277     <span class="comment">// View menu</span>
<a name="l00278"></a>00278     keyaction[<a class="code" href="prefs_8cpp.html#a57c7c8d5358f3abaee3223dd89a7274b">IK_F1</a>+10][0].<a class="code" href="structaction__info.html#aa8aa631cd84cd7672b7870e1af6e6863">id</a> =         <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a14ccfd2e63a339d4172bda3ad550fff2">DO_FULLSCREEN</a>;
<a name="l00279"></a>00279     keyaction[(int)<span class="charliteral">&#39;f&#39;</span>][<a class="code" href="prefs_8cpp.html#aaca2c4e8c2dbb1214dde1c0bb46dbe2f">mk_CMD</a>].<span class="keywordtype">id</span> =    <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a4b6a631192c5074db6357ebea2a4caf0">DO_FIT</a>;
<a name="l00280"></a>00280     keyaction[(int)<span class="charliteral">&#39;w&#39;</span>][0].<span class="keywordtype">id</span> =         <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a069bd47d4f1f5762840246bb5a52bebf">DO_WIREFRAME</a>;
<a name="l00281"></a>00281     keyaction[(int)<span class="charliteral">&#39;p&#39;</span>][<a class="code" href="prefs_8cpp.html#aaca2c4e8c2dbb1214dde1c0bb46dbe2f">mk_CMD</a>].<span class="keywordtype">id</span> =    <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a57a2af46aa8cd3deb36042aa2a05a4f0">DO_PATTERNS</a>;
<a name="l00282"></a>00282     keyaction[(int)<span class="charliteral">&#39;i&#39;</span>][<a class="code" href="prefs_8cpp.html#aaca2c4e8c2dbb1214dde1c0bb46dbe2f">mk_CMD</a>].<span class="keywordtype">id</span> =    <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a3b10246f0f8338327b892109a70eca29">DO_INFO</a>;
<a name="l00283"></a>00283     keyaction[(int)<span class="charliteral">&#39;h&#39;</span>][0].<span class="keywordtype">id</span> =         <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a150b825efd182d9c95b587c9ef5516b9">DO_HELP</a>;
<a name="l00284"></a>00284     keyaction[(int)<span class="charliteral">&#39;?&#39;</span>][0].<span class="keywordtype">id</span> =         <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a150b825efd182d9c95b587c9ef5516b9">DO_HELP</a>;
<a name="l00285"></a>00285     keyaction[<a class="code" href="prefs_8cpp.html#a1537daf825956aab4039bbab9baa0140">IK_HELP</a>][0].<a class="code" href="structaction__info.html#aa8aa631cd84cd7672b7870e1af6e6863">id</a> =          <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a150b825efd182d9c95b587c9ef5516b9">DO_HELP</a>;
<a name="l00286"></a>00286 <span class="preprocessor">#ifdef __WXMAC__</span>
<a name="l00287"></a>00287 <span class="preprocessor"></span>    <span class="comment">// cmd-? is the usual shortcut in Mac apps</span>
<a name="l00288"></a>00288     keyaction[(int)<span class="charliteral">&#39;?&#39;</span>][<a class="code" href="prefs_8cpp.html#aaca2c4e8c2dbb1214dde1c0bb46dbe2f">mk_CMD</a>].<span class="keywordtype">id</span> =    <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a150b825efd182d9c95b587c9ef5516b9">DO_HELP</a>;
<a name="l00289"></a>00289     <span class="comment">// we can only detect shift+cmd+/ so we have to assume &#39;?&#39; is above &#39;/&#39; -- yuk</span>
<a name="l00290"></a>00290     keyaction[(int)<span class="charliteral">&#39;/&#39;</span>][<a class="code" href="prefs_8cpp.html#a438c6e768372ad8199c47855d968ed12">mk_SHIFT</a>+<a class="code" href="prefs_8cpp.html#aaca2c4e8c2dbb1214dde1c0bb46dbe2f">mk_CMD</a>].<span class="keywordtype">id</span> = <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a150b825efd182d9c95b587c9ef5516b9">DO_HELP</a>;
<a name="l00291"></a>00291 <span class="preprocessor">#else</span>
<a name="l00292"></a>00292 <span class="preprocessor"></span>    <span class="comment">// F1 is the usual shortcut in Win/Linux apps</span>
<a name="l00293"></a>00293     keyaction[<a class="code" href="prefs_8cpp.html#a57c7c8d5358f3abaee3223dd89a7274b">IK_F1</a>][0].<a class="code" href="structaction__info.html#aa8aa631cd84cd7672b7870e1af6e6863">id</a> =            <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a150b825efd182d9c95b587c9ef5516b9">DO_HELP</a>;
<a name="l00294"></a>00294 <span class="preprocessor">#endif</span>
<a name="l00295"></a>00295 <span class="preprocessor"></span>
<a name="l00296"></a>00296     <span class="comment">// Action menu</span>
<a name="l00297"></a>00297     keyaction[(int)<span class="charliteral">&#39; &#39;</span>][0].<span class="keywordtype">id</span> =         <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a5b6cbabe6909263c772ceb091fb2edcd">DO_STEP1</a>;
<a name="l00298"></a>00298     keyaction[<a class="code" href="prefs_8cpp.html#aec1ea857bc767cc31b24c0e635f42828">IK_TAB</a>][0].<a class="code" href="structaction__info.html#aa8aa631cd84cd7672b7870e1af6e6863">id</a> =           <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62af6d9327fcfb8264f43b07cb94d66ec10">DO_STEPN</a>;
<a name="l00299"></a>00299     keyaction[<a class="code" href="prefs_8cpp.html#a7379baccbdc0bc2eb69d5ace888b3337">IK_RETURN</a>][0].<a class="code" href="structaction__info.html#aa8aa631cd84cd7672b7870e1af6e6863">id</a> =        <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62ad6773bc2d8b3a475b59775af5afc215c">DO_RUNSTOP</a>;
<a name="l00300"></a>00300     keyaction[(int)<span class="charliteral">&#39;r&#39;</span>][<a class="code" href="prefs_8cpp.html#aaca2c4e8c2dbb1214dde1c0bb46dbe2f">mk_CMD</a>].<span class="keywordtype">id</span> =    <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a4165bc81d865b678b2f9b7410eed6018">DO_RESET</a>;
<a name="l00301"></a>00301     keyaction[(int)<span class="charliteral">&#39;+&#39;</span>][0].<span class="keywordtype">id</span> =         <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a389cee4c4147fecd61a4d134396e2e72">DO_FASTER</a>;
<a name="l00302"></a>00302     keyaction[(int)<span class="charliteral">&#39;+&#39;</span>][<a class="code" href="prefs_8cpp.html#a438c6e768372ad8199c47855d968ed12">mk_SHIFT</a>].<span class="keywordtype">id</span> =  <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a389cee4c4147fecd61a4d134396e2e72">DO_FASTER</a>;
<a name="l00303"></a>00303     keyaction[(int)<span class="charliteral">&#39;=&#39;</span>][0].<span class="keywordtype">id</span> =         <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a389cee4c4147fecd61a4d134396e2e72">DO_FASTER</a>;
<a name="l00304"></a>00304     keyaction[(int)<span class="charliteral">&#39;_&#39;</span>][0].<span class="keywordtype">id</span> =         <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a53386a419f01d0b75372910dc9260c7e">DO_SLOWER</a>;
<a name="l00305"></a>00305     keyaction[(int)<span class="charliteral">&#39;_&#39;</span>][<a class="code" href="prefs_8cpp.html#a438c6e768372ad8199c47855d968ed12">mk_SHIFT</a>].<span class="keywordtype">id</span> =  <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a53386a419f01d0b75372910dc9260c7e">DO_SLOWER</a>;
<a name="l00306"></a>00306     keyaction[(int)<span class="charliteral">&#39;-&#39;</span>][0].<span class="keywordtype">id</span> =         <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a53386a419f01d0b75372910dc9260c7e">DO_SLOWER</a>;
<a name="l00307"></a>00307 }
<a name="l00308"></a>00308 
<a name="l00309"></a>00309 <span class="comment">// -----------------------------------------------------------------------------</span>
<a name="l00310"></a>00310 
<a name="l00311"></a><a class="code" href="prefs_8cpp.html#a2ac81d5c096ce8b42e14d8b0d7e12b6e">00311</a> <span class="keyword">const</span> <span class="keywordtype">char</span>* <a class="code" href="prefs_8cpp.html#a2ac81d5c096ce8b42e14d8b0d7e12b6e">GetActionName</a>(<a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62">action_id</a> action)
<a name="l00312"></a>00312 {
<a name="l00313"></a>00313     <span class="keywordflow">switch</span> (action) {
<a name="l00314"></a>00314         <span class="keywordflow">case</span> <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62aa3c06bc7e4d652a970cab72026c6fed1">DO_NOTHING</a>:        <span class="keywordflow">return</span> <span class="stringliteral">&quot;NONE&quot;</span>;
<a name="l00315"></a>00315         <span class="keywordflow">case</span> <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a143bfdd54d27e620ee14307ec3cbd989">DO_OPENFILE</a>:       <span class="keywordflow">return</span> <span class="stringliteral">&quot;Open:&quot;</span>;
<a name="l00316"></a>00316         <span class="comment">// File menu</span>
<a name="l00317"></a>00317         <span class="keywordflow">case</span> <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a0a8b90d6d06556d673ffab3fe7bd765a">DO_NEWPATT</a>:        <span class="keywordflow">return</span> <span class="stringliteral">&quot;New Pattern&quot;</span>;
<a name="l00318"></a>00318         <span class="keywordflow">case</span> <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a13b814442bb726fc27e2e46d75f68903">DO_OPENPATT</a>:       <span class="keywordflow">return</span> <span class="stringliteral">&quot;Open Pattern...&quot;</span>;
<a name="l00319"></a>00319         <span class="keywordflow">case</span> <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62ae20cb524276f390aad2a8e31a85da68b">DO_RELOAD</a>:         <span class="keywordflow">return</span> <span class="stringliteral">&quot;Reload from Disk&quot;</span>;
<a name="l00320"></a>00320         <span class="keywordflow">case</span> <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a1f4076bb401751fd60b827874e30b09c">DO_IMPORTMESH</a>:     <span class="keywordflow">return</span> <span class="stringliteral">&quot;Import Mesh...&quot;</span>;
<a name="l00321"></a>00321         <span class="keywordflow">case</span> <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a3b71061f14e65228175c258013cbec1c">DO_EXPORTMESH</a>:     <span class="keywordflow">return</span> <span class="stringliteral">&quot;Export Mesh...&quot;</span>;
<a name="l00322"></a>00322         <span class="keywordflow">case</span> <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62ad485985a3e2b6d4f2e4385e9a989ff0c">DO_EXPORTIMAGE</a>:    <span class="keywordflow">return</span> <span class="stringliteral">&quot;Export Image...&quot;</span>;
<a name="l00323"></a>00323         <span class="keywordflow">case</span> <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62ac14c985dfcd45cba2f41c72260d29ffe">DO_SAVE</a>:           <span class="keywordflow">return</span> <span class="stringliteral">&quot;Save Pattern...&quot;</span>;
<a name="l00324"></a>00324         <span class="keywordflow">case</span> <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a43ae0ea688610ce2cd3e579715f7cd94">DO_SAVECOMPACT</a>:    <span class="keywordflow">return</span> <span class="stringliteral">&quot;Save Compact...&quot;</span>;
<a name="l00325"></a>00325         <span class="keywordflow">case</span> <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a8031583e5967eecb9ddf9d6a25962e5d">DO_SCREENSHOT</a>:     <span class="keywordflow">return</span> <span class="stringliteral">&quot;Save Screenshot...&quot;</span>;
<a name="l00326"></a>00326         <span class="keywordflow">case</span> <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62adf45d148a58cce130037eaa02b52b313">DO_RECORDFRAMES</a>:   <span class="keywordflow">return</span> <span class="stringliteral">&quot;Start Recording...&quot;</span>;
<a name="l00327"></a>00327         <span class="keywordflow">case</span> <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a9b0e09a8a5af3eeda22366ae9a682b06">DO_ADDPATTS</a>:       <span class="keywordflow">return</span> <span class="stringliteral">&quot;Add My Patterns...&quot;</span>;
<a name="l00328"></a>00328         <span class="keywordflow">case</span> <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a9df6720475a3f3e52740a0250774dee2">DO_PREFS</a>:          <span class="keywordflow">return</span> <span class="stringliteral">&quot;Preferences...&quot;</span>;
<a name="l00329"></a>00329         <span class="keywordflow">case</span> <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a0d23c152db0c24154c6a13303a6151a4">DO_QUIT</a>:           <span class="keywordflow">return</span> <span class="stringliteral">&quot;Quit Ready&quot;</span>;
<a name="l00330"></a>00330         <span class="comment">// Edit menu</span>
<a name="l00331"></a>00331         <span class="keywordflow">case</span> <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a833eea9a56c8e57c791f512d2a536f97">DO_UNDO</a>:           <span class="keywordflow">return</span> <span class="stringliteral">&quot;Undo&quot;</span>;
<a name="l00332"></a>00332         <span class="keywordflow">case</span> <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a56d64e915e9ea79e9fecf08ddc904103">DO_REDO</a>:           <span class="keywordflow">return</span> <span class="stringliteral">&quot;Redo&quot;</span>;
<a name="l00333"></a>00333         <span class="keywordflow">case</span> <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a86e6bb0ed1ed8e2b71aeee759d04f751">DO_CUT</a>:            <span class="keywordflow">return</span> <span class="stringliteral">&quot;Cut Selection&quot;</span>;
<a name="l00334"></a>00334         <span class="keywordflow">case</span> <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a66ab504cb136ee10d90b5041b69b1072">DO_COPY</a>:           <span class="keywordflow">return</span> <span class="stringliteral">&quot;Copy Selection&quot;</span>;
<a name="l00335"></a>00335         <span class="keywordflow">case</span> <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a57db23febf9d70735b2d5429f9322921">DO_PASTE</a>:          <span class="keywordflow">return</span> <span class="stringliteral">&quot;Paste&quot;</span>;
<a name="l00336"></a>00336         <span class="keywordflow">case</span> <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62ad1502fb1fa8a6db8f0d5eab8c5ea1795">DO_CLEAR</a>:          <span class="keywordflow">return</span> <span class="stringliteral">&quot;Clear Selection&quot;</span>;
<a name="l00337"></a>00337         <span class="keywordflow">case</span> <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a5e89d8bab01100c776f98476f132750c">DO_SELALL</a>:         <span class="keywordflow">return</span> <span class="stringliteral">&quot;Select All&quot;</span>;
<a name="l00338"></a>00338         <span class="keywordflow">case</span> <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a66d7e048711b0cb03d4fe2548def17a8">DO_POINTER</a>:        <span class="keywordflow">return</span> <span class="stringliteral">&quot;Select Pointer Tool&quot;</span>;
<a name="l00339"></a>00339         <span class="keywordflow">case</span> <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a00b376324c5badbfd84bac3aab63a31c">DO_PENCIL</a>:         <span class="keywordflow">return</span> <span class="stringliteral">&quot;Select Pencil Tool&quot;</span>;
<a name="l00340"></a>00340         <span class="keywordflow">case</span> <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a27b2f7b267d983a45e0e41877322da9e">DO_BRUSH</a>:          <span class="keywordflow">return</span> <span class="stringliteral">&quot;Select Brush Tool&quot;</span>;
<a name="l00341"></a>00341         <span class="keywordflow">case</span> <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a2ad7275900c93e5b40f0a1941251ec45">DO_PICKER</a>:         <span class="keywordflow">return</span> <span class="stringliteral">&quot;Select Color Picker Tool&quot;</span>;
<a name="l00342"></a>00342         <span class="keywordflow">case</span> <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62ad661d1cec05119131e12e8bd348aea34">DO_BRUSHSMALL</a>:     <span class="keywordflow">return</span> <span class="stringliteral">&quot;Select Small Brush&quot;</span>;
<a name="l00343"></a>00343         <span class="keywordflow">case</span> <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a17114b44ec886754588d67bbda4c1397">DO_BRUSHMEDIUM</a>:    <span class="keywordflow">return</span> <span class="stringliteral">&quot;Select Medium Brush&quot;</span>;
<a name="l00344"></a>00344         <span class="keywordflow">case</span> <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62ab9dbab9024a4115978609b107fda64c1">DO_BRUSHLARGE</a>:     <span class="keywordflow">return</span> <span class="stringliteral">&quot;Select Large Brush&quot;</span>;
<a name="l00345"></a>00345         <span class="comment">// View menu</span>
<a name="l00346"></a>00346         <span class="keywordflow">case</span> <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a14ccfd2e63a339d4172bda3ad550fff2">DO_FULLSCREEN</a>:     <span class="keywordflow">return</span> <span class="stringliteral">&quot;Full Screen&quot;</span>;
<a name="l00347"></a>00347         <span class="keywordflow">case</span> <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a4b6a631192c5074db6357ebea2a4caf0">DO_FIT</a>:            <span class="keywordflow">return</span> <span class="stringliteral">&quot;Fit Pattern&quot;</span>;
<a name="l00348"></a>00348         <span class="keywordflow">case</span> <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a069bd47d4f1f5762840246bb5a52bebf">DO_WIREFRAME</a>:      <span class="keywordflow">return</span> <span class="stringliteral">&quot;Wireframe&quot;</span>;
<a name="l00349"></a>00349         <span class="keywordflow">case</span> <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a57a2af46aa8cd3deb36042aa2a05a4f0">DO_PATTERNS</a>:       <span class="keywordflow">return</span> <span class="stringliteral">&quot;Show Patterns Pane&quot;</span>;
<a name="l00350"></a>00350         <span class="keywordflow">case</span> <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a3b10246f0f8338327b892109a70eca29">DO_INFO</a>:           <span class="keywordflow">return</span> <span class="stringliteral">&quot;Show Info Pane&quot;</span>;
<a name="l00351"></a>00351         <span class="keywordflow">case</span> <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a150b825efd182d9c95b587c9ef5516b9">DO_HELP</a>:           <span class="keywordflow">return</span> <span class="stringliteral">&quot;Show Help Pane&quot;</span>;
<a name="l00352"></a>00352         <span class="keywordflow">case</span> <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a0f9579471eef04f9463c2abf4d71fbfc">DO_FILETOOLBAR</a>:    <span class="keywordflow">return</span> <span class="stringliteral">&quot;Show File Toolbar&quot;</span>;
<a name="l00353"></a>00353         <span class="keywordflow">case</span> <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62aecc7def1072bf7ddb7a3180620d20329">DO_ACTIONTOOLBAR</a>:  <span class="keywordflow">return</span> <span class="stringliteral">&quot;Show Action Toolbar&quot;</span>;
<a name="l00354"></a>00354         <span class="keywordflow">case</span> <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a71f85bf1a16bd068b7f93aca687446ae">DO_PAINTTOOLBAR</a>:   <span class="keywordflow">return</span> <span class="stringliteral">&quot;Show Paint Toolbar&quot;</span>;
<a name="l00355"></a>00355         <span class="keywordflow">case</span> <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62afb76022044b62bb892c1ee65ac4ef721">DO_RESTORE</a>:        <span class="keywordflow">return</span> <span class="stringliteral">&quot;Restore Default Layout&quot;</span>;
<a name="l00356"></a>00356         <span class="keywordflow">case</span> <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a776300076489934b1008c8d05602a494">DO_CHEMICAL</a>:       <span class="keywordflow">return</span> <span class="stringliteral">&quot;Change Active Chemical...&quot;</span>;
<a name="l00357"></a>00357         <span class="comment">// Action menu</span>
<a name="l00358"></a>00358         <span class="keywordflow">case</span> <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a5b6cbabe6909263c772ceb091fb2edcd">DO_STEP1</a>:          <span class="keywordflow">return</span> <span class="stringliteral">&quot;Step by 1&quot;</span>;
<a name="l00359"></a>00359         <span class="keywordflow">case</span> <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62af6d9327fcfb8264f43b07cb94d66ec10">DO_STEPN</a>:          <span class="keywordflow">return</span> <span class="stringliteral">&quot;Step by N&quot;</span>;
<a name="l00360"></a>00360         <span class="keywordflow">case</span> <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62ad6773bc2d8b3a475b59775af5afc215c">DO_RUNSTOP</a>:        <span class="keywordflow">return</span> <span class="stringliteral">&quot;Run/Stop&quot;</span>;
<a name="l00361"></a>00361         <span class="keywordflow">case</span> <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a389cee4c4147fecd61a4d134396e2e72">DO_FASTER</a>:         <span class="keywordflow">return</span> <span class="stringliteral">&quot;Run Faster&quot;</span>;
<a name="l00362"></a>00362         <span class="keywordflow">case</span> <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a53386a419f01d0b75372910dc9260c7e">DO_SLOWER</a>:         <span class="keywordflow">return</span> <span class="stringliteral">&quot;Run Slower&quot;</span>;
<a name="l00363"></a>00363         <span class="keywordflow">case</span> <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62ae99153a35a4d051301adf666e9263afe">DO_CHANGESPEED</a>:    <span class="keywordflow">return</span> <span class="stringliteral">&quot;Change Running Speed...&quot;</span>;
<a name="l00364"></a>00364         <span class="keywordflow">case</span> <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a4165bc81d865b678b2f9b7410eed6018">DO_RESET</a>:          <span class="keywordflow">return</span> <span class="stringliteral">&quot;Reset&quot;</span>;
<a name="l00365"></a>00365         <span class="keywordflow">case</span> <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a4fe766d76d47511ceac02eff795a8b58">DO_GENPATT</a>:        <span class="keywordflow">return</span> <span class="stringliteral">&quot;Generate Initial Pattern&quot;</span>;
<a name="l00366"></a>00366         <span class="keywordflow">case</span> <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a00385d86c86e7885de37c86cf08587fc">DO_BLANK</a>:          <span class="keywordflow">return</span> <span class="stringliteral">&quot;Blank&quot;</span>;
<a name="l00367"></a>00367         <span class="keywordflow">case</span> <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62aa4d123ec804f00f2a2e6668d0c3770fe">DO_ADDPARAM</a>:       <span class="keywordflow">return</span> <span class="stringliteral">&quot;Add Parameter...&quot;</span>;
<a name="l00368"></a>00368         <span class="keywordflow">case</span> <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a2d72ebc020c77a64e833c939c6dabbd6">DO_DELPARAM</a>:       <span class="keywordflow">return</span> <span class="stringliteral">&quot;Delete Parameter...&quot;</span>;
<a name="l00369"></a>00369         <span class="keywordflow">case</span> <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a2f1156f3997ca07f6a87461122ee21d8">DO_VIEWKERNEL</a>:     <span class="keywordflow">return</span> <span class="stringliteral">&quot;View Full Kernel&quot;</span>;
<a name="l00370"></a>00370         <span class="keywordflow">case</span> <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62af1a82d6dc7f8408e80a8d563591d88df">DO_CONVERTTOKERNEL</a>:<span class="keywordflow">return</span> <span class="stringliteral">&quot;Convert to Full Kernel&quot;</span>;
<a name="l00371"></a>00371         <span class="keywordflow">case</span> <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62acb4c9b11dea3500cc66f3f402c084a2a">DO_DEVICE</a>:         <span class="keywordflow">return</span> <span class="stringliteral">&quot;Select OpenCL Device...&quot;</span>;
<a name="l00372"></a>00372         <span class="keywordflow">case</span> <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a47d344b75c0413566f55457e40d54914">DO_OPENCL</a>:         <span class="keywordflow">return</span> <span class="stringliteral">&quot;Show OpenCL Diagnostics...&quot;</span>;
<a name="l00373"></a>00373         <span class="comment">// Help menu</span>
<a name="l00374"></a>00374         <span class="keywordflow">case</span> <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a6c41bc6a32c0c5bb09a732a21cfccf4f">DO_ABOUT</a>:          <span class="keywordflow">return</span> <span class="stringliteral">&quot;About Ready&quot;</span>;
<a name="l00375"></a>00375         <span class="keywordflow">default</span>:                <a class="code" href="wxutils_8cpp.html#ad496c0028843186f55032174260d2732">Warning</a>(_(<span class="stringliteral">&quot;Bug detected in GetActionName!&quot;</span>));
<a name="l00376"></a>00376     }
<a name="l00377"></a>00377     <span class="keywordflow">return</span> <span class="stringliteral">&quot;BUG&quot;</span>;
<a name="l00378"></a>00378 }
<a name="l00379"></a>00379 
<a name="l00380"></a>00380 <span class="comment">// -----------------------------------------------------------------------------</span>
<a name="l00381"></a>00381 
<a name="l00382"></a>00382 <span class="comment">// is there really no C++ standard for case-insensitive string comparison???</span>
<a name="l00383"></a>00383 <span class="preprocessor">#ifdef __WXMSW__</span>
<a name="l00384"></a>00384 <span class="preprocessor"></span><span class="preprocessor">#define ISTRCMP stricmp</span>
<a name="l00385"></a>00385 <span class="preprocessor"></span><span class="preprocessor">#else</span>
<a name="l00386"></a><a class="code" href="prefs_8cpp.html#a4efbb03b97f31d2fd0c63579d810f557">00386</a> <span class="preprocessor"></span><span class="preprocessor">#define ISTRCMP strcasecmp</span>
<a name="l00387"></a>00387 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l00388"></a>00388 <span class="preprocessor"></span>
<a name="l00389"></a><a class="code" href="prefs_8cpp.html#aff3f148d06f6af72b4b962ac2ec6f52d">00389</a> <span class="keywordtype">void</span> <a class="code" href="prefs_8cpp.html#aff3f148d06f6af72b4b962ac2ec6f52d">GetKeyAction</a>(<span class="keywordtype">char</span>* value)
<a name="l00390"></a>00390 {
<a name="l00391"></a>00391     <span class="comment">// parse strings like &quot;z undo&quot; or &quot;space+ctrl advance selection&quot;;</span>
<a name="l00392"></a>00392     <span class="comment">// note that some errors detected here can be Fatal because the user</span>
<a name="l00393"></a>00393     <span class="comment">// has to quit Ready anyway to edit the prefs file</span>
<a name="l00394"></a>00394     <span class="keywordtype">char</span>* start = value;
<a name="l00395"></a>00395     <span class="keywordtype">char</span>* p = start;
<a name="l00396"></a>00396     <span class="keywordtype">int</span> modset = 0;
<a name="l00397"></a>00397     <span class="keywordtype">int</span> key = -1;
<a name="l00398"></a>00398 
<a name="l00399"></a>00399     <span class="comment">// extract key, skipping first char in case it&#39;s &#39;+&#39;</span>
<a name="l00400"></a>00400     <span class="keywordflow">if</span> (*p &gt; 0) p++;
<a name="l00401"></a>00401     <span class="keywordflow">while</span> (1) {
<a name="l00402"></a>00402         <span class="keywordflow">if</span> (*p == 0) {
<a name="l00403"></a>00403             <a class="code" href="wxutils_8cpp.html#a871ab5f4d4e52fe248abb483c05ab688">Fatal</a>(wxString::Format(_(<span class="stringliteral">&quot;Bad key_action value: %s&quot;</span>),
<a name="l00404"></a>00404                 wxString(value,wxConvLocal).c_str()));
<a name="l00405"></a>00405         }
<a name="l00406"></a>00406         <span class="keywordflow">if</span> (*p == <span class="charliteral">&#39; &#39;</span> || *p == <span class="charliteral">&#39;+&#39;</span>) {
<a name="l00407"></a>00407             <span class="comment">// we found end of key</span>
<a name="l00408"></a>00408             <span class="keywordtype">char</span> oldp = *p;
<a name="l00409"></a>00409             *p = 0;
<a name="l00410"></a>00410             <span class="keywordtype">int</span> len = strlen(start);
<a name="l00411"></a>00411             <span class="keywordflow">if</span> (len == 1) {
<a name="l00412"></a>00412                 key = start[0];
<a name="l00413"></a>00413                 <span class="keywordflow">if</span> (key &lt; &#39; &#39; || key &gt; <span class="charliteral">&#39;~&#39;</span>) {
<a name="l00414"></a>00414                     <a class="code" href="wxutils_8cpp.html#a871ab5f4d4e52fe248abb483c05ab688">Fatal</a>(wxString::Format(_(<span class="stringliteral">&quot;Non-displayable key in key_action: code = %d&quot;</span>), key));
<a name="l00415"></a>00415                 }
<a name="l00416"></a>00416                 <span class="keywordflow">if</span> (key &gt;= <span class="charliteral">&#39;A&#39;</span> &amp;&amp; key &lt;= <span class="charliteral">&#39;Z&#39;</span>) {
<a name="l00417"></a>00417                     <span class="comment">// convert A..Z to shift+a..shift+z so we can use A..X</span>
<a name="l00418"></a>00418                     <span class="comment">// for our internal function keys (IK_F1 to IK_F24)</span>
<a name="l00419"></a>00419                     key += 32;
<a name="l00420"></a>00420                     modset |= <a class="code" href="prefs_8cpp.html#a438c6e768372ad8199c47855d968ed12">mk_SHIFT</a>;
<a name="l00421"></a>00421                 }
<a name="l00422"></a>00422             }
<a name="l00423"></a>00423             <span class="keywordflow">else</span> <span class="keywordflow">if</span> (len &gt; 1) {
<a name="l00424"></a>00424                 <span class="keywordflow">if</span> ((start[0] == <span class="charliteral">&#39;f&#39;</span> || start[0] == <span class="charliteral">&#39;F&#39;</span>) &amp;&amp; start[1] &gt;= <span class="charliteral">&#39;1&#39;</span> &amp;&amp; start[1] &lt;= <span class="charliteral">&#39;9&#39;</span>) {
<a name="l00425"></a>00425                     <span class="comment">// we have a function key</span>
<a name="l00426"></a>00426                     <span class="keywordtype">char</span>* p = &amp;start[1];
<a name="l00427"></a>00427                     <span class="keywordtype">int</span> num;
<a name="l00428"></a>00428                     sscanf(p, <span class="stringliteral">&quot;%d&quot;</span>, &amp;num);
<a name="l00429"></a>00429                     <span class="keywordflow">if</span> (num &gt;= 1 &amp;&amp; num &lt;= 24) key = <a class="code" href="prefs_8cpp.html#a57c7c8d5358f3abaee3223dd89a7274b">IK_F1</a> + num - 1;
<a name="l00430"></a>00430                 }
<a name="l00431"></a>00431                 <span class="keywordflow">else</span> {
<a name="l00432"></a>00432                     <span class="keywordflow">if</span>      (<a class="code" href="prefs_8cpp.html#a4efbb03b97f31d2fd0c63579d810f557">ISTRCMP</a>(start, <a class="code" href="prefs_8cpp.html#a17e778db891c6f7af059a304bdae4c1e">NK_HOME</a>) == 0)    key = <a class="code" href="prefs_8cpp.html#abe22f9c221bffb446bd16099e41d31f3">IK_HOME</a>;
<a name="l00433"></a>00433                     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="prefs_8cpp.html#a4efbb03b97f31d2fd0c63579d810f557">ISTRCMP</a>(start, <a class="code" href="prefs_8cpp.html#adc814fa2c8c13c085ddaa4fb06d963b1">NK_END</a>) == 0)     key = <a class="code" href="prefs_8cpp.html#a743cc0cdc56e37adbb08fc2af9c13be8">IK_END</a>;
<a name="l00434"></a>00434                     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="prefs_8cpp.html#a4efbb03b97f31d2fd0c63579d810f557">ISTRCMP</a>(start, <a class="code" href="prefs_8cpp.html#a838b9bb86001b6fd1cb684a32c4d4be6">NK_PGUP</a>) == 0)    key = <a class="code" href="prefs_8cpp.html#aec8db367cc791fb5c99a3b2e38a4ddf6">IK_PAGEUP</a>;
<a name="l00435"></a>00435                     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="prefs_8cpp.html#a4efbb03b97f31d2fd0c63579d810f557">ISTRCMP</a>(start, <a class="code" href="prefs_8cpp.html#a65899dabf9d10827b1d04186ede6d96f">NK_PGDN</a>) == 0)    key = <a class="code" href="prefs_8cpp.html#ad1a5458044bdc32ff93d96f086fa2bfd">IK_PAGEDOWN</a>;
<a name="l00436"></a>00436                     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="prefs_8cpp.html#a4efbb03b97f31d2fd0c63579d810f557">ISTRCMP</a>(start, <a class="code" href="prefs_8cpp.html#ab984d5104fb7d6099ad625c91bdf7a2c">NK_HELP</a>) == 0)    key = <a class="code" href="prefs_8cpp.html#a1537daf825956aab4039bbab9baa0140">IK_HELP</a>;
<a name="l00437"></a>00437                     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="prefs_8cpp.html#a4efbb03b97f31d2fd0c63579d810f557">ISTRCMP</a>(start, <a class="code" href="prefs_8cpp.html#a5295ec9f3627911411a16979e25ddf27">NK_INSERT</a>) == 0)  key = <a class="code" href="prefs_8cpp.html#a0d7f15108fcb879fdc3c7921d6578585">IK_INSERT</a>;
<a name="l00438"></a>00438                     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="prefs_8cpp.html#a4efbb03b97f31d2fd0c63579d810f557">ISTRCMP</a>(start, <a class="code" href="prefs_8cpp.html#ab8fb90af2ccf1dad92336c2c0eeef6f4">NK_DELETE</a>) == 0)  key = <a class="code" href="prefs_8cpp.html#a5967a8cb9b042e85495977f9ad95e6ef">IK_DELETE</a>;
<a name="l00439"></a>00439                     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="prefs_8cpp.html#a4efbb03b97f31d2fd0c63579d810f557">ISTRCMP</a>(start, <a class="code" href="prefs_8cpp.html#a4cf00ed212021171783c0dea82ab6608">NK_TAB</a>) == 0)     key = <a class="code" href="prefs_8cpp.html#aec1ea857bc767cc31b24c0e635f42828">IK_TAB</a>;
<a name="l00440"></a>00440                     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="prefs_8cpp.html#a4efbb03b97f31d2fd0c63579d810f557">ISTRCMP</a>(start, <a class="code" href="prefs_8cpp.html#ae506d008a73b81b02862fdf6db1a9bbc">NK_RETURN</a>) == 0)  key = <a class="code" href="prefs_8cpp.html#a7379baccbdc0bc2eb69d5ace888b3337">IK_RETURN</a>;
<a name="l00441"></a>00441                     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="prefs_8cpp.html#a4efbb03b97f31d2fd0c63579d810f557">ISTRCMP</a>(start, <a class="code" href="prefs_8cpp.html#a25608bd6d505c19798746fe9f2b50f34">NK_LEFT</a>) == 0)    key = <a class="code" href="prefs_8cpp.html#a98d88c87a65d184c1f501d6062789915">IK_LEFT</a>;
<a name="l00442"></a>00442                     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="prefs_8cpp.html#a4efbb03b97f31d2fd0c63579d810f557">ISTRCMP</a>(start, <a class="code" href="prefs_8cpp.html#aa03501e2b8578995cb932ad67ebeb643">NK_RIGHT</a>) == 0)   key = <a class="code" href="prefs_8cpp.html#a3aa147d88645e5235409e3ace208c9f9">IK_RIGHT</a>;
<a name="l00443"></a>00443                     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="prefs_8cpp.html#a4efbb03b97f31d2fd0c63579d810f557">ISTRCMP</a>(start, <a class="code" href="prefs_8cpp.html#ad0bca97c467815f1721168a787c570d8">NK_UP</a>) == 0)      key = <a class="code" href="prefs_8cpp.html#aa8222f0c05ece7f3c908487b5775cd69">IK_UP</a>;
<a name="l00444"></a>00444                     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="prefs_8cpp.html#a4efbb03b97f31d2fd0c63579d810f557">ISTRCMP</a>(start, <a class="code" href="prefs_8cpp.html#a8ec194f0aebf19a367c709639a324ff4">NK_DOWN</a>) == 0)    key = <a class="code" href="prefs_8cpp.html#a1707b12fb040d96287b8578d835d868f">IK_DOWN</a>;
<a name="l00445"></a>00445                     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="prefs_8cpp.html#a4efbb03b97f31d2fd0c63579d810f557">ISTRCMP</a>(start, <a class="code" href="prefs_8cpp.html#ae0c7e720904f522bf38aaae4798febfe">NK_SPACE</a>) == 0)   key = <span class="charliteral">&#39; &#39;</span>;
<a name="l00446"></a>00446                 }
<a name="l00447"></a>00447                 <span class="keywordflow">if</span> (key &lt; 0)
<a name="l00448"></a>00448                     <a class="code" href="wxutils_8cpp.html#a871ab5f4d4e52fe248abb483c05ab688">Fatal</a>(wxString::Format(_(<span class="stringliteral">&quot;Unknown key in key_action: %s&quot;</span>),
<a name="l00449"></a>00449                         wxString(start,wxConvLocal).c_str()));
<a name="l00450"></a>00450             }
<a name="l00451"></a>00451             *p = oldp;           <span class="comment">// restore &#39; &#39; or &#39;+&#39;</span>
<a name="l00452"></a>00452             start = p;
<a name="l00453"></a>00453             start++;
<a name="l00454"></a>00454             <span class="keywordflow">break</span>;
<a name="l00455"></a>00455         }
<a name="l00456"></a>00456         p++;
<a name="l00457"></a>00457     }
<a name="l00458"></a>00458 
<a name="l00459"></a>00459     <span class="comment">// *p is &#39; &#39; or &#39;+&#39; so extract zero or more modifiers</span>
<a name="l00460"></a>00460     <span class="keywordflow">while</span> (*p != <span class="charliteral">&#39; &#39;</span>) {
<a name="l00461"></a>00461         p++;
<a name="l00462"></a>00462         <span class="keywordflow">if</span> (*p == 0) {
<a name="l00463"></a>00463             <a class="code" href="wxutils_8cpp.html#a871ab5f4d4e52fe248abb483c05ab688">Fatal</a>(wxString::Format(_(<span class="stringliteral">&quot;No action in key_action value: %s&quot;</span>),
<a name="l00464"></a>00464                 wxString(value,wxConvLocal).c_str()));
<a name="l00465"></a>00465         }
<a name="l00466"></a>00466         <span class="keywordflow">if</span> (*p == <span class="charliteral">&#39; &#39;</span> || *p == <span class="charliteral">&#39;+&#39;</span>) {
<a name="l00467"></a>00467             <span class="comment">// we found end of modifier</span>
<a name="l00468"></a>00468             <span class="keywordtype">char</span> oldp = *p;
<a name="l00469"></a>00469             *p = 0;
<a name="l00470"></a>00470 <span class="preprocessor">#ifdef __WXMAC__</span>
<a name="l00471"></a>00471 <span class="preprocessor"></span>            <span class="keywordflow">if</span>      (<a class="code" href="prefs_8cpp.html#a4efbb03b97f31d2fd0c63579d810f557">ISTRCMP</a>(start, <span class="stringliteral">&quot;cmd&quot;</span>) == 0)   modset |= <a class="code" href="prefs_8cpp.html#aaca2c4e8c2dbb1214dde1c0bb46dbe2f">mk_CMD</a>;
<a name="l00472"></a>00472             <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="prefs_8cpp.html#a4efbb03b97f31d2fd0c63579d810f557">ISTRCMP</a>(start, <span class="stringliteral">&quot;opt&quot;</span>) == 0)   modset |= <a class="code" href="prefs_8cpp.html#a635b91d441a7f0e6575bc522e0307cc8">mk_ALT</a>;
<a name="l00473"></a>00473             <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="prefs_8cpp.html#a4efbb03b97f31d2fd0c63579d810f557">ISTRCMP</a>(start, <span class="stringliteral">&quot;ctrl&quot;</span>) == 0)  modset |= mk_CTRL;
<a name="l00474"></a>00474 <span class="preprocessor">#else</span>
<a name="l00475"></a>00475 <span class="preprocessor"></span>            <span class="keywordflow">if</span>      (<a class="code" href="prefs_8cpp.html#a4efbb03b97f31d2fd0c63579d810f557">ISTRCMP</a>(start, <span class="stringliteral">&quot;ctrl&quot;</span>) == 0)  modset |= <a class="code" href="prefs_8cpp.html#aaca2c4e8c2dbb1214dde1c0bb46dbe2f">mk_CMD</a>;
<a name="l00476"></a>00476             <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="prefs_8cpp.html#a4efbb03b97f31d2fd0c63579d810f557">ISTRCMP</a>(start, <span class="stringliteral">&quot;alt&quot;</span>) == 0)   modset |= <a class="code" href="prefs_8cpp.html#a635b91d441a7f0e6575bc522e0307cc8">mk_ALT</a>;
<a name="l00477"></a>00477 <span class="preprocessor">#endif</span>
<a name="l00478"></a>00478 <span class="preprocessor"></span>            <span class="keywordflow">else</span> <span class="keywordflow">if</span>    (<a class="code" href="prefs_8cpp.html#a4efbb03b97f31d2fd0c63579d810f557">ISTRCMP</a>(start, <span class="stringliteral">&quot;shift&quot;</span>) == 0) modset |= <a class="code" href="prefs_8cpp.html#a438c6e768372ad8199c47855d968ed12">mk_SHIFT</a>;
<a name="l00479"></a>00479             <span class="keywordflow">else</span>
<a name="l00480"></a>00480                 <a class="code" href="wxutils_8cpp.html#a871ab5f4d4e52fe248abb483c05ab688">Fatal</a>(wxString::Format(_(<span class="stringliteral">&quot;Unknown modifier in key_action: %s&quot;</span>),
<a name="l00481"></a>00481                     wxString(start,wxConvLocal).c_str()));
<a name="l00482"></a>00482             *p = oldp;           <span class="comment">// restore &#39; &#39; or &#39;+&#39;</span>
<a name="l00483"></a>00483             start = p;
<a name="l00484"></a>00484             start++;
<a name="l00485"></a>00485         }
<a name="l00486"></a>00486     }
<a name="l00487"></a>00487 
<a name="l00488"></a>00488     <span class="comment">// *p is &#39; &#39; so skip and check the action string</span>
<a name="l00489"></a>00489     p++;
<a name="l00490"></a>00490     <a class="code" href="structaction__info.html">action_info</a> action = <a class="code" href="prefs_8cpp.html#aff336a15d7bde7902105a8a59ed27133">nullaction</a>;
<a name="l00491"></a>00491 
<a name="l00492"></a>00492     <span class="comment">// first look for &quot;Open:&quot; followed by file path</span>
<a name="l00493"></a>00493     <span class="keywordflow">if</span> (strncmp(p, <span class="stringliteral">&quot;Open:&quot;</span>, 5) == 0) {
<a name="l00494"></a>00494         action.<a class="code" href="structaction__info.html#aa8aa631cd84cd7672b7870e1af6e6863">id</a> = <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a143bfdd54d27e620ee14307ec3cbd989">DO_OPENFILE</a>;
<a name="l00495"></a>00495         action.<a class="code" href="structaction__info.html#aa467bd3685a2427efa3f49cae6df2301">file</a> = wxString(&amp;p[5], wxConvLocal);
<a name="l00496"></a>00496     }
<a name="l00497"></a>00497     <span class="keywordflow">else</span> {
<a name="l00498"></a>00498         <span class="comment">// assume DO_NOTHING is 0 and start with action 1</span>
<a name="l00499"></a>00499         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt; <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a802dd62e3c2fc79809df7b338c095865">MAX_ACTIONS</a>; i++) {
<a name="l00500"></a>00500             <span class="keywordflow">if</span> (strcmp(p, <a class="code" href="prefs_8cpp.html#a2ac81d5c096ce8b42e14d8b0d7e12b6e">GetActionName</a>((<a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62">action_id</a>) i)) == 0) {
<a name="l00501"></a>00501                 action.<a class="code" href="structaction__info.html#aa8aa631cd84cd7672b7870e1af6e6863">id</a> = (<a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62">action_id</a>) i;
<a name="l00502"></a>00502                 <span class="keywordflow">break</span>;
<a name="l00503"></a>00503             }
<a name="l00504"></a>00504         }
<a name="l00505"></a>00505     }
<a name="l00506"></a>00506 
<a name="l00507"></a>00507     <span class="comment">// test for some deprecated actions</span>
<a name="l00508"></a>00508     <span class="comment">/* </span>
<a name="l00509"></a>00509 <span class="comment">    if (action.id == DO_NOTHING) {</span>
<a name="l00510"></a>00510 <span class="comment">        if (strcmp(p, &quot;Swap Cell Colors&quot;) == 0) action.id = DO_INVERT;</span>
<a name="l00511"></a>00511 <span class="comment">    }</span>
<a name="l00512"></a>00512 <span class="comment">    */</span>
<a name="l00513"></a>00513 
<a name="l00514"></a>00514     <span class="comment">// probably best to silently ignore an unknown action</span>
<a name="l00515"></a>00515     <span class="comment">// (friendlier if old Ready is reading newer prefs)</span>
<a name="l00516"></a>00516     <span class="comment">/*</span>
<a name="l00517"></a>00517 <span class="comment">    if (action.id == DO_NOTHING)</span>
<a name="l00518"></a>00518 <span class="comment">       Warning(wxString::Format(_(&quot;Unknown action in key_action: %s&quot;),</span>
<a name="l00519"></a>00519 <span class="comment">                                wxString(p,wxConvLocal).c_str()));</span>
<a name="l00520"></a>00520 <span class="comment">    */</span>
<a name="l00521"></a>00521 
<a name="l00522"></a>00522     keyaction[key][modset] = action;
<a name="l00523"></a>00523 }
<a name="l00524"></a>00524 
<a name="l00525"></a>00525 <span class="comment">// -----------------------------------------------------------------------------</span>
<a name="l00526"></a>00526 
<a name="l00527"></a><a class="code" href="prefs_8cpp.html#a08014bdc6da754d563b6bcbe6c3daaf0">00527</a> wxString <a class="code" href="prefs_8cpp.html#a08014bdc6da754d563b6bcbe6c3daaf0">GetKeyCombo</a>(<span class="keywordtype">int</span> key, <span class="keywordtype">int</span> modset)
<a name="l00528"></a>00528 {
<a name="l00529"></a>00529     <span class="comment">// build a key combo string for display in prefs dialog and help window</span>
<a name="l00530"></a>00530     wxString result = wxEmptyString;
<a name="l00531"></a>00531 
<a name="l00532"></a>00532 <span class="preprocessor">#ifdef __WXMAC__</span>
<a name="l00533"></a>00533 <span class="preprocessor"></span>    <span class="keywordflow">if</span> (<a class="code" href="prefs_8cpp.html#a635b91d441a7f0e6575bc522e0307cc8">mk_ALT</a> &amp; modset)    result += wxT(<span class="stringliteral">&quot;Option-&quot;</span>);
<a name="l00534"></a>00534     <span class="keywordflow">if</span> (<a class="code" href="prefs_8cpp.html#a438c6e768372ad8199c47855d968ed12">mk_SHIFT</a> &amp; modset)  result += wxT(<span class="stringliteral">&quot;Shift-&quot;</span>);
<a name="l00535"></a>00535     <span class="keywordflow">if</span> (mk_CTRL &amp; modset)   result += wxT(<span class="stringliteral">&quot;Control-&quot;</span>);
<a name="l00536"></a>00536     <span class="keywordflow">if</span> (<a class="code" href="prefs_8cpp.html#aaca2c4e8c2dbb1214dde1c0bb46dbe2f">mk_CMD</a> &amp; modset)    result += wxT(<span class="stringliteral">&quot;Command-&quot;</span>);
<a name="l00537"></a>00537 <span class="preprocessor">#else</span>
<a name="l00538"></a>00538 <span class="preprocessor"></span>    <span class="keywordflow">if</span> (<a class="code" href="prefs_8cpp.html#a635b91d441a7f0e6575bc522e0307cc8">mk_ALT</a> &amp; modset)    result += wxT(<span class="stringliteral">&quot;Alt+&quot;</span>);
<a name="l00539"></a>00539     <span class="keywordflow">if</span> (<a class="code" href="prefs_8cpp.html#a438c6e768372ad8199c47855d968ed12">mk_SHIFT</a> &amp; modset)  result += wxT(<span class="stringliteral">&quot;Shift+&quot;</span>);
<a name="l00540"></a>00540     <span class="keywordflow">if</span> (<a class="code" href="prefs_8cpp.html#aaca2c4e8c2dbb1214dde1c0bb46dbe2f">mk_CMD</a> &amp; modset)    result += wxT(<span class="stringliteral">&quot;Control+&quot;</span>);
<a name="l00541"></a>00541 <span class="preprocessor">#endif</span>
<a name="l00542"></a>00542 <span class="preprocessor"></span>
<a name="l00543"></a>00543     <span class="keywordflow">if</span> (key &gt;= <a class="code" href="prefs_8cpp.html#a57c7c8d5358f3abaee3223dd89a7274b">IK_F1</a> &amp;&amp; key &lt;= <a class="code" href="prefs_8cpp.html#acb38cd3bfb018984d09e861607eb737b">IK_F24</a>) {
<a name="l00544"></a>00544         <span class="comment">// function key</span>
<a name="l00545"></a>00545         result += wxString::Format(wxT(<span class="stringliteral">&quot;F%d&quot;</span>), key - <a class="code" href="prefs_8cpp.html#a57c7c8d5358f3abaee3223dd89a7274b">IK_F1</a> + 1);
<a name="l00546"></a>00546 
<a name="l00547"></a>00547     }
<a name="l00548"></a>00548     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (key &gt;= <span class="charliteral">&#39;a&#39;</span> &amp;&amp; key &lt;= <span class="charliteral">&#39;z&#39;</span>) {
<a name="l00549"></a>00549         <span class="comment">// display A..Z rather than a..z</span>
<a name="l00550"></a>00550         result += wxChar(key - 32);
<a name="l00551"></a>00551 
<a name="l00552"></a>00552     }
<a name="l00553"></a>00553     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (key &gt; <span class="charliteral">&#39; &#39;</span> &amp;&amp; key &lt;= <span class="charliteral">&#39;~&#39;</span>) {
<a name="l00554"></a>00554         <span class="comment">// displayable char, but excluding space (that&#39;s handled below)</span>
<a name="l00555"></a>00555         result += wxChar(key);
<a name="l00556"></a>00556 
<a name="l00557"></a>00557     }
<a name="l00558"></a>00558     <span class="keywordflow">else</span> {
<a name="l00559"></a>00559         <span class="comment">// non-displayable char</span>
<a name="l00560"></a>00560         <span class="keywordflow">switch</span> (key) {
<a name="l00561"></a>00561             <span class="comment">// these strings can be more descriptive than the NK_* strings</span>
<a name="l00562"></a>00562             <span class="keywordflow">case</span> <a class="code" href="prefs_8cpp.html#abe22f9c221bffb446bd16099e41d31f3">IK_HOME</a>:     result += _(<span class="stringliteral">&quot;Home&quot;</span>); <span class="keywordflow">break</span>;
<a name="l00563"></a>00563             <span class="keywordflow">case</span> <a class="code" href="prefs_8cpp.html#a743cc0cdc56e37adbb08fc2af9c13be8">IK_END</a>:      result += _(<span class="stringliteral">&quot;End&quot;</span>); <span class="keywordflow">break</span>;
<a name="l00564"></a>00564             <span class="keywordflow">case</span> <a class="code" href="prefs_8cpp.html#aec8db367cc791fb5c99a3b2e38a4ddf6">IK_PAGEUP</a>:   result += _(<span class="stringliteral">&quot;PageUp&quot;</span>); <span class="keywordflow">break</span>;
<a name="l00565"></a>00565             <span class="keywordflow">case</span> <a class="code" href="prefs_8cpp.html#ad1a5458044bdc32ff93d96f086fa2bfd">IK_PAGEDOWN</a>: result += _(<span class="stringliteral">&quot;PageDown&quot;</span>); <span class="keywordflow">break</span>;
<a name="l00566"></a>00566             <span class="keywordflow">case</span> <a class="code" href="prefs_8cpp.html#a1537daf825956aab4039bbab9baa0140">IK_HELP</a>:     result += _(<span class="stringliteral">&quot;Help&quot;</span>); <span class="keywordflow">break</span>;
<a name="l00567"></a>00567             <span class="keywordflow">case</span> <a class="code" href="prefs_8cpp.html#a0d7f15108fcb879fdc3c7921d6578585">IK_INSERT</a>:   result += _(<span class="stringliteral">&quot;Insert&quot;</span>); <span class="keywordflow">break</span>;
<a name="l00568"></a>00568             <span class="keywordflow">case</span> <a class="code" href="prefs_8cpp.html#a5967a8cb9b042e85495977f9ad95e6ef">IK_DELETE</a>:   result += _(<span class="stringliteral">&quot;Delete&quot;</span>); <span class="keywordflow">break</span>;
<a name="l00569"></a>00569             <span class="keywordflow">case</span> <a class="code" href="prefs_8cpp.html#aec1ea857bc767cc31b24c0e635f42828">IK_TAB</a>:      result += _(<span class="stringliteral">&quot;Tab&quot;</span>); <span class="keywordflow">break</span>;
<a name="l00570"></a>00570 <span class="preprocessor">#ifdef __WXMSW__</span>
<a name="l00571"></a>00571 <span class="preprocessor"></span>            <span class="keywordflow">case</span> <a class="code" href="prefs_8cpp.html#a7379baccbdc0bc2eb69d5ace888b3337">IK_RETURN</a>:   result += _(<span class="stringliteral">&quot;Enter&quot;</span>); <span class="keywordflow">break</span>;
<a name="l00572"></a>00572 <span class="preprocessor">#else</span>
<a name="l00573"></a>00573 <span class="preprocessor"></span>            <span class="keywordflow">case</span> <a class="code" href="prefs_8cpp.html#a7379baccbdc0bc2eb69d5ace888b3337">IK_RETURN</a>:   result += _(<span class="stringliteral">&quot;Return&quot;</span>); <span class="keywordflow">break</span>;
<a name="l00574"></a>00574 <span class="preprocessor">#endif</span>
<a name="l00575"></a>00575 <span class="preprocessor"></span>            <span class="keywordflow">case</span> <a class="code" href="prefs_8cpp.html#a98d88c87a65d184c1f501d6062789915">IK_LEFT</a>:     result += _(<span class="stringliteral">&quot;Left&quot;</span>); <span class="keywordflow">break</span>;
<a name="l00576"></a>00576             <span class="keywordflow">case</span> <a class="code" href="prefs_8cpp.html#a3aa147d88645e5235409e3ace208c9f9">IK_RIGHT</a>:    result += _(<span class="stringliteral">&quot;Right&quot;</span>); <span class="keywordflow">break</span>;
<a name="l00577"></a>00577             <span class="keywordflow">case</span> <a class="code" href="prefs_8cpp.html#aa8222f0c05ece7f3c908487b5775cd69">IK_UP</a>:       result += _(<span class="stringliteral">&quot;Up&quot;</span>); <span class="keywordflow">break</span>;
<a name="l00578"></a>00578             <span class="keywordflow">case</span> <a class="code" href="prefs_8cpp.html#a1707b12fb040d96287b8578d835d868f">IK_DOWN</a>:     result += _(<span class="stringliteral">&quot;Down&quot;</span>); <span class="keywordflow">break</span>;
<a name="l00579"></a>00579             <span class="keywordflow">case</span> <span class="charliteral">&#39; &#39;</span>:         result += _(<span class="stringliteral">&quot;Space&quot;</span>); <span class="keywordflow">break</span>;
<a name="l00580"></a>00580             <span class="keywordflow">default</span>:          result = wxEmptyString;
<a name="l00581"></a>00581         }
<a name="l00582"></a>00582     }
<a name="l00583"></a>00583 
<a name="l00584"></a>00584     <span class="keywordflow">return</span> result;
<a name="l00585"></a>00585 }
<a name="l00586"></a>00586 
<a name="l00587"></a>00587 <span class="comment">// -----------------------------------------------------------------------------</span>
<a name="l00588"></a>00588 
<a name="l00589"></a><a class="code" href="prefs_8hpp.html#a2bfe07d8e0b8bfe673248da24ce4cafc">00589</a> wxString <a class="code" href="prefs_8cpp.html#a2bfe07d8e0b8bfe673248da24ce4cafc">GetShortcutTable</a>()
<a name="l00590"></a>00590 {
<a name="l00591"></a>00591     <span class="comment">// return HTML data to display current keyboard shortcuts in help window</span>
<a name="l00592"></a>00592     wxString result;
<a name="l00593"></a>00593     result += _(<span class="stringliteral">&quot;&lt;html&gt;&lt;title&gt;Ready Help: Keyboard Shortcuts&lt;/title&gt;&quot;</span>);
<a name="l00594"></a>00594     result += _(<span class="stringliteral">&quot;&lt;body&gt;&quot;</span>);
<a name="l00595"></a>00595     result += _(<span class="stringliteral">&quot;&lt;p&gt;&lt;font size=+1&gt;&lt;b&gt;Keyboard shortcuts&lt;/b&gt;&lt;/font&gt;&quot;</span>);
<a name="l00596"></a>00596     result += _(<span class="stringliteral">&quot;&lt;p&gt;Use &lt;a href=\&quot;prefs:keyboard\&quot;&gt;Preferences &gt; Keyboard&lt;/a&gt;&quot;</span>);
<a name="l00597"></a>00597     result += _(<span class="stringliteral">&quot; to change the following keyboard shortcuts:&quot;</span>);
<a name="l00598"></a>00598     result += _(<span class="stringliteral">&quot;&lt;p&gt;&lt;center&gt;&quot;</span>);
<a name="l00599"></a>00599     result += _(<span class="stringliteral">&quot;&lt;table cellspacing=1 border=2 cols=2 width=\&quot;90%\&quot;&gt;&quot;</span>);
<a name="l00600"></a>00600     result += _(<span class="stringliteral">&quot;&lt;tr&gt;&lt;td align=center&gt;Key Combination&lt;/td&gt;&lt;td align=center&gt;Action&lt;/td&gt;&lt;/tr&gt;&quot;</span>);
<a name="l00601"></a>00601 
<a name="l00602"></a>00602     <span class="keywordtype">bool</span> assigned[<a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a802dd62e3c2fc79809df7b338c095865">MAX_ACTIONS</a>] = {<span class="keyword">false</span>};
<a name="l00603"></a>00603 
<a name="l00604"></a>00604     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> key = 0; key &lt; <a class="code" href="prefs_8cpp.html#a85c7a27ef78976422a68cf49a99bd589">MAX_KEYCODES</a>; key++) {
<a name="l00605"></a>00605         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> modset = 0; modset &lt; <a class="code" href="prefs_8cpp.html#a91ac701426603f585619c7a4be1b3f6d">MAX_MODS</a>; modset++) {
<a name="l00606"></a>00606             <a class="code" href="structaction__info.html">action_info</a> action = keyaction[key][modset];
<a name="l00607"></a>00607             <span class="keywordflow">if</span> ( action.<a class="code" href="structaction__info.html#aa8aa631cd84cd7672b7870e1af6e6863">id</a> != <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62aa3c06bc7e4d652a970cab72026c6fed1">DO_NOTHING</a> ) {
<a name="l00608"></a>00608                 assigned[action.<a class="code" href="structaction__info.html#aa8aa631cd84cd7672b7870e1af6e6863">id</a>] = <span class="keyword">true</span>;
<a name="l00609"></a>00609                 wxString keystring = <a class="code" href="prefs_8cpp.html#a08014bdc6da754d563b6bcbe6c3daaf0">GetKeyCombo</a>(key, modset);
<a name="l00610"></a>00610                 <span class="keywordflow">if</span> (key == <span class="charliteral">&#39;&lt;&#39;</span>) {
<a name="l00611"></a>00611                     keystring.Replace(_(<span class="stringliteral">&quot;&lt;&quot;</span>), _(<span class="stringliteral">&quot;&amp;lt;&quot;</span>));
<a name="l00612"></a>00612                 }
<a name="l00613"></a>00613                 result += _(<span class="stringliteral">&quot;&lt;tr&gt;&lt;td align=right&gt;&quot;</span>);
<a name="l00614"></a>00614                 result += keystring;
<a name="l00615"></a>00615                 result += _(<span class="stringliteral">&quot;&amp;nbsp;&lt;/td&gt;&lt;td&gt;&amp;nbsp;&quot;</span>);
<a name="l00616"></a>00616                 result += wxString(<a class="code" href="prefs_8cpp.html#a2ac81d5c096ce8b42e14d8b0d7e12b6e">GetActionName</a>(action.<a class="code" href="structaction__info.html#aa8aa631cd84cd7672b7870e1af6e6863">id</a>), wxConvLocal);
<a name="l00617"></a>00617                 <span class="keywordflow">if</span> (action.<a class="code" href="structaction__info.html#aa8aa631cd84cd7672b7870e1af6e6863">id</a> == <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a143bfdd54d27e620ee14307ec3cbd989">DO_OPENFILE</a>) {
<a name="l00618"></a>00618                     result += _(<span class="stringliteral">&quot;&amp;nbsp;&quot;</span>);
<a name="l00619"></a>00619                     result += action.<a class="code" href="structaction__info.html#aa467bd3685a2427efa3f49cae6df2301">file</a>;
<a name="l00620"></a>00620                 }
<a name="l00621"></a>00621                 result += _(<span class="stringliteral">&quot;&lt;/td&gt;&lt;/tr&gt;&quot;</span>);
<a name="l00622"></a>00622             }
<a name="l00623"></a>00623         }
<a name="l00624"></a>00624     }
<a name="l00625"></a>00625 
<a name="l00626"></a>00626     result += _(<span class="stringliteral">&quot;&lt;/table&gt;&lt;/center&gt;&quot;</span>);
<a name="l00627"></a>00627 
<a name="l00628"></a>00628     <span class="comment">// also list unassigned actions</span>
<a name="l00629"></a>00629     result += _(<span class="stringliteral">&quot;&lt;p&gt;The following actions currently have no keyboard shortcuts:&lt;p&gt;&quot;</span>);
<a name="l00630"></a>00630     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt; <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a802dd62e3c2fc79809df7b338c095865">MAX_ACTIONS</a>; i++) {
<a name="l00631"></a>00631         <span class="keywordflow">if</span> (!assigned[i]) {
<a name="l00632"></a>00632             wxString name = wxString(<a class="code" href="prefs_8cpp.html#a2ac81d5c096ce8b42e14d8b0d7e12b6e">GetActionName</a>((<a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62">action_id</a>) i),wxConvLocal);
<a name="l00633"></a>00633             result += wxString::Format(_(<span class="stringliteral">&quot;&lt;dd&gt;%s&lt;/dd&gt;&quot;</span>), name.c_str());
<a name="l00634"></a>00634         }
<a name="l00635"></a>00635     }
<a name="l00636"></a>00636 
<a name="l00637"></a>00637     result += _(<span class="stringliteral">&quot;&lt;/body&gt;&lt;/html&gt;&quot;</span>);
<a name="l00638"></a>00638     <span class="keywordflow">return</span> result;
<a name="l00639"></a>00639 }
<a name="l00640"></a>00640 
<a name="l00641"></a>00641 <span class="comment">// -----------------------------------------------------------------------------</span>
<a name="l00642"></a>00642 
<a name="l00643"></a><a class="code" href="prefs_8cpp.html#aea515f65541e328698a149ccc3dc279a">00643</a> wxString <a class="code" href="prefs_8cpp.html#aea515f65541e328698a149ccc3dc279a">GetModifiers</a>(<span class="keywordtype">int</span> modset)
<a name="l00644"></a>00644 {
<a name="l00645"></a>00645     wxString modkeys = wxEmptyString;
<a name="l00646"></a>00646 <span class="preprocessor">#ifdef __WXMAC__</span>
<a name="l00647"></a>00647 <span class="preprocessor"></span>    <span class="keywordflow">if</span> (<a class="code" href="prefs_8cpp.html#a635b91d441a7f0e6575bc522e0307cc8">mk_ALT</a> &amp; modset)    modkeys += wxT(<span class="stringliteral">&quot;+opt&quot;</span>);
<a name="l00648"></a>00648     <span class="keywordflow">if</span> (<a class="code" href="prefs_8cpp.html#a438c6e768372ad8199c47855d968ed12">mk_SHIFT</a> &amp; modset)  modkeys += wxT(<span class="stringliteral">&quot;+shift&quot;</span>);
<a name="l00649"></a>00649     <span class="keywordflow">if</span> (mk_CTRL &amp; modset)   modkeys += wxT(<span class="stringliteral">&quot;+ctrl&quot;</span>);
<a name="l00650"></a>00650     <span class="keywordflow">if</span> (<a class="code" href="prefs_8cpp.html#aaca2c4e8c2dbb1214dde1c0bb46dbe2f">mk_CMD</a> &amp; modset)    modkeys += wxT(<span class="stringliteral">&quot;+cmd&quot;</span>);
<a name="l00651"></a>00651 <span class="preprocessor">#else</span>
<a name="l00652"></a>00652 <span class="preprocessor"></span>    <span class="keywordflow">if</span> (<a class="code" href="prefs_8cpp.html#a635b91d441a7f0e6575bc522e0307cc8">mk_ALT</a> &amp; modset)    modkeys += wxT(<span class="stringliteral">&quot;+alt&quot;</span>);
<a name="l00653"></a>00653     <span class="keywordflow">if</span> (<a class="code" href="prefs_8cpp.html#a438c6e768372ad8199c47855d968ed12">mk_SHIFT</a> &amp; modset)  modkeys += wxT(<span class="stringliteral">&quot;+shift&quot;</span>);
<a name="l00654"></a>00654     <span class="keywordflow">if</span> (<a class="code" href="prefs_8cpp.html#aaca2c4e8c2dbb1214dde1c0bb46dbe2f">mk_CMD</a> &amp; modset)    modkeys += wxT(<span class="stringliteral">&quot;+ctrl&quot;</span>);
<a name="l00655"></a>00655 <span class="preprocessor">#endif</span>
<a name="l00656"></a>00656 <span class="preprocessor"></span>    <span class="keywordflow">return</span> modkeys;
<a name="l00657"></a>00657 }
<a name="l00658"></a>00658 
<a name="l00659"></a>00659 <span class="comment">// -----------------------------------------------------------------------------</span>
<a name="l00660"></a>00660 
<a name="l00661"></a><a class="code" href="prefs_8cpp.html#aa382474e1617bb3950299f34d6f2c20b">00661</a> wxString <a class="code" href="prefs_8cpp.html#aa382474e1617bb3950299f34d6f2c20b">GetKeyName</a>(<span class="keywordtype">int</span> key)
<a name="l00662"></a>00662 {
<a name="l00663"></a>00663     wxString result;
<a name="l00664"></a>00664 
<a name="l00665"></a>00665     <span class="keywordflow">if</span> (key &gt;= <a class="code" href="prefs_8cpp.html#a57c7c8d5358f3abaee3223dd89a7274b">IK_F1</a> &amp;&amp; key &lt;= <a class="code" href="prefs_8cpp.html#acb38cd3bfb018984d09e861607eb737b">IK_F24</a>) {
<a name="l00666"></a>00666         <span class="comment">// function key</span>
<a name="l00667"></a>00667         result.Printf(wxT(<span class="stringliteral">&quot;F%d&quot;</span>), key - <a class="code" href="prefs_8cpp.html#a57c7c8d5358f3abaee3223dd89a7274b">IK_F1</a> + 1);
<a name="l00668"></a>00668 
<a name="l00669"></a>00669     }
<a name="l00670"></a>00670     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (key &gt; <span class="charliteral">&#39; &#39;</span> &amp;&amp; key &lt;= <span class="charliteral">&#39;~&#39;</span>) {
<a name="l00671"></a>00671         <span class="comment">// displayable char, but excluding space (that&#39;s handled below)</span>
<a name="l00672"></a>00672         result = wxChar(key);
<a name="l00673"></a>00673 
<a name="l00674"></a>00674     }
<a name="l00675"></a>00675     <span class="keywordflow">else</span> {
<a name="l00676"></a>00676         <span class="comment">// non-displayable char</span>
<a name="l00677"></a>00677         <span class="keywordflow">switch</span> (key) {
<a name="l00678"></a>00678             <span class="keywordflow">case</span> <a class="code" href="prefs_8cpp.html#abe22f9c221bffb446bd16099e41d31f3">IK_HOME</a>:     result = wxString(<a class="code" href="prefs_8cpp.html#a17e778db891c6f7af059a304bdae4c1e">NK_HOME</a>, wxConvLocal); <span class="keywordflow">break</span>;
<a name="l00679"></a>00679             <span class="keywordflow">case</span> <a class="code" href="prefs_8cpp.html#a743cc0cdc56e37adbb08fc2af9c13be8">IK_END</a>:      result = wxString(<a class="code" href="prefs_8cpp.html#adc814fa2c8c13c085ddaa4fb06d963b1">NK_END</a>, wxConvLocal); <span class="keywordflow">break</span>;
<a name="l00680"></a>00680             <span class="keywordflow">case</span> <a class="code" href="prefs_8cpp.html#aec8db367cc791fb5c99a3b2e38a4ddf6">IK_PAGEUP</a>:   result = wxString(<a class="code" href="prefs_8cpp.html#a838b9bb86001b6fd1cb684a32c4d4be6">NK_PGUP</a>, wxConvLocal); <span class="keywordflow">break</span>;
<a name="l00681"></a>00681             <span class="keywordflow">case</span> <a class="code" href="prefs_8cpp.html#ad1a5458044bdc32ff93d96f086fa2bfd">IK_PAGEDOWN</a>: result = wxString(<a class="code" href="prefs_8cpp.html#a65899dabf9d10827b1d04186ede6d96f">NK_PGDN</a>, wxConvLocal); <span class="keywordflow">break</span>;
<a name="l00682"></a>00682             <span class="keywordflow">case</span> <a class="code" href="prefs_8cpp.html#a1537daf825956aab4039bbab9baa0140">IK_HELP</a>:     result = wxString(<a class="code" href="prefs_8cpp.html#ab984d5104fb7d6099ad625c91bdf7a2c">NK_HELP</a>, wxConvLocal); <span class="keywordflow">break</span>;
<a name="l00683"></a>00683             <span class="keywordflow">case</span> <a class="code" href="prefs_8cpp.html#a0d7f15108fcb879fdc3c7921d6578585">IK_INSERT</a>:   result = wxString(<a class="code" href="prefs_8cpp.html#a5295ec9f3627911411a16979e25ddf27">NK_INSERT</a>, wxConvLocal); <span class="keywordflow">break</span>;
<a name="l00684"></a>00684             <span class="keywordflow">case</span> <a class="code" href="prefs_8cpp.html#a5967a8cb9b042e85495977f9ad95e6ef">IK_DELETE</a>:   result = wxString(<a class="code" href="prefs_8cpp.html#ab8fb90af2ccf1dad92336c2c0eeef6f4">NK_DELETE</a>, wxConvLocal); <span class="keywordflow">break</span>;
<a name="l00685"></a>00685             <span class="keywordflow">case</span> <a class="code" href="prefs_8cpp.html#aec1ea857bc767cc31b24c0e635f42828">IK_TAB</a>:      result = wxString(<a class="code" href="prefs_8cpp.html#a4cf00ed212021171783c0dea82ab6608">NK_TAB</a>, wxConvLocal); <span class="keywordflow">break</span>;
<a name="l00686"></a>00686             <span class="keywordflow">case</span> <a class="code" href="prefs_8cpp.html#a7379baccbdc0bc2eb69d5ace888b3337">IK_RETURN</a>:   result = wxString(<a class="code" href="prefs_8cpp.html#ae506d008a73b81b02862fdf6db1a9bbc">NK_RETURN</a>, wxConvLocal); <span class="keywordflow">break</span>;
<a name="l00687"></a>00687             <span class="keywordflow">case</span> <a class="code" href="prefs_8cpp.html#a98d88c87a65d184c1f501d6062789915">IK_LEFT</a>:     result = wxString(<a class="code" href="prefs_8cpp.html#a25608bd6d505c19798746fe9f2b50f34">NK_LEFT</a>, wxConvLocal); <span class="keywordflow">break</span>;
<a name="l00688"></a>00688             <span class="keywordflow">case</span> <a class="code" href="prefs_8cpp.html#a3aa147d88645e5235409e3ace208c9f9">IK_RIGHT</a>:    result = wxString(<a class="code" href="prefs_8cpp.html#aa03501e2b8578995cb932ad67ebeb643">NK_RIGHT</a>, wxConvLocal); <span class="keywordflow">break</span>;
<a name="l00689"></a>00689             <span class="keywordflow">case</span> <a class="code" href="prefs_8cpp.html#aa8222f0c05ece7f3c908487b5775cd69">IK_UP</a>:       result = wxString(<a class="code" href="prefs_8cpp.html#ad0bca97c467815f1721168a787c570d8">NK_UP</a>, wxConvLocal); <span class="keywordflow">break</span>;
<a name="l00690"></a>00690             <span class="keywordflow">case</span> <a class="code" href="prefs_8cpp.html#a1707b12fb040d96287b8578d835d868f">IK_DOWN</a>:     result = wxString(<a class="code" href="prefs_8cpp.html#a8ec194f0aebf19a367c709639a324ff4">NK_DOWN</a>, wxConvLocal); <span class="keywordflow">break</span>;
<a name="l00691"></a>00691             <span class="keywordflow">case</span> <span class="charliteral">&#39; &#39;</span>:         result = wxString(<a class="code" href="prefs_8cpp.html#ae0c7e720904f522bf38aaae4798febfe">NK_SPACE</a>, wxConvLocal); <span class="keywordflow">break</span>;
<a name="l00692"></a>00692             <span class="keywordflow">default</span>:          result = wxEmptyString;
<a name="l00693"></a>00693         }
<a name="l00694"></a>00694     }
<a name="l00695"></a>00695 
<a name="l00696"></a>00696     <span class="keywordflow">return</span> result;
<a name="l00697"></a>00697 }
<a name="l00698"></a>00698 
<a name="l00699"></a>00699 <span class="comment">// -----------------------------------------------------------------------------</span>
<a name="l00700"></a>00700 
<a name="l00701"></a><a class="code" href="prefs_8cpp.html#a9a4e48379de2b0a84470f8dee26e1d48">00701</a> <span class="keywordtype">void</span> <a class="code" href="prefs_8cpp.html#a9a4e48379de2b0a84470f8dee26e1d48">SaveKeyActions</a>(FILE* f)
<a name="l00702"></a>00702 {
<a name="l00703"></a>00703     <span class="keywordtype">bool</span> assigned[<a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a802dd62e3c2fc79809df7b338c095865">MAX_ACTIONS</a>] = {<span class="keyword">false</span>};
<a name="l00704"></a>00704 
<a name="l00705"></a>00705     fputs(<span class="stringliteral">&quot;\n&quot;</span>, f);
<a name="l00706"></a>00706     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> key = 0; key &lt; <a class="code" href="prefs_8cpp.html#a85c7a27ef78976422a68cf49a99bd589">MAX_KEYCODES</a>; key++) {
<a name="l00707"></a>00707         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> modset = 0; modset &lt; <a class="code" href="prefs_8cpp.html#a91ac701426603f585619c7a4be1b3f6d">MAX_MODS</a>; modset++) {
<a name="l00708"></a>00708             <a class="code" href="structaction__info.html">action_info</a> action = keyaction[key][modset];
<a name="l00709"></a>00709             <span class="keywordflow">if</span> ( action.<a class="code" href="structaction__info.html#aa8aa631cd84cd7672b7870e1af6e6863">id</a> != <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62aa3c06bc7e4d652a970cab72026c6fed1">DO_NOTHING</a> ) {
<a name="l00710"></a>00710                 assigned[action.<a class="code" href="structaction__info.html#aa8aa631cd84cd7672b7870e1af6e6863">id</a>] = <span class="keyword">true</span>;
<a name="l00711"></a>00711                 fprintf(f, <span class="stringliteral">&quot;key_action=%s%s %s%s\n&quot;</span>,
<a name="l00712"></a>00712                     (<span class="keyword">const</span> <span class="keywordtype">char</span>*) <a class="code" href="prefs_8cpp.html#aa382474e1617bb3950299f34d6f2c20b">GetKeyName</a>(key).mb_str(wxConvLocal),
<a name="l00713"></a>00713                     (<span class="keyword">const</span> <span class="keywordtype">char</span>*) <a class="code" href="prefs_8cpp.html#aea515f65541e328698a149ccc3dc279a">GetModifiers</a>(modset).mb_str(wxConvLocal),
<a name="l00714"></a>00714                     <a class="code" href="prefs_8cpp.html#a2ac81d5c096ce8b42e14d8b0d7e12b6e">GetActionName</a>(action.<a class="code" href="structaction__info.html#aa8aa631cd84cd7672b7870e1af6e6863">id</a>),
<a name="l00715"></a>00715                     (<span class="keyword">const</span> <span class="keywordtype">char</span>*) action.<a class="code" href="structaction__info.html#aa467bd3685a2427efa3f49cae6df2301">file</a>.mb_str(wxConvLocal));
<a name="l00716"></a>00716             }
<a name="l00717"></a>00717         }
<a name="l00718"></a>00718     }
<a name="l00719"></a>00719 
<a name="l00720"></a>00720     <span class="comment">// list all unassigned actions in comment lines</span>
<a name="l00721"></a>00721     fputs(<span class="stringliteral">&quot;# unassigned actions:\n&quot;</span>, f);
<a name="l00722"></a>00722     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt; <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a802dd62e3c2fc79809df7b338c095865">MAX_ACTIONS</a>; i++) {
<a name="l00723"></a>00723         <span class="keywordflow">if</span> ( !assigned[i] ) {
<a name="l00724"></a>00724             fprintf(f, <span class="stringliteral">&quot;# key_action=key+mods %s&quot;</span>, <a class="code" href="prefs_8cpp.html#a2ac81d5c096ce8b42e14d8b0d7e12b6e">GetActionName</a>((<a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62">action_id</a>) i));
<a name="l00725"></a>00725             <span class="keywordflow">if</span> ( i == <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a143bfdd54d27e620ee14307ec3cbd989">DO_OPENFILE</a> ) fputs(<span class="stringliteral">&quot;file&quot;</span>, f);
<a name="l00726"></a>00726             fputs(<span class="stringliteral">&quot;\n&quot;</span>, f);
<a name="l00727"></a>00727         }
<a name="l00728"></a>00728     }
<a name="l00729"></a>00729     fputs(<span class="stringliteral">&quot;\n&quot;</span>, f);
<a name="l00730"></a>00730 }
<a name="l00731"></a>00731 
<a name="l00732"></a>00732 <span class="comment">// -----------------------------------------------------------------------------</span>
<a name="l00733"></a>00733 
<a name="l00734"></a><a class="code" href="prefs_8cpp.html#a36905fbfd1fa1436a4b983217e079229">00734</a> <span class="keywordtype">void</span> <a class="code" href="prefs_8cpp.html#a36905fbfd1fa1436a4b983217e079229">CreateAccelerator</a>(<a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62">action_id</a> action, <span class="keywordtype">int</span> modset, <span class="keywordtype">int</span> key)
<a name="l00735"></a>00735 {
<a name="l00736"></a>00736     <a class="code" href="prefs_8cpp.html#a53b624a5d80e5a337965fd3952ce80b9">accelerator</a>[action] = wxT(<span class="stringliteral">&quot;\t&quot;</span>);
<a name="l00737"></a>00737 <span class="preprocessor">#ifdef __WXMAC__</span>
<a name="l00738"></a>00738 <span class="preprocessor"></span>    <span class="keywordflow">if</span> (modset &amp; mk_CTRL) <a class="code" href="prefs_8cpp.html#a53b624a5d80e5a337965fd3952ce80b9">accelerator</a>[action] += wxT(<span class="stringliteral">&quot;RawCtrl+&quot;</span>);
<a name="l00739"></a>00739 <span class="preprocessor">#endif</span>
<a name="l00740"></a>00740 <span class="preprocessor"></span>    <span class="keywordflow">if</span> (modset &amp; <a class="code" href="prefs_8cpp.html#aaca2c4e8c2dbb1214dde1c0bb46dbe2f">mk_CMD</a>) <a class="code" href="prefs_8cpp.html#a53b624a5d80e5a337965fd3952ce80b9">accelerator</a>[action] += wxT(<span class="stringliteral">&quot;Ctrl+&quot;</span>);
<a name="l00741"></a>00741     <span class="keywordflow">if</span> (modset &amp; <a class="code" href="prefs_8cpp.html#a635b91d441a7f0e6575bc522e0307cc8">mk_ALT</a>) <a class="code" href="prefs_8cpp.html#a53b624a5d80e5a337965fd3952ce80b9">accelerator</a>[action] += wxT(<span class="stringliteral">&quot;Alt+&quot;</span>);
<a name="l00742"></a>00742     <span class="keywordflow">if</span> (modset &amp; <a class="code" href="prefs_8cpp.html#a438c6e768372ad8199c47855d968ed12">mk_SHIFT</a>) <a class="code" href="prefs_8cpp.html#a53b624a5d80e5a337965fd3952ce80b9">accelerator</a>[action] += wxT(<span class="stringliteral">&quot;Shift+&quot;</span>);
<a name="l00743"></a>00743     <span class="keywordflow">if</span> (key &gt;= <span class="charliteral">&#39;a&#39;</span> &amp;&amp; key &lt;= <span class="charliteral">&#39;z&#39;</span>) {
<a name="l00744"></a>00744         <span class="comment">// convert a..z to A..Z</span>
<a name="l00745"></a>00745         <a class="code" href="prefs_8cpp.html#a53b624a5d80e5a337965fd3952ce80b9">accelerator</a>[action] += wxChar(key - 32);
<a name="l00746"></a>00746 <span class="preprocessor">#ifdef __WXMAC__</span>
<a name="l00747"></a>00747 <span class="preprocessor"></span>    }
<a name="l00748"></a>00748     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (key == <a class="code" href="prefs_8cpp.html#a5967a8cb9b042e85495977f9ad95e6ef">IK_DELETE</a>) {
<a name="l00749"></a>00749         <span class="comment">// must use &quot;Back&quot; to get correct symbol (&lt;+ rather than +&gt;)</span>
<a name="l00750"></a>00750         <a class="code" href="prefs_8cpp.html#a53b624a5d80e5a337965fd3952ce80b9">accelerator</a>[action] += wxT(<span class="stringliteral">&quot;Back&quot;</span>);
<a name="l00751"></a>00751 <span class="preprocessor">#endif</span>
<a name="l00752"></a>00752 <span class="preprocessor"></span>    }
<a name="l00753"></a>00753     <span class="keywordflow">else</span> {
<a name="l00754"></a>00754         <a class="code" href="prefs_8cpp.html#a53b624a5d80e5a337965fd3952ce80b9">accelerator</a>[action] += <a class="code" href="prefs_8cpp.html#aa382474e1617bb3950299f34d6f2c20b">GetKeyName</a>(key);
<a name="l00755"></a>00755     }
<a name="l00756"></a>00756 }
<a name="l00757"></a>00757 
<a name="l00758"></a>00758 <span class="comment">// -----------------------------------------------------------------------------</span>
<a name="l00759"></a>00759 
<a name="l00760"></a><a class="code" href="prefs_8cpp.html#a3b1ae22a369445497a51790d57de407c">00760</a> <span class="keywordtype">void</span> <a class="code" href="prefs_8cpp.html#a3b1ae22a369445497a51790d57de407c">UpdateAcceleratorStrings</a>()
<a name="l00761"></a>00761 {
<a name="l00762"></a>00762     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a802dd62e3c2fc79809df7b338c095865">MAX_ACTIONS</a>; i++)
<a name="l00763"></a>00763         <a class="code" href="prefs_8cpp.html#a53b624a5d80e5a337965fd3952ce80b9">accelerator</a>[i] = wxEmptyString;
<a name="l00764"></a>00764 
<a name="l00765"></a>00765     <span class="comment">// go thru keyaction table looking for key combos that are valid menu item</span>
<a name="l00766"></a>00766     <span class="comment">// accelerators and construct suitable strings like &quot;\tCtrl+Alt+Shift+K&quot;</span>
<a name="l00767"></a>00767     <span class="comment">// or &quot;\tF12&quot; or &quot;\tReturn&quot; etc</span>
<a name="l00768"></a>00768     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> key = 0; key &lt; <a class="code" href="prefs_8cpp.html#a85c7a27ef78976422a68cf49a99bd589">MAX_KEYCODES</a>; key++) {
<a name="l00769"></a>00769         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> modset = 0; modset &lt; <a class="code" href="prefs_8cpp.html#a91ac701426603f585619c7a4be1b3f6d">MAX_MODS</a>; modset++) {
<a name="l00770"></a>00770             <a class="code" href="structaction__info.html">action_info</a> info = keyaction[key][modset];
<a name="l00771"></a>00771             <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62">action_id</a> action = info.<a class="code" href="structaction__info.html#aa8aa631cd84cd7672b7870e1af6e6863">id</a>;
<a name="l00772"></a>00772             <span class="keywordflow">if</span> (action != <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62aa3c06bc7e4d652a970cab72026c6fed1">DO_NOTHING</a> &amp;&amp; <a class="code" href="prefs_8cpp.html#a53b624a5d80e5a337965fd3952ce80b9">accelerator</a>[action].IsEmpty()) {
<a name="l00773"></a>00773                 <span class="comment">// check if key can be used as an accelerator</span>
<a name="l00774"></a>00774                 <span class="keywordflow">if</span> ((key &gt;= <span class="charliteral">&#39; &#39;</span> &amp;&amp; key &lt;= <span class="charliteral">&#39;~&#39;</span>) ||
<a name="l00775"></a>00775                     (key &gt;= <a class="code" href="prefs_8cpp.html#a57c7c8d5358f3abaee3223dd89a7274b">IK_F1</a> &amp;&amp; key &lt;= <a class="code" href="prefs_8cpp.html#acb38cd3bfb018984d09e861607eb737b">IK_F24</a>) ||
<a name="l00776"></a>00776                     (key &gt;= <a class="code" href="prefs_8cpp.html#a98d88c87a65d184c1f501d6062789915">IK_LEFT</a> &amp;&amp; key &lt;= <a class="code" href="prefs_8cpp.html#a1707b12fb040d96287b8578d835d868f">IK_DOWN</a>) ||
<a name="l00777"></a>00777                     key == <a class="code" href="prefs_8cpp.html#abe22f9c221bffb446bd16099e41d31f3">IK_HOME</a> ||
<a name="l00778"></a>00778                     key == <a class="code" href="prefs_8cpp.html#a743cc0cdc56e37adbb08fc2af9c13be8">IK_END</a> ||
<a name="l00779"></a>00779                     key == <a class="code" href="prefs_8cpp.html#aec8db367cc791fb5c99a3b2e38a4ddf6">IK_PAGEUP</a> ||
<a name="l00780"></a>00780                     key == <a class="code" href="prefs_8cpp.html#ad1a5458044bdc32ff93d96f086fa2bfd">IK_PAGEDOWN</a> ||
<a name="l00781"></a>00781                     key == <a class="code" href="prefs_8cpp.html#a5967a8cb9b042e85495977f9ad95e6ef">IK_DELETE</a> ||
<a name="l00782"></a>00782                     key == <a class="code" href="prefs_8cpp.html#aec1ea857bc767cc31b24c0e635f42828">IK_TAB</a> ||
<a name="l00783"></a>00783                     key == <a class="code" href="prefs_8cpp.html#a7379baccbdc0bc2eb69d5ace888b3337">IK_RETURN</a>)
<a name="l00784"></a>00784                     <a class="code" href="prefs_8cpp.html#a36905fbfd1fa1436a4b983217e079229">CreateAccelerator</a>(action, modset, key);
<a name="l00785"></a>00785              }
<a name="l00786"></a>00786         }
<a name="l00787"></a>00787     }
<a name="l00788"></a>00788 
<a name="l00789"></a>00789     <span class="comment">// go thru keyaction table again looking only for key combos containing Ctrl;</span>
<a name="l00790"></a>00790     <span class="comment">// we do this so that the Paste menu item will have the standard Ctrl+V</span>
<a name="l00791"></a>00791     <span class="comment">// shortcut rather than a plain V if both those shortcuts are assigned</span>
<a name="l00792"></a>00792     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> key = 0; key &lt; <a class="code" href="prefs_8cpp.html#a85c7a27ef78976422a68cf49a99bd589">MAX_KEYCODES</a>; key++) {
<a name="l00793"></a>00793         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> modset = 0; modset &lt; <a class="code" href="prefs_8cpp.html#a91ac701426603f585619c7a4be1b3f6d">MAX_MODS</a>; modset++) {
<a name="l00794"></a>00794             <a class="code" href="structaction__info.html">action_info</a> info = keyaction[key][modset];
<a name="l00795"></a>00795             <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62">action_id</a> action = info.<a class="code" href="structaction__info.html#aa8aa631cd84cd7672b7870e1af6e6863">id</a>;
<a name="l00796"></a>00796             <span class="keywordflow">if</span> (action != <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62aa3c06bc7e4d652a970cab72026c6fed1">DO_NOTHING</a> &amp;&amp; (modset &amp; <a class="code" href="prefs_8cpp.html#aaca2c4e8c2dbb1214dde1c0bb46dbe2f">mk_CMD</a>))
<a name="l00797"></a>00797                 <a class="code" href="prefs_8cpp.html#a36905fbfd1fa1436a4b983217e079229">CreateAccelerator</a>(action, modset, key);
<a name="l00798"></a>00798          }
<a name="l00799"></a>00799     }
<a name="l00800"></a>00800 }
<a name="l00801"></a>00801 
<a name="l00802"></a>00802 <span class="comment">// -----------------------------------------------------------------------------</span>
<a name="l00803"></a>00803 
<a name="l00804"></a><a class="code" href="prefs_8hpp.html#ab9798965988e2083acef3da70016317f">00804</a> wxString <a class="code" href="prefs_8cpp.html#ab9798965988e2083acef3da70016317f">GetAccelerator</a>(<a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62">action_id</a> action)
<a name="l00805"></a>00805 {
<a name="l00806"></a>00806     <span class="keywordflow">return</span> <a class="code" href="prefs_8cpp.html#a53b624a5d80e5a337965fd3952ce80b9">accelerator</a>[action];
<a name="l00807"></a>00807 }
<a name="l00808"></a>00808 
<a name="l00809"></a>00809 <span class="comment">// -----------------------------------------------------------------------------</span>
<a name="l00810"></a>00810 
<a name="l00811"></a>00811 <span class="comment">// some method names have changed in wx 2.9</span>
<a name="l00812"></a>00812 <span class="preprocessor">#if wxCHECK_VERSION(2,9,0)</span>
<a name="l00813"></a>00813 <span class="preprocessor"></span><span class="preprocessor">#define GetLabelFromText GetLabelText</span>
<a name="l00814"></a>00814 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l00815"></a>00815 <span class="preprocessor"></span>
<a name="l00816"></a><a class="code" href="prefs_8hpp.html#ac27fe116b1c94a4a74cafc5aa8564e60">00816</a> <span class="keywordtype">void</span> <a class="code" href="prefs_8cpp.html#ac27fe116b1c94a4a74cafc5aa8564e60">RemoveAccelerator</a>(wxMenuBar* mbar, <span class="keywordtype">int</span> item, <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62">action_id</a> action)
<a name="l00817"></a>00817 {
<a name="l00818"></a>00818     <span class="keywordflow">if</span> (!<a class="code" href="prefs_8cpp.html#a53b624a5d80e5a337965fd3952ce80b9">accelerator</a>[action].IsEmpty()) {
<a name="l00819"></a>00819         <span class="comment">// remove accelerator from given menu item</span>
<a name="l00820"></a>00820         mbar-&gt;SetLabel(item, wxMenuItem::GetLabelFromText(mbar-&gt;GetLabel(item)));
<a name="l00821"></a>00821     }
<a name="l00822"></a>00822 }
<a name="l00823"></a>00823 
<a name="l00824"></a>00824 <span class="comment">// -----------------------------------------------------------------------------</span>
<a name="l00825"></a>00825 
<a name="l00826"></a><a class="code" href="prefs_8hpp.html#a80ab9b805f2f3378a3e053969dddbb2c">00826</a> <span class="keywordtype">void</span> <a class="code" href="prefs_8cpp.html#a80ab9b805f2f3378a3e053969dddbb2c">SetAccelerator</a>(wxMenuBar* mbar, <span class="keywordtype">int</span> item, <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62">action_id</a> action)
<a name="l00827"></a>00827 {
<a name="l00828"></a>00828     wxString accel = <a class="code" href="prefs_8cpp.html#a53b624a5d80e5a337965fd3952ce80b9">accelerator</a>[action];
<a name="l00829"></a>00829 
<a name="l00830"></a>00830     <span class="comment">// we need to remove old accelerator string from GetLabel text</span>
<a name="l00831"></a>00831     mbar-&gt;SetLabel(item, wxMenuItem::GetLabelFromText(mbar-&gt;GetLabel(item)) + accel);
<a name="l00832"></a>00832 }
<a name="l00833"></a>00833 
<a name="l00834"></a>00834 <span class="comment">// -----------------------------------------------------------------------------</span>
<a name="l00835"></a>00835 
<a name="l00836"></a><a class="code" href="prefs_8cpp.html#a9e280c761ad8c839005adf2f710dc0c1">00836</a> <span class="keywordtype">void</span> <a class="code" href="prefs_8cpp.html#a9e280c761ad8c839005adf2f710dc0c1">GetRelPath</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* value, wxString&amp; path,
<a name="l00837"></a>00837                 <span class="keyword">const</span> wxString&amp; defdir = wxEmptyString,
<a name="l00838"></a>00838                 <span class="keywordtype">bool</span> isdir = <span class="keyword">true</span>)
<a name="l00839"></a>00839 {
<a name="l00840"></a>00840     path = wxString(value, wxConvLocal);
<a name="l00841"></a>00841     wxFileName fname(path);
<a name="l00842"></a>00842 
<a name="l00843"></a>00843     <span class="comment">// if path isn&#39;t absolute then prepend Ready directory</span>
<a name="l00844"></a>00844     <span class="keywordflow">if</span> (!fname.IsAbsolute()) path = <a class="code" href="prefs_8cpp.html#aa3af5b468230e51f15091c9f1410b2c4">readydir</a> + path;
<a name="l00845"></a>00845 
<a name="l00846"></a>00846     <span class="keywordflow">if</span> (defdir.length() &gt; 0) {
<a name="l00847"></a>00847         <span class="comment">// if path doesn&#39;t exist then reset to default directory</span>
<a name="l00848"></a>00848         <span class="keywordflow">if</span> (!wxFileName::DirExists(path)) path = <a class="code" href="prefs_8cpp.html#aa3af5b468230e51f15091c9f1410b2c4">readydir</a> + defdir;
<a name="l00849"></a>00849     }
<a name="l00850"></a>00850 
<a name="l00851"></a>00851     <span class="comment">// nicer if directory path ends with separator</span>
<a name="l00852"></a>00852     <span class="keywordflow">if</span> (isdir &amp;&amp; path.Last() != wxFILE_SEP_PATH) path += wxFILE_SEP_PATH;
<a name="l00853"></a>00853 }
<a name="l00854"></a>00854 
<a name="l00855"></a>00855 <span class="comment">// -----------------------------------------------------------------------------</span>
<a name="l00856"></a>00856 
<a name="l00857"></a><a class="code" href="prefs_8cpp.html#a345bf382713ca2a30926e15164b036da">00857</a> <span class="keywordtype">void</span> <a class="code" href="prefs_8cpp.html#a345bf382713ca2a30926e15164b036da">SaveRelPath</a>(FILE* f, <span class="keyword">const</span> <span class="keywordtype">char</span>* name, wxString path)
<a name="l00858"></a>00858 {
<a name="l00859"></a>00859     <span class="comment">// if given path is inside Ready directory then save as a relative path</span>
<a name="l00860"></a>00860     <span class="keywordflow">if</span> (path.StartsWith(<a class="code" href="prefs_8cpp.html#aa3af5b468230e51f15091c9f1410b2c4">readydir</a>)) {
<a name="l00861"></a>00861         <span class="comment">// remove readydir from start of path</span>
<a name="l00862"></a>00862         path.erase(0, <a class="code" href="prefs_8cpp.html#aa3af5b468230e51f15091c9f1410b2c4">readydir</a>.length());
<a name="l00863"></a>00863     }
<a name="l00864"></a>00864     fprintf(f, <span class="stringliteral">&quot;%s=%s\n&quot;</span>, name, (<span class="keyword">const</span> <span class="keywordtype">char</span>*)path.mb_str(wxConvLocal));
<a name="l00865"></a>00865 }
<a name="l00866"></a>00866 
<a name="l00867"></a>00867 <span class="comment">// -----------------------------------------------------------------------------</span>
<a name="l00868"></a>00868 
<a name="l00869"></a><a class="code" href="prefs_8hpp.html#a36a6fcc2c220a813bd9f3057c8c8bfc1">00869</a> <span class="keywordtype">void</span> <a class="code" href="prefs_8cpp.html#a36a6fcc2c220a813bd9f3057c8c8bfc1">SavePrefs</a>()
<a name="l00870"></a>00870 {
<a name="l00871"></a>00871     FILE* f = fopen((<span class="keyword">const</span> <span class="keywordtype">char</span>*)<a class="code" href="prefs_8cpp.html#ab9caae868f071ef53f59a17b995b45ec">prefspath</a>.mb_str(wxConvLocal), <span class="stringliteral">&quot;w&quot;</span>);
<a name="l00872"></a>00872     <span class="keywordflow">if</span> (f == NULL) {
<a name="l00873"></a>00873         <a class="code" href="wxutils_8cpp.html#ad496c0028843186f55032174260d2732">Warning</a>(_(<span class="stringliteral">&quot;Could not save preferences file:\n&quot;</span>) + <a class="code" href="prefs_8cpp.html#ab9caae868f071ef53f59a17b995b45ec">prefspath</a>);
<a name="l00874"></a>00874         <span class="keywordflow">return</span>;
<a name="l00875"></a>00875     }
<a name="l00876"></a>00876 
<a name="l00877"></a>00877     fprintf(f, <span class="stringliteral">&quot;# NOTE: If you edit this file then do so when Ready isn&#39;t running\n&quot;</span>);
<a name="l00878"></a>00878     fprintf(f, <span class="stringliteral">&quot;# otherwise all your changes will be clobbered when Ready quits.\n\n&quot;</span>);
<a name="l00879"></a>00879     fprintf(f, <span class="stringliteral">&quot;prefs_version=%d\n&quot;</span>, <a class="code" href="prefs_8cpp.html#a8f18c82361263ce84f69cb17db9dfe9a">PREFS_VERSION</a>);
<a name="l00880"></a>00880     fprintf(f, <span class="stringliteral">&quot;ready_version=%s\n&quot;</span>, <a class="code" href="utils_8hpp.html#ac2e9bff2b922868f2b467492cb32839f">STR</a>(READY_VERSION));
<a name="l00881"></a>00881     wxString wxversion = wxVERSION_STRING;
<a name="l00882"></a>00882     fprintf(f, <span class="stringliteral">&quot;wx_version=%s\n&quot;</span>, (<span class="keyword">const</span> <span class="keywordtype">char</span>*)wxversion.mb_str(wxConvLocal));
<a name="l00883"></a>00883 <span class="preprocessor">#if defined(__WXMAC__)</span>
<a name="l00884"></a>00884 <span class="preprocessor"></span>    fprintf(f, <span class="stringliteral">&quot;platform=Mac\n&quot;</span>);
<a name="l00885"></a>00885 <span class="preprocessor">#elif defined(__WXMSW__)</span>
<a name="l00886"></a>00886 <span class="preprocessor"></span>    fprintf(f, <span class="stringliteral">&quot;platform=Windows\n&quot;</span>);
<a name="l00887"></a>00887 <span class="preprocessor">#elif defined(__WXGTK__)</span>
<a name="l00888"></a>00888 <span class="preprocessor"></span>    fprintf(f, <span class="stringliteral">&quot;platform=Linux\n&quot;</span>);
<a name="l00889"></a>00889 <span class="preprocessor">#else</span>
<a name="l00890"></a>00890 <span class="preprocessor"></span>    fprintf(f, <span class="stringliteral">&quot;platform=unknown\n&quot;</span>);
<a name="l00891"></a>00891 <span class="preprocessor">#endif</span>
<a name="l00892"></a>00892 <span class="preprocessor"></span>    fprintf(f, <span class="stringliteral">&quot;debug_level=%d\n&quot;</span>, <a class="code" href="prefs_8cpp.html#af219299ebad47daa6631415a8b41345a">debuglevel</a>);
<a name="l00893"></a>00893 
<a name="l00894"></a>00894     <span class="comment">// save main window&#39;s location and size</span>
<a name="l00895"></a>00895     <a class="code" href="classMyFrame.html" title="The wxFrame-derived top-level window for the Ready GUI.">MyFrame</a>* frameptr = wxGetApp().currframe;
<a name="l00896"></a>00896 <span class="preprocessor">    #ifdef __WXMSW__</span>
<a name="l00897"></a>00897 <span class="preprocessor"></span>    <span class="keywordflow">if</span> (frameptr-&gt;<a class="code" href="classMyFrame.html#a1bea8a15bb46eb21b3ccc1e7627a5ef9">IsFullScreen</a>() || frameptr-&gt;IsIconized()) {
<a name="l00898"></a>00898         <span class="comment">// use mainx, mainy, mainwd, mainht set by frameptr-&gt;OnFullScreen()</span>
<a name="l00899"></a>00899         <span class="comment">// or by frameptr-&gt;OnSize</span>
<a name="l00900"></a>00900 <span class="preprocessor">    #else</span>
<a name="l00901"></a>00901 <span class="preprocessor"></span>    <span class="keywordflow">if</span> (frameptr-&gt;<a class="code" href="classMyFrame.html#a1bea8a15bb46eb21b3ccc1e7627a5ef9">IsFullScreen</a>()) {
<a name="l00902"></a>00902         <span class="comment">// use mainx, mainy, mainwd, mainht set by frameptr-&gt;OnFullScreen()</span>
<a name="l00903"></a>00903 <span class="preprocessor">    #endif</span>
<a name="l00904"></a>00904 <span class="preprocessor"></span>    } <span class="keywordflow">else</span> {
<a name="l00905"></a>00905         wxRect r = frameptr-&gt;GetRect();
<a name="l00906"></a>00906         <a class="code" href="prefs_8cpp.html#a26b11189d93fef33172f1a2a1d174188">mainx</a> = r.x;
<a name="l00907"></a>00907         <a class="code" href="prefs_8cpp.html#a8b015efaa4cb16287077ac74b60ad67a">mainy</a> = r.y;
<a name="l00908"></a>00908         <a class="code" href="prefs_8cpp.html#a7b08ad54bec54f213c5ed4c1d8749548">mainwd</a> = r.width;
<a name="l00909"></a>00909         <a class="code" href="prefs_8cpp.html#afd8ee1110367c04cc21e2219607b7a7b">mainht</a> = r.height;
<a name="l00910"></a>00910     }
<a name="l00911"></a>00911     fprintf(f, <span class="stringliteral">&quot;main_window=%d,%d,%d,%d\n&quot;</span>, <a class="code" href="prefs_8cpp.html#a26b11189d93fef33172f1a2a1d174188">mainx</a>, <a class="code" href="prefs_8cpp.html#a8b015efaa4cb16287077ac74b60ad67a">mainy</a>, <a class="code" href="prefs_8cpp.html#a7b08ad54bec54f213c5ed4c1d8749548">mainwd</a>, <a class="code" href="prefs_8cpp.html#afd8ee1110367c04cc21e2219607b7a7b">mainht</a>);
<a name="l00912"></a>00912     fprintf(f, <span class="stringliteral">&quot;maximize=%d\n&quot;</span>, frameptr-&gt;IsMaximized() ? 1 : 0);
<a name="l00913"></a>00913 
<a name="l00914"></a>00914     fprintf(f, <span class="stringliteral">&quot;aui_layout=%s\n&quot;</span>, (<span class="keyword">const</span> <span class="keywordtype">char</span>*)<a class="code" href="prefs_8cpp.html#a9c5a9f65dc02b9e7ed8abef92565e5fa">auilayout</a>.mb_str(wxConvLocal));
<a name="l00915"></a>00915     fprintf(f, <span class="stringliteral">&quot;opencl_platform=%d\n&quot;</span>, <a class="code" href="prefs_8cpp.html#a0de6a378ca700dd877cab59c65ba2f7b">opencl_platform</a>);
<a name="l00916"></a>00916     fprintf(f, <span class="stringliteral">&quot;opencl_device=%d\n&quot;</span>, <a class="code" href="prefs_8cpp.html#a11d0cbab21425e351638f4bf2cc72874">opencl_device</a>);
<a name="l00917"></a>00917 
<a name="l00918"></a>00918     <a class="code" href="prefs_8cpp.html#a9a4e48379de2b0a84470f8dee26e1d48">SaveKeyActions</a>(f);
<a name="l00919"></a>00919     
<a name="l00920"></a>00920     fprintf(f, <span class="stringliteral">&quot;info_font_size=%d (%d..%d)\n&quot;</span>, <a class="code" href="prefs_8cpp.html#a7af6ffef487690c55989fafb52cad837">infofontsize</a>, <a class="code" href="prefs_8hpp.html#ab9bb4307b077f19442247557845c3535">minfontsize</a>, <a class="code" href="prefs_8hpp.html#aac2c9b284ec614d2ba278a3ad5522840">maxfontsize</a>);
<a name="l00921"></a>00921     fprintf(f, <span class="stringliteral">&quot;help_font_size=%d (%d..%d)\n&quot;</span>, <a class="code" href="prefs_8cpp.html#a4632890b2d4f7c0ecb125a0b924fae2f">helpfontsize</a>, <a class="code" href="prefs_8hpp.html#ab9bb4307b077f19442247557845c3535">minfontsize</a>, <a class="code" href="prefs_8hpp.html#aac2c9b284ec614d2ba278a3ad5522840">maxfontsize</a>);
<a name="l00922"></a>00922     fprintf(f, <span class="stringliteral">&quot;text_dlg_wd=%d\n&quot;</span>, <a class="code" href="prefs_8cpp.html#a3fe8c36e5972115938dc8a7abc55be62">textdlgwd</a>);
<a name="l00923"></a>00923     fprintf(f, <span class="stringliteral">&quot;text_dlg_ht=%d\n&quot;</span>, <a class="code" href="prefs_8cpp.html#a0b9937fefba071008390e6e3149bdb11">textdlght</a>);
<a name="l00924"></a>00924     fprintf(f, <span class="stringliteral">&quot;show_tips=%d\n&quot;</span>, <a class="code" href="prefs_8cpp.html#af831ab3ffe0ee800c61d7a73b2873ce3">showtips</a> ? 1 : 0);
<a name="l00925"></a>00925     fprintf(f, <span class="stringliteral">&quot;repaint_to_erase=%d\n&quot;</span>, <a class="code" href="prefs_8cpp.html#a12fa8d7d57fa0c4eab03e55cb31d3ca1">repaint_to_erase</a> ? 1 : 0);
<a name="l00926"></a>00926     fprintf(f, <span class="stringliteral">&quot;current_brush_size=%d\n&quot;</span>, <a class="code" href="prefs_8cpp.html#ae204d3ec12d9c681259496320dfe1e00">current_brush_size</a>);
<a name="l00927"></a>00927     fprintf(f, <span class="stringliteral">&quot;allow_beep=%d\n&quot;</span>, <a class="code" href="prefs_8cpp.html#a68723f2f0bf26bff2564c1af8aa80d22">allowbeep</a> ? 1 : 0);
<a name="l00928"></a>00928     fprintf(f, <span class="stringliteral">&quot;ask_on_new=%d\n&quot;</span>, <a class="code" href="prefs_8cpp.html#af99b0c2f2338ed759034777927bd3101">askonnew</a> ? 1 : 0);
<a name="l00929"></a>00929     fprintf(f, <span class="stringliteral">&quot;ask_on_load=%d\n&quot;</span>, <a class="code" href="prefs_8cpp.html#aac5614bb4154327f09ed8d29bec54d0b">askonload</a> ? 1 : 0);
<a name="l00930"></a>00930     fprintf(f, <span class="stringliteral">&quot;ask_on_quit=%d\n&quot;</span>, <a class="code" href="prefs_8cpp.html#a0498f5ccb6ca073727aa39f77e82660b">askonquit</a> ? 1 : 0);
<a name="l00931"></a>00931 
<a name="l00932"></a>00932     fputs(<span class="stringliteral">&quot;\n&quot;</span>, f);
<a name="l00933"></a>00933 
<a name="l00934"></a>00934     <a class="code" href="prefs_8cpp.html#a345bf382713ca2a30926e15164b036da">SaveRelPath</a>(f, <span class="stringliteral">&quot;open_save_dir&quot;</span>, <a class="code" href="prefs_8cpp.html#adc6c83c9ee4250d0b1f2b2b9f33fa777">opensavedir</a>);
<a name="l00935"></a>00935     <a class="code" href="prefs_8cpp.html#a345bf382713ca2a30926e15164b036da">SaveRelPath</a>(f, <span class="stringliteral">&quot;screenshot_dir&quot;</span>, <a class="code" href="prefs_8cpp.html#aecf1f655ef78e68e956e57878e7ea48d">screenshotdir</a>);
<a name="l00936"></a>00936     <a class="code" href="prefs_8cpp.html#a345bf382713ca2a30926e15164b036da">SaveRelPath</a>(f, <span class="stringliteral">&quot;choose_dir&quot;</span>, <a class="code" href="prefs_8cpp.html#a8bf37d7016c72a6f4df10b194849371a">choosedir</a>);
<a name="l00937"></a>00937     <a class="code" href="prefs_8cpp.html#a345bf382713ca2a30926e15164b036da">SaveRelPath</a>(f, <span class="stringliteral">&quot;user_dir&quot;</span>, <a class="code" href="prefs_8cpp.html#a91188f84b92fb18a365b824f1d78c07f">userdir</a>);
<a name="l00938"></a>00938     <a class="code" href="prefs_8cpp.html#a345bf382713ca2a30926e15164b036da">SaveRelPath</a>(f, <span class="stringliteral">&quot;recording_dir&quot;</span>, <a class="code" href="prefs_8cpp.html#ab452266aeee4716a62c33d520df9ba7f">recordingdir</a>);
<a name="l00939"></a>00939 
<a name="l00940"></a>00940     fputs(<span class="stringliteral">&quot;\n&quot;</span>, f);
<a name="l00941"></a>00941 
<a name="l00942"></a>00942     fprintf(f, <span class="stringliteral">&quot;text_editor=%s\n&quot;</span>, (<span class="keyword">const</span> <span class="keywordtype">char</span>*)<a class="code" href="prefs_8cpp.html#a3a8c57e4e1beb747c341e067dc8869bf">texteditor</a>.mb_str(wxConvLocal));
<a name="l00943"></a>00943     fprintf(f, <span class="stringliteral">&quot;max_patterns=%d (1..%d)\n&quot;</span>, <a class="code" href="prefs_8cpp.html#af74247065dccdcbc74c5e1b8dc09e01c">maxpatterns</a>, <a class="code" href="namespaceID.html#add26a31edd435929e305eca022a899d0">ID::MAX_RECENT</a>);
<a name="l00944"></a>00944 
<a name="l00945"></a>00945     <span class="keywordflow">if</span> (<a class="code" href="prefs_8cpp.html#a17a3671114d042df36485b7cf3a80840">numpatterns</a> &gt; 0) {
<a name="l00946"></a>00946         fputs(<span class="stringliteral">&quot;\n&quot;</span>, f);
<a name="l00947"></a>00947         <span class="keywordtype">int</span> i;
<a name="l00948"></a>00948         <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="prefs_8cpp.html#a17a3671114d042df36485b7cf3a80840">numpatterns</a>; i++) {
<a name="l00949"></a>00949             wxMenuItem* item = <a class="code" href="prefs_8cpp.html#ae5246b1632294beb0e04a2942722d304">patternSubMenu</a>-&gt;FindItemByPosition(i);
<a name="l00950"></a>00950             <span class="keywordflow">if</span> (item) {
<a name="l00951"></a>00951 <span class="preprocessor">#if wxCHECK_VERSION(2,9,0)</span>
<a name="l00952"></a>00952 <span class="preprocessor"></span>                wxString path = item-&gt;GetItemLabel();
<a name="l00953"></a>00953 <span class="preprocessor">#else</span>
<a name="l00954"></a>00954 <span class="preprocessor"></span>                wxString path = item-&gt;GetText();
<a name="l00955"></a>00955 <span class="preprocessor">#endif</span>
<a name="l00956"></a>00956 <span class="preprocessor"></span><span class="preprocessor">#ifdef __WXGTK__</span>
<a name="l00957"></a>00957 <span class="preprocessor"></span>                <span class="comment">// remove duplicate underscores</span>
<a name="l00958"></a>00958                 path.Replace(wxT(<span class="stringliteral">&quot;__&quot;</span>), wxT(<span class="stringliteral">&quot;_&quot;</span>));
<a name="l00959"></a>00959 <span class="preprocessor">#endif</span>
<a name="l00960"></a>00960 <span class="preprocessor"></span>                <span class="comment">// remove duplicate ampersands</span>
<a name="l00961"></a>00961                 path.Replace(wxT(<span class="stringliteral">&quot;&amp;&amp;&quot;</span>), wxT(<span class="stringliteral">&quot;&amp;&quot;</span>));
<a name="l00962"></a>00962                 fprintf(f, <span class="stringliteral">&quot;recent_pattern=%s\n&quot;</span>, (<span class="keyword">const</span> <span class="keywordtype">char</span>*)path.mb_str(wxConvLocal));
<a name="l00963"></a>00963             }
<a name="l00964"></a>00964         }
<a name="l00965"></a>00965     }
<a name="l00966"></a>00966 
<a name="l00967"></a>00967     fclose(f);
<a name="l00968"></a>00968 }
<a name="l00969"></a>00969 
<a name="l00970"></a>00970 <span class="comment">// -----------------------------------------------------------------------------</span>
<a name="l00971"></a>00971 
<a name="l00972"></a>00972 <span class="comment">// the linereader class handles all line endings (CR, CR+LF, LF)</span>
<a name="l00973"></a>00973 <span class="comment">// and terminates a line buffer with \0</span>
<a name="l00974"></a>00974 
<a name="l00975"></a><a class="code" href="prefs_8cpp.html#a9efa21d4c812c5c9f085a638b1bb0268">00975</a> <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="prefs_8cpp.html#a9efa21d4c812c5c9f085a638b1bb0268">LF</a> = 10;
<a name="l00976"></a><a class="code" href="prefs_8cpp.html#a984744e7980d3a3646a27dbb40871365">00976</a> <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="prefs_8cpp.html#a984744e7980d3a3646a27dbb40871365">CR</a> = 13;
<a name="l00977"></a>00977 
<a name="l00978"></a><a class="code" href="classlinereader.html">00978</a> <span class="keyword">class </span><a class="code" href="classlinereader.html">linereader</a> {
<a name="l00979"></a>00979     <span class="keyword">public</span>:
<a name="l00980"></a><a class="code" href="classlinereader.html#a48e9cef2da2c0c3f5b08de994ad47b49">00980</a>         <a class="code" href="classlinereader.html#a48e9cef2da2c0c3f5b08de994ad47b49">linereader</a>(FILE* f) { <a class="code" href="classlinereader.html#aba400a2150f966f110baf8c02a5bf125">setfile</a>(f); }
<a name="l00981"></a><a class="code" href="classlinereader.html#a6866e7f6874a47ba10f92cdc5b8332ba">00981</a>         <a class="code" href="classlinereader.html#a6866e7f6874a47ba10f92cdc5b8332ba">~linereader</a>() { <span class="keywordflow">if</span> (<a class="code" href="classlinereader.html#adabbf042891a9928f3120cd63da53692">closeonfree</a>) <a class="code" href="classlinereader.html#a16f4017f86f15ea87ab031ed2e35c1e1">close</a>(); }
<a name="l00982"></a>00982         <span class="keywordtype">char</span> *<a class="code" href="classlinereader.html#ae6f7efc197278a15ef7f2c026acca5d5">fgets</a>(<span class="keywordtype">char</span>* buf, <span class="keywordtype">int</span> maxlen);
<a name="l00983"></a>00983         <span class="keywordtype">void</span> <a class="code" href="classlinereader.html#aba400a2150f966f110baf8c02a5bf125">setfile</a>(FILE* f);
<a name="l00984"></a><a class="code" href="classlinereader.html#adf27efab53ec864c82bd13bb2430efd2">00984</a>         <span class="keywordtype">void</span> <a class="code" href="classlinereader.html#adf27efab53ec864c82bd13bb2430efd2">setcloseonfree</a>() { <a class="code" href="classlinereader.html#adabbf042891a9928f3120cd63da53692">closeonfree</a> = 1; }
<a name="l00985"></a>00985         <span class="keywordtype">int</span> <a class="code" href="classlinereader.html#a16f4017f86f15ea87ab031ed2e35c1e1">close</a>();
<a name="l00986"></a>00986     <span class="keyword">private</span>:
<a name="l00987"></a><a class="code" href="classlinereader.html#ad9f0f6be5a6cc6f3a335fe992cdcad14">00987</a>         <span class="keywordtype">int</span> <a class="code" href="classlinereader.html#ad9f0f6be5a6cc6f3a335fe992cdcad14">lastchar</a>;
<a name="l00988"></a><a class="code" href="classlinereader.html#adabbf042891a9928f3120cd63da53692">00988</a>         <span class="keywordtype">int</span> <a class="code" href="classlinereader.html#adabbf042891a9928f3120cd63da53692">closeonfree</a>;
<a name="l00989"></a><a class="code" href="classlinereader.html#a6e6c629bd313ef1e971ab1c6525fb6f0">00989</a>         FILE* <a class="code" href="classlinereader.html#a6e6c629bd313ef1e971ab1c6525fb6f0">fp</a>;
<a name="l00990"></a>00990 };
<a name="l00991"></a>00991 
<a name="l00992"></a><a class="code" href="classlinereader.html#aba400a2150f966f110baf8c02a5bf125">00992</a> <span class="keywordtype">void</span> <a class="code" href="classlinereader.html#aba400a2150f966f110baf8c02a5bf125">linereader::setfile</a>(FILE* f) {
<a name="l00993"></a>00993     <a class="code" href="classlinereader.html#a6e6c629bd313ef1e971ab1c6525fb6f0">fp</a> = f;
<a name="l00994"></a>00994     <a class="code" href="classlinereader.html#ad9f0f6be5a6cc6f3a335fe992cdcad14">lastchar</a> = 0;
<a name="l00995"></a>00995     <a class="code" href="classlinereader.html#adabbf042891a9928f3120cd63da53692">closeonfree</a> = 0;
<a name="l00996"></a>00996 }
<a name="l00997"></a>00997 
<a name="l00998"></a><a class="code" href="classlinereader.html#a16f4017f86f15ea87ab031ed2e35c1e1">00998</a> <span class="keywordtype">int</span> <a class="code" href="classlinereader.html#a16f4017f86f15ea87ab031ed2e35c1e1">linereader::close</a>() {
<a name="l00999"></a>00999      <span class="keywordflow">if</span> (<a class="code" href="classlinereader.html#a6e6c629bd313ef1e971ab1c6525fb6f0">fp</a>) {
<a name="l01000"></a>01000         <span class="keywordflow">return</span> fclose(<a class="code" href="classlinereader.html#a6e6c629bd313ef1e971ab1c6525fb6f0">fp</a>);
<a name="l01001"></a>01001         <a class="code" href="classlinereader.html#a6e6c629bd313ef1e971ab1c6525fb6f0">fp</a> = 0;
<a name="l01002"></a>01002     }
<a name="l01003"></a>01003     <span class="keywordflow">return</span> 0;
<a name="l01004"></a>01004 }
<a name="l01005"></a>01005 
<a name="l01006"></a><a class="code" href="classlinereader.html#ae6f7efc197278a15ef7f2c026acca5d5">01006</a> <span class="keywordtype">char</span>* <a class="code" href="classlinereader.html#ae6f7efc197278a15ef7f2c026acca5d5">linereader::fgets</a>(<span class="keywordtype">char</span>* buf, <span class="keywordtype">int</span> maxlen)
<a name="l01007"></a>01007 {
<a name="l01008"></a>01008     <span class="keywordtype">int</span> i = 0;
<a name="l01009"></a>01009     <span class="keywordflow">for</span> (;;) {
<a name="l01010"></a>01010         <span class="keywordflow">if</span> (i+1 &gt;= maxlen) {
<a name="l01011"></a>01011             buf[i] = 0;
<a name="l01012"></a>01012             <span class="keywordflow">return</span> buf;
<a name="l01013"></a>01013         }
<a name="l01014"></a>01014         <span class="keywordtype">int</span> c = getc(<a class="code" href="classlinereader.html#a6e6c629bd313ef1e971ab1c6525fb6f0">fp</a>);
<a name="l01015"></a>01015         <span class="keywordflow">switch</span> (c) {
<a name="l01016"></a>01016         <span class="keywordflow">case</span> EOF:
<a name="l01017"></a>01017             <span class="keywordflow">if</span> (i == 0) <span class="keywordflow">return</span> 0;
<a name="l01018"></a>01018             buf[i] = 0;
<a name="l01019"></a>01019             <span class="keywordflow">return</span> buf;
<a name="l01020"></a>01020         <span class="keywordflow">case</span> LF:
<a name="l01021"></a>01021             <span class="keywordflow">if</span> (<a class="code" href="classlinereader.html#ad9f0f6be5a6cc6f3a335fe992cdcad14">lastchar</a> != CR) {
<a name="l01022"></a>01022                 <a class="code" href="classlinereader.html#ad9f0f6be5a6cc6f3a335fe992cdcad14">lastchar</a> = <a class="code" href="prefs_8cpp.html#a9efa21d4c812c5c9f085a638b1bb0268">LF</a>;
<a name="l01023"></a>01023                 buf[i] = 0;
<a name="l01024"></a>01024                 <span class="keywordflow">return</span> buf;
<a name="l01025"></a>01025             }
<a name="l01026"></a>01026             <span class="keywordflow">break</span>;
<a name="l01027"></a>01027         <span class="keywordflow">case</span> CR:
<a name="l01028"></a>01028             <a class="code" href="classlinereader.html#ad9f0f6be5a6cc6f3a335fe992cdcad14">lastchar</a> = <a class="code" href="prefs_8cpp.html#a984744e7980d3a3646a27dbb40871365">CR</a>;
<a name="l01029"></a>01029             buf[i] = 0;
<a name="l01030"></a>01030             <span class="keywordflow">return</span> buf;
<a name="l01031"></a>01031         <span class="keywordflow">default</span>:
<a name="l01032"></a>01032             <a class="code" href="classlinereader.html#ad9f0f6be5a6cc6f3a335fe992cdcad14">lastchar</a> = c;
<a name="l01033"></a>01033             buf[i++] = (char)c;
<a name="l01034"></a>01034             <span class="keywordflow">break</span>;
<a name="l01035"></a>01035         }
<a name="l01036"></a>01036     }
<a name="l01037"></a>01037 }
<a name="l01038"></a>01038 
<a name="l01039"></a>01039 <span class="comment">// -----------------------------------------------------------------------------</span>
<a name="l01040"></a>01040 
<a name="l01041"></a><a class="code" href="prefs_8cpp.html#a5f676384f389f4058c42965308c7217c">01041</a> <span class="keywordtype">bool</span> <a class="code" href="prefs_8cpp.html#a5f676384f389f4058c42965308c7217c">GetKeywordAndValue</a>(<a class="code" href="classlinereader.html">linereader</a>&amp; lr, <span class="keywordtype">char</span>* line, <span class="keywordtype">char</span>** keyword, <span class="keywordtype">char</span>** value)
<a name="l01042"></a>01042 {
<a name="l01043"></a>01043     <span class="keywordflow">while</span> ( lr.<a class="code" href="classlinereader.html#ae6f7efc197278a15ef7f2c026acca5d5">fgets</a>(line, <a class="code" href="prefs_8cpp.html#aad1b9da94bf263a8ea6e237c6207c12a">PREF_LINE_SIZE</a>) != 0 ) {
<a name="l01044"></a>01044         <span class="keywordflow">if</span> ( line[0] == <span class="charliteral">&#39;#&#39;</span> || line[0] == 0 ) {
<a name="l01045"></a>01045             <span class="comment">// skip comment line or empty line</span>
<a name="l01046"></a>01046         }
<a name="l01047"></a>01047         <span class="keywordflow">else</span> {
<a name="l01048"></a>01048             <span class="comment">// line should have format keyword=value</span>
<a name="l01049"></a>01049             *keyword = line;
<a name="l01050"></a>01050             *value = line;
<a name="l01051"></a>01051             <span class="keywordflow">while</span> ( **value != <span class="charliteral">&#39;=&#39;</span> &amp;&amp; **value != 0 ) *value += 1;
<a name="l01052"></a>01052             **value = 0;         <span class="comment">// terminate keyword</span>
<a name="l01053"></a>01053             *value += 1;
<a name="l01054"></a>01054             <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l01055"></a>01055         }
<a name="l01056"></a>01056     }
<a name="l01057"></a>01057     <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l01058"></a>01058 }
<a name="l01059"></a>01059 
<a name="l01060"></a>01060 <span class="comment">// -----------------------------------------------------------------------------</span>
<a name="l01061"></a>01061 
<a name="l01062"></a><a class="code" href="prefs_8cpp.html#ac2d9a0448a288b1b398be4b489b0b7b2">01062</a> <span class="keywordtype">void</span> <a class="code" href="prefs_8cpp.html#ac2d9a0448a288b1b398be4b489b0b7b2">CheckVisibility</a>(<span class="keywordtype">int</span>* x, <span class="keywordtype">int</span>* y, <span class="keywordtype">int</span>* wd, <span class="keywordtype">int</span>* ht)
<a name="l01063"></a>01063 {
<a name="l01064"></a>01064     wxRect maxrect = wxGetClientDisplayRect();
<a name="l01065"></a>01065     <span class="comment">// reset x,y if title bar isn&#39;t clearly visible</span>
<a name="l01066"></a>01066     <span class="keywordflow">if</span> ( *y + 10 &lt; maxrect.y || *y + 10 &gt; maxrect.GetBottom() ||
<a name="l01067"></a>01067          *x + 10 &gt; maxrect.GetRight() || *x + *wd - 10 &lt; maxrect.x ) {
<a name="l01068"></a>01068         *x = wxDefaultCoord;
<a name="l01069"></a>01069         *y = wxDefaultCoord;
<a name="l01070"></a>01070     }
<a name="l01071"></a>01071     <span class="comment">// reduce wd,ht if too big for screen</span>
<a name="l01072"></a>01072     <span class="keywordflow">if</span> (*wd &gt; maxrect.width) *wd = maxrect.width;
<a name="l01073"></a>01073     <span class="keywordflow">if</span> (*ht &gt; maxrect.height) *ht = maxrect.height;
<a name="l01074"></a>01074 }
<a name="l01075"></a>01075 
<a name="l01076"></a>01076 <span class="comment">// -----------------------------------------------------------------------------</span>
<a name="l01077"></a>01077 
<a name="l01078"></a><a class="code" href="prefs_8cpp.html#a1ee6493fe6ca0efb8c60abbfe5454fea">01078</a> <span class="keywordtype">void</span> <a class="code" href="prefs_8cpp.html#a1ee6493fe6ca0efb8c60abbfe5454fea">InitPaths</a>()
<a name="l01079"></a>01079 {
<a name="l01080"></a>01080 <span class="preprocessor">#ifdef __WXGTK__</span>
<a name="l01081"></a>01081 <span class="preprocessor"></span>    <span class="comment">// on Linux we want datadir to be &quot;~/.ready&quot; rather than &quot;~/.Ready&quot;</span>
<a name="l01082"></a>01082     wxGetApp().SetAppName(_(<span class="stringliteral">&quot;ready&quot;</span>));
<a name="l01083"></a>01083 <span class="preprocessor">#endif</span>
<a name="l01084"></a>01084 <span class="preprocessor"></span>
<a name="l01085"></a>01085     <span class="comment">// init datadir and create the directory if it doesn&#39;t exist;</span>
<a name="l01086"></a>01086     <span class="comment">// the directory will probably be:</span>
<a name="l01087"></a>01087     <span class="comment">// Win: C:\Documents and Settings\username\Application Data\Ready</span>
<a name="l01088"></a>01088     <span class="comment">// Mac: ~/Library/Application Support/Ready</span>
<a name="l01089"></a>01089     <span class="comment">// Unix: ~/.ready</span>
<a name="l01090"></a>01090     <a class="code" href="prefs_8cpp.html#ab560d022c77858352411b140714050db">datadir</a> = wxStandardPaths::Get().GetUserDataDir();
<a name="l01091"></a>01091     <span class="keywordflow">if</span> ( !wxFileName::DirExists(<a class="code" href="prefs_8cpp.html#ab560d022c77858352411b140714050db">datadir</a>) ) {
<a name="l01092"></a>01092         <span class="keywordflow">if</span> ( !wxFileName::Mkdir(<a class="code" href="prefs_8cpp.html#ab560d022c77858352411b140714050db">datadir</a>, 0777, wxPATH_MKDIR_FULL) ) {
<a name="l01093"></a>01093             <a class="code" href="wxutils_8cpp.html#ad496c0028843186f55032174260d2732">Warning</a>(_(<span class="stringliteral">&quot;Could not create a user-specific data directory!\nWill try to use the application directory instead.&quot;</span>));
<a name="l01094"></a>01094             <a class="code" href="prefs_8cpp.html#ab560d022c77858352411b140714050db">datadir</a> = <a class="code" href="prefs_8cpp.html#aa3af5b468230e51f15091c9f1410b2c4">readydir</a>;
<a name="l01095"></a>01095         }
<a name="l01096"></a>01096     }
<a name="l01097"></a>01097     <span class="keywordflow">if</span> (<a class="code" href="prefs_8cpp.html#ab560d022c77858352411b140714050db">datadir</a>.Last() != wxFILE_SEP_PATH) <a class="code" href="prefs_8cpp.html#ab560d022c77858352411b140714050db">datadir</a> += wxFILE_SEP_PATH;
<a name="l01098"></a>01098 
<a name="l01099"></a>01099     <span class="comment">// init tempdir to a temporary directory unique to this process</span>
<a name="l01100"></a>01100     <a class="code" href="prefs_8cpp.html#a3edf5a81e7705cff70d24652da075f4f">tempdir</a> = wxFileName::CreateTempFileName(wxT(<span class="stringliteral">&quot;ready_&quot;</span>));
<a name="l01101"></a>01101     <span class="comment">// on Linux the file is in /tmp;</span>
<a name="l01102"></a>01102     <span class="comment">// on my Mac the file is in /private/var/tmp/folders.502/TemporaryItems;</span>
<a name="l01103"></a>01103     <span class="comment">// on WinXP the file is in C:\Documents and Settings\Andy\Local Settings\Temp</span>
<a name="l01104"></a>01104     <span class="comment">// (or shorter equivalent C:\DOCUME~1\Andy\LOCALS~1\Temp) but the file name</span>
<a name="l01105"></a>01105     <span class="comment">// is rea*.tmp (ie. only 1st 3 chars of the prefix are used, and .tmp is added)</span>
<a name="l01106"></a>01106     wxRemoveFile(<a class="code" href="prefs_8cpp.html#a3edf5a81e7705cff70d24652da075f4f">tempdir</a>);
<a name="l01107"></a>01107     <span class="keywordflow">if</span> ( !wxFileName::Mkdir(<a class="code" href="prefs_8cpp.html#a3edf5a81e7705cff70d24652da075f4f">tempdir</a>, 0777, wxPATH_MKDIR_FULL) ) {
<a name="l01108"></a>01108         <a class="code" href="wxutils_8cpp.html#ad496c0028843186f55032174260d2732">Warning</a>(_(<span class="stringliteral">&quot;Could not create temporary directory:\n&quot;</span>) + <a class="code" href="prefs_8cpp.html#a3edf5a81e7705cff70d24652da075f4f">tempdir</a>);
<a name="l01109"></a>01109         <span class="comment">// use standard directory for temp files</span>
<a name="l01110"></a>01110         <a class="code" href="prefs_8cpp.html#a3edf5a81e7705cff70d24652da075f4f">tempdir</a> = wxStandardPaths::Get().GetTempDir();
<a name="l01111"></a>01111         <span class="keywordflow">if</span> ( !wxFileName::DirExists(<a class="code" href="prefs_8cpp.html#a3edf5a81e7705cff70d24652da075f4f">tempdir</a>) ) {
<a name="l01112"></a>01112             <span class="comment">// should never happen, but play safe</span>
<a name="l01113"></a>01113             <a class="code" href="wxutils_8cpp.html#a871ab5f4d4e52fe248abb483c05ab688">Fatal</a>(_(<span class="stringliteral">&quot;Sorry, temporary directory does not exist:\n&quot;</span>) + <a class="code" href="prefs_8cpp.html#a3edf5a81e7705cff70d24652da075f4f">tempdir</a>);
<a name="l01114"></a>01114         }
<a name="l01115"></a>01115     }
<a name="l01116"></a>01116     <span class="keywordflow">if</span> (<a class="code" href="prefs_8cpp.html#a3edf5a81e7705cff70d24652da075f4f">tempdir</a>.Last() != wxFILE_SEP_PATH) <a class="code" href="prefs_8cpp.html#a3edf5a81e7705cff70d24652da075f4f">tempdir</a> += wxFILE_SEP_PATH;
<a name="l01117"></a>01117 
<a name="l01118"></a>01118 <span class="preprocessor">#ifdef __WXGTK__</span>
<a name="l01119"></a>01119 <span class="preprocessor"></span>    <span class="comment">// &quot;Ready&quot; is nicer for warning dialogs etc</span>
<a name="l01120"></a>01120     wxGetApp().SetAppName(_(<span class="stringliteral">&quot;Ready&quot;</span>));
<a name="l01121"></a>01121 <span class="preprocessor">#endif</span>
<a name="l01122"></a>01122 <span class="preprocessor"></span>
<a name="l01123"></a>01123     <span class="comment">// init prefspath -- look in readydir first, then in datadir</span>
<a name="l01124"></a>01124     <a class="code" href="prefs_8cpp.html#ab9caae868f071ef53f59a17b995b45ec">prefspath</a> = <a class="code" href="prefs_8cpp.html#aa3af5b468230e51f15091c9f1410b2c4">readydir</a> + <a class="code" href="prefs_8cpp.html#affe07b3e664c212da7b1732908dd3fba">PREFS_NAME</a>;
<a name="l01125"></a>01125     <span class="keywordflow">if</span> ( !wxFileExists(<a class="code" href="prefs_8cpp.html#ab9caae868f071ef53f59a17b995b45ec">prefspath</a>) ) {
<a name="l01126"></a>01126         <a class="code" href="prefs_8cpp.html#ab9caae868f071ef53f59a17b995b45ec">prefspath</a> = <a class="code" href="prefs_8cpp.html#ab560d022c77858352411b140714050db">datadir</a> + <a class="code" href="prefs_8cpp.html#affe07b3e664c212da7b1732908dd3fba">PREFS_NAME</a>;
<a name="l01127"></a>01127     }
<a name="l01128"></a>01128     
<a name="l01129"></a>01129     <a class="code" href="prefs_8cpp.html#af8401ddad0a73df36c378eac775654cd">patterndir</a> = <a class="code" href="prefs_8cpp.html#aa3af5b468230e51f15091c9f1410b2c4">readydir</a> + <a class="code" href="prefs_8cpp.html#a8d853814b27b21dc32810f161cd6a6d0">PATT_DIR</a>;
<a name="l01130"></a>01130 
<a name="l01131"></a>01131     <a class="code" href="prefs_8cpp.html#ab452266aeee4716a62c33d520df9ba7f">recordingdir</a> = _T(<span class="stringliteral">&quot;.&quot;</span>);
<a name="l01132"></a>01132 }
<a name="l01133"></a>01133 
<a name="l01134"></a>01134 <span class="comment">// -----------------------------------------------------------------------------</span>
<a name="l01135"></a>01135 
<a name="l01136"></a><a class="code" href="prefs_8hpp.html#a3b2a68cd85602c7c83ebb305f79d2617">01136</a> <span class="keywordtype">void</span> <a class="code" href="prefs_8cpp.html#a3b2a68cd85602c7c83ebb305f79d2617">GetPrefs</a>()
<a name="l01137"></a>01137 {
<a name="l01138"></a>01138     <span class="keywordtype">bool</span> sawkeyaction = <span class="keyword">false</span>;   <span class="comment">// saw at least one key_action entry?</span>
<a name="l01139"></a>01139 
<a name="l01140"></a>01140     <a class="code" href="prefs_8cpp.html#a1ee6493fe6ca0efb8c60abbfe5454fea">InitPaths</a>();                 <span class="comment">// init datadir, tempdir, prefspath, patterndir</span>
<a name="l01141"></a>01141 
<a name="l01142"></a>01142     <a class="code" href="prefs_8cpp.html#adc6c83c9ee4250d0b1f2b2b9f33fa777">opensavedir</a> = <a class="code" href="prefs_8cpp.html#aa3af5b468230e51f15091c9f1410b2c4">readydir</a> + <a class="code" href="prefs_8cpp.html#a8d853814b27b21dc32810f161cd6a6d0">PATT_DIR</a>;
<a name="l01143"></a>01143     <a class="code" href="prefs_8cpp.html#aecf1f655ef78e68e956e57878e7ea48d">screenshotdir</a> = <a class="code" href="prefs_8cpp.html#aa3af5b468230e51f15091c9f1410b2c4">readydir</a> + <a class="code" href="prefs_8cpp.html#a8d853814b27b21dc32810f161cd6a6d0">PATT_DIR</a>;
<a name="l01144"></a>01144     <a class="code" href="prefs_8cpp.html#a8bf37d7016c72a6f4df10b194849371a">choosedir</a> = <a class="code" href="prefs_8cpp.html#aa3af5b468230e51f15091c9f1410b2c4">readydir</a>;
<a name="l01145"></a>01145     <a class="code" href="prefs_8cpp.html#a91188f84b92fb18a365b824f1d78c07f">userdir</a> = wxT(<span class="stringliteral">&quot;:\\/:&quot;</span>);     <span class="comment">// better if initially an illegal dir name</span>
<a name="l01146"></a>01146 
<a name="l01147"></a>01147     <span class="comment">// init the text editor to something reasonable</span>
<a name="l01148"></a>01148 <span class="preprocessor">#ifdef __WXMSW__</span>
<a name="l01149"></a>01149 <span class="preprocessor"></span>    <a class="code" href="prefs_8cpp.html#a3a8c57e4e1beb747c341e067dc8869bf">texteditor</a> = wxT(<span class="stringliteral">&quot;Notepad&quot;</span>);
<a name="l01150"></a>01150 <span class="preprocessor">#elif defined(__WXMAC__)</span>
<a name="l01151"></a>01151 <span class="preprocessor"></span>    <a class="code" href="prefs_8cpp.html#a3a8c57e4e1beb747c341e067dc8869bf">texteditor</a> = wxT(<span class="stringliteral">&quot;/Applications/TextEdit.app&quot;</span>);
<a name="l01152"></a>01152 <span class="preprocessor">#else</span>
<a name="l01153"></a>01153 <span class="preprocessor"></span>    <span class="comment">// assume Linux</span>
<a name="l01154"></a>01154     <span class="comment">// don&#39;t attempt to guess which editor might be available;</span>
<a name="l01155"></a>01155     <span class="comment">// set the string empty so the user is asked to choose their</span>
<a name="l01156"></a>01156     <span class="comment">// preferred editor the first time texteditor is used</span>
<a name="l01157"></a>01157     <a class="code" href="prefs_8cpp.html#a3a8c57e4e1beb747c341e067dc8869bf">texteditor</a> = wxEmptyString;
<a name="l01158"></a>01158 <span class="preprocessor">#endif</span>
<a name="l01159"></a>01159 <span class="preprocessor"></span>
<a name="l01160"></a>01160     <span class="comment">// initialize Open Recent submenu</span>
<a name="l01161"></a>01161     <a class="code" href="prefs_8cpp.html#ae5246b1632294beb0e04a2942722d304">patternSubMenu</a> = <span class="keyword">new</span> wxMenu();
<a name="l01162"></a>01162     <a class="code" href="prefs_8cpp.html#ae5246b1632294beb0e04a2942722d304">patternSubMenu</a>-&gt;AppendSeparator();
<a name="l01163"></a>01163     <a class="code" href="prefs_8cpp.html#ae5246b1632294beb0e04a2942722d304">patternSubMenu</a>-&gt;Append(<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a62c752cf096291b16dd60eaa26527904">ID::ClearMissingPatterns</a>, _(<span class="stringliteral">&quot;Clear Missing Files&quot;</span>));
<a name="l01164"></a>01164     <a class="code" href="prefs_8cpp.html#ae5246b1632294beb0e04a2942722d304">patternSubMenu</a>-&gt;Append(<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a706737e76be11ecaa9546057bf8216c3">ID::ClearAllPatterns</a>, _(<span class="stringliteral">&quot;Clear All Files&quot;</span>));
<a name="l01165"></a>01165 
<a name="l01166"></a>01166     <span class="keywordflow">if</span> ( !wxFileExists(<a class="code" href="prefs_8cpp.html#ab9caae868f071ef53f59a17b995b45ec">prefspath</a>) ) {
<a name="l01167"></a>01167         <a class="code" href="prefs_8cpp.html#a561f8734ac9b2da848da296a0ce2a8e2">AddDefaultKeyActions</a>();
<a name="l01168"></a>01168         <a class="code" href="prefs_8cpp.html#a3b1ae22a369445497a51790d57de407c">UpdateAcceleratorStrings</a>();
<a name="l01169"></a>01169         <span class="keywordflow">return</span>;
<a name="l01170"></a>01170     }
<a name="l01171"></a>01171 
<a name="l01172"></a>01172     FILE* f = fopen((<span class="keyword">const</span> <span class="keywordtype">char</span>*)<a class="code" href="prefs_8cpp.html#ab9caae868f071ef53f59a17b995b45ec">prefspath</a>.mb_str(wxConvLocal), <span class="stringliteral">&quot;r&quot;</span>);
<a name="l01173"></a>01173     <span class="keywordflow">if</span> (f == NULL) {
<a name="l01174"></a>01174         <a class="code" href="wxutils_8cpp.html#ad496c0028843186f55032174260d2732">Warning</a>(_(<span class="stringliteral">&quot;Could not read preferences file!&quot;</span>));
<a name="l01175"></a>01175         <span class="keywordflow">return</span>;
<a name="l01176"></a>01176     }
<a name="l01177"></a>01177 
<a name="l01178"></a>01178     <a class="code" href="classlinereader.html">linereader</a> reader(f);
<a name="l01179"></a>01179     <span class="keywordtype">char</span> line[<a class="code" href="prefs_8cpp.html#aad1b9da94bf263a8ea6e237c6207c12a">PREF_LINE_SIZE</a>];
<a name="l01180"></a>01180     <span class="keywordtype">char</span>* keyword;
<a name="l01181"></a>01181     <span class="keywordtype">char</span>* value;
<a name="l01182"></a>01182     <span class="keywordflow">while</span> ( <a class="code" href="prefs_8cpp.html#a5f676384f389f4058c42965308c7217c">GetKeywordAndValue</a>(reader, line, &amp;keyword, &amp;value) ) {
<a name="l01183"></a>01183 
<a name="l01184"></a>01184         <span class="keywordflow">if</span> (strcmp(keyword, <span class="stringliteral">&quot;prefs_version&quot;</span>) == 0) {
<a name="l01185"></a>01185             sscanf(value, <span class="stringliteral">&quot;%d&quot;</span>, &amp;<a class="code" href="prefs_8cpp.html#af6fe256936340f78df9e04549496d809">currversion</a>);
<a name="l01186"></a>01186             <span class="comment">/* should we prevent older Ready clobbering newer Ready&#39;s prefs???</span>
<a name="l01187"></a>01187 <span class="comment">            if (currversion &gt; PREFS_VERSION) {</span>
<a name="l01188"></a>01188 <span class="comment">               Fatal(...);</span>
<a name="l01189"></a>01189 <span class="comment">            }</span>
<a name="l01190"></a>01190 <span class="comment">            */</span>
<a name="l01191"></a>01191 
<a name="l01192"></a>01192         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(keyword, <span class="stringliteral">&quot;debug_level&quot;</span>) == 0) {
<a name="l01193"></a>01193             sscanf(value, <span class="stringliteral">&quot;%d&quot;</span>, &amp;<a class="code" href="prefs_8cpp.html#af219299ebad47daa6631415a8b41345a">debuglevel</a>);
<a name="l01194"></a>01194 
<a name="l01195"></a>01195         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(keyword, <span class="stringliteral">&quot;main_window&quot;</span>) == 0) {
<a name="l01196"></a>01196             sscanf(value, <span class="stringliteral">&quot;%d,%d,%d,%d&quot;</span>, &amp;<a class="code" href="prefs_8cpp.html#a26b11189d93fef33172f1a2a1d174188">mainx</a>, &amp;<a class="code" href="prefs_8cpp.html#a8b015efaa4cb16287077ac74b60ad67a">mainy</a>, &amp;<a class="code" href="prefs_8cpp.html#a7b08ad54bec54f213c5ed4c1d8749548">mainwd</a>, &amp;<a class="code" href="prefs_8cpp.html#afd8ee1110367c04cc21e2219607b7a7b">mainht</a>);
<a name="l01197"></a>01197             <span class="comment">// avoid very small window</span>
<a name="l01198"></a>01198             <span class="keywordflow">if</span> (<a class="code" href="prefs_8cpp.html#a7b08ad54bec54f213c5ed4c1d8749548">mainwd</a> &lt; <a class="code" href="prefs_8cpp.html#a7328da96cb977523dc8ca977be1c4963">minmainwd</a>) <a class="code" href="prefs_8cpp.html#a7b08ad54bec54f213c5ed4c1d8749548">mainwd</a> = <a class="code" href="prefs_8cpp.html#a7328da96cb977523dc8ca977be1c4963">minmainwd</a>;
<a name="l01199"></a>01199             <span class="keywordflow">if</span> (<a class="code" href="prefs_8cpp.html#afd8ee1110367c04cc21e2219607b7a7b">mainht</a> &lt; <a class="code" href="prefs_8cpp.html#ad39746c614087b9de8d0dbc68bc14816">minmainht</a>) <a class="code" href="prefs_8cpp.html#afd8ee1110367c04cc21e2219607b7a7b">mainht</a> = <a class="code" href="prefs_8cpp.html#ad39746c614087b9de8d0dbc68bc14816">minmainht</a>;
<a name="l01200"></a>01200             <a class="code" href="prefs_8cpp.html#ac2d9a0448a288b1b398be4b489b0b7b2">CheckVisibility</a>(&amp;<a class="code" href="prefs_8cpp.html#a26b11189d93fef33172f1a2a1d174188">mainx</a>, &amp;<a class="code" href="prefs_8cpp.html#a8b015efaa4cb16287077ac74b60ad67a">mainy</a>, &amp;<a class="code" href="prefs_8cpp.html#a7b08ad54bec54f213c5ed4c1d8749548">mainwd</a>, &amp;<a class="code" href="prefs_8cpp.html#afd8ee1110367c04cc21e2219607b7a7b">mainht</a>);
<a name="l01201"></a>01201 
<a name="l01202"></a>01202         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(keyword, <span class="stringliteral">&quot;maximize&quot;</span>) == 0) {
<a name="l01203"></a>01203             <a class="code" href="prefs_8cpp.html#a8ae3f893c3d94492fdf3191dbd5c89f5">maximize</a> = value[0] == <span class="charliteral">&#39;1&#39;</span>;
<a name="l01204"></a>01204 
<a name="l01205"></a>01205         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(keyword, <span class="stringliteral">&quot;aui_layout&quot;</span>) == 0) {
<a name="l01206"></a>01206             <a class="code" href="prefs_8cpp.html#a9c5a9f65dc02b9e7ed8abef92565e5fa">auilayout</a> = wxString(value,wxConvLocal);
<a name="l01207"></a>01207 
<a name="l01208"></a>01208         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(keyword, <span class="stringliteral">&quot;opencl_platform&quot;</span>) == 0) {
<a name="l01209"></a>01209             sscanf(value, <span class="stringliteral">&quot;%d&quot;</span>, &amp;<a class="code" href="prefs_8cpp.html#a0de6a378ca700dd877cab59c65ba2f7b">opencl_platform</a>);
<a name="l01210"></a>01210 
<a name="l01211"></a>01211         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(keyword, <span class="stringliteral">&quot;opencl_device&quot;</span>) == 0) {
<a name="l01212"></a>01212             sscanf(value, <span class="stringliteral">&quot;%d&quot;</span>, &amp;<a class="code" href="prefs_8cpp.html#a11d0cbab21425e351638f4bf2cc72874">opencl_device</a>);
<a name="l01213"></a>01213 
<a name="l01214"></a>01214         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(keyword, <span class="stringliteral">&quot;key_action&quot;</span>) == 0) {
<a name="l01215"></a>01215             <a class="code" href="prefs_8cpp.html#aff3f148d06f6af72b4b962ac2ec6f52d">GetKeyAction</a>(value);
<a name="l01216"></a>01216             sawkeyaction = <span class="keyword">true</span>;
<a name="l01217"></a>01217 
<a name="l01218"></a>01218         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(keyword, <span class="stringliteral">&quot;info_font_size&quot;</span>) == 0) {
<a name="l01219"></a>01219             sscanf(value, <span class="stringliteral">&quot;%d&quot;</span>, &amp;<a class="code" href="prefs_8cpp.html#a7af6ffef487690c55989fafb52cad837">infofontsize</a>);
<a name="l01220"></a>01220             <span class="keywordflow">if</span> (<a class="code" href="prefs_8cpp.html#a7af6ffef487690c55989fafb52cad837">infofontsize</a> &lt; <a class="code" href="prefs_8hpp.html#ab9bb4307b077f19442247557845c3535">minfontsize</a>) <a class="code" href="prefs_8cpp.html#a7af6ffef487690c55989fafb52cad837">infofontsize</a> = <a class="code" href="prefs_8hpp.html#ab9bb4307b077f19442247557845c3535">minfontsize</a>;
<a name="l01221"></a>01221             <span class="keywordflow">if</span> (<a class="code" href="prefs_8cpp.html#a7af6ffef487690c55989fafb52cad837">infofontsize</a> &gt; <a class="code" href="prefs_8hpp.html#aac2c9b284ec614d2ba278a3ad5522840">maxfontsize</a>) <a class="code" href="prefs_8cpp.html#a7af6ffef487690c55989fafb52cad837">infofontsize</a> = <a class="code" href="prefs_8hpp.html#aac2c9b284ec614d2ba278a3ad5522840">maxfontsize</a>;
<a name="l01222"></a>01222 
<a name="l01223"></a>01223         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(keyword, <span class="stringliteral">&quot;help_font_size&quot;</span>) == 0) {
<a name="l01224"></a>01224             sscanf(value, <span class="stringliteral">&quot;%d&quot;</span>, &amp;<a class="code" href="prefs_8cpp.html#a4632890b2d4f7c0ecb125a0b924fae2f">helpfontsize</a>);
<a name="l01225"></a>01225             <span class="keywordflow">if</span> (<a class="code" href="prefs_8cpp.html#a4632890b2d4f7c0ecb125a0b924fae2f">helpfontsize</a> &lt; <a class="code" href="prefs_8hpp.html#ab9bb4307b077f19442247557845c3535">minfontsize</a>) <a class="code" href="prefs_8cpp.html#a4632890b2d4f7c0ecb125a0b924fae2f">helpfontsize</a> = <a class="code" href="prefs_8hpp.html#ab9bb4307b077f19442247557845c3535">minfontsize</a>;
<a name="l01226"></a>01226             <span class="keywordflow">if</span> (<a class="code" href="prefs_8cpp.html#a4632890b2d4f7c0ecb125a0b924fae2f">helpfontsize</a> &gt; <a class="code" href="prefs_8hpp.html#aac2c9b284ec614d2ba278a3ad5522840">maxfontsize</a>) <a class="code" href="prefs_8cpp.html#a4632890b2d4f7c0ecb125a0b924fae2f">helpfontsize</a> = <a class="code" href="prefs_8hpp.html#aac2c9b284ec614d2ba278a3ad5522840">maxfontsize</a>;
<a name="l01227"></a>01227 
<a name="l01228"></a>01228         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(keyword, <span class="stringliteral">&quot;text_dlg_wd&quot;</span>) == 0) {
<a name="l01229"></a>01229             sscanf(value, <span class="stringliteral">&quot;%d&quot;</span>, &amp;<a class="code" href="prefs_8cpp.html#a3fe8c36e5972115938dc8a7abc55be62">textdlgwd</a>);
<a name="l01230"></a>01230             <span class="keywordflow">if</span> (<a class="code" href="prefs_8cpp.html#a3fe8c36e5972115938dc8a7abc55be62">textdlgwd</a> &lt; 200) <a class="code" href="prefs_8cpp.html#a3fe8c36e5972115938dc8a7abc55be62">textdlgwd</a> = 200;
<a name="l01231"></a>01231 
<a name="l01232"></a>01232         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(keyword, <span class="stringliteral">&quot;text_dlg_ht&quot;</span>) == 0) {
<a name="l01233"></a>01233             sscanf(value, <span class="stringliteral">&quot;%d&quot;</span>, &amp;<a class="code" href="prefs_8cpp.html#a0b9937fefba071008390e6e3149bdb11">textdlght</a>);
<a name="l01234"></a>01234             <span class="keywordflow">if</span> (<a class="code" href="prefs_8cpp.html#a0b9937fefba071008390e6e3149bdb11">textdlght</a> &lt; 100) <a class="code" href="prefs_8cpp.html#a0b9937fefba071008390e6e3149bdb11">textdlght</a> = 100;
<a name="l01235"></a>01235 
<a name="l01236"></a>01236         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(keyword, <span class="stringliteral">&quot;show_tips&quot;</span>) == 0)   { <a class="code" href="prefs_8cpp.html#af831ab3ffe0ee800c61d7a73b2873ce3">showtips</a> = value[0] == <span class="charliteral">&#39;1&#39;</span>;
<a name="l01237"></a>01237         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(keyword, <span class="stringliteral">&quot;repaint_to_erase&quot;</span>) == 0)  { <a class="code" href="prefs_8cpp.html#a12fa8d7d57fa0c4eab03e55cb31d3ca1">repaint_to_erase</a> = value[0] == <span class="charliteral">&#39;1&#39;</span>;
<a name="l01238"></a>01238         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(keyword, <span class="stringliteral">&quot;current_brush_size&quot;</span>) == 0) { 
<a name="l01239"></a>01239             sscanf(value, <span class="stringliteral">&quot;%d&quot;</span>, &amp;<a class="code" href="prefs_8cpp.html#ae204d3ec12d9c681259496320dfe1e00">current_brush_size</a>);
<a name="l01240"></a>01240             <a class="code" href="prefs_8cpp.html#ae204d3ec12d9c681259496320dfe1e00">current_brush_size</a> = std::min(2,std::max(0,<a class="code" href="prefs_8cpp.html#ae204d3ec12d9c681259496320dfe1e00">current_brush_size</a>));
<a name="l01241"></a>01241         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(keyword, <span class="stringliteral">&quot;allow_beep&quot;</span>) == 0)  { <a class="code" href="prefs_8cpp.html#a68723f2f0bf26bff2564c1af8aa80d22">allowbeep</a> = value[0] == <span class="charliteral">&#39;1&#39;</span>;
<a name="l01242"></a>01242         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(keyword, <span class="stringliteral">&quot;ask_on_new&quot;</span>) == 0)  { <a class="code" href="prefs_8cpp.html#af99b0c2f2338ed759034777927bd3101">askonnew</a> = value[0] == <span class="charliteral">&#39;1&#39;</span>;
<a name="l01243"></a>01243         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(keyword, <span class="stringliteral">&quot;ask_on_load&quot;</span>) == 0) { <a class="code" href="prefs_8cpp.html#aac5614bb4154327f09ed8d29bec54d0b">askonload</a> = value[0] == <span class="charliteral">&#39;1&#39;</span>;
<a name="l01244"></a>01244         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(keyword, <span class="stringliteral">&quot;ask_on_quit&quot;</span>) == 0) { <a class="code" href="prefs_8cpp.html#a0498f5ccb6ca073727aa39f77e82660b">askonquit</a> = value[0] == <span class="charliteral">&#39;1&#39;</span>;
<a name="l01245"></a>01245 
<a name="l01246"></a>01246         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(keyword, <span class="stringliteral">&quot;open_save_dir&quot;</span>) == 0)  { <a class="code" href="prefs_8cpp.html#a9e280c761ad8c839005adf2f710dc0c1">GetRelPath</a>(value, <a class="code" href="prefs_8cpp.html#adc6c83c9ee4250d0b1f2b2b9f33fa777">opensavedir</a>, PATT_DIR);
<a name="l01247"></a>01247         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(keyword, <span class="stringliteral">&quot;screenshot_dir&quot;</span>) == 0) { <a class="code" href="prefs_8cpp.html#a9e280c761ad8c839005adf2f710dc0c1">GetRelPath</a>(value, <a class="code" href="prefs_8cpp.html#aecf1f655ef78e68e956e57878e7ea48d">screenshotdir</a>, PATT_DIR);
<a name="l01248"></a>01248         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(keyword, <span class="stringliteral">&quot;choose_dir&quot;</span>) == 0)     { <a class="code" href="prefs_8cpp.html#a9e280c761ad8c839005adf2f710dc0c1">GetRelPath</a>(value, <a class="code" href="prefs_8cpp.html#a8bf37d7016c72a6f4df10b194849371a">choosedir</a>);
<a name="l01249"></a>01249         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(keyword, <span class="stringliteral">&quot;user_dir&quot;</span>) == 0)       { <a class="code" href="prefs_8cpp.html#a9e280c761ad8c839005adf2f710dc0c1">GetRelPath</a>(value, <a class="code" href="prefs_8cpp.html#a91188f84b92fb18a365b824f1d78c07f">userdir</a>);
<a name="l01250"></a>01250         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(keyword, <span class="stringliteral">&quot;recording_dir&quot;</span>) == 0)  { <a class="code" href="prefs_8cpp.html#a9e280c761ad8c839005adf2f710dc0c1">GetRelPath</a>(value, <a class="code" href="prefs_8cpp.html#ab452266aeee4716a62c33d520df9ba7f">recordingdir</a>);
<a name="l01251"></a>01251         
<a name="l01252"></a>01252         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(keyword, <span class="stringliteral">&quot;text_editor&quot;</span>) == 0) {
<a name="l01253"></a>01253             <a class="code" href="prefs_8cpp.html#a3a8c57e4e1beb747c341e067dc8869bf">texteditor</a> = wxString(value,wxConvLocal);
<a name="l01254"></a>01254 
<a name="l01255"></a>01255         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(keyword, <span class="stringliteral">&quot;max_patterns&quot;</span>) == 0) {
<a name="l01256"></a>01256             sscanf(value, <span class="stringliteral">&quot;%d&quot;</span>, &amp;<a class="code" href="prefs_8cpp.html#af74247065dccdcbc74c5e1b8dc09e01c">maxpatterns</a>);
<a name="l01257"></a>01257             <span class="keywordflow">if</span> (<a class="code" href="prefs_8cpp.html#af74247065dccdcbc74c5e1b8dc09e01c">maxpatterns</a> &lt; 1) <a class="code" href="prefs_8cpp.html#af74247065dccdcbc74c5e1b8dc09e01c">maxpatterns</a> = 1;
<a name="l01258"></a>01258             <span class="keywordflow">if</span> (<a class="code" href="prefs_8cpp.html#af74247065dccdcbc74c5e1b8dc09e01c">maxpatterns</a> &gt; <a class="code" href="namespaceID.html#add26a31edd435929e305eca022a899d0">ID::MAX_RECENT</a>) <a class="code" href="prefs_8cpp.html#af74247065dccdcbc74c5e1b8dc09e01c">maxpatterns</a> = <a class="code" href="namespaceID.html#add26a31edd435929e305eca022a899d0">ID::MAX_RECENT</a>;
<a name="l01259"></a>01259 
<a name="l01260"></a>01260         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(keyword, <span class="stringliteral">&quot;recent_pattern&quot;</span>) == 0) {
<a name="l01261"></a>01261             <span class="comment">// append path to Open Recent submenu</span>
<a name="l01262"></a>01262             <span class="keywordflow">if</span> (<a class="code" href="prefs_8cpp.html#a17a3671114d042df36485b7cf3a80840">numpatterns</a> &lt; <a class="code" href="prefs_8cpp.html#af74247065dccdcbc74c5e1b8dc09e01c">maxpatterns</a> &amp;&amp; value[0]) {
<a name="l01263"></a>01263                 <a class="code" href="prefs_8cpp.html#a17a3671114d042df36485b7cf3a80840">numpatterns</a>++;
<a name="l01264"></a>01264                 wxString path(value, wxConvLocal);
<a name="l01265"></a>01265                 <span class="comment">// duplicate ampersands so they appear in menu</span>
<a name="l01266"></a>01266                 path.Replace(wxT(<span class="stringliteral">&quot;&amp;&quot;</span>), wxT(<span class="stringliteral">&quot;&amp;&amp;&quot;</span>));
<a name="l01267"></a>01267                 <a class="code" href="prefs_8cpp.html#ae5246b1632294beb0e04a2942722d304">patternSubMenu</a>-&gt;Insert(<a class="code" href="prefs_8cpp.html#a17a3671114d042df36485b7cf3a80840">numpatterns</a> - 1, <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a7cbbd0c9c34ab62384ebaaea64700a6e">ID::OpenRecent</a> + <a class="code" href="prefs_8cpp.html#a17a3671114d042df36485b7cf3a80840">numpatterns</a>, path);
<a name="l01268"></a>01268             }
<a name="l01269"></a>01269         }
<a name="l01270"></a>01270     }
<a name="l01271"></a>01271 
<a name="l01272"></a>01272     reader.<a class="code" href="classlinereader.html#a16f4017f86f15ea87ab031ed2e35c1e1">close</a>();
<a name="l01273"></a>01273 
<a name="l01274"></a>01274     <span class="comment">// if no key_action entries then use default shortcuts</span>
<a name="l01275"></a>01275     <span class="keywordflow">if</span> (!sawkeyaction) <a class="code" href="prefs_8cpp.html#a561f8734ac9b2da848da296a0ce2a8e2">AddDefaultKeyActions</a>();
<a name="l01276"></a>01276 
<a name="l01277"></a>01277     <span class="comment">// initialize accelerator array</span>
<a name="l01278"></a>01278     <a class="code" href="prefs_8cpp.html#a3b1ae22a369445497a51790d57de407c">UpdateAcceleratorStrings</a>();
<a name="l01279"></a>01279 }
<a name="l01280"></a>01280 
<a name="l01281"></a>01281 <span class="comment">// -----------------------------------------------------------------------------</span>
<a name="l01282"></a>01282 
<a name="l01283"></a>01283 <span class="comment">// Preferences dialog:</span>
<a name="l01284"></a>01284 
<a name="l01285"></a>01285 <span class="preprocessor">#if defined(__WXMAC__) &amp;&amp; wxCHECK_VERSION(2,7,2)</span>
<a name="l01286"></a>01286 <span class="preprocessor"></span><span class="comment">// fix wxMac 2.7.2+ bug in wxTextCtrl::SetSelection</span>
<a name="l01287"></a>01287 <span class="preprocessor">#define ALL_TEXT 0,999</span>
<a name="l01288"></a>01288 <span class="preprocessor"></span><span class="preprocessor">#else</span>
<a name="l01289"></a><a class="code" href="prefs_8cpp.html#ac4977c99d64fe0b792fb6b3ff9cab186">01289</a> <span class="preprocessor"></span><span class="preprocessor">#define ALL_TEXT -1,-1</span>
<a name="l01290"></a>01290 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l01291"></a>01291 <span class="preprocessor"></span>
<a name="l01292"></a>01292 <span class="preprocessor">#if defined(__WXMAC__) &amp;&amp; wxCHECK_VERSION(2,8,0) &amp;&amp; !wxCHECK_VERSION(2,9,0)</span>
<a name="l01293"></a>01293 <span class="preprocessor"></span><span class="comment">// fix wxALIGN_CENTER_VERTICAL bug in wxMac 2.8.x;</span>
<a name="l01294"></a>01294 <span class="comment">// eg. when a wxStaticText box is next to a wxChoice box</span>
<a name="l01295"></a>01295 <span class="preprocessor">#define FIX_ALIGN_BUG wxBOTTOM,4</span>
<a name="l01296"></a>01296 <span class="preprocessor"></span><span class="preprocessor">#else</span>
<a name="l01297"></a><a class="code" href="prefs_8cpp.html#a5f5d836d9fcb0ef54e453c8b486d822c">01297</a> <span class="preprocessor"></span><span class="preprocessor">#define FIX_ALIGN_BUG wxALL,0</span>
<a name="l01298"></a>01298 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l01299"></a>01299 <span class="preprocessor"></span>
<a name="l01300"></a><a class="code" href="prefs_8cpp.html#aad818288638918d0901b9d818c0ff852">01300</a> <span class="keyword">static</span> <span class="keywordtype">size_t</span> <a class="code" href="prefs_8cpp.html#aad818288638918d0901b9d818c0ff852">currpage</a> = 0;      <span class="comment">// current page in PrefsDialog</span>
<a name="l01301"></a>01301 
<a name="l01302"></a>01302 <span class="comment">// these are global so we can remember current key combination</span>
<a name="l01303"></a><a class="code" href="prefs_8cpp.html#aaacf1a77c10b6c97201e93054bf86843">01303</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="prefs_8cpp.html#aaacf1a77c10b6c97201e93054bf86843">currkey</a> = <span class="charliteral">&#39; &#39;</span>;
<a name="l01304"></a><a class="code" href="prefs_8cpp.html#a76d947d833846c69306f2bee3a6f9b9f">01304</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="prefs_8cpp.html#a76d947d833846c69306f2bee3a6f9b9f">currmods</a> = <a class="code" href="prefs_8cpp.html#a635b91d441a7f0e6575bc522e0307cc8">mk_ALT</a> + <a class="code" href="prefs_8cpp.html#a438c6e768372ad8199c47855d968ed12">mk_SHIFT</a> + <a class="code" href="prefs_8cpp.html#aaca2c4e8c2dbb1214dde1c0bb46dbe2f">mk_CMD</a>;
<a name="l01305"></a>01305 
<a name="l01306"></a>01306 <span class="keyword">enum</span>
<a name="l01307"></a>01307 {
<a name="l01308"></a>01308     <span class="comment">// these *_PAGE values must correspond to currpage values</span>
<a name="l01309"></a><a class="code" href="prefs_8cpp.html#a99fb83031ce9923c84392b4e92f956b5a6c75fb9088aa1e821b14551cff631b0b">01309</a>     <a class="code" href="prefs_8cpp.html#a99fb83031ce9923c84392b4e92f956b5a6c75fb9088aa1e821b14551cff631b0b">FILE_PAGE</a> = 0,
<a name="l01310"></a><a class="code" href="prefs_8cpp.html#a99fb83031ce9923c84392b4e92f956b5ab2000382ee96091a0f199de2c23f93dc">01310</a>     <a class="code" href="prefs_8cpp.html#a99fb83031ce9923c84392b4e92f956b5ab2000382ee96091a0f199de2c23f93dc">EDIT_PAGE</a>,
<a name="l01311"></a><a class="code" href="prefs_8cpp.html#a99fb83031ce9923c84392b4e92f956b5a5c4a8b972182ff89076d34c67e15ff37">01311</a>     <a class="code" href="prefs_8cpp.html#a99fb83031ce9923c84392b4e92f956b5a5c4a8b972182ff89076d34c67e15ff37">VIEW_PAGE</a>,
<a name="l01312"></a><a class="code" href="prefs_8cpp.html#a99fb83031ce9923c84392b4e92f956b5ae6193528cfdfbc97479fe6ef2ff962f6">01312</a>     <a class="code" href="prefs_8cpp.html#a99fb83031ce9923c84392b4e92f956b5ae6193528cfdfbc97479fe6ef2ff962f6">ACTION_PAGE</a>,
<a name="l01313"></a><a class="code" href="prefs_8cpp.html#a99fb83031ce9923c84392b4e92f956b5a36b5ca67ee4b41c8df6806befb820e86">01313</a>     <a class="code" href="prefs_8cpp.html#a99fb83031ce9923c84392b4e92f956b5a36b5ca67ee4b41c8df6806befb820e86">KEYBOARD_PAGE</a>
<a name="l01314"></a>01314 };
<a name="l01315"></a>01315 
<a name="l01316"></a>01316 <span class="keyword">enum</span>
<a name="l01317"></a>01317 {
<a name="l01318"></a>01318     <span class="comment">// File prefs</span>
<a name="l01319"></a><a class="code" href="prefs_8cpp.html#abc6126af1d45847bc59afa0aa3216b04ac528b6e272d252b4eaa82b28ea62c85f">01319</a>     <a class="code" href="prefs_8cpp.html#abc6126af1d45847bc59afa0aa3216b04ac528b6e272d252b4eaa82b28ea62c85f">PREF_MAX_PATTERNS</a> = wxID_HIGHEST + 1,
<a name="l01320"></a><a class="code" href="prefs_8cpp.html#abc6126af1d45847bc59afa0aa3216b04a6340d6e469ce3321da69dd844bc28e4e">01320</a>     <a class="code" href="prefs_8cpp.html#abc6126af1d45847bc59afa0aa3216b04a6340d6e469ce3321da69dd844bc28e4e">PREF_EDITOR_BUTT</a>,
<a name="l01321"></a><a class="code" href="prefs_8cpp.html#abc6126af1d45847bc59afa0aa3216b04a9555ecc0a874a07b0332ba282ba92814">01321</a>     <a class="code" href="prefs_8cpp.html#abc6126af1d45847bc59afa0aa3216b04a9555ecc0a874a07b0332ba282ba92814">PREF_EDITOR_BOX</a>,
<a name="l01322"></a>01322 <span class="preprocessor">    #ifdef __WXOSX__</span>
<a name="l01323"></a>01323 <span class="preprocessor"></span>        PREF_HIDDEN,    <span class="comment">// needed to fix wxOSX bug</span>
<a name="l01324"></a>01324 <span class="preprocessor">    #endif</span>
<a name="l01325"></a>01325 <span class="preprocessor"></span>    <span class="comment">// Edit prefs</span>
<a name="l01326"></a><a class="code" href="prefs_8cpp.html#abc6126af1d45847bc59afa0aa3216b04adae37cf8a27c006e510ea97f602d6eed">01326</a>     <a class="code" href="prefs_8cpp.html#abc6126af1d45847bc59afa0aa3216b04adae37cf8a27c006e510ea97f602d6eed">PREF_ERASE</a>,
<a name="l01327"></a><a class="code" href="prefs_8cpp.html#abc6126af1d45847bc59afa0aa3216b04a29b8515407b4085d812758d22f7ab6b9">01327</a>     <a class="code" href="prefs_8cpp.html#abc6126af1d45847bc59afa0aa3216b04a29b8515407b4085d812758d22f7ab6b9">PREF_BEEP</a>,
<a name="l01328"></a>01328     <span class="comment">// View prefs</span>
<a name="l01329"></a><a class="code" href="prefs_8cpp.html#abc6126af1d45847bc59afa0aa3216b04a9acefbbd3767c6640a5f6b168847e6fb">01329</a>     <a class="code" href="prefs_8cpp.html#abc6126af1d45847bc59afa0aa3216b04a9acefbbd3767c6640a5f6b168847e6fb">PREF_SHOW_TIPS</a>,
<a name="l01330"></a>01330     <span class="comment">// Action prefs</span>
<a name="l01331"></a>01331     <span class="comment">// none as yet</span>
<a name="l01332"></a>01332     <span class="comment">// Keyboard prefs</span>
<a name="l01333"></a><a class="code" href="prefs_8cpp.html#abc6126af1d45847bc59afa0aa3216b04a54200275e98be6a4e4d615407411a1a7">01333</a>     <a class="code" href="prefs_8cpp.html#abc6126af1d45847bc59afa0aa3216b04a54200275e98be6a4e4d615407411a1a7">PREF_KEYCOMBO</a>,
<a name="l01334"></a><a class="code" href="prefs_8cpp.html#abc6126af1d45847bc59afa0aa3216b04a19964575f179f798d3a112f25ed3df0c">01334</a>     <a class="code" href="prefs_8cpp.html#abc6126af1d45847bc59afa0aa3216b04a19964575f179f798d3a112f25ed3df0c">PREF_ACTION</a>,
<a name="l01335"></a><a class="code" href="prefs_8cpp.html#abc6126af1d45847bc59afa0aa3216b04acbeb709d0e949a0635dbfcefc595370b">01335</a>     <a class="code" href="prefs_8cpp.html#abc6126af1d45847bc59afa0aa3216b04acbeb709d0e949a0635dbfcefc595370b">PREF_CHOOSE</a>,
<a name="l01336"></a><a class="code" href="prefs_8cpp.html#abc6126af1d45847bc59afa0aa3216b04aa995dcceafdaa0951e58998d30cc7fe4">01336</a>     <a class="code" href="prefs_8cpp.html#abc6126af1d45847bc59afa0aa3216b04aa995dcceafdaa0951e58998d30cc7fe4">PREF_FILE_BOX</a>
<a name="l01337"></a>01337 };
<a name="l01338"></a>01338 
<a name="l01339"></a>01339 <span class="comment">// define a multi-page dialog for changing various preferences</span>
<a name="l01340"></a>01340 
<a name="l01341"></a><a class="code" href="classPrefsDialog.html">01341</a> <span class="keyword">class </span><a class="code" href="classPrefsDialog.html">PrefsDialog</a> : <span class="keyword">public</span> wxPropertySheetDialog
<a name="l01342"></a>01342 {
<a name="l01343"></a>01343     <span class="keyword">public</span>:
<a name="l01344"></a>01344         <a class="code" href="classPrefsDialog.html#a17c30b2e50cfb01f690ba732fada7974">PrefsDialog</a>(<a class="code" href="classMyFrame.html" title="The wxFrame-derived top-level window for the Ready GUI.">MyFrame</a>* parent, <span class="keyword">const</span> wxString&amp; page);
<a name="l01345"></a><a class="code" href="classPrefsDialog.html#ad971182376c749c314f0a62a58350520">01345</a>         <a class="code" href="classPrefsDialog.html#ad971182376c749c314f0a62a58350520">~PrefsDialog</a>() { <span class="keyword">delete</span> <a class="code" href="classPrefsDialog.html#a45b7bfaa325a6eb58246a9129840b83b">onetimer</a>; }
<a name="l01346"></a>01346 
<a name="l01347"></a>01347         wxPanel* <a class="code" href="classPrefsDialog.html#a45e3ed2ff24cfe3a8b27d7b06e2fb923">CreateFilePrefs</a>(wxWindow* parent);
<a name="l01348"></a>01348         wxPanel* <a class="code" href="classPrefsDialog.html#adcdddc6ae06520ad194efb2e29123ac8">CreateEditPrefs</a>(wxWindow* parent);
<a name="l01349"></a>01349         wxPanel* <a class="code" href="classPrefsDialog.html#a55c21618ec242209de49380ab430e763">CreateViewPrefs</a>(wxWindow* parent);
<a name="l01350"></a>01350         wxPanel* <a class="code" href="classPrefsDialog.html#a359e83e7843fce110e7181b0e04a7b93">CreateActionPrefs</a>(wxWindow* parent);
<a name="l01351"></a>01351         wxPanel* <a class="code" href="classPrefsDialog.html#a972b4afdca775ce6fec10b25c3529293">CreateKeyboardPrefs</a>(wxWindow* parent);
<a name="l01352"></a>01352 
<a name="l01353"></a>01353         <span class="comment">// called when user hits OK</span>
<a name="l01354"></a>01354         <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="classPrefsDialog.html#ae0763000443b9e4bea57ffb1baa0002c">TransferDataFromWindow</a>();
<a name="l01355"></a>01355 
<a name="l01356"></a>01356 <span class="preprocessor">        #ifdef __WXMAC__</span>
<a name="l01357"></a>01357 <span class="preprocessor"></span>            <span class="keywordtype">void</span> OnSpinCtrlChar(wxKeyEvent&amp; event);
<a name="l01358"></a>01358 <span class="preprocessor">        #endif</span>
<a name="l01359"></a>01359 <span class="preprocessor"></span>
<a name="l01360"></a>01360         <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="classPrefsDialog.html#aaff94d6e344082dc6c1991a7dd466dd4">UpdateChosenFile</a>();
<a name="l01361"></a>01361 
<a name="l01362"></a>01362     <span class="keyword">private</span>:
<a name="l01363"></a>01363         <span class="keywordtype">bool</span> <a class="code" href="classPrefsDialog.html#a0cb1ca864dbb4c9d6e10d002a9b13f69">GetCheckVal</a>(<span class="keywordtype">long</span> <span class="keywordtype">id</span>);
<a name="l01364"></a>01364         <span class="keywordtype">int</span> <a class="code" href="classPrefsDialog.html#abc328e39f625c5ad941192a9aac76764">GetChoiceVal</a>(<span class="keywordtype">long</span> <span class="keywordtype">id</span>);
<a name="l01365"></a>01365         <span class="keywordtype">int</span> <a class="code" href="classPrefsDialog.html#a238aef45dbe2a7fd3f7775ffb057f7e0">GetSpinVal</a>(<span class="keywordtype">long</span> <span class="keywordtype">id</span>);
<a name="l01366"></a>01366         <span class="keywordtype">int</span> <a class="code" href="classPrefsDialog.html#a4119129237bfe2086489d2a2f2f1bf42">GetRadioVal</a>(<span class="keywordtype">long</span> firstid, <span class="keywordtype">int</span> numbuttons);
<a name="l01367"></a>01367         <span class="keywordtype">bool</span> <a class="code" href="classPrefsDialog.html#a6fb95b44d3053ec680c00717b41a1157">BadSpinVal</a>(<span class="keywordtype">int</span> <span class="keywordtype">id</span>, <span class="keywordtype">int</span> minval, <span class="keywordtype">int</span> maxval, <span class="keyword">const</span> wxString&amp; prefix);
<a name="l01368"></a>01368         <span class="keywordtype">bool</span> <a class="code" href="classPrefsDialog.html#aa8a53cb28f7fc37c69c5b63d5e0ffe7e">ValidatePage</a>();
<a name="l01369"></a>01369 
<a name="l01370"></a>01370         <span class="keywordtype">void</span> <a class="code" href="classPrefsDialog.html#a52bb7a74d013acd38bd11f4b5ec48263">OnCheckBoxClicked</a>(wxCommandEvent&amp; event);
<a name="l01371"></a>01371         <span class="keywordtype">void</span> <a class="code" href="classPrefsDialog.html#abe9b8634a5026cafb9e61ea3f4ba04c6">OnPageChanging</a>(wxNotebookEvent&amp; event);
<a name="l01372"></a>01372         <span class="keywordtype">void</span> <a class="code" href="classPrefsDialog.html#a02875d51a2e8e80fb94f5c5d021971dc">OnPageChanged</a>(wxNotebookEvent&amp; event);
<a name="l01373"></a>01373         <span class="keywordtype">void</span> <a class="code" href="classPrefsDialog.html#aa616681ac6aad245fa92415ed839677e">OnChoice</a>(wxCommandEvent&amp; event);
<a name="l01374"></a>01374         <span class="keywordtype">void</span> <a class="code" href="classPrefsDialog.html#af9b84e2aeaeeaba1f8854cfc0e591308">OnButton</a>(wxCommandEvent&amp; event);
<a name="l01375"></a>01375         <span class="keywordtype">void</span> <a class="code" href="classPrefsDialog.html#a01f2edbe47f25e2d624d39ae428ed4e0">OnOneTimer</a>(wxTimerEvent&amp; event);
<a name="l01376"></a>01376 
<a name="l01377"></a><a class="code" href="classPrefsDialog.html#acf48c0cdb1d05cc17d1ef3ff9dd10d94">01377</a>         <span class="keywordtype">bool</span> <a class="code" href="classPrefsDialog.html#acf48c0cdb1d05cc17d1ef3ff9dd10d94">ignore_page_event</a>;  <span class="comment">// used to prevent currpage being changed</span>
<a name="l01378"></a>01378 
<a name="l01379"></a><a class="code" href="classPrefsDialog.html#ab70af43614d3d362387ac81eb4ddd98f">01379</a>         wxString <a class="code" href="classPrefsDialog.html#ab70af43614d3d362387ac81eb4ddd98f">neweditor</a>;      <span class="comment">// new text editor</span>
<a name="l01380"></a><a class="code" href="classPrefsDialog.html#a92efaf99742dff680820b7c836b16279">01380</a>         wxString <a class="code" href="classPrefsDialog.html#a92efaf99742dff680820b7c836b16279">newdownloaddir</a>; <span class="comment">// new directory for downloaded files</span>
<a name="l01381"></a><a class="code" href="classPrefsDialog.html#a09a8f5db653315e44d3313631e54ab6f">01381</a>         wxString <a class="code" href="classPrefsDialog.html#a09a8f5db653315e44d3313631e54ab6f">newuserrules</a>;   <span class="comment">// new directory for user&#39;s rules</span>
<a name="l01382"></a>01382 
<a name="l01383"></a><a class="code" href="classPrefsDialog.html#a45b7bfaa325a6eb58246a9129840b83b">01383</a>         wxTimer* <a class="code" href="classPrefsDialog.html#a45b7bfaa325a6eb58246a9129840b83b">onetimer</a>;       <span class="comment">// one shot timer (see OnOneTimer)</span>
<a name="l01384"></a>01384 
<a name="l01385"></a>01385         DECLARE_EVENT_TABLE()
<a name="l01386"></a>01386 };
<a name="l01387"></a>01387 
<a name="l01388"></a>01388 BEGIN_EVENT_TABLE(<a class="code" href="classPrefsDialog.html">PrefsDialog</a>, wxPropertySheetDialog)
<a name="l01389"></a>01389 EVT_CHECKBOX               (wxID_ANY, <a class="code" href="classPrefsDialog.html">PrefsDialog</a>::OnCheckBoxClicked)
<a name="l01390"></a>01390 EVT_NOTEBOOK_PAGE_CHANGING (wxID_ANY, <a class="code" href="classPrefsDialog.html">PrefsDialog</a>::OnPageChanging)
<a name="l01391"></a>01391 EVT_NOTEBOOK_PAGE_CHANGED  (wxID_ANY, <a class="code" href="classPrefsDialog.html">PrefsDialog</a>::OnPageChanged)
<a name="l01392"></a>01392 EVT_CHOICE                 (wxID_ANY, <a class="code" href="classPrefsDialog.html">PrefsDialog</a>::OnChoice)
<a name="l01393"></a>01393 EVT_BUTTON                 (wxID_ANY, <a class="code" href="classPrefsDialog.html">PrefsDialog</a>::OnButton)
<a name="l01394"></a>01394 EVT_TIMER                  (wxID_ANY, <a class="code" href="classPrefsDialog.html">PrefsDialog</a>::OnOneTimer)
<a name="l01395"></a>01395 END_EVENT_TABLE()
<a name="l01396"></a>01396 
<a name="l01397"></a>01397 <span class="comment">// -----------------------------------------------------------------------------</span>
<a name="l01398"></a>01398 
<a name="l01399"></a>01399 <span class="comment">// define a text control for showing current key combination</span>
<a name="l01400"></a>01400 
<a name="l01401"></a><a class="code" href="classKeyComboCtrl.html">01401</a> class <a class="code" href="classKeyComboCtrl.html">KeyComboCtrl</a> : public wxTextCtrl
<a name="l01402"></a>01402 {
<a name="l01403"></a>01403     <span class="keyword">public</span>:
<a name="l01404"></a><a class="code" href="classKeyComboCtrl.html#a453db42ccb1e3e14c2222b8660414be6">01404</a>         <a class="code" href="classKeyComboCtrl.html">KeyComboCtrl</a>(wxWindow* parent, wxWindowID <span class="keywordtype">id</span>, <span class="keyword">const</span> wxString&amp; value,
<a name="l01405"></a>01405             <span class="keyword">const</span> wxPoint&amp; pos, <span class="keyword">const</span> wxSize&amp; size, <span class="keywordtype">int</span> style = 0)
<a name="l01406"></a>01406             : wxTextCtrl(parent, id, value, pos, size, style) {}
<a name="l01407"></a><a class="code" href="classKeyComboCtrl.html#afd6909afdc6623542b44a8b784729f8f">01407</a>         <a class="code" href="classKeyComboCtrl.html#afd6909afdc6623542b44a8b784729f8f">~KeyComboCtrl</a>() {}
<a name="l01408"></a>01408 
<a name="l01409"></a>01409         <span class="comment">// handlers to intercept keyboard events</span>
<a name="l01410"></a>01410         <span class="keywordtype">void</span> OnKeyDown(wxKeyEvent&amp; event);
<a name="l01411"></a>01411         <span class="keywordtype">void</span> OnChar(wxKeyEvent&amp; event);
<a name="l01412"></a>01412 
<a name="l01413"></a>01413     <span class="keyword">private</span>:
<a name="l01414"></a><a class="code" href="classKeyComboCtrl.html#aed3d8e42eab9b0e7b7a37c45c0a99668">01414</a>         <span class="keywordtype">int</span> <a class="code" href="classKeyComboCtrl.html#aed3d8e42eab9b0e7b7a37c45c0a99668">realkey</a>;             <span class="comment">// key code set by OnKeyDown</span>
<a name="l01415"></a><a class="code" href="classKeyComboCtrl.html#a7cd2688c7886405fdaf59f867bccd8c1">01415</a>         wxString <a class="code" href="classKeyComboCtrl.html#a7cd2688c7886405fdaf59f867bccd8c1">debugkey</a>;       <span class="comment">// display debug info for OnKeyDown and OnChar</span>
<a name="l01416"></a>01416 
<a name="l01417"></a>01417         DECLARE_EVENT_TABLE()
<a name="l01418"></a>01418 };
<a name="l01419"></a>01419 
<a name="l01420"></a>01420 BEGIN_EVENT_TABLE(<a class="code" href="classKeyComboCtrl.html">KeyComboCtrl</a>, wxTextCtrl)
<a name="l01421"></a>01421 EVT_KEY_DOWN  (<a class="code" href="classKeyComboCtrl.html">KeyComboCtrl</a>::OnKeyDown)
<a name="l01422"></a>01422 EVT_CHAR      (<a class="code" href="classKeyComboCtrl.html">KeyComboCtrl</a>::OnChar)
<a name="l01423"></a>01423 END_EVENT_TABLE()
<a name="l01424"></a>01424 
<a name="l01425"></a>01425 <span class="comment">// -----------------------------------------------------------------------------</span>
<a name="l01426"></a>01426 
<a name="l01427"></a><a class="code" href="classKeyComboCtrl.html#a4b5954f97910a9b40bcacf98f6a86503">01427</a> <span class="keywordtype">void</span> <a class="code" href="classKeyComboCtrl.html">KeyComboCtrl</a>::OnKeyDown(wxKeyEvent&amp; event)
<a name="l01428"></a>01428 {
<a name="l01429"></a>01429     realkey = <span class="keyword">event</span>.GetKeyCode();
<a name="l01430"></a>01430     <span class="keywordtype">int</span> mods = <span class="keyword">event</span>.GetModifiers();
<a name="l01431"></a>01431 
<a name="l01432"></a>01432     <span class="keywordflow">if</span> (<a class="code" href="prefs_8cpp.html#af219299ebad47daa6631415a8b41345a">debuglevel</a> == 1) {
<a name="l01433"></a>01433         <span class="comment">// set debugkey now but don&#39;t show it until OnChar</span>
<a name="l01434"></a>01434         debugkey = wxString::Format(_(<span class="stringliteral">&quot;OnKeyDown: key=%d (%c) mods=%d&quot;</span>),
<a name="l01435"></a>01435             realkey, realkey &lt; 128 ? wxChar(realkey) : wxChar(<span class="charliteral">&#39;?&#39;</span>), mods);
<a name="l01436"></a>01436     }
<a name="l01437"></a>01437 
<a name="l01438"></a>01438     <span class="keywordflow">if</span> (realkey == WXK_ESCAPE) {
<a name="l01439"></a>01439         <span class="comment">// escape key is reserved for other uses</span>
<a name="l01440"></a>01440         <a class="code" href="wxutils_8cpp.html#a26f50e4eb3544de269fffd2cf13ced86">Beep</a>();
<a name="l01441"></a>01441         <span class="keywordflow">return</span>;
<a name="l01442"></a>01442     }
<a name="l01443"></a>01443 
<a name="l01444"></a>01444 <span class="preprocessor">#ifdef __WXOSX__</span>
<a name="l01445"></a>01445 <span class="preprocessor"></span>    <span class="comment">// pass arrow key or function key or delete key directly to OnChar</span>
<a name="l01446"></a>01446     <span class="keywordflow">if</span> ( (realkey &gt;=  WXK_LEFT &amp;&amp; realkey &lt;= WXK_DOWN) ||
<a name="l01447"></a>01447     (realkey &gt;= WXK_F1 &amp;&amp; realkey &lt;= WXK_F24) || realkey == WXK_BACK ) {
<a name="l01448"></a>01448         OnChar(event);
<a name="l01449"></a>01449         <span class="keywordflow">return</span>;
<a name="l01450"></a>01450     }
<a name="l01451"></a>01451 <span class="preprocessor">#endif</span>
<a name="l01452"></a>01452 <span class="preprocessor"></span>
<a name="l01453"></a>01453     <span class="comment">// WARNING: logic must match that in MyFrame::OnKeyDown</span>
<a name="l01454"></a>01454     <span class="keywordflow">if</span> (mods == wxMOD_NONE || realkey &gt; 127) {
<a name="l01455"></a>01455         <span class="comment">// tell OnChar handler to ignore realkey</span>
<a name="l01456"></a>01456         realkey = 0;
<a name="l01457"></a>01457     }
<a name="l01458"></a>01458 
<a name="l01459"></a>01459 <span class="preprocessor">#ifdef __WXOSX__</span>
<a name="l01460"></a>01460 <span class="preprocessor"></span>    <span class="comment">// pass ctrl/cmd-key combos directly to OnChar</span>
<a name="l01461"></a>01461     <span class="keywordflow">if</span> (realkey &gt; 0 &amp;&amp; ((mods &amp; wxMOD_CONTROL) || (mods &amp; wxMOD_CMD))) {
<a name="l01462"></a>01462         OnChar(event);
<a name="l01463"></a>01463         <span class="keywordflow">return</span>;
<a name="l01464"></a>01464     }
<a name="l01465"></a>01465 <span class="preprocessor">#endif</span>
<a name="l01466"></a>01466 <span class="preprocessor"></span>
<a name="l01467"></a>01467 <span class="preprocessor">#ifdef __WXMAC__</span>
<a name="l01468"></a>01468 <span class="preprocessor"></span>    <span class="comment">// avoid translating option-E/I/N/U/`</span>
<a name="l01469"></a>01469     <span class="keywordflow">if</span> (mods == wxMOD_ALT &amp;&amp; (realkey == <span class="charliteral">&#39;E&#39;</span> || realkey == <span class="charliteral">&#39;I&#39;</span> || realkey == <span class="charliteral">&#39;N&#39;</span> ||
<a name="l01470"></a>01470                               realkey == <span class="charliteral">&#39;U&#39;</span> || realkey == <span class="charliteral">&#39;`&#39;</span>)) {
<a name="l01471"></a>01471         OnChar(event);
<a name="l01472"></a>01472         <span class="keywordflow">return</span>;
<a name="l01473"></a>01473     }
<a name="l01474"></a>01474 <span class="preprocessor">#endif</span>
<a name="l01475"></a>01475 <span class="preprocessor"></span>
<a name="l01476"></a>01476 <span class="preprocessor">#ifdef __WXMSW__</span>
<a name="l01477"></a>01477 <span class="preprocessor"></span>    <span class="comment">// on Windows, OnChar is NOT called for some ctrl-key combos like</span>
<a name="l01478"></a>01478     <span class="comment">// ctrl-0..9 or ctrl-alt-key, so we call OnChar ourselves</span>
<a name="l01479"></a>01479     <span class="keywordflow">if</span> (realkey &gt; 0 &amp;&amp; (mods &amp; wxMOD_CONTROL)) {
<a name="l01480"></a>01480         OnChar(event);
<a name="l01481"></a>01481         <span class="keywordflow">return</span>;
<a name="l01482"></a>01482     }
<a name="l01483"></a>01483 <span class="preprocessor">#endif</span>
<a name="l01484"></a>01484 <span class="preprocessor"></span>
<a name="l01485"></a>01485     <span class="keyword">event</span>.Skip();
<a name="l01486"></a>01486 }
<a name="l01487"></a>01487 
<a name="l01488"></a>01488 <span class="comment">// -----------------------------------------------------------------------------</span>
<a name="l01489"></a>01489 
<a name="l01490"></a>01490 <span class="preprocessor">#ifdef __WXOSX__</span>
<a name="l01491"></a>01491 <span class="preprocessor"></span>    <span class="keyword">static</span> <span class="keywordtype">bool</span> inonchar = <span class="keyword">false</span>;
<a name="l01492"></a>01492 <span class="preprocessor">#endif</span>
<a name="l01493"></a>01493 <span class="preprocessor"></span>
<a name="l01494"></a><a class="code" href="classKeyComboCtrl.html#a76aa60c9250ed63d4d71a08d27dd70cc">01494</a> <span class="keywordtype">void</span> <a class="code" href="classKeyComboCtrl.html#a76aa60c9250ed63d4d71a08d27dd70cc">KeyComboCtrl::OnChar</a>(wxKeyEvent&amp; event)
<a name="l01495"></a>01495 {
<a name="l01496"></a>01496 <span class="preprocessor">    #ifdef __WXOSX__</span>
<a name="l01497"></a>01497 <span class="preprocessor"></span>        <span class="comment">// avoid infinite recursion in wxOSX due to ChangeValue call below</span>
<a name="l01498"></a>01498         <span class="keywordflow">if</span> (inonchar) { <span class="keyword">event</span>.Skip(); <span class="keywordflow">return</span>; }
<a name="l01499"></a>01499         inonchar = <span class="keyword">true</span>;
<a name="l01500"></a>01500 <span class="preprocessor">    #endif</span>
<a name="l01501"></a>01501 <span class="preprocessor"></span>
<a name="l01502"></a>01502     <span class="keywordtype">int</span> key = <span class="keyword">event</span>.GetKeyCode();
<a name="l01503"></a>01503     <span class="keywordtype">int</span> mods = <span class="keyword">event</span>.GetModifiers();
<a name="l01504"></a>01504 
<a name="l01505"></a>01505     <span class="keywordflow">if</span> (<a class="code" href="prefs_8cpp.html#af219299ebad47daa6631415a8b41345a">debuglevel</a> == 1) {
<a name="l01506"></a>01506         <a class="code" href="classKeyComboCtrl.html#a7cd2688c7886405fdaf59f867bccd8c1">debugkey</a> += wxString::Format(_(<span class="stringliteral">&quot;\nOnChar: key=%d (%c) mods=%d&quot;</span>),
<a name="l01507"></a>01507             key, key &lt; 128 ? wxChar(key) : wxChar(<span class="charliteral">&#39;?&#39;</span>), mods);
<a name="l01508"></a>01508         <a class="code" href="wxutils_8cpp.html#ad496c0028843186f55032174260d2732">Warning</a>(<a class="code" href="classKeyComboCtrl.html#a7cd2688c7886405fdaf59f867bccd8c1">debugkey</a>);
<a name="l01509"></a>01509     }
<a name="l01510"></a>01510 
<a name="l01511"></a>01511     <span class="comment">// WARNING: logic must match that in MyFrame::OnChar</span>
<a name="l01512"></a>01512     <span class="keywordflow">if</span> (<a class="code" href="classKeyComboCtrl.html#aed3d8e42eab9b0e7b7a37c45c0a99668">realkey</a> &gt; 0 &amp;&amp; mods != wxMOD_NONE) {
<a name="l01513"></a>01513 <span class="preprocessor">        #ifdef __WXGTK__</span>
<a name="l01514"></a>01514 <span class="preprocessor"></span>            <span class="comment">// sigh... wxGTK returns inconsistent results for shift-comma combos</span>
<a name="l01515"></a>01515             <span class="comment">// so we assume that &#39;&lt;&#39; is produced by pressing shift-comma</span>
<a name="l01516"></a>01516             <span class="comment">// (which might only be true for US keyboards)</span>
<a name="l01517"></a>01517             <span class="keywordflow">if</span> (key == <span class="charliteral">&#39;&lt;&#39;</span> &amp;&amp; (mods &amp; wxMOD_SHIFT)) <a class="code" href="classKeyComboCtrl.html#aed3d8e42eab9b0e7b7a37c45c0a99668">realkey</a> = <span class="charliteral">&#39;,&#39;</span>;
<a name="l01518"></a>01518 <span class="preprocessor">        #endif</span>
<a name="l01519"></a>01519 <span class="preprocessor"></span><span class="preprocessor">        #ifdef __WXMSW__</span>
<a name="l01520"></a>01520 <span class="preprocessor"></span>            <span class="comment">// sigh... wxMSW returns inconsistent results for some shift-key combos</span>
<a name="l01521"></a>01521             <span class="comment">// so again we assume we&#39;re using a US keyboard</span>
<a name="l01522"></a>01522             <span class="keywordflow">if</span> (key == <span class="charliteral">&#39;~&#39;</span> &amp;&amp; (mods &amp; wxMOD_SHIFT)) <a class="code" href="classKeyComboCtrl.html#aed3d8e42eab9b0e7b7a37c45c0a99668">realkey</a> = <span class="charliteral">&#39;`&#39;</span>;
<a name="l01523"></a>01523             <span class="keywordflow">if</span> (key == <span class="charliteral">&#39;+&#39;</span> &amp;&amp; (mods &amp; wxMOD_SHIFT)) <a class="code" href="classKeyComboCtrl.html#aed3d8e42eab9b0e7b7a37c45c0a99668">realkey</a> = <span class="charliteral">&#39;=&#39;</span>;
<a name="l01524"></a>01524 <span class="preprocessor">        #endif</span>
<a name="l01525"></a>01525 <span class="preprocessor"></span>        <span class="keywordflow">if</span> (mods == wxMOD_SHIFT &amp;&amp; key != <a class="code" href="classKeyComboCtrl.html#aed3d8e42eab9b0e7b7a37c45c0a99668">realkey</a>) {
<a name="l01526"></a>01526             <span class="comment">// use translated key code but remove shift key;</span>
<a name="l01527"></a>01527             <span class="comment">// eg. we want shift-&#39;/&#39; to be seen as &#39;?&#39;</span>
<a name="l01528"></a>01528             mods = wxMOD_NONE;
<a name="l01529"></a>01529         } <span class="keywordflow">else</span> {
<a name="l01530"></a>01530             <span class="comment">// use key code seen by OnKeyDown</span>
<a name="l01531"></a>01531             key = <a class="code" href="classKeyComboCtrl.html#aed3d8e42eab9b0e7b7a37c45c0a99668">realkey</a>;
<a name="l01532"></a>01532             <span class="keywordflow">if</span> (key &gt;= <span class="charliteral">&#39;A&#39;</span> &amp;&amp; key &lt;= <span class="charliteral">&#39;Z&#39;</span>) key += 32;   <span class="comment">// convert A..Z to a..z</span>
<a name="l01533"></a>01533         }
<a name="l01534"></a>01534     }
<a name="l01535"></a>01535 
<a name="l01536"></a>01536     <span class="comment">// convert wx key and mods to our internal key code and modifiers</span>
<a name="l01537"></a>01537     <span class="comment">// and, if they are valid, display the key combo and update the action</span>
<a name="l01538"></a>01538     <span class="keywordflow">if</span> ( <a class="code" href="prefs_8cpp.html#a6947434df6c6efa4e866e0e8667b1096">ConvertKeyAndModifiers</a>(key, mods, &amp;currkey, &amp;currmods) ) {
<a name="l01539"></a>01539         wxChoice* actionmenu = (wxChoice*) FindWindowById(<a class="code" href="prefs_8cpp.html#abc6126af1d45847bc59afa0aa3216b04a19964575f179f798d3a112f25ed3df0c">PREF_ACTION</a>);
<a name="l01540"></a>01540         <span class="keywordflow">if</span> (actionmenu) {
<a name="l01541"></a>01541             wxString keystring = <a class="code" href="prefs_8cpp.html#a08014bdc6da754d563b6bcbe6c3daaf0">GetKeyCombo</a>(currkey, currmods);
<a name="l01542"></a>01542             <span class="keywordflow">if</span> (!keystring.IsEmpty()) {
<a name="l01543"></a>01543                 ChangeValue(keystring);
<a name="l01544"></a>01544             }
<a name="l01545"></a>01545             <span class="keywordflow">else</span> {
<a name="l01546"></a>01546                 currkey = 0;
<a name="l01547"></a>01547                 currmods = 0;
<a name="l01548"></a>01548                 ChangeValue(_(<span class="stringliteral">&quot;UNKNOWN KEY&quot;</span>));
<a name="l01549"></a>01549             }
<a name="l01550"></a>01550             actionmenu-&gt;SetSelection(keyaction[currkey][currmods].<span class="keywordtype">id</span>);
<a name="l01551"></a>01551             <a class="code" href="classPrefsDialog.html#aaff94d6e344082dc6c1991a7dd466dd4">PrefsDialog::UpdateChosenFile</a>();
<a name="l01552"></a>01552             SetFocus();
<a name="l01553"></a>01553             SetSelection(<a class="code" href="prefs_8cpp.html#ac4977c99d64fe0b792fb6b3ff9cab186">ALL_TEXT</a>);
<a name="l01554"></a>01554         }
<a name="l01555"></a>01555         <span class="keywordflow">else</span> {
<a name="l01556"></a>01556             <a class="code" href="wxutils_8cpp.html#ad496c0028843186f55032174260d2732">Warning</a>(_(<span class="stringliteral">&quot;Failed to find wxChoice control!&quot;</span>));
<a name="l01557"></a>01557         }
<a name="l01558"></a>01558     }
<a name="l01559"></a>01559     <span class="keywordflow">else</span> {
<a name="l01560"></a>01560         <span class="comment">// unsupported key combo</span>
<a name="l01561"></a>01561         <a class="code" href="wxutils_8cpp.html#a26f50e4eb3544de269fffd2cf13ced86">Beep</a>();
<a name="l01562"></a>01562     }
<a name="l01563"></a>01563 
<a name="l01564"></a>01564     <span class="comment">// do NOT pass event on to next handler</span>
<a name="l01565"></a>01565     <span class="comment">// event.Skip();</span>
<a name="l01566"></a>01566 
<a name="l01567"></a>01567 <span class="preprocessor">    #ifdef __WXOSX__</span>
<a name="l01568"></a>01568 <span class="preprocessor"></span>        inonchar = <span class="keyword">false</span>;
<a name="l01569"></a>01569 <span class="preprocessor">    #endif</span>
<a name="l01570"></a>01570 <span class="preprocessor"></span>}
<a name="l01571"></a>01571 
<a name="l01572"></a>01572 <span class="comment">// -----------------------------------------------------------------------------</span>
<a name="l01573"></a>01573 
<a name="l01574"></a>01574 <span class="preprocessor">#ifdef __WXMAC__</span>
<a name="l01575"></a>01575 <span class="preprocessor"></span>
<a name="l01576"></a>01576 <span class="comment">// override key event handler for wxSpinCtrl to allow key checking</span>
<a name="l01577"></a>01577 <span class="comment">// and to get tab key navigation to work correctly</span>
<a name="l01578"></a>01578 <span class="keyword">class </span><a class="code" href="prefs_8cpp.html#a13f7121ffd55a00072f0e359cb60194e">MySpinCtrl</a> : <span class="keyword">public</span> wxSpinCtrl
<a name="l01579"></a>01579 {
<a name="l01580"></a>01580     <span class="keyword">public</span>:
<a name="l01581"></a>01581         <a class="code" href="prefs_8cpp.html#a13f7121ffd55a00072f0e359cb60194e">MySpinCtrl</a>(wxWindow* parent, wxWindowID <span class="keywordtype">id</span>, <span class="keyword">const</span> wxString&amp; str,
<a name="l01582"></a>01582             <span class="keyword">const</span> wxPoint&amp; pos, <span class="keyword">const</span> wxSize&amp; size)
<a name="l01583"></a>01583         : wxSpinCtrl(parent, id, str, pos, size) {
<a name="l01584"></a>01584             <span class="comment">// create a dynamic event handler for the underlying wxTextCtrl</span>
<a name="l01585"></a>01585             wxTextCtrl* textctrl = GetText();
<a name="l01586"></a>01586             <span class="keywordflow">if</span> (textctrl) {
<a name="l01587"></a>01587                 textctrl-&gt;Connect(wxID_ANY, wxEVT_CHAR,
<a name="l01588"></a>01588                     wxKeyEventHandler(PrefsDialog::OnSpinCtrlChar));
<a name="l01589"></a>01589             }
<a name="l01590"></a>01590         }
<a name="l01591"></a>01591 };
<a name="l01592"></a>01592 
<a name="l01593"></a>01593 <span class="keywordtype">void</span> PrefsDialog::OnSpinCtrlChar(wxKeyEvent&amp; event)
<a name="l01594"></a>01594 {
<a name="l01595"></a>01595     <span class="keywordtype">int</span> key = <span class="keyword">event</span>.GetKeyCode();
<a name="l01596"></a>01596 
<a name="l01597"></a>01597     <span class="keywordflow">if</span> (event.CmdDown()) {
<a name="l01598"></a>01598         <span class="comment">// allow handling of cmd-x/v/etc</span>
<a name="l01599"></a>01599         <span class="keyword">event</span>.Skip();
<a name="l01600"></a>01600 
<a name="l01601"></a>01601     }
<a name="l01602"></a>01602     <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( key == WXK_TAB ) {
<a name="l01603"></a>01603         <span class="comment">// note that FindFocus() returns pointer to wxTextCtrl window in wxSpinCtrl</span>
<a name="l01604"></a>01604         <span class="keywordflow">if</span> ( currpage == <a class="code" href="prefs_8cpp.html#a99fb83031ce9923c84392b4e92f956b5a6c75fb9088aa1e821b14551cff631b0b">FILE_PAGE</a> ) {
<a name="l01605"></a>01605             <span class="comment">// only one spin ctrl on this page</span>
<a name="l01606"></a>01606             wxSpinCtrl* s1 = (wxSpinCtrl*) FindWindowById(<a class="code" href="prefs_8cpp.html#abc6126af1d45847bc59afa0aa3216b04ac528b6e272d252b4eaa82b28ea62c85f">PREF_MAX_PATTERNS</a>);
<a name="l01607"></a>01607             <span class="keywordflow">if</span> ( s1 ) { s1-&gt;SetFocus(); s1-&gt;SetSelection(<a class="code" href="prefs_8cpp.html#ac4977c99d64fe0b792fb6b3ff9cab186">ALL_TEXT</a>); }
<a name="l01608"></a>01608         }
<a name="l01609"></a>01609         <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( currpage == <a class="code" href="prefs_8cpp.html#a99fb83031ce9923c84392b4e92f956b5ab2000382ee96091a0f199de2c23f93dc">EDIT_PAGE</a> ) {
<a name="l01610"></a>01610             <span class="comment">// no spin ctrls on this page</span>
<a name="l01611"></a>01611         }
<a name="l01612"></a>01612         <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( currpage == <a class="code" href="prefs_8cpp.html#a99fb83031ce9923c84392b4e92f956b5a5c4a8b972182ff89076d34c67e15ff37">VIEW_PAGE</a> ) {
<a name="l01613"></a>01613             <span class="comment">// no spin ctrls on this page</span>
<a name="l01614"></a>01614         }
<a name="l01615"></a>01615         <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( currpage == <a class="code" href="prefs_8cpp.html#a99fb83031ce9923c84392b4e92f956b5ae6193528cfdfbc97479fe6ef2ff962f6">ACTION_PAGE</a> ) {
<a name="l01616"></a>01616             <span class="comment">// no spin ctrls on this page</span>
<a name="l01617"></a>01617         }
<a name="l01618"></a>01618         <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( currpage == <a class="code" href="prefs_8cpp.html#a99fb83031ce9923c84392b4e92f956b5a36b5ca67ee4b41c8df6806befb820e86">KEYBOARD_PAGE</a> ) {
<a name="l01619"></a>01619             <span class="comment">// no spin ctrls on this page</span>
<a name="l01620"></a>01620         }
<a name="l01621"></a>01621 
<a name="l01622"></a>01622     }
<a name="l01623"></a>01623     <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( key &gt;= <span class="charliteral">&#39; &#39;</span> &amp;&amp; key &lt;= <span class="charliteral">&#39;~&#39;</span> ) {
<a name="l01624"></a>01624         <span class="keywordflow">if</span> ( key &gt;= <span class="charliteral">&#39;0&#39;</span> &amp;&amp; key &lt;= <span class="charliteral">&#39;9&#39;</span> ) {
<a name="l01625"></a>01625             <span class="comment">// allow digits</span>
<a name="l01626"></a>01626             <span class="keyword">event</span>.Skip();
<a name="l01627"></a>01627         }
<a name="l01628"></a>01628         <span class="keywordflow">else</span> {
<a name="l01629"></a>01629             <span class="comment">// disallow any other displayable ascii char</span>
<a name="l01630"></a>01630             <a class="code" href="wxutils_8cpp.html#a26f50e4eb3544de269fffd2cf13ced86">Beep</a>();
<a name="l01631"></a>01631         }
<a name="l01632"></a>01632 
<a name="l01633"></a>01633     }
<a name="l01634"></a>01634     <span class="keywordflow">else</span> {
<a name="l01635"></a>01635         <span class="keyword">event</span>.Skip();
<a name="l01636"></a>01636     }
<a name="l01637"></a>01637 }
<a name="l01638"></a>01638 
<a name="l01639"></a>01639 
<a name="l01640"></a>01640 <span class="preprocessor">#else</span>
<a name="l01641"></a>01641 <span class="preprocessor"></span>
<a name="l01642"></a><a class="code" href="prefs_8cpp.html#a13f7121ffd55a00072f0e359cb60194e">01642</a> <span class="preprocessor">#define MySpinCtrl wxSpinCtrl</span>
<a name="l01643"></a>01643 <span class="preprocessor"></span>
<a name="l01644"></a>01644 <span class="preprocessor">#endif      // !__WXMAC__</span>
<a name="l01645"></a>01645 <span class="preprocessor"></span>
<a name="l01646"></a>01646 <span class="comment">// -----------------------------------------------------------------------------</span>
<a name="l01647"></a>01647 
<a name="l01648"></a><a class="code" href="classPrefsDialog.html#a17c30b2e50cfb01f690ba732fada7974">01648</a> <a class="code" href="classPrefsDialog.html#a17c30b2e50cfb01f690ba732fada7974">PrefsDialog::PrefsDialog</a>(<a class="code" href="classMyFrame.html" title="The wxFrame-derived top-level window for the Ready GUI.">MyFrame</a>* parent, <span class="keyword">const</span> wxString&amp; page)
<a name="l01649"></a>01649 {
<a name="l01650"></a>01650     <span class="comment">// not using validators so no need for this:</span>
<a name="l01651"></a>01651     <span class="comment">// SetExtraStyle(wxWS_EX_VALIDATE_RECURSIVELY);</span>
<a name="l01652"></a>01652 
<a name="l01653"></a>01653     Create(parent, wxID_ANY, _(<span class="stringliteral">&quot;Preferences&quot;</span>));
<a name="l01654"></a>01654     CreateButtons(wxOK | wxCANCEL);
<a name="l01655"></a>01655 
<a name="l01656"></a>01656     wxBookCtrlBase* notebook = GetBookCtrl();
<a name="l01657"></a>01657 
<a name="l01658"></a>01658     wxPanel* filePrefs = <a class="code" href="classPrefsDialog.html#a45e3ed2ff24cfe3a8b27d7b06e2fb923">CreateFilePrefs</a>(notebook);
<a name="l01659"></a>01659     wxPanel* editPrefs = <a class="code" href="classPrefsDialog.html#adcdddc6ae06520ad194efb2e29123ac8">CreateEditPrefs</a>(notebook);
<a name="l01660"></a>01660     wxPanel* viewPrefs = <a class="code" href="classPrefsDialog.html#a55c21618ec242209de49380ab430e763">CreateViewPrefs</a>(notebook);
<a name="l01661"></a>01661     wxPanel* actionPrefs = <a class="code" href="classPrefsDialog.html#a359e83e7843fce110e7181b0e04a7b93">CreateActionPrefs</a>(notebook);
<a name="l01662"></a>01662     wxPanel* keyboardPrefs = <a class="code" href="classPrefsDialog.html#a972b4afdca775ce6fec10b25c3529293">CreateKeyboardPrefs</a>(notebook);
<a name="l01663"></a>01663 
<a name="l01664"></a>01664     <span class="comment">// AddPage and SetSelection cause OnPageChanging and OnPageChanged to be called</span>
<a name="l01665"></a>01665     <span class="comment">// so we use a flag to prevent currpage being changed (and unnecessary validation)</span>
<a name="l01666"></a>01666     <a class="code" href="classPrefsDialog.html#acf48c0cdb1d05cc17d1ef3ff9dd10d94">ignore_page_event</a> = <span class="keyword">true</span>;
<a name="l01667"></a>01667 
<a name="l01668"></a>01668     notebook-&gt;AddPage(filePrefs, _(<span class="stringliteral">&quot;File&quot;</span>));
<a name="l01669"></a>01669     notebook-&gt;AddPage(editPrefs, _(<span class="stringliteral">&quot;Edit&quot;</span>));
<a name="l01670"></a>01670     notebook-&gt;AddPage(viewPrefs, _(<span class="stringliteral">&quot;View&quot;</span>));
<a name="l01671"></a>01671     notebook-&gt;AddPage(actionPrefs, _(<span class="stringliteral">&quot;Action&quot;</span>));
<a name="l01672"></a>01672     notebook-&gt;AddPage(keyboardPrefs, _(<span class="stringliteral">&quot;Keyboard&quot;</span>));
<a name="l01673"></a>01673 
<a name="l01674"></a>01674     <span class="keywordflow">if</span> (!page.IsEmpty()) {
<a name="l01675"></a>01675         <span class="keywordflow">if</span> (page == wxT(<span class="stringliteral">&quot;file&quot;</span>))            currpage = <a class="code" href="prefs_8cpp.html#a99fb83031ce9923c84392b4e92f956b5a6c75fb9088aa1e821b14551cff631b0b">FILE_PAGE</a>;
<a name="l01676"></a>01676         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (page == wxT(<span class="stringliteral">&quot;edit&quot;</span>))       currpage = <a class="code" href="prefs_8cpp.html#a99fb83031ce9923c84392b4e92f956b5ab2000382ee96091a0f199de2c23f93dc">EDIT_PAGE</a>;
<a name="l01677"></a>01677         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (page == wxT(<span class="stringliteral">&quot;view&quot;</span>))       currpage = <a class="code" href="prefs_8cpp.html#a99fb83031ce9923c84392b4e92f956b5a5c4a8b972182ff89076d34c67e15ff37">VIEW_PAGE</a>;
<a name="l01678"></a>01678         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (page == wxT(<span class="stringliteral">&quot;action&quot;</span>))     currpage = <a class="code" href="prefs_8cpp.html#a99fb83031ce9923c84392b4e92f956b5ae6193528cfdfbc97479fe6ef2ff962f6">ACTION_PAGE</a>;
<a name="l01679"></a>01679         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (page == wxT(<span class="stringliteral">&quot;keyboard&quot;</span>))   currpage = <a class="code" href="prefs_8cpp.html#a99fb83031ce9923c84392b4e92f956b5a36b5ca67ee4b41c8df6806befb820e86">KEYBOARD_PAGE</a>;
<a name="l01680"></a>01680     }
<a name="l01681"></a>01681 
<a name="l01682"></a>01682     <span class="comment">// show the desired page</span>
<a name="l01683"></a>01683     notebook-&gt;SetSelection(currpage);
<a name="l01684"></a>01684 
<a name="l01685"></a>01685     <a class="code" href="classPrefsDialog.html#acf48c0cdb1d05cc17d1ef3ff9dd10d94">ignore_page_event</a> = <span class="keyword">false</span>;
<a name="l01686"></a>01686 
<a name="l01687"></a>01687     LayoutDialog();
<a name="l01688"></a>01688 
<a name="l01689"></a>01689     <span class="comment">// ensure top text box has focus and text is selected by creating</span>
<a name="l01690"></a>01690     <span class="comment">// a one-shot timer which will call OnOneTimer after short delay</span>
<a name="l01691"></a>01691     <a class="code" href="classPrefsDialog.html#a45b7bfaa325a6eb58246a9129840b83b">onetimer</a> = <span class="keyword">new</span> wxTimer(<span class="keyword">this</span>, wxID_ANY);
<a name="l01692"></a>01692     <span class="keywordflow">if</span> (<a class="code" href="classPrefsDialog.html#a45b7bfaa325a6eb58246a9129840b83b">onetimer</a>) <a class="code" href="classPrefsDialog.html#a45b7bfaa325a6eb58246a9129840b83b">onetimer</a>-&gt;Start(10, wxTIMER_ONE_SHOT);
<a name="l01693"></a>01693 }
<a name="l01694"></a>01694 
<a name="l01695"></a>01695 <span class="comment">// -----------------------------------------------------------------------------</span>
<a name="l01696"></a>01696 
<a name="l01697"></a><a class="code" href="classPrefsDialog.html#a01f2edbe47f25e2d624d39ae428ed4e0">01697</a> <span class="keywordtype">void</span> <a class="code" href="classPrefsDialog.html#a01f2edbe47f25e2d624d39ae428ed4e0">PrefsDialog::OnOneTimer</a>(wxTimerEvent&amp; WXUNUSED(event))
<a name="l01698"></a>01698 {
<a name="l01699"></a>01699     <a class="code" href="prefs_8cpp.html#a13f7121ffd55a00072f0e359cb60194e">MySpinCtrl</a>* s1 = NULL;
<a name="l01700"></a>01700     <a class="code" href="prefs_8cpp.html#a13f7121ffd55a00072f0e359cb60194e">MySpinCtrl</a>* s2 = NULL;
<a name="l01701"></a>01701 
<a name="l01702"></a>01702     <span class="keywordflow">if</span> (currpage == <a class="code" href="prefs_8cpp.html#a99fb83031ce9923c84392b4e92f956b5a6c75fb9088aa1e821b14551cff631b0b">FILE_PAGE</a>) {
<a name="l01703"></a>01703         s1 = (<a class="code" href="prefs_8cpp.html#a13f7121ffd55a00072f0e359cb60194e">MySpinCtrl</a>*) FindWindowById(<a class="code" href="prefs_8cpp.html#abc6126af1d45847bc59afa0aa3216b04ac528b6e272d252b4eaa82b28ea62c85f">PREF_MAX_PATTERNS</a>);
<a name="l01704"></a>01704 <span class="preprocessor">        #ifdef __WXOSX__</span>
<a name="l01705"></a>01705 <span class="preprocessor"></span>            <span class="comment">// have to set s2 to hidden spin ctrl... sigh</span>
<a name="l01706"></a>01706             s2 = (<a class="code" href="prefs_8cpp.html#a13f7121ffd55a00072f0e359cb60194e">MySpinCtrl</a>*) FindWindowById(PREF_HIDDEN);
<a name="l01707"></a>01707 <span class="preprocessor">        #else</span>
<a name="l01708"></a>01708 <span class="preprocessor"></span>            s2 = s1;
<a name="l01709"></a>01709 <span class="preprocessor">        #endif</span>
<a name="l01710"></a>01710 <span class="preprocessor"></span>    }
<a name="l01711"></a>01711     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (currpage == <a class="code" href="prefs_8cpp.html#a99fb83031ce9923c84392b4e92f956b5a36b5ca67ee4b41c8df6806befb820e86">KEYBOARD_PAGE</a>) {
<a name="l01712"></a>01712         <a class="code" href="classKeyComboCtrl.html">KeyComboCtrl</a>* k = (<a class="code" href="classKeyComboCtrl.html">KeyComboCtrl</a>*) FindWindowById(<a class="code" href="prefs_8cpp.html#abc6126af1d45847bc59afa0aa3216b04a54200275e98be6a4e4d615407411a1a7">PREF_KEYCOMBO</a>);
<a name="l01713"></a>01713         <span class="keywordflow">if</span> (k) {
<a name="l01714"></a>01714             <span class="comment">// don&#39;t need to change focus to some other control if wxOSX</span>
<a name="l01715"></a>01715             k-&gt;SetFocus();
<a name="l01716"></a>01716             k-&gt;SetSelection(<a class="code" href="prefs_8cpp.html#ac4977c99d64fe0b792fb6b3ff9cab186">ALL_TEXT</a>);
<a name="l01717"></a>01717         }
<a name="l01718"></a>01718         <span class="keywordflow">return</span>;
<a name="l01719"></a>01719     }
<a name="l01720"></a>01720 
<a name="l01721"></a>01721     <span class="keywordflow">if</span> (s1 &amp;&amp; s2) {
<a name="l01722"></a>01722 <span class="preprocessor">#ifdef __WXOSX__</span>
<a name="l01723"></a>01723 <span class="preprocessor"></span>        <span class="comment">// first need to change focus to some other control</span>
<a name="l01724"></a>01724         s2-&gt;SetFocus();
<a name="l01725"></a>01725 <span class="preprocessor">#endif</span>
<a name="l01726"></a>01726 <span class="preprocessor"></span>        s1-&gt;SetFocus();
<a name="l01727"></a>01727         s1-&gt;SetSelection(<a class="code" href="prefs_8cpp.html#ac4977c99d64fe0b792fb6b3ff9cab186">ALL_TEXT</a>);
<a name="l01728"></a>01728     }
<a name="l01729"></a>01729 }
<a name="l01730"></a>01730 
<a name="l01731"></a>01731 <span class="comment">// -----------------------------------------------------------------------------</span>
<a name="l01732"></a>01732 
<a name="l01733"></a>01733 <span class="comment">// these consts are used to get nicely spaced controls on each platform:</span>
<a name="l01734"></a>01734 
<a name="l01735"></a>01735 <span class="preprocessor">#ifdef __WXMAC__</span>
<a name="l01736"></a>01736 <span class="preprocessor"></span><span class="preprocessor">#define GROUPGAP (12)            // vertical gap between a group of controls</span>
<a name="l01737"></a>01737 <span class="preprocessor"></span><span class="preprocessor">#define SBTOPGAP (2)             // vertical gap before first item in wxStaticBoxSizer</span>
<a name="l01738"></a>01738 <span class="preprocessor"></span><span class="preprocessor">#define SBBOTGAP (2)             // vertical gap after last item in wxStaticBoxSizer</span>
<a name="l01739"></a>01739 <span class="preprocessor"></span><span class="preprocessor">#define SVGAP (4)                // vertical gap above wxSpinCtrl box</span>
<a name="l01740"></a>01740 <span class="preprocessor"></span><span class="preprocessor">#define S2VGAP (0)               // vertical gap between 2 wxSpinCtrl boxes</span>
<a name="l01741"></a>01741 <span class="preprocessor"></span><span class="preprocessor">#define CH2VGAP (6)              // vertical gap between 2 check/radio boxes</span>
<a name="l01742"></a>01742 <span class="preprocessor"></span><span class="preprocessor">#define CVGAP (9)                // vertical gap above wxChoice box</span>
<a name="l01743"></a>01743 <span class="preprocessor"></span><span class="preprocessor">#define LRGAP (5)                // space left and right of vertically stacked boxes</span>
<a name="l01744"></a>01744 <span class="preprocessor"></span><span class="preprocessor">#define SPINGAP (3)              // horizontal gap around each wxSpinCtrl box</span>
<a name="l01745"></a>01745 <span class="preprocessor"></span><span class="preprocessor">#define CHOICEGAP (6)            // horizontal gap to left of wxChoice box</span>
<a name="l01746"></a>01746 <span class="preprocessor"></span><span class="preprocessor">#elif defined(__WXMSW__)</span>
<a name="l01747"></a>01747 <span class="preprocessor"></span><span class="preprocessor">#define GROUPGAP (10)</span>
<a name="l01748"></a>01748 <span class="preprocessor"></span><span class="preprocessor">#define SBTOPGAP (7)</span>
<a name="l01749"></a>01749 <span class="preprocessor"></span><span class="preprocessor">#define SBBOTGAP (7)</span>
<a name="l01750"></a>01750 <span class="preprocessor"></span><span class="preprocessor">#define SVGAP (7)</span>
<a name="l01751"></a>01751 <span class="preprocessor"></span><span class="preprocessor">#define S2VGAP (5)</span>
<a name="l01752"></a>01752 <span class="preprocessor"></span><span class="preprocessor">#define CH2VGAP (8)</span>
<a name="l01753"></a>01753 <span class="preprocessor"></span><span class="preprocessor">#define CVGAP (7)</span>
<a name="l01754"></a>01754 <span class="preprocessor"></span><span class="preprocessor">#define LRGAP (5)</span>
<a name="l01755"></a>01755 <span class="preprocessor"></span><span class="preprocessor">#define SPINGAP (6)</span>
<a name="l01756"></a>01756 <span class="preprocessor"></span><span class="preprocessor">#define CHOICEGAP (6)</span>
<a name="l01757"></a>01757 <span class="preprocessor"></span><span class="preprocessor">#else                            // assume Linux</span>
<a name="l01758"></a><a class="code" href="prefs_8cpp.html#afe9d9401ff7f404b969ca87875417613">01758</a> <span class="preprocessor"></span><span class="preprocessor">#define GROUPGAP (10)</span>
<a name="l01759"></a><a class="code" href="prefs_8cpp.html#aae41ae433ca73e8ed1b09d8233d6a1c9">01759</a> <span class="preprocessor"></span><span class="preprocessor">#define SBTOPGAP (12)</span>
<a name="l01760"></a><a class="code" href="prefs_8cpp.html#ad4d68922d0b5ddec845c401fac446a13">01760</a> <span class="preprocessor"></span><span class="preprocessor">#define SBBOTGAP (7)</span>
<a name="l01761"></a><a class="code" href="prefs_8cpp.html#a595c2f3398f657c9ee6109d30dc0ec28">01761</a> <span class="preprocessor"></span><span class="preprocessor">#define SVGAP (7)</span>
<a name="l01762"></a><a class="code" href="prefs_8cpp.html#a3c154b751ab3f1fe314373fc26a04359">01762</a> <span class="preprocessor"></span><span class="preprocessor">#define S2VGAP (5)</span>
<a name="l01763"></a><a class="code" href="prefs_8cpp.html#a273e43596627046471557fc2ba85712a">01763</a> <span class="preprocessor"></span><span class="preprocessor">#define CH2VGAP (8)</span>
<a name="l01764"></a><a class="code" href="prefs_8cpp.html#a1ee9dd82018135f43d1c0ffe2ef4dad5">01764</a> <span class="preprocessor"></span><span class="preprocessor">#define CVGAP (7)</span>
<a name="l01765"></a><a class="code" href="prefs_8cpp.html#a9b2f9f5f5b3b2c2195bcf78bf7a5a706">01765</a> <span class="preprocessor"></span><span class="preprocessor">#define LRGAP (5)</span>
<a name="l01766"></a><a class="code" href="prefs_8cpp.html#abb3823efd580f7e48b3a7ed59f34834b">01766</a> <span class="preprocessor"></span><span class="preprocessor">#define SPINGAP (6)</span>
<a name="l01767"></a><a class="code" href="prefs_8cpp.html#a3509e4abe6c94615e6a6a7a437c0317c">01767</a> <span class="preprocessor"></span><span class="preprocessor">#define CHOICEGAP (6)</span>
<a name="l01768"></a>01768 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l01769"></a>01769 <span class="preprocessor"></span>
<a name="l01770"></a>01770 <span class="comment">// -----------------------------------------------------------------------------</span>
<a name="l01771"></a>01771 
<a name="l01772"></a><a class="code" href="classPrefsDialog.html#a45e3ed2ff24cfe3a8b27d7b06e2fb923">01772</a> wxPanel* <a class="code" href="classPrefsDialog.html#a45e3ed2ff24cfe3a8b27d7b06e2fb923">PrefsDialog::CreateFilePrefs</a>(wxWindow* parent)
<a name="l01773"></a>01773 {
<a name="l01774"></a>01774     wxPanel* panel = <span class="keyword">new</span> wxPanel(parent, wxID_ANY);
<a name="l01775"></a>01775     wxBoxSizer* topSizer = <span class="keyword">new</span> wxBoxSizer(wxVERTICAL);
<a name="l01776"></a>01776     wxBoxSizer* vbox = <span class="keyword">new</span> wxBoxSizer(wxVERTICAL);
<a name="l01777"></a>01777 
<a name="l01778"></a>01778 <span class="preprocessor">    #ifdef __WXOSX__</span>
<a name="l01779"></a>01779 <span class="preprocessor"></span>        <span class="comment">// create hidden spin ctrl for use in OnOneTimer</span>
<a name="l01780"></a>01780         wxSpinCtrl* hidden = <span class="keyword">new</span> <a class="code" href="prefs_8cpp.html#a13f7121ffd55a00072f0e359cb60194e">MySpinCtrl</a>(panel, PREF_HIDDEN, wxEmptyString,
<a name="l01781"></a>01781             wxPoint(-1000,-1000), wxSize(70, wxDefaultCoord));
<a name="l01782"></a>01782         hidden-&gt;SetValue(666);
<a name="l01783"></a>01783 <span class="preprocessor">    #endif</span>
<a name="l01784"></a>01784 <span class="preprocessor"></span>
<a name="l01785"></a>01785     <span class="comment">// max_patterns and max_scripts</span>
<a name="l01786"></a>01786 
<a name="l01787"></a>01787     wxBoxSizer* maxbox = <span class="keyword">new</span> wxBoxSizer(wxHORIZONTAL);
<a name="l01788"></a>01788     maxbox-&gt;Add(<span class="keyword">new</span> wxStaticText(panel, wxID_STATIC, _(<span class="stringliteral">&quot;Maximum number of recent patterns:&quot;</span>)),
<a name="l01789"></a>01789         0, wxALL, 0);
<a name="l01790"></a>01790 
<a name="l01791"></a>01791     wxSpinCtrl* spin1 = <span class="keyword">new</span> <a class="code" href="prefs_8cpp.html#a13f7121ffd55a00072f0e359cb60194e">MySpinCtrl</a>(panel, <a class="code" href="prefs_8cpp.html#abc6126af1d45847bc59afa0aa3216b04ac528b6e272d252b4eaa82b28ea62c85f">PREF_MAX_PATTERNS</a>, wxEmptyString,
<a name="l01792"></a>01792         wxDefaultPosition, wxSize(70, wxDefaultCoord));
<a name="l01793"></a>01793 
<a name="l01794"></a>01794     wxBoxSizer* hpbox = <span class="keyword">new</span> wxBoxSizer(wxHORIZONTAL);
<a name="l01795"></a>01795     hpbox-&gt;Add(maxbox, 0, wxALIGN_CENTER_VERTICAL, 0);
<a name="l01796"></a>01796     hpbox-&gt;Add(spin1, 0, wxLEFT | wxRIGHT | wxALIGN_CENTER_VERTICAL, <a class="code" href="prefs_8cpp.html#abb3823efd580f7e48b3a7ed59f34834b">SPINGAP</a>);
<a name="l01797"></a>01797 
<a name="l01798"></a>01798     wxButton* editorbutt = <span class="keyword">new</span> wxButton(panel, <a class="code" href="prefs_8cpp.html#abc6126af1d45847bc59afa0aa3216b04a6340d6e469ce3321da69dd844bc28e4e">PREF_EDITOR_BUTT</a>, _(<span class="stringliteral">&quot;Text Editor...&quot;</span>));
<a name="l01799"></a>01799     wxStaticText* editorbox = <span class="keyword">new</span> wxStaticText(panel, <a class="code" href="prefs_8cpp.html#abc6126af1d45847bc59afa0aa3216b04a9555ecc0a874a07b0332ba282ba92814">PREF_EDITOR_BOX</a>, <a class="code" href="prefs_8cpp.html#a3a8c57e4e1beb747c341e067dc8869bf">texteditor</a>);
<a name="l01800"></a>01800     <a class="code" href="classPrefsDialog.html#ab70af43614d3d362387ac81eb4ddd98f">neweditor</a> = <a class="code" href="prefs_8cpp.html#a3a8c57e4e1beb747c341e067dc8869bf">texteditor</a>;
<a name="l01801"></a>01801 
<a name="l01802"></a>01802     wxBoxSizer* hebox = <span class="keyword">new</span> wxBoxSizer(wxHORIZONTAL);
<a name="l01803"></a>01803     hebox-&gt;Add(editorbutt, 0, wxLEFT | wxRIGHT | wxALIGN_CENTER_VERTICAL, 0);
<a name="l01804"></a>01804     hebox-&gt;Add(editorbox, 0, wxLEFT | wxALIGN_CENTER_VERTICAL, <a class="code" href="prefs_8cpp.html#a9b2f9f5f5b3b2c2195bcf78bf7a5a706">LRGAP</a>);
<a name="l01805"></a>01805 
<a name="l01806"></a>01806     <span class="comment">// position things</span>
<a name="l01807"></a>01807     vbox-&gt;AddSpacer(5);
<a name="l01808"></a>01808     vbox-&gt;Add(hpbox, 0, wxLEFT | wxRIGHT, <a class="code" href="prefs_8cpp.html#a9b2f9f5f5b3b2c2195bcf78bf7a5a706">LRGAP</a>);
<a name="l01809"></a>01809     vbox-&gt;AddSpacer(10);
<a name="l01810"></a>01810     vbox-&gt;Add(hebox, 0, wxLEFT | wxRIGHT, <a class="code" href="prefs_8cpp.html#a9b2f9f5f5b3b2c2195bcf78bf7a5a706">LRGAP</a>);
<a name="l01811"></a>01811     vbox-&gt;AddSpacer(5);
<a name="l01812"></a>01812 
<a name="l01813"></a>01813     <span class="comment">// init control values</span>
<a name="l01814"></a>01814     spin1-&gt;SetRange(1, <a class="code" href="namespaceID.html#add26a31edd435929e305eca022a899d0">ID::MAX_RECENT</a>); spin1-&gt;SetValue(<a class="code" href="prefs_8cpp.html#af74247065dccdcbc74c5e1b8dc09e01c">maxpatterns</a>);
<a name="l01815"></a>01815     spin1-&gt;SetFocus();
<a name="l01816"></a>01816     spin1-&gt;SetSelection(<a class="code" href="prefs_8cpp.html#ac4977c99d64fe0b792fb6b3ff9cab186">ALL_TEXT</a>);
<a name="l01817"></a>01817 
<a name="l01818"></a>01818     topSizer-&gt;Add(vbox, 1, wxGROW | wxALIGN_CENTER | wxALL, 5);
<a name="l01819"></a>01819     panel-&gt;SetSizer(topSizer);
<a name="l01820"></a>01820     topSizer-&gt;Fit(panel);
<a name="l01821"></a>01821     <span class="keywordflow">return</span> panel;
<a name="l01822"></a>01822 }
<a name="l01823"></a>01823 
<a name="l01824"></a>01824 <span class="comment">// -----------------------------------------------------------------------------</span>
<a name="l01825"></a>01825 
<a name="l01826"></a><a class="code" href="classPrefsDialog.html#adcdddc6ae06520ad194efb2e29123ac8">01826</a> wxPanel* <a class="code" href="classPrefsDialog.html#adcdddc6ae06520ad194efb2e29123ac8">PrefsDialog::CreateEditPrefs</a>(wxWindow* parent)
<a name="l01827"></a>01827 {
<a name="l01828"></a>01828     wxPanel* panel = <span class="keyword">new</span> wxPanel(parent, wxID_ANY);
<a name="l01829"></a>01829     wxBoxSizer* topSizer = <span class="keyword">new</span> wxBoxSizer(wxVERTICAL);
<a name="l01830"></a>01830     wxBoxSizer* vbox = <span class="keyword">new</span> wxBoxSizer(wxVERTICAL);
<a name="l01831"></a>01831 
<a name="l01832"></a>01832     <span class="comment">// repaint_to_erase</span>
<a name="l01833"></a>01833 
<a name="l01834"></a>01834     wxCheckBox* erasecheck = <span class="keyword">new</span> wxCheckBox(panel, <a class="code" href="prefs_8cpp.html#abc6126af1d45847bc59afa0aa3216b04adae37cf8a27c006e510ea97f602d6eed">PREF_ERASE</a>,
<a name="l01835"></a>01835         _(<span class="stringliteral">&quot;Pencil tool erases (to low value) if cell is redrawn with same value&quot;</span>));
<a name="l01836"></a>01836 
<a name="l01837"></a>01837     <span class="comment">// allow_beep</span>
<a name="l01838"></a>01838 
<a name="l01839"></a>01839     wxCheckBox* beepcheck = <span class="keyword">new</span> wxCheckBox(panel, <a class="code" href="prefs_8cpp.html#abc6126af1d45847bc59afa0aa3216b04a29b8515407b4085d812758d22f7ab6b9">PREF_BEEP</a>, _(<span class="stringliteral">&quot;Allow beep sound&quot;</span>));
<a name="l01840"></a>01840 
<a name="l01841"></a>01841     <span class="comment">// position things</span>
<a name="l01842"></a>01842     vbox-&gt;AddSpacer(5);
<a name="l01843"></a>01843     vbox-&gt;Add(erasecheck, 0, wxLEFT | wxRIGHT, <a class="code" href="prefs_8cpp.html#a9b2f9f5f5b3b2c2195bcf78bf7a5a706">LRGAP</a>);
<a name="l01844"></a>01844     vbox-&gt;AddSpacer(5);
<a name="l01845"></a>01845     vbox-&gt;Add(beepcheck, 0, wxLEFT | wxRIGHT, <a class="code" href="prefs_8cpp.html#a9b2f9f5f5b3b2c2195bcf78bf7a5a706">LRGAP</a>);
<a name="l01846"></a>01846 
<a name="l01847"></a>01847     <span class="comment">// init control values</span>
<a name="l01848"></a>01848     erasecheck-&gt;SetValue(<a class="code" href="prefs_8cpp.html#a12fa8d7d57fa0c4eab03e55cb31d3ca1">repaint_to_erase</a>);
<a name="l01849"></a>01849     beepcheck-&gt;SetValue(<a class="code" href="prefs_8cpp.html#a68723f2f0bf26bff2564c1af8aa80d22">allowbeep</a>);
<a name="l01850"></a>01850 
<a name="l01851"></a>01851     topSizer-&gt;Add(vbox, 1, wxGROW | wxALIGN_CENTER | wxALL, 5);
<a name="l01852"></a>01852     panel-&gt;SetSizer(topSizer);
<a name="l01853"></a>01853     topSizer-&gt;Fit(panel);
<a name="l01854"></a>01854     <span class="keywordflow">return</span> panel;
<a name="l01855"></a>01855 }
<a name="l01856"></a>01856 
<a name="l01857"></a>01857 <span class="comment">// -----------------------------------------------------------------------------</span>
<a name="l01858"></a>01858 
<a name="l01859"></a><a class="code" href="classPrefsDialog.html#a55c21618ec242209de49380ab430e763">01859</a> wxPanel* <a class="code" href="classPrefsDialog.html#a55c21618ec242209de49380ab430e763">PrefsDialog::CreateViewPrefs</a>(wxWindow* parent)
<a name="l01860"></a>01860 {
<a name="l01861"></a>01861     wxPanel* panel = <span class="keyword">new</span> wxPanel(parent, wxID_ANY);
<a name="l01862"></a>01862     wxBoxSizer* topSizer = <span class="keyword">new</span> wxBoxSizer(wxVERTICAL);
<a name="l01863"></a>01863     wxBoxSizer* vbox = <span class="keyword">new</span> wxBoxSizer(wxVERTICAL);
<a name="l01864"></a>01864 
<a name="l01865"></a>01865     <span class="comment">// show_tips</span>
<a name="l01866"></a>01866 
<a name="l01867"></a>01867 <span class="preprocessor">#if wxUSE_TOOLTIPS</span>
<a name="l01868"></a>01868 <span class="preprocessor"></span>    wxCheckBox* toolcheck = <span class="keyword">new</span> wxCheckBox(panel, <a class="code" href="prefs_8cpp.html#abc6126af1d45847bc59afa0aa3216b04a9acefbbd3767c6640a5f6b168847e6fb">PREF_SHOW_TIPS</a>, _(<span class="stringliteral">&quot;Show tool tips&quot;</span>));
<a name="l01869"></a>01869 <span class="preprocessor">#endif</span>
<a name="l01870"></a>01870 <span class="preprocessor"></span>
<a name="l01871"></a>01871     <span class="comment">// position things</span>
<a name="l01872"></a>01872     vbox-&gt;AddSpacer(5);
<a name="l01873"></a>01873 <span class="preprocessor">#if wxUSE_TOOLTIPS</span>
<a name="l01874"></a>01874 <span class="preprocessor"></span>    vbox-&gt;Add(toolcheck, 0, wxLEFT | wxRIGHT, <a class="code" href="prefs_8cpp.html#a9b2f9f5f5b3b2c2195bcf78bf7a5a706">LRGAP</a>);
<a name="l01875"></a>01875 <span class="preprocessor">#endif</span>
<a name="l01876"></a>01876 <span class="preprocessor"></span>
<a name="l01877"></a>01877     <span class="comment">// init control values</span>
<a name="l01878"></a>01878 <span class="preprocessor">#if wxUSE_TOOLTIPS</span>
<a name="l01879"></a>01879 <span class="preprocessor"></span>    toolcheck-&gt;SetValue(<a class="code" href="prefs_8cpp.html#af831ab3ffe0ee800c61d7a73b2873ce3">showtips</a>);
<a name="l01880"></a>01880 <span class="preprocessor">#endif</span>
<a name="l01881"></a>01881 <span class="preprocessor"></span>
<a name="l01882"></a>01882     topSizer-&gt;Add(vbox, 1, wxGROW | wxALIGN_CENTER | wxALL, 5);
<a name="l01883"></a>01883     panel-&gt;SetSizer(topSizer);
<a name="l01884"></a>01884     topSizer-&gt;Fit(panel);
<a name="l01885"></a>01885     <span class="keywordflow">return</span> panel;
<a name="l01886"></a>01886 }
<a name="l01887"></a>01887 
<a name="l01888"></a>01888 <span class="comment">// -----------------------------------------------------------------------------</span>
<a name="l01889"></a>01889 
<a name="l01890"></a><a class="code" href="classPrefsDialog.html#a359e83e7843fce110e7181b0e04a7b93">01890</a> wxPanel* <a class="code" href="classPrefsDialog.html#a359e83e7843fce110e7181b0e04a7b93">PrefsDialog::CreateActionPrefs</a>(wxWindow* parent)
<a name="l01891"></a>01891 {
<a name="l01892"></a>01892     wxPanel* panel = <span class="keyword">new</span> wxPanel(parent, wxID_ANY);
<a name="l01893"></a>01893     wxBoxSizer* topSizer = <span class="keyword">new</span> wxBoxSizer(wxVERTICAL);
<a name="l01894"></a>01894     wxBoxSizer* vbox = <span class="keyword">new</span> wxBoxSizer(wxVERTICAL);
<a name="l01895"></a>01895 
<a name="l01896"></a>01896     wxString note = _(<span class="stringliteral">&quot;No settings here as yet.&quot;</span>);
<a name="l01897"></a>01897     wxBoxSizer* notebox = <span class="keyword">new</span> wxBoxSizer(wxHORIZONTAL);
<a name="l01898"></a>01898     notebox-&gt;Add(<span class="keyword">new</span> wxStaticText(panel, wxID_STATIC, note));
<a name="l01899"></a>01899 
<a name="l01900"></a>01900     <span class="comment">// position things</span>
<a name="l01901"></a>01901     vbox-&gt;AddSpacer(5);
<a name="l01902"></a>01902     vbox-&gt;Add(notebox, 0, wxALIGN_CENTER, <a class="code" href="prefs_8cpp.html#a9b2f9f5f5b3b2c2195bcf78bf7a5a706">LRGAP</a>);
<a name="l01903"></a>01903 
<a name="l01904"></a>01904     topSizer-&gt;Add(vbox, 1, wxGROW | wxALIGN_CENTER | wxALL, 5);
<a name="l01905"></a>01905     panel-&gt;SetSizer(topSizer);
<a name="l01906"></a>01906     topSizer-&gt;Fit(panel);
<a name="l01907"></a>01907     <span class="keywordflow">return</span> panel;
<a name="l01908"></a>01908 }
<a name="l01909"></a>01909 
<a name="l01910"></a>01910 <span class="comment">// -----------------------------------------------------------------------------</span>
<a name="l01911"></a>01911 
<a name="l01912"></a><a class="code" href="classPrefsDialog.html#a972b4afdca775ce6fec10b25c3529293">01912</a> wxPanel* <a class="code" href="classPrefsDialog.html#a972b4afdca775ce6fec10b25c3529293">PrefsDialog::CreateKeyboardPrefs</a>(wxWindow* parent)
<a name="l01913"></a>01913 {
<a name="l01914"></a>01914     wxPanel* panel = <span class="keyword">new</span> wxPanel(parent, wxID_ANY);
<a name="l01915"></a>01915     wxBoxSizer* topSizer = <span class="keyword">new</span> wxBoxSizer(wxVERTICAL);
<a name="l01916"></a>01916     wxBoxSizer* vbox = <span class="keyword">new</span> wxBoxSizer(wxVERTICAL);
<a name="l01917"></a>01917 
<a name="l01918"></a>01918     <span class="comment">// make sure this is the first control added so it gets focus on a page change</span>
<a name="l01919"></a>01919     <a class="code" href="classKeyComboCtrl.html">KeyComboCtrl</a>* keycombo = <span class="keyword">new</span> <a class="code" href="classKeyComboCtrl.html">KeyComboCtrl</a>(panel, <a class="code" href="prefs_8cpp.html#abc6126af1d45847bc59afa0aa3216b04a54200275e98be6a4e4d615407411a1a7">PREF_KEYCOMBO</a>, wxEmptyString,
<a name="l01920"></a>01920         wxDefaultPosition, wxSize(230, wxDefaultCoord),
<a name="l01921"></a>01921         wxTE_CENTER
<a name="l01922"></a>01922         | wxTE_PROCESS_TAB
<a name="l01923"></a>01923         | wxTE_PROCESS_ENTER     <span class="comment">// so enter key won&#39;t select OK on Windows</span>
<a name="l01924"></a>01924     #ifdef __WXOSX__
<a name="l01925"></a>01925         <span class="comment">// avoid wxTE_RICH2 otherwise we see scroll bar</span>
<a name="l01926"></a>01926     #<span class="keywordflow">else</span>
<a name="l01927"></a>01927         <span class="comment">// better for Windows</span>
<a name="l01928"></a>01928         | wxTE_RICH2
<a name="l01929"></a>01929     #endif
<a name="l01930"></a>01930     );
<a name="l01931"></a>01931 
<a name="l01932"></a>01932     wxArrayString actionChoices;
<a name="l01933"></a>01933     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a802dd62e3c2fc79809df7b338c095865">MAX_ACTIONS</a>; i++) {
<a name="l01934"></a>01934         actionChoices.Add( wxString(<a class="code" href="prefs_8cpp.html#a2ac81d5c096ce8b42e14d8b0d7e12b6e">GetActionName</a>((<a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62">action_id</a>) i), wxConvLocal) );
<a name="l01935"></a>01935     }
<a name="l01936"></a>01936     actionChoices[<a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a143bfdd54d27e620ee14307ec3cbd989">DO_OPENFILE</a>] = _(<span class="stringliteral">&quot;Open Chosen File&quot;</span>);
<a name="l01937"></a>01937     wxChoice* actionmenu = <span class="keyword">new</span> wxChoice(panel, <a class="code" href="prefs_8cpp.html#abc6126af1d45847bc59afa0aa3216b04a19964575f179f798d3a112f25ed3df0c">PREF_ACTION</a>,
<a name="l01938"></a>01938     wxDefaultPosition, wxDefaultSize, actionChoices);
<a name="l01939"></a>01939 
<a name="l01940"></a>01940     wxBoxSizer* hbox0 = <span class="keyword">new</span> wxBoxSizer(wxHORIZONTAL);
<a name="l01941"></a>01941     hbox0-&gt;Add(<span class="keyword">new</span> wxStaticText(panel, wxID_STATIC,
<a name="l01942"></a>01942                                 _(<span class="stringliteral">&quot;Type a key combination, then select the desired action:&quot;</span>)));
<a name="l01943"></a>01943 
<a name="l01944"></a>01944     wxBoxSizer* keybox = <span class="keyword">new</span> wxBoxSizer(wxVERTICAL);
<a name="l01945"></a>01945     keybox-&gt;Add(<span class="keyword">new</span> wxStaticText(panel, wxID_STATIC, _(<span class="stringliteral">&quot;Key Combination&quot;</span>)), 0, wxALIGN_CENTER, 0);
<a name="l01946"></a>01946     keybox-&gt;AddSpacer(5);
<a name="l01947"></a>01947     keybox-&gt;Add(keycombo, 0, wxALIGN_CENTER, 0);
<a name="l01948"></a>01948 
<a name="l01949"></a>01949     wxBoxSizer* actbox = <span class="keyword">new</span> wxBoxSizer(wxVERTICAL);
<a name="l01950"></a>01950 <span class="preprocessor">    #if defined(__WXMAC__) &amp;&amp; wxCHECK_VERSION(2,8,0) &amp;&amp; !wxCHECK_VERSION(2,9,0)</span>
<a name="l01951"></a>01951 <span class="preprocessor"></span>        actbox-&gt;AddSpacer(2);
<a name="l01952"></a>01952 <span class="preprocessor">    #endif</span>
<a name="l01953"></a>01953 <span class="preprocessor"></span>    actbox-&gt;Add(<span class="keyword">new</span> wxStaticText(panel, wxID_STATIC, _(<span class="stringliteral">&quot;Action&quot;</span>)), 0, wxALIGN_CENTER, 0);
<a name="l01954"></a>01954     actbox-&gt;AddSpacer(5);
<a name="l01955"></a>01955     actbox-&gt;Add(actionmenu, 0, wxALIGN_CENTER, 0);
<a name="l01956"></a>01956 
<a name="l01957"></a>01957     wxBoxSizer* hbox1 = <span class="keyword">new</span> wxBoxSizer(wxHORIZONTAL);
<a name="l01958"></a>01958     hbox1-&gt;Add(keybox, 0, wxLEFT | wxRIGHT | wxALIGN_CENTER_VERTICAL, <a class="code" href="prefs_8cpp.html#a9b2f9f5f5b3b2c2195bcf78bf7a5a706">LRGAP</a>);
<a name="l01959"></a>01959     hbox1-&gt;AddSpacer(15);
<a name="l01960"></a>01960     hbox1-&gt;Add(actbox, 0, wxLEFT | wxRIGHT | wxALIGN_CENTER_VERTICAL, <a class="code" href="prefs_8cpp.html#a9b2f9f5f5b3b2c2195bcf78bf7a5a706">LRGAP</a>);
<a name="l01961"></a>01961 
<a name="l01962"></a>01962     wxButton* choose = <span class="keyword">new</span> wxButton(panel, <a class="code" href="prefs_8cpp.html#abc6126af1d45847bc59afa0aa3216b04acbeb709d0e949a0635dbfcefc595370b">PREF_CHOOSE</a>, _(<span class="stringliteral">&quot;Choose File...&quot;</span>));
<a name="l01963"></a>01963     wxStaticText* filebox = <span class="keyword">new</span> wxStaticText(panel, <a class="code" href="prefs_8cpp.html#abc6126af1d45847bc59afa0aa3216b04aa995dcceafdaa0951e58998d30cc7fe4">PREF_FILE_BOX</a>, wxEmptyString);
<a name="l01964"></a>01964 
<a name="l01965"></a>01965     wxBoxSizer* hbox2 = <span class="keyword">new</span> wxBoxSizer(wxHORIZONTAL);
<a name="l01966"></a>01966     hbox2-&gt;Add(choose, 0, wxLEFT | wxRIGHT | wxALIGN_CENTER_VERTICAL, <a class="code" href="prefs_8cpp.html#a9b2f9f5f5b3b2c2195bcf78bf7a5a706">LRGAP</a>);
<a name="l01967"></a>01967     hbox2-&gt;Add(filebox, 0, wxLEFT | wxALIGN_CENTER_VERTICAL, <a class="code" href="prefs_8cpp.html#a9b2f9f5f5b3b2c2195bcf78bf7a5a706">LRGAP</a>);
<a name="l01968"></a>01968 
<a name="l01969"></a>01969     wxBoxSizer* midbox = <span class="keyword">new</span> wxBoxSizer(wxVERTICAL);
<a name="l01970"></a>01970     midbox-&gt;Add(hbox1, 0, wxLEFT | wxRIGHT, <a class="code" href="prefs_8cpp.html#a9b2f9f5f5b3b2c2195bcf78bf7a5a706">LRGAP</a>);
<a name="l01971"></a>01971     midbox-&gt;AddSpacer(15);
<a name="l01972"></a>01972     midbox-&gt;Add(hbox2, 0, wxLEFT, <a class="code" href="prefs_8cpp.html#a9b2f9f5f5b3b2c2195bcf78bf7a5a706">LRGAP</a>);
<a name="l01973"></a>01973 
<a name="l01974"></a>01974     wxString notes = _(<span class="stringliteral">&quot;Note:&quot;</span>);
<a name="l01975"></a>01975     notes += _(<span class="stringliteral">&quot;\n- Different key combinations can be assigned to the same action.&quot;</span>);
<a name="l01976"></a>01976     notes += _(<span class="stringliteral">&quot;\n- The Escape key is reserved for hard-wired actions.&quot;</span>);
<a name="l01977"></a>01977     notes += _(<span class="stringliteral">&quot;\n- Click OK to save changes (the Return key can be assigned to an action).&quot;</span>);
<a name="l01978"></a>01978     wxBoxSizer* hbox3 = <span class="keyword">new</span> wxBoxSizer(wxHORIZONTAL);
<a name="l01979"></a>01979     hbox3-&gt;Add(<span class="keyword">new</span> wxStaticText(panel, wxID_STATIC, notes));
<a name="l01980"></a>01980 
<a name="l01981"></a>01981     <span class="comment">// position things</span>
<a name="l01982"></a>01982     vbox-&gt;AddSpacer(5);
<a name="l01983"></a>01983     vbox-&gt;Add(hbox0, 0, wxLEFT, <a class="code" href="prefs_8cpp.html#a9b2f9f5f5b3b2c2195bcf78bf7a5a706">LRGAP</a>);
<a name="l01984"></a>01984     vbox-&gt;AddSpacer(15);
<a name="l01985"></a>01985     vbox-&gt;Add(midbox, 0, wxALIGN_CENTER, 0);
<a name="l01986"></a>01986     vbox-&gt;AddSpacer(30);
<a name="l01987"></a>01987     vbox-&gt;Add(hbox3, 0, wxLEFT, <a class="code" href="prefs_8cpp.html#a9b2f9f5f5b3b2c2195bcf78bf7a5a706">LRGAP</a>);
<a name="l01988"></a>01988 
<a name="l01989"></a>01989     <span class="comment">// initialize controls</span>
<a name="l01990"></a>01990     keycombo-&gt;ChangeValue( <a class="code" href="prefs_8cpp.html#a08014bdc6da754d563b6bcbe6c3daaf0">GetKeyCombo</a>(currkey, currmods) );
<a name="l01991"></a>01991     actionmenu-&gt;SetSelection( keyaction[currkey][currmods].<span class="keywordtype">id</span> );
<a name="l01992"></a>01992     <a class="code" href="classPrefsDialog.html#aaff94d6e344082dc6c1991a7dd466dd4">UpdateChosenFile</a>();
<a name="l01993"></a>01993     keycombo-&gt;SetFocus();
<a name="l01994"></a>01994     keycombo-&gt;SetSelection(<a class="code" href="prefs_8cpp.html#ac4977c99d64fe0b792fb6b3ff9cab186">ALL_TEXT</a>);
<a name="l01995"></a>01995 
<a name="l01996"></a>01996     topSizer-&gt;Add(vbox, 1, wxGROW | wxALIGN_CENTER | wxALL, 5);
<a name="l01997"></a>01997     panel-&gt;SetSizer(topSizer);
<a name="l01998"></a>01998     topSizer-&gt;Fit(panel);
<a name="l01999"></a>01999     <span class="keywordflow">return</span> panel;
<a name="l02000"></a>02000 }
<a name="l02001"></a>02001 
<a name="l02002"></a>02002 <span class="comment">// -----------------------------------------------------------------------------</span>
<a name="l02003"></a>02003 
<a name="l02004"></a><a class="code" href="classPrefsDialog.html#aaff94d6e344082dc6c1991a7dd466dd4">02004</a> <span class="keywordtype">void</span> <a class="code" href="classPrefsDialog.html#aaff94d6e344082dc6c1991a7dd466dd4">PrefsDialog::UpdateChosenFile</a>()
<a name="l02005"></a>02005 {
<a name="l02006"></a>02006     wxStaticText* filebox = (wxStaticText*) FindWindowById(<a class="code" href="prefs_8cpp.html#abc6126af1d45847bc59afa0aa3216b04aa995dcceafdaa0951e58998d30cc7fe4">PREF_FILE_BOX</a>);
<a name="l02007"></a>02007     <span class="keywordflow">if</span> (filebox) {
<a name="l02008"></a>02008         <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62">action_id</a> action = keyaction[<a class="code" href="prefs_8cpp.html#aaacf1a77c10b6c97201e93054bf86843">currkey</a>][<a class="code" href="prefs_8cpp.html#a76d947d833846c69306f2bee3a6f9b9f">currmods</a>].<a class="code" href="structaction__info.html#aa8aa631cd84cd7672b7870e1af6e6863">id</a>;
<a name="l02009"></a>02009         <span class="keywordflow">if</span> (action == <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a143bfdd54d27e620ee14307ec3cbd989">DO_OPENFILE</a>) {
<a name="l02010"></a>02010             <span class="comment">// display current file name</span>
<a name="l02011"></a>02011             filebox-&gt;SetLabel(keyaction[currkey][currmods].file);
<a name="l02012"></a>02012         }
<a name="l02013"></a>02013         <span class="keywordflow">else</span> {
<a name="l02014"></a>02014             <span class="comment">// clear file name; don&#39;t set keyaction[currkey][currmods].file empty</span>
<a name="l02015"></a>02015             <span class="comment">// here because user might change their mind (TransferDataFromWindow</span>
<a name="l02016"></a>02016             <span class="comment">// will eventually set the file empty)</span>
<a name="l02017"></a>02017             filebox-&gt;SetLabel(wxEmptyString);
<a name="l02018"></a>02018         }
<a name="l02019"></a>02019     }
<a name="l02020"></a>02020 }
<a name="l02021"></a>02021 
<a name="l02022"></a>02022 <span class="comment">// -----------------------------------------------------------------------------</span>
<a name="l02023"></a>02023 
<a name="l02024"></a><a class="code" href="classPrefsDialog.html#aa616681ac6aad245fa92415ed839677e">02024</a> <span class="keywordtype">void</span> <a class="code" href="classPrefsDialog.html#aa616681ac6aad245fa92415ed839677e">PrefsDialog::OnChoice</a>(wxCommandEvent&amp; event)
<a name="l02025"></a>02025 {
<a name="l02026"></a>02026     <span class="keywordtype">int</span> <span class="keywordtype">id</span> = <span class="keyword">event</span>.GetId();
<a name="l02027"></a>02027 
<a name="l02028"></a>02028     <span class="keywordflow">if</span> ( <span class="keywordtype">id</span> == <a class="code" href="prefs_8cpp.html#abc6126af1d45847bc59afa0aa3216b04a19964575f179f798d3a112f25ed3df0c">PREF_ACTION</a> ) {
<a name="l02029"></a>02029         <span class="keywordtype">int</span> i = <span class="keyword">event</span>.GetSelection();
<a name="l02030"></a>02030         <span class="keywordflow">if</span> (i &gt;= 0 &amp;&amp; i &lt; <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a802dd62e3c2fc79809df7b338c095865">MAX_ACTIONS</a>) {
<a name="l02031"></a>02031             <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62">action_id</a> action = (<a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62">action_id</a>) i;
<a name="l02032"></a>02032             keyaction[<a class="code" href="prefs_8cpp.html#aaacf1a77c10b6c97201e93054bf86843">currkey</a>][<a class="code" href="prefs_8cpp.html#a76d947d833846c69306f2bee3a6f9b9f">currmods</a>].<a class="code" href="structaction__info.html#aa8aa631cd84cd7672b7870e1af6e6863">id</a> = action;
<a name="l02033"></a>02033             <span class="keywordflow">if</span> ( action == <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a143bfdd54d27e620ee14307ec3cbd989">DO_OPENFILE</a> &amp;&amp; keyaction[currkey][currmods].file.IsEmpty() ) {
<a name="l02034"></a>02034                 <span class="comment">// call OnButton (which will call UpdateChosenFile)</span>
<a name="l02035"></a>02035                 wxCommandEvent buttevt(wxEVT_COMMAND_BUTTON_CLICKED, <a class="code" href="prefs_8cpp.html#abc6126af1d45847bc59afa0aa3216b04acbeb709d0e949a0635dbfcefc595370b">PREF_CHOOSE</a>);
<a name="l02036"></a>02036                 <a class="code" href="classPrefsDialog.html#af9b84e2aeaeeaba1f8854cfc0e591308">OnButton</a>(buttevt);
<a name="l02037"></a>02037             } <span class="keywordflow">else</span> {
<a name="l02038"></a>02038                 <a class="code" href="classPrefsDialog.html#aaff94d6e344082dc6c1991a7dd466dd4">UpdateChosenFile</a>();
<a name="l02039"></a>02039             }
<a name="l02040"></a>02040         }
<a name="l02041"></a>02041     }
<a name="l02042"></a>02042 }
<a name="l02043"></a>02043 
<a name="l02044"></a>02044 <span class="comment">// -----------------------------------------------------------------------------</span>
<a name="l02045"></a>02045 
<a name="l02046"></a><a class="code" href="prefs_8hpp.html#a02ca260200a3047b1cd1f87c4b8d8eda">02046</a> <span class="keywordtype">void</span> <a class="code" href="prefs_8cpp.html#a02ca260200a3047b1cd1f87c4b8d8eda">ChooseTextEditor</a>(wxWindow* parent, wxString&amp; result)
<a name="l02047"></a>02047 {
<a name="l02048"></a>02048 <span class="preprocessor">    #ifdef __WXMSW__</span>
<a name="l02049"></a>02049 <span class="preprocessor"></span>        wxString filetypes = _(<span class="stringliteral">&quot;Applications (*.exe)|*.exe&quot;</span>);
<a name="l02050"></a>02050 <span class="preprocessor">    #elif defined(__WXMAC__)</span>
<a name="l02051"></a>02051 <span class="preprocessor"></span>        wxString filetypes = _(<span class="stringliteral">&quot;Applications (*.app)|*.app&quot;</span>);
<a name="l02052"></a>02052 <span class="preprocessor">    #else</span>
<a name="l02053"></a>02053 <span class="preprocessor"></span>        <span class="comment">// assume Linux</span>
<a name="l02054"></a>02054         wxString filetypes = _(<span class="stringliteral">&quot;All files (*)|*&quot;</span>);
<a name="l02055"></a>02055 <span class="preprocessor">    #endif</span>
<a name="l02056"></a>02056 <span class="preprocessor"></span>
<a name="l02057"></a>02057     wxFileDialog opendlg(parent, _(<span class="stringliteral">&quot;Choose a text editor&quot;</span>),
<a name="l02058"></a>02058     wxEmptyString, wxEmptyString, filetypes,
<a name="l02059"></a>02059     wxFD_OPEN | wxFD_FILE_MUST_EXIST);
<a name="l02060"></a>02060 
<a name="l02061"></a>02061 <span class="preprocessor">    #ifdef __WXMSW__</span>
<a name="l02062"></a>02062 <span class="preprocessor"></span>        opendlg.SetDirectory(_(<span class="stringliteral">&quot;C:\\Program Files&quot;</span>));
<a name="l02063"></a>02063 <span class="preprocessor">    #elif defined(__WXMAC__)</span>
<a name="l02064"></a>02064 <span class="preprocessor"></span>        opendlg.SetDirectory(_(<span class="stringliteral">&quot;/Applications&quot;</span>));
<a name="l02065"></a>02065 <span class="preprocessor">    #else</span>
<a name="l02066"></a>02066 <span class="preprocessor"></span>        <span class="comment">// assume Linux</span>
<a name="l02067"></a>02067         opendlg.SetDirectory(_(<span class="stringliteral">&quot;/usr/bin&quot;</span>));
<a name="l02068"></a>02068 <span class="preprocessor">    #endif</span>
<a name="l02069"></a>02069 <span class="preprocessor"></span>
<a name="l02070"></a>02070     <span class="keywordflow">if</span> ( opendlg.ShowModal() == wxID_OK ) {
<a name="l02071"></a>02071         result = opendlg.GetPath();
<a name="l02072"></a>02072     } <span class="keywordflow">else</span> {
<a name="l02073"></a>02073         result = wxEmptyString;
<a name="l02074"></a>02074     }
<a name="l02075"></a>02075 }
<a name="l02076"></a>02076 
<a name="l02077"></a>02077 <span class="comment">// -----------------------------------------------------------------------------</span>
<a name="l02078"></a>02078 
<a name="l02079"></a><a class="code" href="classPrefsDialog.html#af9b84e2aeaeeaba1f8854cfc0e591308">02079</a> <span class="keywordtype">void</span> <a class="code" href="classPrefsDialog.html#af9b84e2aeaeeaba1f8854cfc0e591308">PrefsDialog::OnButton</a>(wxCommandEvent&amp; event)
<a name="l02080"></a>02080 {
<a name="l02081"></a>02081     <span class="keywordtype">int</span> <span class="keywordtype">id</span> = <span class="keyword">event</span>.GetId();
<a name="l02082"></a>02082 
<a name="l02083"></a>02083     <span class="keywordflow">if</span> ( <span class="keywordtype">id</span> == <a class="code" href="prefs_8cpp.html#abc6126af1d45847bc59afa0aa3216b04acbeb709d0e949a0635dbfcefc595370b">PREF_CHOOSE</a> ) {
<a name="l02084"></a>02084         <span class="comment">// ask user to choose an appropriate file</span>
<a name="l02085"></a>02085         wxString filetypes = _(<span class="stringliteral">&quot;All files (*)|*&quot;</span>);
<a name="l02086"></a>02086         filetypes +=         _(<span class="stringliteral">&quot;|Pattern (*.vti)|*.vti&quot;</span>);
<a name="l02087"></a>02087         filetypes +=         _(<span class="stringliteral">&quot;|HTML (*.html;*.htm)|*.html;*.htm&quot;</span>);
<a name="l02088"></a>02088 
<a name="l02089"></a>02089         wxFileDialog opendlg(<span class="keyword">this</span>, _(<span class="stringliteral">&quot;Choose a pattern file or HTML file&quot;</span>),
<a name="l02090"></a>02090                              <a class="code" href="prefs_8cpp.html#a8bf37d7016c72a6f4df10b194849371a">choosedir</a>, wxEmptyString, filetypes,
<a name="l02091"></a>02091                              wxFD_OPEN | wxFD_FILE_MUST_EXIST);
<a name="l02092"></a>02092 <span class="preprocessor">    #ifdef __WXGTK__</span>
<a name="l02093"></a>02093 <span class="preprocessor"></span>        <span class="comment">// choosedir is ignored above (bug in wxGTK 2.8.0???)</span>
<a name="l02094"></a>02094         opendlg.SetDirectory(<a class="code" href="prefs_8cpp.html#a8bf37d7016c72a6f4df10b194849371a">choosedir</a>);
<a name="l02095"></a>02095 <span class="preprocessor">    #endif</span>
<a name="l02096"></a>02096 <span class="preprocessor"></span>        <span class="keywordflow">if</span> ( opendlg.ShowModal() == wxID_OK ) {
<a name="l02097"></a>02097             wxFileName fullpath( opendlg.GetPath() );
<a name="l02098"></a>02098             <a class="code" href="prefs_8cpp.html#a8bf37d7016c72a6f4df10b194849371a">choosedir</a> = fullpath.GetPath();
<a name="l02099"></a>02099             wxString path = opendlg.GetPath();
<a name="l02100"></a>02100             <span class="keywordflow">if</span> (path.StartsWith(<a class="code" href="prefs_8cpp.html#aa3af5b468230e51f15091c9f1410b2c4">readydir</a>)) {
<a name="l02101"></a>02101                 <span class="comment">// remove readydir from start of path</span>
<a name="l02102"></a>02102                 path.erase(0, <a class="code" href="prefs_8cpp.html#aa3af5b468230e51f15091c9f1410b2c4">readydir</a>.length());
<a name="l02103"></a>02103             }
<a name="l02104"></a>02104             keyaction[<a class="code" href="prefs_8cpp.html#aaacf1a77c10b6c97201e93054bf86843">currkey</a>][<a class="code" href="prefs_8cpp.html#a76d947d833846c69306f2bee3a6f9b9f">currmods</a>].<a class="code" href="structaction__info.html#aa467bd3685a2427efa3f49cae6df2301">file</a> = path;
<a name="l02105"></a>02105             keyaction[<a class="code" href="prefs_8cpp.html#aaacf1a77c10b6c97201e93054bf86843">currkey</a>][<a class="code" href="prefs_8cpp.html#a76d947d833846c69306f2bee3a6f9b9f">currmods</a>].<a class="code" href="structaction__info.html#aa8aa631cd84cd7672b7870e1af6e6863">id</a> = <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a143bfdd54d27e620ee14307ec3cbd989">DO_OPENFILE</a>;
<a name="l02106"></a>02106             wxChoice* actionmenu = (wxChoice*) FindWindowById(<a class="code" href="prefs_8cpp.html#abc6126af1d45847bc59afa0aa3216b04a19964575f179f798d3a112f25ed3df0c">PREF_ACTION</a>);
<a name="l02107"></a>02107             <span class="keywordflow">if</span> (actionmenu) {
<a name="l02108"></a>02108                 actionmenu-&gt;SetSelection(<a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a143bfdd54d27e620ee14307ec3cbd989">DO_OPENFILE</a>);
<a name="l02109"></a>02109             }
<a name="l02110"></a>02110         }
<a name="l02111"></a>02111 
<a name="l02112"></a>02112         <a class="code" href="classPrefsDialog.html#aaff94d6e344082dc6c1991a7dd466dd4">UpdateChosenFile</a>();
<a name="l02113"></a>02113 
<a name="l02114"></a>02114     }
<a name="l02115"></a>02115     <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( <span class="keywordtype">id</span> == <a class="code" href="prefs_8cpp.html#abc6126af1d45847bc59afa0aa3216b04a6340d6e469ce3321da69dd844bc28e4e">PREF_EDITOR_BUTT</a> ) {
<a name="l02116"></a>02116         <span class="comment">// ask user to choose a text editor</span>
<a name="l02117"></a>02117         wxString result;
<a name="l02118"></a>02118         <a class="code" href="prefs_8cpp.html#a02ca260200a3047b1cd1f87c4b8d8eda">ChooseTextEditor</a>(<span class="keyword">this</span>, result);
<a name="l02119"></a>02119         <span class="keywordflow">if</span> ( !result.IsEmpty() ) {
<a name="l02120"></a>02120             <a class="code" href="classPrefsDialog.html#ab70af43614d3d362387ac81eb4ddd98f">neweditor</a> = result;
<a name="l02121"></a>02121             wxStaticText* editorbox = (wxStaticText*) FindWindowById(<a class="code" href="prefs_8cpp.html#abc6126af1d45847bc59afa0aa3216b04a9555ecc0a874a07b0332ba282ba92814">PREF_EDITOR_BOX</a>);
<a name="l02122"></a>02122             <span class="keywordflow">if</span> (editorbox) {
<a name="l02123"></a>02123                 editorbox-&gt;SetLabel(<a class="code" href="classPrefsDialog.html#ab70af43614d3d362387ac81eb4ddd98f">neweditor</a>);
<a name="l02124"></a>02124             }
<a name="l02125"></a>02125         }
<a name="l02126"></a>02126 
<a name="l02127"></a>02127     }
<a name="l02128"></a>02128 
<a name="l02129"></a>02129     <span class="keyword">event</span>.Skip();   <span class="comment">// need this so other buttons work correctly</span>
<a name="l02130"></a>02130 }
<a name="l02131"></a>02131 
<a name="l02132"></a>02132 <span class="comment">// -----------------------------------------------------------------------------</span>
<a name="l02133"></a>02133 
<a name="l02134"></a><a class="code" href="classPrefsDialog.html#a52bb7a74d013acd38bd11f4b5ec48263">02134</a> <span class="keywordtype">void</span> <a class="code" href="classPrefsDialog.html#a52bb7a74d013acd38bd11f4b5ec48263">PrefsDialog::OnCheckBoxClicked</a>(wxCommandEvent&amp; event)
<a name="l02135"></a>02135 {
<a name="l02136"></a>02136     <span class="keywordtype">int</span> <span class="keywordtype">id</span> = <span class="keyword">event</span>.GetId();
<a name="l02137"></a>02137 
<a name="l02138"></a>02138     <span class="comment">// no need???</span>
<a name="l02139"></a>02139 }
<a name="l02140"></a>02140 
<a name="l02141"></a>02141 <span class="comment">// -----------------------------------------------------------------------------</span>
<a name="l02142"></a>02142 
<a name="l02143"></a><a class="code" href="classPrefsDialog.html#a0cb1ca864dbb4c9d6e10d002a9b13f69">02143</a> <span class="keywordtype">bool</span> <a class="code" href="classPrefsDialog.html#a0cb1ca864dbb4c9d6e10d002a9b13f69">PrefsDialog::GetCheckVal</a>(<span class="keywordtype">long</span> <span class="keywordtype">id</span>)
<a name="l02144"></a>02144 {
<a name="l02145"></a>02145     wxCheckBox* checkbox = (wxCheckBox*) FindWindow(<span class="keywordtype">id</span>);
<a name="l02146"></a>02146     <span class="keywordflow">if</span> (checkbox) {
<a name="l02147"></a>02147         <span class="keywordflow">return</span> checkbox-&gt;GetValue();
<a name="l02148"></a>02148     } <span class="keywordflow">else</span> {
<a name="l02149"></a>02149         <a class="code" href="wxutils_8cpp.html#ad496c0028843186f55032174260d2732">Warning</a>(_(<span class="stringliteral">&quot;Bug in GetCheckVal!&quot;</span>));
<a name="l02150"></a>02150         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l02151"></a>02151     }
<a name="l02152"></a>02152 }
<a name="l02153"></a>02153 
<a name="l02154"></a>02154 <span class="comment">// -----------------------------------------------------------------------------</span>
<a name="l02155"></a>02155 
<a name="l02156"></a><a class="code" href="classPrefsDialog.html#abc328e39f625c5ad941192a9aac76764">02156</a> <span class="keywordtype">int</span> <a class="code" href="classPrefsDialog.html#abc328e39f625c5ad941192a9aac76764">PrefsDialog::GetChoiceVal</a>(<span class="keywordtype">long</span> <span class="keywordtype">id</span>)
<a name="l02157"></a>02157 {
<a name="l02158"></a>02158     wxChoice* choice = (wxChoice*) FindWindow(<span class="keywordtype">id</span>);
<a name="l02159"></a>02159     <span class="keywordflow">if</span> (choice) {
<a name="l02160"></a>02160         <span class="keywordflow">return</span> choice-&gt;GetSelection();
<a name="l02161"></a>02161     } <span class="keywordflow">else</span> {
<a name="l02162"></a>02162         <a class="code" href="wxutils_8cpp.html#ad496c0028843186f55032174260d2732">Warning</a>(_(<span class="stringliteral">&quot;Bug in GetChoiceVal!&quot;</span>));
<a name="l02163"></a>02163         <span class="keywordflow">return</span> 0;
<a name="l02164"></a>02164     }
<a name="l02165"></a>02165 }
<a name="l02166"></a>02166 
<a name="l02167"></a>02167 <span class="comment">// -----------------------------------------------------------------------------</span>
<a name="l02168"></a>02168 
<a name="l02169"></a><a class="code" href="classPrefsDialog.html#a4119129237bfe2086489d2a2f2f1bf42">02169</a> <span class="keywordtype">int</span> <a class="code" href="classPrefsDialog.html#a4119129237bfe2086489d2a2f2f1bf42">PrefsDialog::GetRadioVal</a>(<span class="keywordtype">long</span> firstid, <span class="keywordtype">int</span> numbuttons)
<a name="l02170"></a>02170 {
<a name="l02171"></a>02171     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; numbuttons; i++) {
<a name="l02172"></a>02172         wxRadioButton* radio = (wxRadioButton*) FindWindow(firstid + i);
<a name="l02173"></a>02173         <span class="keywordflow">if</span> (radio-&gt;GetValue()) <span class="keywordflow">return</span> i;
<a name="l02174"></a>02174     }
<a name="l02175"></a>02175     <a class="code" href="wxutils_8cpp.html#ad496c0028843186f55032174260d2732">Warning</a>(_(<span class="stringliteral">&quot;Bug in GetRadioVal!&quot;</span>));
<a name="l02176"></a>02176     <span class="keywordflow">return</span> 0;
<a name="l02177"></a>02177 }
<a name="l02178"></a>02178 
<a name="l02179"></a>02179 <span class="comment">// -----------------------------------------------------------------------------</span>
<a name="l02180"></a>02180 
<a name="l02181"></a><a class="code" href="classPrefsDialog.html#a238aef45dbe2a7fd3f7775ffb057f7e0">02181</a> <span class="keywordtype">int</span> <a class="code" href="classPrefsDialog.html#a238aef45dbe2a7fd3f7775ffb057f7e0">PrefsDialog::GetSpinVal</a>(<span class="keywordtype">long</span> <span class="keywordtype">id</span>)
<a name="l02182"></a>02182 {
<a name="l02183"></a>02183     wxSpinCtrl* spinctrl = (wxSpinCtrl*) FindWindow(<span class="keywordtype">id</span>);
<a name="l02184"></a>02184     <span class="keywordflow">if</span> (spinctrl) {
<a name="l02185"></a>02185         <span class="keywordflow">return</span> spinctrl-&gt;GetValue();
<a name="l02186"></a>02186     } <span class="keywordflow">else</span> {
<a name="l02187"></a>02187         <a class="code" href="wxutils_8cpp.html#ad496c0028843186f55032174260d2732">Warning</a>(_(<span class="stringliteral">&quot;Bug in GetSpinVal!&quot;</span>));
<a name="l02188"></a>02188         <span class="keywordflow">return</span> 0;
<a name="l02189"></a>02189     }
<a name="l02190"></a>02190 }
<a name="l02191"></a>02191 
<a name="l02192"></a>02192 <span class="comment">// -----------------------------------------------------------------------------</span>
<a name="l02193"></a>02193 
<a name="l02194"></a><a class="code" href="classPrefsDialog.html#a6fb95b44d3053ec680c00717b41a1157">02194</a> <span class="keywordtype">bool</span> <a class="code" href="classPrefsDialog.html#a6fb95b44d3053ec680c00717b41a1157">PrefsDialog::BadSpinVal</a>(<span class="keywordtype">int</span> <span class="keywordtype">id</span>, <span class="keywordtype">int</span> minval, <span class="keywordtype">int</span> maxval, <span class="keyword">const</span> wxString&amp; prefix)
<a name="l02195"></a>02195 {
<a name="l02196"></a>02196     wxSpinCtrl* spinctrl = (wxSpinCtrl*) FindWindow(<span class="keywordtype">id</span>);
<a name="l02197"></a>02197 <span class="preprocessor">#if defined(__WXMSW__) || defined(__WXGTK__)</span>
<a name="l02198"></a>02198 <span class="preprocessor"></span>    <span class="comment">// spinctrl-&gt;GetValue() always returns a value within range even if</span>
<a name="l02199"></a>02199     <span class="comment">// the text ctrl doesn&#39;t contain a valid number -- yuk!</span>
<a name="l02200"></a>02200     <span class="keywordtype">int</span> i = spinctrl-&gt;GetValue();
<a name="l02201"></a>02201     <span class="keywordflow">if</span> (i &lt; minval || i &gt; maxval)
<a name="l02202"></a>02202 <span class="preprocessor">#else</span>
<a name="l02203"></a>02203 <span class="preprocessor"></span>    <span class="comment">// GetTextValue returns FALSE if text ctrl doesn&#39;t contain a valid number</span>
<a name="l02204"></a>02204     <span class="comment">// or the number is out of range, but it&#39;s not available in wxMSW or wxGTK</span>
<a name="l02205"></a>02205     <span class="keywordtype">int</span> i;
<a name="l02206"></a>02206     <span class="keywordflow">if</span> ( !spinctrl-&gt;GetTextValue(&amp;i) || i &lt; minval || i &gt; maxval )
<a name="l02207"></a>02207 #endif
<a name="l02208"></a>02208     {
<a name="l02209"></a>02209         wxString msg;
<a name="l02210"></a>02210         msg.Printf(_(<span class="stringliteral">&quot;%s must be from %d to %d.&quot;</span>), prefix.c_str(), minval, maxval);
<a name="l02211"></a>02211         <a class="code" href="wxutils_8cpp.html#ad496c0028843186f55032174260d2732">Warning</a>(msg);
<a name="l02212"></a>02212         spinctrl-&gt;SetFocus();
<a name="l02213"></a>02213         spinctrl-&gt;SetSelection(<a class="code" href="prefs_8cpp.html#ac4977c99d64fe0b792fb6b3ff9cab186">ALL_TEXT</a>);
<a name="l02214"></a>02214         <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l02215"></a>02215     } <span class="keywordflow">else</span> {
<a name="l02216"></a>02216         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l02217"></a>02217     }
<a name="l02218"></a>02218 }
<a name="l02219"></a>02219 
<a name="l02220"></a>02220 <span class="comment">// -----------------------------------------------------------------------------</span>
<a name="l02221"></a>02221 
<a name="l02222"></a><a class="code" href="classPrefsDialog.html#aa8a53cb28f7fc37c69c5b63d5e0ffe7e">02222</a> <span class="keywordtype">bool</span> <a class="code" href="classPrefsDialog.html#aa8a53cb28f7fc37c69c5b63d5e0ffe7e">PrefsDialog::ValidatePage</a>()
<a name="l02223"></a>02223 {
<a name="l02224"></a>02224     <span class="comment">// validate all spin control values on current page</span>
<a name="l02225"></a>02225     <span class="keywordflow">if</span> (currpage == <a class="code" href="prefs_8cpp.html#a99fb83031ce9923c84392b4e92f956b5a6c75fb9088aa1e821b14551cff631b0b">FILE_PAGE</a>) {
<a name="l02226"></a>02226         <span class="keywordflow">if</span> ( <a class="code" href="classPrefsDialog.html#a6fb95b44d3053ec680c00717b41a1157">BadSpinVal</a>(<a class="code" href="prefs_8cpp.html#abc6126af1d45847bc59afa0aa3216b04ac528b6e272d252b4eaa82b28ea62c85f">PREF_MAX_PATTERNS</a>, 1, <a class="code" href="namespaceID.html#add26a31edd435929e305eca022a899d0">ID::MAX_RECENT</a>, _(<span class="stringliteral">&quot;Maximum number of recent patterns&quot;</span>)) )
<a name="l02227"></a>02227             <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l02228"></a>02228     
<a name="l02229"></a>02229     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (currpage == <a class="code" href="prefs_8cpp.html#a99fb83031ce9923c84392b4e92f956b5ab2000382ee96091a0f199de2c23f93dc">EDIT_PAGE</a>) {
<a name="l02230"></a>02230         <span class="comment">// no spin ctrls on this page</span>
<a name="l02231"></a>02231     
<a name="l02232"></a>02232     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (currpage == <a class="code" href="prefs_8cpp.html#a99fb83031ce9923c84392b4e92f956b5a5c4a8b972182ff89076d34c67e15ff37">VIEW_PAGE</a>) {
<a name="l02233"></a>02233         <span class="comment">// no spin ctrls on this page</span>
<a name="l02234"></a>02234     
<a name="l02235"></a>02235     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (currpage == <a class="code" href="prefs_8cpp.html#a99fb83031ce9923c84392b4e92f956b5ae6193528cfdfbc97479fe6ef2ff962f6">ACTION_PAGE</a>) {
<a name="l02236"></a>02236         <span class="comment">// no spin ctrls on this page</span>
<a name="l02237"></a>02237 
<a name="l02238"></a>02238     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (currpage == <a class="code" href="prefs_8cpp.html#a99fb83031ce9923c84392b4e92f956b5a36b5ca67ee4b41c8df6806befb820e86">KEYBOARD_PAGE</a>) {
<a name="l02239"></a>02239         <span class="comment">// no spin ctrls on this page</span>
<a name="l02240"></a>02240 
<a name="l02241"></a>02241     } <span class="keywordflow">else</span> {
<a name="l02242"></a>02242         <a class="code" href="wxutils_8cpp.html#ad496c0028843186f55032174260d2732">Warning</a>(_(<span class="stringliteral">&quot;Bug in ValidatePage!&quot;</span>));
<a name="l02243"></a>02243         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l02244"></a>02244     }
<a name="l02245"></a>02245 
<a name="l02246"></a>02246     <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l02247"></a>02247 }
<a name="l02248"></a>02248 
<a name="l02249"></a>02249 <span class="comment">// -----------------------------------------------------------------------------</span>
<a name="l02250"></a>02250 
<a name="l02251"></a><a class="code" href="classPrefsDialog.html#abe9b8634a5026cafb9e61ea3f4ba04c6">02251</a> <span class="keywordtype">void</span> <a class="code" href="classPrefsDialog.html#abe9b8634a5026cafb9e61ea3f4ba04c6">PrefsDialog::OnPageChanging</a>(wxNotebookEvent&amp; event)
<a name="l02252"></a>02252 {
<a name="l02253"></a>02253     <span class="keywordflow">if</span> (<a class="code" href="classPrefsDialog.html#acf48c0cdb1d05cc17d1ef3ff9dd10d94">ignore_page_event</a>) <span class="keywordflow">return</span>;
<a name="l02254"></a>02254     <span class="comment">// validate current page and veto change if invalid</span>
<a name="l02255"></a>02255     <span class="keywordflow">if</span> (!<a class="code" href="classPrefsDialog.html#aa8a53cb28f7fc37c69c5b63d5e0ffe7e">ValidatePage</a>()) <span class="keyword">event</span>.Veto();
<a name="l02256"></a>02256 }
<a name="l02257"></a>02257 
<a name="l02258"></a>02258 <span class="comment">// -----------------------------------------------------------------------------</span>
<a name="l02259"></a>02259 
<a name="l02260"></a><a class="code" href="classPrefsDialog.html#a02875d51a2e8e80fb94f5c5d021971dc">02260</a> <span class="keywordtype">void</span> <a class="code" href="classPrefsDialog.html#a02875d51a2e8e80fb94f5c5d021971dc">PrefsDialog::OnPageChanged</a>(wxNotebookEvent&amp; event)
<a name="l02261"></a>02261 {
<a name="l02262"></a>02262     <span class="keywordflow">if</span> (<a class="code" href="classPrefsDialog.html#acf48c0cdb1d05cc17d1ef3ff9dd10d94">ignore_page_event</a>) <span class="keywordflow">return</span>;
<a name="l02263"></a>02263     currpage = <span class="keyword">event</span>.GetSelection();
<a name="l02264"></a>02264 
<a name="l02265"></a>02265 <span class="preprocessor">#ifdef __WXMSW__</span>
<a name="l02266"></a>02266 <span class="preprocessor"></span>    <span class="comment">// ensure key combo box has focus</span>
<a name="l02267"></a>02267     <span class="keywordflow">if</span> (currpage == <a class="code" href="prefs_8cpp.html#a99fb83031ce9923c84392b4e92f956b5a36b5ca67ee4b41c8df6806befb820e86">KEYBOARD_PAGE</a>) {
<a name="l02268"></a>02268         <a class="code" href="classKeyComboCtrl.html">KeyComboCtrl</a>* keycombo = (<a class="code" href="classKeyComboCtrl.html">KeyComboCtrl</a>*) FindWindowById(<a class="code" href="prefs_8cpp.html#abc6126af1d45847bc59afa0aa3216b04a54200275e98be6a4e4d615407411a1a7">PREF_KEYCOMBO</a>);
<a name="l02269"></a>02269         <span class="keywordflow">if</span> (keycombo) {
<a name="l02270"></a>02270             keycombo-&gt;SetFocus();
<a name="l02271"></a>02271             keycombo-&gt;SetSelection(<a class="code" href="prefs_8cpp.html#ac4977c99d64fe0b792fb6b3ff9cab186">ALL_TEXT</a>);
<a name="l02272"></a>02272         }
<a name="l02273"></a>02273     }
<a name="l02274"></a>02274 <span class="preprocessor">#endif</span>
<a name="l02275"></a>02275 <span class="preprocessor"></span>}
<a name="l02276"></a>02276 
<a name="l02277"></a>02277 <span class="comment">// -----------------------------------------------------------------------------</span>
<a name="l02278"></a>02278 
<a name="l02279"></a><a class="code" href="classPrefsDialog.html#ae0763000443b9e4bea57ffb1baa0002c">02279</a> <span class="keywordtype">bool</span> <a class="code" href="classPrefsDialog.html#ae0763000443b9e4bea57ffb1baa0002c">PrefsDialog::TransferDataFromWindow</a>()
<a name="l02280"></a>02280 {
<a name="l02281"></a>02281     <span class="keywordflow">if</span> (!<a class="code" href="classPrefsDialog.html#aa8a53cb28f7fc37c69c5b63d5e0ffe7e">ValidatePage</a>()) <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l02282"></a>02282 
<a name="l02283"></a>02283     <span class="comment">// set global prefs to current control values</span>
<a name="l02284"></a>02284 
<a name="l02285"></a>02285     <span class="comment">// FILE_PAGE</span>
<a name="l02286"></a>02286     <a class="code" href="prefs_8cpp.html#af74247065dccdcbc74c5e1b8dc09e01c">maxpatterns</a>   = <a class="code" href="classPrefsDialog.html#a238aef45dbe2a7fd3f7775ffb057f7e0">GetSpinVal</a>(<a class="code" href="prefs_8cpp.html#abc6126af1d45847bc59afa0aa3216b04ac528b6e272d252b4eaa82b28ea62c85f">PREF_MAX_PATTERNS</a>);
<a name="l02287"></a>02287     <a class="code" href="prefs_8cpp.html#a3a8c57e4e1beb747c341e067dc8869bf">texteditor</a>    = <a class="code" href="classPrefsDialog.html#ab70af43614d3d362387ac81eb4ddd98f">neweditor</a>;
<a name="l02288"></a>02288 
<a name="l02289"></a>02289     <span class="comment">// EDIT_PAGE</span>
<a name="l02290"></a>02290     <a class="code" href="prefs_8cpp.html#a12fa8d7d57fa0c4eab03e55cb31d3ca1">repaint_to_erase</a> = <a class="code" href="classPrefsDialog.html#a0cb1ca864dbb4c9d6e10d002a9b13f69">GetCheckVal</a>(<a class="code" href="prefs_8cpp.html#abc6126af1d45847bc59afa0aa3216b04adae37cf8a27c006e510ea97f602d6eed">PREF_ERASE</a>);
<a name="l02291"></a>02291     <a class="code" href="prefs_8cpp.html#a68723f2f0bf26bff2564c1af8aa80d22">allowbeep</a>     = <a class="code" href="classPrefsDialog.html#a0cb1ca864dbb4c9d6e10d002a9b13f69">GetCheckVal</a>(<a class="code" href="prefs_8cpp.html#abc6126af1d45847bc59afa0aa3216b04a29b8515407b4085d812758d22f7ab6b9">PREF_BEEP</a>);
<a name="l02292"></a>02292 
<a name="l02293"></a>02293     <span class="comment">// VIEW_PAGE</span>
<a name="l02294"></a>02294 <span class="preprocessor">    #if wxUSE_TOOLTIPS</span>
<a name="l02295"></a>02295 <span class="preprocessor"></span>        <a class="code" href="prefs_8cpp.html#af831ab3ffe0ee800c61d7a73b2873ce3">showtips</a> = <a class="code" href="classPrefsDialog.html#a0cb1ca864dbb4c9d6e10d002a9b13f69">GetCheckVal</a>(<a class="code" href="prefs_8cpp.html#abc6126af1d45847bc59afa0aa3216b04a9acefbbd3767c6640a5f6b168847e6fb">PREF_SHOW_TIPS</a>);
<a name="l02296"></a>02296         wxToolTip::Enable(<a class="code" href="prefs_8cpp.html#af831ab3ffe0ee800c61d7a73b2873ce3">showtips</a>);
<a name="l02297"></a>02297 <span class="preprocessor">    #endif</span>
<a name="l02298"></a>02298 <span class="preprocessor"></span>
<a name="l02299"></a>02299     <span class="comment">// ACTION_PAGE</span>
<a name="l02300"></a>02300     <span class="comment">// nothing yet</span>
<a name="l02301"></a>02301 
<a name="l02302"></a>02302     <span class="comment">// KEYBOARD_PAGE</span>
<a name="l02303"></a>02303     <span class="comment">// go thru keyaction table and make sure the file field is empty</span>
<a name="l02304"></a>02304     <span class="comment">// if the action isn&#39;t DO_OPENFILE</span>
<a name="l02305"></a>02305     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> key = 0; key &lt; <a class="code" href="prefs_8cpp.html#a85c7a27ef78976422a68cf49a99bd589">MAX_KEYCODES</a>; key++)
<a name="l02306"></a>02306         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> modset = 0; modset &lt; <a class="code" href="prefs_8cpp.html#a91ac701426603f585619c7a4be1b3f6d">MAX_MODS</a>; modset++)
<a name="l02307"></a>02307             <span class="keywordflow">if</span> ( keyaction[key][modset].<span class="keywordtype">id</span> != <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a143bfdd54d27e620ee14307ec3cbd989">DO_OPENFILE</a> &amp;&amp;
<a name="l02308"></a>02308                  !keyaction[key][modset].file.IsEmpty() )
<a name="l02309"></a>02309                 keyaction[key][modset].file = wxEmptyString;
<a name="l02310"></a>02310 
<a name="l02311"></a>02311     <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l02312"></a>02312 }
<a name="l02313"></a>02313 
<a name="l02314"></a>02314 <span class="comment">// -----------------------------------------------------------------------------</span>
<a name="l02315"></a>02315 
<a name="l02316"></a><a class="code" href="prefs_8hpp.html#a64b9ee51f62e15bc2969519122d85e25">02316</a> <span class="keywordtype">bool</span> <a class="code" href="prefs_8cpp.html#a64b9ee51f62e15bc2969519122d85e25">ChangePrefs</a>(<span class="keyword">const</span> wxString&amp; page)
<a name="l02317"></a>02317 {
<a name="l02318"></a>02318     <span class="comment">// save current keyboard shortcuts so we can restore them or detect a change</span>
<a name="l02319"></a>02319     <a class="code" href="structaction__info.html">action_info</a> savekeyaction[<a class="code" href="prefs_8cpp.html#a85c7a27ef78976422a68cf49a99bd589">MAX_KEYCODES</a>][<a class="code" href="prefs_8cpp.html#a91ac701426603f585619c7a4be1b3f6d">MAX_MODS</a>];
<a name="l02320"></a>02320     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> key = 0; key &lt; <a class="code" href="prefs_8cpp.html#a85c7a27ef78976422a68cf49a99bd589">MAX_KEYCODES</a>; key++)
<a name="l02321"></a>02321         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> modset = 0; modset &lt; <a class="code" href="prefs_8cpp.html#a91ac701426603f585619c7a4be1b3f6d">MAX_MODS</a>; modset++)
<a name="l02322"></a>02322             savekeyaction[key][modset] = keyaction[key][modset];
<a name="l02323"></a>02323     
<a name="l02324"></a>02324     <a class="code" href="classMyFrame.html" title="The wxFrame-derived top-level window for the Ready GUI.">MyFrame</a>* frameptr = wxGetApp().currframe;
<a name="l02325"></a>02325     
<a name="l02326"></a>02326     <a class="code" href="classPrefsDialog.html">PrefsDialog</a> dialog(frameptr, page);
<a name="l02327"></a>02327 
<a name="l02328"></a>02328     <span class="keywordtype">bool</span> result;
<a name="l02329"></a>02329     <span class="keywordflow">if</span> (dialog.ShowModal() == wxID_OK) {
<a name="l02330"></a>02330         <span class="comment">// TransferDataFromWindow has validated and updated all global prefs</span>
<a name="l02331"></a>02331         
<a name="l02332"></a>02332         <span class="comment">// if a keyboard shortcut changed then update menu item accelerators</span>
<a name="l02333"></a>02333         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> key = 0; key &lt; <a class="code" href="prefs_8cpp.html#a85c7a27ef78976422a68cf49a99bd589">MAX_KEYCODES</a>; key++)
<a name="l02334"></a>02334             <span class="keywordflow">for</span> (<span class="keywordtype">int</span> modset = 0; modset &lt; <a class="code" href="prefs_8cpp.html#a91ac701426603f585619c7a4be1b3f6d">MAX_MODS</a>; modset++)
<a name="l02335"></a>02335                 <span class="keywordflow">if</span> (savekeyaction[key][modset].<span class="keywordtype">id</span> != keyaction[key][modset].<span class="keywordtype">id</span>) {
<a name="l02336"></a>02336                     <span class="comment">// first update accelerator array</span>
<a name="l02337"></a>02337                     <a class="code" href="prefs_8cpp.html#a3b1ae22a369445497a51790d57de407c">UpdateAcceleratorStrings</a>();
<a name="l02338"></a>02338                     <span class="keywordflow">goto</span> done;
<a name="l02339"></a>02339                 }
<a name="l02340"></a>02340         done:
<a name="l02341"></a>02341 
<a name="l02342"></a>02342         <span class="comment">// if maxpatterns was reduced then we may need to remove some paths</span>
<a name="l02343"></a>02343         <span class="keywordflow">while</span> (<a class="code" href="prefs_8cpp.html#a17a3671114d042df36485b7cf3a80840">numpatterns</a> &gt; <a class="code" href="prefs_8cpp.html#af74247065dccdcbc74c5e1b8dc09e01c">maxpatterns</a>) {
<a name="l02344"></a>02344             <a class="code" href="prefs_8cpp.html#a17a3671114d042df36485b7cf3a80840">numpatterns</a>--;
<a name="l02345"></a>02345             <a class="code" href="prefs_8cpp.html#ae5246b1632294beb0e04a2942722d304">patternSubMenu</a>-&gt;Delete( <a class="code" href="prefs_8cpp.html#ae5246b1632294beb0e04a2942722d304">patternSubMenu</a>-&gt;FindItemByPosition(<a class="code" href="prefs_8cpp.html#a17a3671114d042df36485b7cf3a80840">numpatterns</a>) );
<a name="l02346"></a>02346         }
<a name="l02347"></a>02347 
<a name="l02348"></a>02348         result = <span class="keyword">true</span>;
<a name="l02349"></a>02349     }
<a name="l02350"></a>02350     <span class="keywordflow">else</span> {
<a name="l02351"></a>02351         <span class="comment">// user hit Cancel, so restore keyaction array in case it was changed</span>
<a name="l02352"></a>02352         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> key = 0; key &lt; <a class="code" href="prefs_8cpp.html#a85c7a27ef78976422a68cf49a99bd589">MAX_KEYCODES</a>; key++)
<a name="l02353"></a>02353             <span class="keywordflow">for</span> (<span class="keywordtype">int</span> modset = 0; modset &lt; <a class="code" href="prefs_8cpp.html#a91ac701426603f585619c7a4be1b3f6d">MAX_MODS</a>; modset++)
<a name="l02354"></a>02354                 keyaction[key][modset] = savekeyaction[key][modset];
<a name="l02355"></a>02355 
<a name="l02356"></a>02356         result = <span class="keyword">false</span>;
<a name="l02357"></a>02357     }
<a name="l02358"></a>02358     
<a name="l02359"></a>02359     frameptr-&gt;<a class="code" href="classMyFrame.html#a2fb74621355633ddff14d83943003550">UpdateMenuAccelerators</a>();
<a name="l02360"></a>02360 
<a name="l02361"></a>02361     <span class="keywordflow">return</span> result;
<a name="l02362"></a>02362 }
</pre></div></div><!-- contents -->


<hr class="footer"/><address class="footer"><small>
Generated on Wed Nov 21 2012 17:35:47 for Ready by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.0
</small></address>

</body>
</html>
