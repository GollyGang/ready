<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>Ready: gui/frame.cpp Source File</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />

<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  <td id="projectlogo"><img alt="Logo" src="logo.png"/></td>
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">Ready
   &#160;<span id="projectnumber">0.3</span>
   </div>
   <div id="projectbrief">A cross-platform implementation of various reaction-diffusion systems.</div>
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.8.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="dir_11bc0974ce736ce9a6fadebbeb7a8314.html">gui</a>      </li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<div class="title">frame.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="frame_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/*  Copyright 2011, 2012 The Ready Bunch</span>
<a name="l00002"></a>00002 <span class="comment"></span>
<a name="l00003"></a>00003 <span class="comment">    This file is part of Ready.</span>
<a name="l00004"></a>00004 <span class="comment"></span>
<a name="l00005"></a>00005 <span class="comment">    Ready is free software: you can redistribute it and/or modify</span>
<a name="l00006"></a>00006 <span class="comment">    it under the terms of the GNU General Public License as published by</span>
<a name="l00007"></a>00007 <span class="comment">    the Free Software Foundation, either version 3 of the License, or</span>
<a name="l00008"></a>00008 <span class="comment">    (at your option) any later version.</span>
<a name="l00009"></a>00009 <span class="comment"></span>
<a name="l00010"></a>00010 <span class="comment">    Ready is distributed in the hope that it will be useful,</span>
<a name="l00011"></a>00011 <span class="comment">    but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<a name="l00012"></a>00012 <span class="comment">    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the</span>
<a name="l00013"></a>00013 <span class="comment">    GNU General Public License for more details.</span>
<a name="l00014"></a>00014 <span class="comment"></span>
<a name="l00015"></a>00015 <span class="comment">    You should have received a copy of the GNU General Public License</span>
<a name="l00016"></a>00016 <span class="comment">    along with Ready. If not, see &lt;http://www.gnu.org/licenses/&gt;.         */</span>
<a name="l00017"></a>00017 
<a name="l00018"></a>00018 <span class="comment">// local:</span>
<a name="l00019"></a>00019 <span class="preprocessor">#include &quot;<a class="code" href="frame_8hpp.html">frame.hpp</a>&quot;</span>
<a name="l00020"></a>00020 <span class="preprocessor">#include &quot;<a class="code" href="app_8hpp.html">app.hpp</a>&quot;</span>              <span class="comment">// for wxGetApp</span>
<a name="l00021"></a>00021 <span class="preprocessor">#include &quot;<a class="code" href="wxutils_8hpp.html">wxutils.hpp</a>&quot;</span>
<a name="l00022"></a>00022 <span class="preprocessor">#include &quot;<a class="code" href="prefs_8hpp.html">prefs.hpp</a>&quot;</span>            <span class="comment">// for GetPrefs, SavePrefs, etc</span>
<a name="l00023"></a>00023 <span class="preprocessor">#include &quot;<a class="code" href="PatternsPanel_8hpp.html">PatternsPanel.hpp</a>&quot;</span>
<a name="l00024"></a>00024 <span class="preprocessor">#include &quot;<a class="code" href="InfoPanel_8hpp.html">InfoPanel.hpp</a>&quot;</span>
<a name="l00025"></a>00025 <span class="preprocessor">#include &quot;<a class="code" href="HelpPanel_8hpp.html">HelpPanel.hpp</a>&quot;</span>
<a name="l00026"></a>00026 <span class="preprocessor">#include &quot;<a class="code" href="IDs_8hpp.html">IDs.hpp</a>&quot;</span>
<a name="l00027"></a>00027 <span class="preprocessor">#include &quot;<a class="code" href="vtk__pipeline_8hpp.html">vtk_pipeline.hpp</a>&quot;</span>
<a name="l00028"></a>00028 <span class="preprocessor">#include &quot;<a class="code" href="dialogs_8hpp.html">dialogs.hpp</a>&quot;</span>
<a name="l00029"></a>00029 <span class="preprocessor">#include &quot;<a class="code" href="RecordingDialog_8hpp.html">RecordingDialog.hpp</a>&quot;</span>
<a name="l00030"></a>00030 
<a name="l00031"></a>00031 <span class="comment">// readybase:</span>
<a name="l00032"></a>00032 <span class="preprocessor">#include &quot;<a class="code" href="utils_8hpp.html">utils.hpp</a>&quot;</span>
<a name="l00033"></a>00033 <span class="preprocessor">#include &quot;<a class="code" href="GrayScottImageRD_8hpp.html">GrayScottImageRD.hpp</a>&quot;</span>
<a name="l00034"></a>00034 <span class="preprocessor">#include &quot;<a class="code" href="OpenCL__utils_8hpp.html">OpenCL_utils.hpp</a>&quot;</span>
<a name="l00035"></a>00035 <span class="preprocessor">#include &quot;<a class="code" href="IO__XML_8hpp.html">IO_XML.hpp</a>&quot;</span>
<a name="l00036"></a>00036 <span class="preprocessor">#include &quot;<a class="code" href="GrayScottMeshRD_8hpp.html">GrayScottMeshRD.hpp</a>&quot;</span>
<a name="l00037"></a>00037 <span class="preprocessor">#include &quot;<a class="code" href="FormulaOpenCLImageRD_8hpp.html">FormulaOpenCLImageRD.hpp</a>&quot;</span>
<a name="l00038"></a>00038 <span class="preprocessor">#include &quot;<a class="code" href="FullKernelOpenCLImageRD_8hpp.html">FullKernelOpenCLImageRD.hpp</a>&quot;</span>
<a name="l00039"></a>00039 <span class="preprocessor">#include &quot;<a class="code" href="FormulaOpenCLMeshRD_8hpp.html">FormulaOpenCLMeshRD.hpp</a>&quot;</span>
<a name="l00040"></a>00040 <span class="preprocessor">#include &quot;<a class="code" href="FullKernelOpenCLMeshRD_8hpp.html">FullKernelOpenCLMeshRD.hpp</a>&quot;</span>
<a name="l00041"></a>00041 <span class="preprocessor">#include &quot;<a class="code" href="MeshGenerators_8hpp.html">MeshGenerators.hpp</a>&quot;</span>
<a name="l00042"></a>00042 
<a name="l00043"></a>00043 <span class="comment">// local resources:</span>
<a name="l00044"></a>00044 <span class="preprocessor">#include &quot;appicon16.xpm&quot;</span>
<a name="l00045"></a>00045 
<a name="l00046"></a>00046 <span class="comment">// wxWidgets:</span>
<a name="l00047"></a>00047 <span class="preprocessor">#include &lt;wx/config.h&gt;</span>
<a name="l00048"></a>00048 <span class="preprocessor">#include &lt;wx/aboutdlg.h&gt;</span>
<a name="l00049"></a>00049 <span class="preprocessor">#include &lt;wx/filename.h&gt;</span>
<a name="l00050"></a>00050 <span class="preprocessor">#include &lt;wx/font.h&gt;</span>
<a name="l00051"></a>00051 <span class="preprocessor">#include &lt;wx/dir.h&gt;</span>
<a name="l00052"></a>00052 <span class="preprocessor">#include &lt;wx/dnd.h&gt;</span>             <span class="comment">// for wxFileDropTarget</span>
<a name="l00053"></a>00053 <span class="preprocessor">#include &lt;wx/artprov.h&gt;</span>
<a name="l00054"></a>00054 <span class="preprocessor">#if wxUSE_TOOLTIPS</span>
<a name="l00055"></a>00055 <span class="preprocessor"></span><span class="preprocessor">   #include &quot;wx/tooltip.h&quot;</span>      <span class="comment">// for wxToolTip</span>
<a name="l00056"></a>00056 <span class="preprocessor">#endif</span>
<a name="l00057"></a>00057 <span class="preprocessor"></span><span class="preprocessor">#include &lt;wx/choicdlg.h&gt;</span>
<a name="l00058"></a>00058 
<a name="l00059"></a>00059 <span class="comment">// wxVTK: (local copy)</span>
<a name="l00060"></a>00060 <span class="preprocessor">#include &quot;<a class="code" href="wxVTKRenderWindowInteractor_8h.html">wxVTKRenderWindowInteractor.h</a>&quot;</span>
<a name="l00061"></a>00061 
<a name="l00062"></a>00062 <span class="comment">// STL:</span>
<a name="l00063"></a>00063 <span class="preprocessor">#include &lt;fstream&gt;</span>
<a name="l00064"></a>00064 <span class="preprocessor">#include &lt;string&gt;</span>
<a name="l00065"></a>00065 <span class="preprocessor">#include &lt;stdexcept&gt;</span>
<a name="l00066"></a>00066 <span class="preprocessor">#include &lt;algorithm&gt;</span>
<a name="l00067"></a>00067 <span class="keyword">using namespace </span>std;
<a name="l00068"></a>00068 
<a name="l00069"></a>00069 <span class="comment">// VTK:</span>
<a name="l00070"></a>00070 <span class="preprocessor">#include &lt;vtkWindowToImageFilter.h&gt;</span>
<a name="l00071"></a>00071 <span class="preprocessor">#include &lt;vtkPNGWriter.h&gt;</span>
<a name="l00072"></a>00072 <span class="preprocessor">#include &lt;vtkJPEGWriter.h&gt;</span>
<a name="l00073"></a>00073 <span class="preprocessor">#include &lt;vtkSmartPointer.h&gt;</span>
<a name="l00074"></a>00074 <span class="preprocessor">#include &lt;vtkXMLPolyDataReader.h&gt;</span>
<a name="l00075"></a>00075 <span class="preprocessor">#include &lt;vtkUnstructuredGrid.h&gt;</span>
<a name="l00076"></a>00076 <span class="preprocessor">#include &lt;vtkPolyData.h&gt;</span>
<a name="l00077"></a>00077 <span class="preprocessor">#include &lt;vtkOBJReader.h&gt;</span>
<a name="l00078"></a>00078 <span class="preprocessor">#include &lt;vtkCellArray.h&gt;</span>
<a name="l00079"></a>00079 <span class="preprocessor">#include &lt;vtkXMLPolyDataWriter.h&gt;</span>
<a name="l00080"></a>00080 <span class="preprocessor">#include &lt;vtkTriangleFilter.h&gt;</span>
<a name="l00081"></a>00081 <span class="preprocessor">#include &lt;vtkPointData.h&gt;</span>
<a name="l00082"></a>00082 <span class="preprocessor">#include &lt;vtkRendererCollection.h&gt;</span>
<a name="l00083"></a>00083 <span class="preprocessor">#include &lt;vtkXMLGenericDataObjectReader.h&gt;</span>
<a name="l00084"></a>00084 
<a name="l00085"></a>00085 <span class="preprocessor">#ifdef __WXMAC__</span>
<a name="l00086"></a>00086 <span class="preprocessor"></span><span class="preprocessor">    #include &lt;Carbon/Carbon.h&gt;</span>  <span class="comment">// for GetCurrentProcess, etc</span>
<a name="l00087"></a>00087 <span class="preprocessor">#endif</span>
<a name="l00088"></a>00088 <span class="preprocessor"></span>
<a name="l00089"></a>00089 <span class="preprocessor">#if wxCHECK_VERSION(2,9,0)</span>
<a name="l00090"></a>00090 <span class="preprocessor"></span>    <span class="comment">// some wxMenuItem method names have changed in wx 2.9</span>
<a name="l00091"></a>00091 <span class="preprocessor">    #define GetText GetItemLabel</span>
<a name="l00092"></a>00092 <span class="preprocessor"></span><span class="preprocessor">    #define SetText SetItemLabel</span>
<a name="l00093"></a>00093 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l00094"></a>00094 <span class="preprocessor"></span>
<a name="l00095"></a>00095 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l00096"></a>00096 
<a name="l00097"></a><a class="code" href="frame_8cpp.html#adb2d02d23949d250b57d1b3e00210c70">00097</a> wxString <a class="code" href="frame_8cpp.html#adb2d02d23949d250b57d1b3e00210c70">PaneName</a>(<span class="keywordtype">int</span> <span class="keywordtype">id</span>)
<a name="l00098"></a>00098 {
<a name="l00099"></a>00099     <span class="keywordflow">return</span> wxString::Format(_T(<span class="stringliteral">&quot;%d&quot;</span>),<span class="keywordtype">id</span>);
<a name="l00100"></a>00100 }
<a name="l00101"></a>00101 
<a name="l00102"></a>00102 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l00103"></a>00103 
<a name="l00104"></a>00104 BEGIN_EVENT_TABLE(<a class="code" href="classMyFrame.html" title="The wxFrame-derived top-level window for the Ready GUI.">MyFrame</a>, wxFrame)
<a name="l00105"></a>00105     EVT_ACTIVATE(<a class="code" href="classMyFrame.html" title="The wxFrame-derived top-level window for the Ready GUI.">MyFrame</a>::OnActivate)
<a name="l00106"></a>00106     EVT_IDLE(<a class="code" href="classMyFrame.html" title="The wxFrame-derived top-level window for the Ready GUI.">MyFrame</a>::OnIdle)
<a name="l00107"></a>00107     EVT_SIZE(<a class="code" href="classMyFrame.html" title="The wxFrame-derived top-level window for the Ready GUI.">MyFrame</a>::OnSize)
<a name="l00108"></a>00108     EVT_CLOSE(<a class="code" href="classMyFrame.html" title="The wxFrame-derived top-level window for the Ready GUI.">MyFrame</a>::OnClose)
<a name="l00109"></a>00109     <span class="comment">// file menu</span>
<a name="l00110"></a>00110     EVT_MENU(wxID_NEW, <a class="code" href="classMyFrame.html" title="The wxFrame-derived top-level window for the Ready GUI.">MyFrame</a>::OnNewPattern)
<a name="l00111"></a>00111     EVT_MENU(wxID_OPEN, <a class="code" href="classMyFrame.html" title="The wxFrame-derived top-level window for the Ready GUI.">MyFrame</a>::OnOpenPattern)
<a name="l00112"></a>00112     EVT_MENU(ID::<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994ae7bda90ebbf43016198827042d4096a6">ReloadFromDisk</a>, <a class="code" href="classMyFrame.html" title="The wxFrame-derived top-level window for the Ready GUI.">MyFrame</a>::OnReloadFromDisk)
<a name="l00113"></a>00113     EVT_MENU(wxID_SAVE, <a class="code" href="classMyFrame.html" title="The wxFrame-derived top-level window for the Ready GUI.">MyFrame</a>::OnSavePattern)
<a name="l00114"></a>00114     EVT_MENU(ID::<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a175531e6c07358f49a087d247ad79c2c">ImportMesh</a>, <a class="code" href="classMyFrame.html" title="The wxFrame-derived top-level window for the Ready GUI.">MyFrame</a>::OnImportMesh)
<a name="l00115"></a>00115     EVT_MENU(ID::<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a5a8bede146a5ee0a5972b95d7398f52b">ExportMesh</a>, <a class="code" href="classMyFrame.html" title="The wxFrame-derived top-level window for the Ready GUI.">MyFrame</a>::OnExportMesh)
<a name="l00116"></a>00116     EVT_MENU(ID::<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994ad82007f1e3c968f6c48cafeee5703960">ExportImage</a>, <a class="code" href="classMyFrame.html" title="The wxFrame-derived top-level window for the Ready GUI.">MyFrame</a>::OnExportImage)
<a name="l00117"></a>00117     EVT_MENU(ID::<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a67f4892e5c57cce8f949046681a353e9">Screenshot</a>, <a class="code" href="classMyFrame.html" title="The wxFrame-derived top-level window for the Ready GUI.">MyFrame</a>::OnScreenshot)
<a name="l00118"></a>00118     EVT_MENU(ID::<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a7e41393e0cd6b5ee413a7d3669b3caf0">StartRecording</a>, <a class="code" href="classMyFrame.html" title="The wxFrame-derived top-level window for the Ready GUI.">MyFrame</a>::OnStartRecording)
<a name="l00119"></a>00119     EVT_UPDATE_UI(ID::StartRecording, <a class="code" href="classMyFrame.html" title="The wxFrame-derived top-level window for the Ready GUI.">MyFrame</a>::OnUpdateStartRecording)
<a name="l00120"></a>00120     EVT_MENU(ID::<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994ad88b62c95bc0ef4d7d10305be547100d">StopRecording</a>, <a class="code" href="classMyFrame.html" title="The wxFrame-derived top-level window for the Ready GUI.">MyFrame</a>::OnStopRecording)
<a name="l00121"></a>00121     EVT_UPDATE_UI(ID::StopRecording, <a class="code" href="classMyFrame.html" title="The wxFrame-derived top-level window for the Ready GUI.">MyFrame</a>::OnUpdateStopRecording)
<a name="l00122"></a>00122     EVT_MENU(ID::<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a96cb152725348747ab810e2f61fd95b8">AddMyPatterns</a>, <a class="code" href="classMyFrame.html" title="The wxFrame-derived top-level window for the Ready GUI.">MyFrame</a>::OnAddMyPatterns)
<a name="l00123"></a>00123     EVT_MENU(wxID_PREFERENCES, <a class="code" href="classMyFrame.html" title="The wxFrame-derived top-level window for the Ready GUI.">MyFrame</a>::OnPreferences)
<a name="l00124"></a>00124     EVT_MENU(wxID_EXIT, <a class="code" href="classMyFrame.html" title="The wxFrame-derived top-level window for the Ready GUI.">MyFrame</a>::OnQuit)
<a name="l00125"></a>00125     <span class="comment">// edit menu</span>
<a name="l00126"></a>00126     EVT_MENU(wxID_CUT, <a class="code" href="classMyFrame.html" title="The wxFrame-derived top-level window for the Ready GUI.">MyFrame</a>::OnCut)
<a name="l00127"></a>00127     EVT_MENU(wxID_COPY, <a class="code" href="classMyFrame.html" title="The wxFrame-derived top-level window for the Ready GUI.">MyFrame</a>::OnCopy)
<a name="l00128"></a>00128     EVT_MENU(wxID_PASTE, <a class="code" href="classMyFrame.html" title="The wxFrame-derived top-level window for the Ready GUI.">MyFrame</a>::OnPaste)
<a name="l00129"></a>00129     EVT_UPDATE_UI(wxID_PASTE, <a class="code" href="classMyFrame.html" title="The wxFrame-derived top-level window for the Ready GUI.">MyFrame</a>::OnUpdatePaste)
<a name="l00130"></a>00130     EVT_MENU(wxID_CLEAR, <a class="code" href="classMyFrame.html" title="The wxFrame-derived top-level window for the Ready GUI.">MyFrame</a>::OnClear)
<a name="l00131"></a>00131     EVT_MENU(wxID_SELECTALL, <a class="code" href="classMyFrame.html" title="The wxFrame-derived top-level window for the Ready GUI.">MyFrame</a>::OnSelectAll)
<a name="l00132"></a>00132     <span class="comment">// view menu</span>
<a name="l00133"></a>00133     EVT_MENU(ID::<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a414589df96055cbbf92f287fc135dcbf">FullScreen</a>, <a class="code" href="classMyFrame.html" title="The wxFrame-derived top-level window for the Ready GUI.">MyFrame</a>::OnFullScreen)
<a name="l00134"></a>00134     EVT_MENU(ID::<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a427c0b326c042c60a407421b66c543fa">FitPattern</a>, <a class="code" href="classMyFrame.html" title="The wxFrame-derived top-level window for the Ready GUI.">MyFrame</a>::OnFitPattern)
<a name="l00135"></a>00135     EVT_MENU(ID::<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994ac939d32eac9bad1c9c238c92526f6143">Wireframe</a>, <a class="code" href="classMyFrame.html" title="The wxFrame-derived top-level window for the Ready GUI.">MyFrame</a>::OnWireframe)
<a name="l00136"></a>00136     EVT_UPDATE_UI(ID::Wireframe, <a class="code" href="classMyFrame.html" title="The wxFrame-derived top-level window for the Ready GUI.">MyFrame</a>::OnUpdateWireframe)
<a name="l00137"></a>00137     EVT_MENU(ID::<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994acb63579b388e2e1b0fa5117d6bc55e08">PatternsPane</a>, <a class="code" href="classMyFrame.html" title="The wxFrame-derived top-level window for the Ready GUI.">MyFrame</a>::OnToggleViewPane)
<a name="l00138"></a>00138     EVT_UPDATE_UI(ID::PatternsPane, <a class="code" href="classMyFrame.html" title="The wxFrame-derived top-level window for the Ready GUI.">MyFrame</a>::OnUpdateViewPane)
<a name="l00139"></a>00139     EVT_MENU(ID::<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a9a7b8f50f338bc1f33bbb46a265c66b2">InfoPane</a>, <a class="code" href="classMyFrame.html" title="The wxFrame-derived top-level window for the Ready GUI.">MyFrame</a>::OnToggleViewPane)
<a name="l00140"></a>00140     EVT_UPDATE_UI(ID::InfoPane, <a class="code" href="classMyFrame.html" title="The wxFrame-derived top-level window for the Ready GUI.">MyFrame</a>::OnUpdateViewPane)
<a name="l00141"></a>00141     EVT_MENU(ID::<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994aa793fe9cd53e4212456e78a881d61e73">HelpPane</a>, <a class="code" href="classMyFrame.html" title="The wxFrame-derived top-level window for the Ready GUI.">MyFrame</a>::OnToggleViewPane)
<a name="l00142"></a>00142     EVT_UPDATE_UI(ID::HelpPane, <a class="code" href="classMyFrame.html" title="The wxFrame-derived top-level window for the Ready GUI.">MyFrame</a>::OnUpdateViewPane)
<a name="l00143"></a>00143     EVT_MENU(ID::<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a970f2597ef339a100a5499c8bb8521c8">RestoreDefaultPerspective</a>, <a class="code" href="classMyFrame.html" title="The wxFrame-derived top-level window for the Ready GUI.">MyFrame</a>::OnRestoreDefaultPerspective)
<a name="l00144"></a>00144     EVT_MENU(ID::<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a877fbb5ffc961960113e5daaa2cf81b2">ChangeActiveChemical</a>, <a class="code" href="classMyFrame.html" title="The wxFrame-derived top-level window for the Ready GUI.">MyFrame</a>::OnChangeActiveChemical)
<a name="l00145"></a>00145     <span class="comment">// action menu</span>
<a name="l00146"></a>00146     EVT_MENU(ID::<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a29ce194c83647cde2066a129499a28b1">Step1</a>, <a class="code" href="classMyFrame.html" title="The wxFrame-derived top-level window for the Ready GUI.">MyFrame</a>::OnStep)
<a name="l00147"></a>00147     EVT_MENU(ID::<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994aabc39ee10e4d33f32ba11dd7773ad781">StepN</a>, <a class="code" href="classMyFrame.html" title="The wxFrame-derived top-level window for the Ready GUI.">MyFrame</a>::OnStep)
<a name="l00148"></a>00148     EVT_UPDATE_UI(ID::Step1, <a class="code" href="classMyFrame.html" title="The wxFrame-derived top-level window for the Ready GUI.">MyFrame</a>::OnUpdateStep)
<a name="l00149"></a>00149     EVT_UPDATE_UI(ID::StepN, <a class="code" href="classMyFrame.html" title="The wxFrame-derived top-level window for the Ready GUI.">MyFrame</a>::OnUpdateStep)
<a name="l00150"></a>00150     EVT_MENU(ID::<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a7fa86a9ca58943a68ee72c2278d7091f">RunStop</a>, <a class="code" href="classMyFrame.html" title="The wxFrame-derived top-level window for the Ready GUI.">MyFrame</a>::OnRunStop)
<a name="l00151"></a>00151     EVT_UPDATE_UI(ID::RunStop, <a class="code" href="classMyFrame.html" title="The wxFrame-derived top-level window for the Ready GUI.">MyFrame</a>::OnUpdateRunStop)
<a name="l00152"></a>00152     EVT_MENU(ID::<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994ac6fcd8a484e837c655a4dfbbe689c12c">Faster</a>, <a class="code" href="classMyFrame.html" title="The wxFrame-derived top-level window for the Ready GUI.">MyFrame</a>::OnRunFaster)
<a name="l00153"></a>00153     EVT_MENU(ID::<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a9ec4f0f78fdccdd3937c37932871cb31">Slower</a>, <a class="code" href="classMyFrame.html" title="The wxFrame-derived top-level window for the Ready GUI.">MyFrame</a>::OnRunSlower)
<a name="l00154"></a>00154     EVT_MENU(ID::<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a34de4b7050e8e026745a5287938fd874">ChangeRunningSpeed</a>, <a class="code" href="classMyFrame.html" title="The wxFrame-derived top-level window for the Ready GUI.">MyFrame</a>::OnChangeRunningSpeed)
<a name="l00155"></a>00155     EVT_MENU(ID::<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994ae64df26aa1aa17c056626418eeba266c">Reset</a>, <a class="code" href="classMyFrame.html" title="The wxFrame-derived top-level window for the Ready GUI.">MyFrame</a>::OnReset)
<a name="l00156"></a>00156     EVT_UPDATE_UI(ID::Reset, <a class="code" href="classMyFrame.html" title="The wxFrame-derived top-level window for the Ready GUI.">MyFrame</a>::OnUpdateReset)
<a name="l00157"></a>00157     EVT_MENU(ID::<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a8b6dde37a380581b5c30d1d5f912f183">GenerateInitialPattern</a>, <a class="code" href="classMyFrame.html" title="The wxFrame-derived top-level window for the Ready GUI.">MyFrame</a>::OnGenerateInitialPattern)
<a name="l00158"></a>00158     EVT_MENU(ID::<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a549e30966f04ac0c4348ea12a1d7282a">Blank</a>, <a class="code" href="classMyFrame.html" title="The wxFrame-derived top-level window for the Ready GUI.">MyFrame</a>::OnBlank)
<a name="l00159"></a>00159     EVT_MENU(ID::<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a7755c932c23e416eff7e29e82276dc87">AddParameter</a>,<a class="code" href="classMyFrame.html" title="The wxFrame-derived top-level window for the Ready GUI.">MyFrame</a>::OnAddParameter)
<a name="l00160"></a>00160     EVT_UPDATE_UI(ID::AddParameter, <a class="code" href="classMyFrame.html" title="The wxFrame-derived top-level window for the Ready GUI.">MyFrame</a>::OnUpdateAddParameter)
<a name="l00161"></a>00161     EVT_MENU(ID::<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a9377f837fdf3eb370dd4d06d34dd1e29">DeleteParameter</a>,<a class="code" href="classMyFrame.html" title="The wxFrame-derived top-level window for the Ready GUI.">MyFrame</a>::OnDeleteParameter)
<a name="l00162"></a>00162     EVT_UPDATE_UI(ID::DeleteParameter, <a class="code" href="classMyFrame.html" title="The wxFrame-derived top-level window for the Ready GUI.">MyFrame</a>::OnUpdateDeleteParameter)
<a name="l00163"></a>00163     EVT_MENU(ID::<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a9fa971bdea3dff48c7f2500cc9d0a693">ViewFullKernel</a>,<a class="code" href="classMyFrame.html" title="The wxFrame-derived top-level window for the Ready GUI.">MyFrame</a>::OnViewFullKernel)
<a name="l00164"></a>00164     EVT_UPDATE_UI(ID::ViewFullKernel, <a class="code" href="classMyFrame.html" title="The wxFrame-derived top-level window for the Ready GUI.">MyFrame</a>::OnUpdateViewFullKernel)
<a name="l00165"></a>00165     EVT_MENU(ID::<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a82d526382ae3e9f7b1ecf5274d3c265f">SelectOpenCLDevice</a>, <a class="code" href="classMyFrame.html" title="The wxFrame-derived top-level window for the Ready GUI.">MyFrame</a>::OnSelectOpenCLDevice)
<a name="l00166"></a>00166     EVT_MENU(ID::<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a25785909b339d2424ba3e06092aea24d">OpenCLDiagnostics</a>, <a class="code" href="classMyFrame.html" title="The wxFrame-derived top-level window for the Ready GUI.">MyFrame</a>::OnOpenCLDiagnostics)
<a name="l00167"></a>00167     <span class="comment">// help menu</span>
<a name="l00168"></a>00168     EVT_MENU(wxID_HELP, <a class="code" href="classMyFrame.html" title="The wxFrame-derived top-level window for the Ready GUI.">MyFrame</a>::OnHelp)
<a name="l00169"></a>00169     EVT_MENU(ID::<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994ae4da177bc93aa9c32cd1c4c7e5df05f7">HelpQuick</a>, <a class="code" href="classMyFrame.html" title="The wxFrame-derived top-level window for the Ready GUI.">MyFrame</a>::OnHelp)
<a name="l00170"></a>00170     EVT_MENU(ID::<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a11b4d5cc94f2a3b6cee7cb09da2126d6">HelpIntro</a>, <a class="code" href="classMyFrame.html" title="The wxFrame-derived top-level window for the Ready GUI.">MyFrame</a>::OnHelp)
<a name="l00171"></a>00171     EVT_MENU(ID::<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a2e16df9987ffe628f9c3379f468762b4">HelpTips</a>, <a class="code" href="classMyFrame.html" title="The wxFrame-derived top-level window for the Ready GUI.">MyFrame</a>::OnHelp)
<a name="l00172"></a>00172     EVT_MENU(ID::<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a19e87388929f7a4f3d961de8105c5f6d">HelpKeyboard</a>, <a class="code" href="classMyFrame.html" title="The wxFrame-derived top-level window for the Ready GUI.">MyFrame</a>::OnHelp)
<a name="l00173"></a>00173     EVT_MENU(ID::<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a4c430f7f8809a8418a14a2641b48719a">HelpMouse</a>, <a class="code" href="classMyFrame.html" title="The wxFrame-derived top-level window for the Ready GUI.">MyFrame</a>::OnHelp)
<a name="l00174"></a>00174     EVT_MENU(ID::<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a34623182ac086372c85925d0939f666b">HelpFile</a>, <a class="code" href="classMyFrame.html" title="The wxFrame-derived top-level window for the Ready GUI.">MyFrame</a>::OnHelp)
<a name="l00175"></a>00175     EVT_MENU(ID::<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994ab5e85cc7435ed3454f3f5b980ed96e3d">HelpEdit</a>, <a class="code" href="classMyFrame.html" title="The wxFrame-derived top-level window for the Ready GUI.">MyFrame</a>::OnHelp)
<a name="l00176"></a>00176     EVT_MENU(ID::<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994aa6e5d26454218360dd70852ca324bec2">HelpView</a>, <a class="code" href="classMyFrame.html" title="The wxFrame-derived top-level window for the Ready GUI.">MyFrame</a>::OnHelp)
<a name="l00177"></a>00177     EVT_MENU(ID::<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a11c4f11523bb33079a18947830fa827e">HelpAction</a>, <a class="code" href="classMyFrame.html" title="The wxFrame-derived top-level window for the Ready GUI.">MyFrame</a>::OnHelp)
<a name="l00178"></a>00178     EVT_MENU(ID::<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a34a6d520118d6a6012bd9e8f0f9a1560">HelpHelp</a>, <a class="code" href="classMyFrame.html" title="The wxFrame-derived top-level window for the Ready GUI.">MyFrame</a>::OnHelp)
<a name="l00179"></a>00179     EVT_MENU(ID::<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a05b3c81109c55177ad668803cb8c6e1a">HelpFormats</a>, <a class="code" href="classMyFrame.html" title="The wxFrame-derived top-level window for the Ready GUI.">MyFrame</a>::OnHelp)
<a name="l00180"></a>00180     EVT_MENU(ID::<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a99d9508355ab71324cf773c2b607a41f">HelpProblems</a>, <a class="code" href="classMyFrame.html" title="The wxFrame-derived top-level window for the Ready GUI.">MyFrame</a>::OnHelp)
<a name="l00181"></a>00181     EVT_MENU(ID::<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a9f852fa906fbd919f0dd378129029422">HelpChanges</a>, <a class="code" href="classMyFrame.html" title="The wxFrame-derived top-level window for the Ready GUI.">MyFrame</a>::OnHelp)
<a name="l00182"></a>00182     EVT_MENU(ID::<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a5aea20957851faa34cfbf82d59895b56">HelpCredits</a>, <a class="code" href="classMyFrame.html" title="The wxFrame-derived top-level window for the Ready GUI.">MyFrame</a>::OnHelp)
<a name="l00183"></a>00183     EVT_MENU(wxID_ABOUT, <a class="code" href="classMyFrame.html" title="The wxFrame-derived top-level window for the Ready GUI.">MyFrame</a>::OnAbout)
<a name="l00184"></a>00184     <span class="comment">// items in Open Recent submenu must be handled last</span>
<a name="l00185"></a>00185     EVT_MENU(wxID_ANY, <a class="code" href="classMyFrame.html" title="The wxFrame-derived top-level window for the Ready GUI.">MyFrame</a>::OnOpenRecent)
<a name="l00186"></a>00186 END_EVENT_TABLE()
<a name="l00187"></a>00187 
<a name="l00188"></a>00188 const <span class="keywordtype">char</span>* <a class="code" href="classMyFrame.html" title="The wxFrame-derived top-level window for the Ready GUI.">MyFrame</a>::opencl_not_available_message = 
<a name="l00189"></a>00189         &quot;This file requires OpenCL, which has not been detected on your system.\n\n&quot;
<a name="l00190"></a>00190         &quot;OpenCL allows Ready to take advantage of the many-core architectures on\n&quot;
<a name="l00191"></a>00191         &quot;graphics cards and modern CPUs. OpenCL also allows rules to be written in\n&quot;
<a name="l00192"></a>00192         &quot;a text format and compiled on the fly. It is available on every operating\n&quot;
<a name="l00193"></a>00193         &quot;system, so please install it to get the most out of Ready. (If your OS is\n&quot;
<a name="l00194"></a>00194         &quot;running in a virtual machine then it may not be possible to get OpenCL\n&quot;
<a name="l00195"></a>00195         &quot;working.)\n\n&quot;
<a name="l00196"></a>00196         &quot;You can load the files in the &#39;CPU-only&#39; folder, which don&#39;t use OpenCL. Or\n&quot;
<a name="l00197"></a>00197         &quot;use File &gt; New Pattern or File &gt; Import Mesh to make new examples.&quot;;
<a name="l00198"></a>00198                                                 
<a name="l00199"></a>00199 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l00200"></a>00200 
<a name="l00201"></a>00201 <span class="comment">// constructor</span>
<a name="l00202"></a><a class="code" href="classMyFrame.html#af13d7bffe3d6844c2331085f423764a4">00202</a> <a class="code" href="classMyFrame.html" title="The wxFrame-derived top-level window for the Ready GUI.">MyFrame</a>::<a class="code" href="classMyFrame.html" title="The wxFrame-derived top-level window for the Ready GUI.">MyFrame</a>(const wxString&amp; title)
<a name="l00203"></a>00203        : wxFrame(NULL, wxID_ANY, title),
<a name="l00204"></a>00204        pVTKWindow(NULL),system(NULL),
<a name="l00205"></a>00205        is_running(false),
<a name="l00206"></a>00206        frames_per_second(0.0),
<a name="l00207"></a>00207        million_cell_generations_per_second(0.0),
<a name="l00208"></a>00208        fullscreen(false),
<a name="l00209"></a>00209        render_settings(&quot;render_settings&quot;),
<a name="l00210"></a>00210        is_recording(false)
<a name="l00211"></a>00211 {
<a name="l00212"></a>00212     this-&gt;SetIcon(wxICON(appicon16));
<a name="l00213"></a>00213 <span class="preprocessor">    #ifdef __WXGTK__</span>
<a name="l00214"></a>00214 <span class="preprocessor"></span>        <span class="comment">// advanced docking hints cause problems on xfce (and probably others)</span>
<a name="l00215"></a>00215         this-&gt;aui_mgr.SetFlags( wxAUI_MGR_ALLOW_FLOATING | wxAUI_MGR_RECTANGLE_HINT );
<a name="l00216"></a>00216 <span class="preprocessor">    #endif</span>
<a name="l00217"></a>00217 <span class="preprocessor"></span><span class="preprocessor">    #ifdef __WXMAC__</span>
<a name="l00218"></a>00218 <span class="preprocessor"></span>        this-&gt;aui_mgr.SetFlags( wxAUI_MGR_ALLOW_FLOATING | wxAUI_MGR_TRANSPARENT_HINT | wxAUI_MGR_ALLOW_ACTIVE_PANE );
<a name="l00219"></a>00219 <span class="preprocessor">    #endif</span>
<a name="l00220"></a>00220 <span class="preprocessor"></span>    this-&gt;aui_mgr.SetManagedWindow(<span class="keyword">this</span>);
<a name="l00221"></a>00221     
<a name="l00222"></a>00222     <a class="code" href="prefs_8cpp.html#a3b2a68cd85602c7c83ebb305f79d2617">GetPrefs</a>();     <span class="comment">// must be called before InitializeMenus</span>
<a name="l00223"></a>00223 
<a name="l00224"></a>00224     this-&gt;InitializeMenus();
<a name="l00225"></a>00225     this-&gt;InitializeToolbars();
<a name="l00226"></a>00226 
<a name="l00227"></a>00227     CreateStatusBar(1);
<a name="l00228"></a>00228     SetStatusText(_(<span class="stringliteral">&quot;Ready&quot;</span>));
<a name="l00229"></a>00229     
<a name="l00230"></a>00230     this-&gt;is_opencl_available = <a class="code" href="namespaceOpenCL__utils.html#a426b51800ee7948af966128dffb3890e" title="Determines whether at least one OpenCL device is available.">OpenCL_utils::IsOpenCLAvailable</a>();
<a name="l00231"></a>00231 
<a name="l00232"></a>00232     this-&gt;InitializePatternsPane();
<a name="l00233"></a>00233     this-&gt;InitializeInfoPane();
<a name="l00234"></a>00234     this-&gt;InitializeHelpPane();
<a name="l00235"></a>00235     this-&gt;InitializeRenderPane();
<a name="l00236"></a>00236 
<a name="l00237"></a>00237     this-&gt;default_perspective = this-&gt;aui_mgr.SavePerspective();
<a name="l00238"></a>00238     this-&gt;LoadSettings();
<a name="l00239"></a>00239     this-&gt;aui_mgr.Update();
<a name="l00240"></a>00240 
<a name="l00241"></a>00241     <span class="comment">// enable/disable tool tips</span>
<a name="l00242"></a>00242 <span class="preprocessor">    #if wxUSE_TOOLTIPS</span>
<a name="l00243"></a>00243 <span class="preprocessor"></span>        <span class="comment">// AKT TODO!!! fix bug: can&#39;t disable tooltips in Mac app (bug is in wxOSX-Cocoa)</span>
<a name="l00244"></a>00244         wxToolTip::Enable(<a class="code" href="prefs_8cpp.html#af831ab3ffe0ee800c61d7a73b2873ce3">showtips</a>);
<a name="l00245"></a>00245 <span class="preprocessor">    #endif</span>
<a name="l00246"></a>00246 <span class="preprocessor"></span>
<a name="l00247"></a>00247     <span class="comment">// initialize an RD system to get us started</span>
<a name="l00248"></a>00248 <span class="preprocessor">    #ifdef __WXMSW__</span>
<a name="l00249"></a>00249 <span class="preprocessor"></span>        <span class="comment">// use back slashes on Windows</span>
<a name="l00250"></a>00250         <span class="keyword">const</span> wxString initfile = _T(<span class="stringliteral">&quot;Patterns\\CPU-only\\grayscott_3D.vti&quot;</span>);
<a name="l00251"></a>00251 <span class="preprocessor">    #else</span>
<a name="l00252"></a>00252 <span class="preprocessor"></span>        <span class="comment">// use forward slashes on Mac/Linux</span>
<a name="l00253"></a>00253         <span class="keyword">const</span> wxString initfile = _T(<span class="stringliteral">&quot;Patterns/CPU-only/grayscott_3D.vti&quot;</span>);
<a name="l00254"></a>00254 <span class="preprocessor">    #endif</span>
<a name="l00255"></a>00255 <span class="preprocessor"></span>    <span class="keywordflow">if</span> (wxFileExists(initfile)) {
<a name="l00256"></a>00256         this-&gt;OpenFile(initfile);
<a name="l00257"></a>00257     } <span class="keywordflow">else</span> {
<a name="l00258"></a>00258         <span class="comment">// create new pattern</span>
<a name="l00259"></a>00259         wxCommandEvent cmdevent(wxID_NEW);
<a name="l00260"></a>00260         OnNewPattern(cmdevent);
<a name="l00261"></a>00261     }
<a name="l00262"></a>00262 }
<a name="l00263"></a>00263 
<a name="l00264"></a>00264 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l00265"></a>00265 
<a name="l00266"></a><a class="code" href="classMyFrame.html#a711b2bda77494841f2e582982b80c356">00266</a> <a class="code" href="classMyFrame.html#a711b2bda77494841f2e582982b80c356">MyFrame::~MyFrame</a>()
<a name="l00267"></a>00267 {
<a name="l00268"></a>00268     this-&gt;SaveSettings(); <span class="comment">// save the current settings so it starts up the same next time</span>
<a name="l00269"></a>00269     this-&gt;aui_mgr.UnInit();
<a name="l00270"></a>00270     this-&gt;pVTKWindow-&gt;Delete();
<a name="l00271"></a>00271     <span class="keyword">delete</span> this-&gt;system;
<a name="l00272"></a>00272 }
<a name="l00273"></a>00273 
<a name="l00274"></a>00274 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l00275"></a>00275 
<a name="l00276"></a><a class="code" href="classMyFrame.html#a8c4a61f9dd46a80206b1d9af7b2052ee">00276</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#a8c4a61f9dd46a80206b1d9af7b2052ee">MyFrame::InitializeMenus</a>()
<a name="l00277"></a>00277 {
<a name="l00278"></a>00278     wxMenuBar *menuBar = <span class="keyword">new</span> wxMenuBar();
<a name="l00279"></a>00279     {   <span class="comment">// file menu:</span>
<a name="l00280"></a>00280         wxMenu *menu = <span class="keyword">new</span> wxMenu;
<a name="l00281"></a>00281         menu-&gt;Append(wxID_NEW, _(<span class="stringliteral">&quot;New Pattern&quot;</span>) + <a class="code" href="prefs_8cpp.html#ab9798965988e2083acef3da70016317f">GetAccelerator</a>(<a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a0a8b90d6d06556d673ffab3fe7bd765a">DO_NEWPATT</a>), _(<span class="stringliteral">&quot;Create a new pattern&quot;</span>));
<a name="l00282"></a>00282         menu-&gt;AppendSeparator();
<a name="l00283"></a>00283         menu-&gt;Append(wxID_OPEN, _(<span class="stringliteral">&quot;Open Pattern...&quot;</span>) + <a class="code" href="prefs_8cpp.html#ab9798965988e2083acef3da70016317f">GetAccelerator</a>(<a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a13b814442bb726fc27e2e46d75f68903">DO_OPENPATT</a>), _(<span class="stringliteral">&quot;Choose a pattern file to open&quot;</span>));
<a name="l00284"></a>00284         menu-&gt;Append(<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a7cbbd0c9c34ab62384ebaaea64700a6e">ID::OpenRecent</a>, _(<span class="stringliteral">&quot;Open Recent&quot;</span>), <a class="code" href="prefs_8cpp.html#ae5246b1632294beb0e04a2942722d304">patternSubMenu</a>);
<a name="l00285"></a>00285         menu-&gt;Append(<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994ae7bda90ebbf43016198827042d4096a6">ID::ReloadFromDisk</a>, _(<span class="stringliteral">&quot;Reload from Disk&quot;</span>) + <a class="code" href="prefs_8cpp.html#ab9798965988e2083acef3da70016317f">GetAccelerator</a>(<a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62ae20cb524276f390aad2a8e31a85da68b">DO_RELOAD</a>), _(<span class="stringliteral">&quot;Reload the pattern file from disk&quot;</span>));
<a name="l00286"></a>00286         menu-&gt;AppendSeparator();
<a name="l00287"></a>00287         menu-&gt;Append(<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a175531e6c07358f49a087d247ad79c2c">ID::ImportMesh</a>, _(<span class="stringliteral">&quot;Import Mesh...&quot;</span>) + <a class="code" href="prefs_8cpp.html#ab9798965988e2083acef3da70016317f">GetAccelerator</a>(<a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a1f4076bb401751fd60b827874e30b09c">DO_IMPORTMESH</a>), _(<span class="stringliteral">&quot;Import a mesh&quot;</span>));
<a name="l00288"></a>00288         menu-&gt;Append(<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a5a8bede146a5ee0a5972b95d7398f52b">ID::ExportMesh</a>, _(<span class="stringliteral">&quot;Export Mesh...&quot;</span>) + <a class="code" href="prefs_8cpp.html#ab9798965988e2083acef3da70016317f">GetAccelerator</a>(<a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a3b71061f14e65228175c258013cbec1c">DO_EXPORTMESH</a>), _(<span class="stringliteral">&quot;Export the mesh&quot;</span>));
<a name="l00289"></a>00289         menu-&gt;Append(<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994ad82007f1e3c968f6c48cafeee5703960">ID::ExportImage</a>, _(<span class="stringliteral">&quot;Export Image...&quot;</span>) + <a class="code" href="prefs_8cpp.html#ab9798965988e2083acef3da70016317f">GetAccelerator</a>(<a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62ad485985a3e2b6d4f2e4385e9a989ff0c">DO_EXPORTIMAGE</a>), _(<span class="stringliteral">&quot;Export the image&quot;</span>));
<a name="l00290"></a>00290         menu-&gt;AppendSeparator();
<a name="l00291"></a>00291         menu-&gt;Append(wxID_SAVE, _(<span class="stringliteral">&quot;Save Pattern...&quot;</span>) + <a class="code" href="prefs_8cpp.html#ab9798965988e2083acef3da70016317f">GetAccelerator</a>(<a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62ac14c985dfcd45cba2f41c72260d29ffe">DO_SAVE</a>), _(<span class="stringliteral">&quot;Save the current pattern&quot;</span>));
<a name="l00292"></a>00292         menu-&gt;Append(<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a67f4892e5c57cce8f949046681a353e9">ID::Screenshot</a>, _(<span class="stringliteral">&quot;Save Screenshot...&quot;</span>) + <a class="code" href="prefs_8cpp.html#ab9798965988e2083acef3da70016317f">GetAccelerator</a>(<a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a8031583e5967eecb9ddf9d6a25962e5d">DO_SCREENSHOT</a>), _(<span class="stringliteral">&quot;Save a screenshot of the current view&quot;</span>));
<a name="l00293"></a>00293         menu-&gt;AppendSeparator();
<a name="l00294"></a>00294         menu-&gt;Append(<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a7e41393e0cd6b5ee413a7d3669b3caf0">ID::StartRecording</a>, _(<span class="stringliteral">&quot;Start Recording...&quot;</span>) + <a class="code" href="prefs_8cpp.html#ab9798965988e2083acef3da70016317f">GetAccelerator</a>(<a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a082e23992459dda1ce84300f90abe78f">DO_STARTRECORDING</a>), _(<span class="stringliteral">&quot;Start recording frames as images to disk&quot;</span>));
<a name="l00295"></a>00295         menu-&gt;Append(<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994ad88b62c95bc0ef4d7d10305be547100d">ID::StopRecording</a>, _(<span class="stringliteral">&quot;Stop Recording&quot;</span>) + <a class="code" href="prefs_8cpp.html#ab9798965988e2083acef3da70016317f">GetAccelerator</a>(<a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a897e611210825bbe786f7689733208c1">DO_STOPRECORDING</a>), _(<span class="stringliteral">&quot;Stop recording frames&quot;</span>));
<a name="l00296"></a>00296         menu-&gt;AppendSeparator();
<a name="l00297"></a>00297         menu-&gt;Append(<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a96cb152725348747ab810e2f61fd95b8">ID::AddMyPatterns</a>, _(<span class="stringliteral">&quot;Add My Patterns...&quot;</span>) + <a class="code" href="prefs_8cpp.html#ab9798965988e2083acef3da70016317f">GetAccelerator</a>(<a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a9b0e09a8a5af3eeda22366ae9a682b06">DO_ADDPATTS</a>), _(<span class="stringliteral">&quot;Add chosen folder to patterns pane&quot;</span>));
<a name="l00298"></a>00298 <span class="preprocessor">        #if !defined(__WXOSX_COCOA__)</span>
<a name="l00299"></a>00299 <span class="preprocessor"></span>            menu-&gt;AppendSeparator();
<a name="l00300"></a>00300 <span class="preprocessor">        #endif</span>
<a name="l00301"></a>00301 <span class="preprocessor"></span>        <span class="comment">// on the Mac the wxID_PREFERENCES item is moved to the app menu</span>
<a name="l00302"></a>00302         menu-&gt;Append(wxID_PREFERENCES, _(<span class="stringliteral">&quot;Preferences...&quot;</span>) + <a class="code" href="prefs_8cpp.html#ab9798965988e2083acef3da70016317f">GetAccelerator</a>(<a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a9df6720475a3f3e52740a0250774dee2">DO_PREFS</a>), _(<span class="stringliteral">&quot;Edit the preferences&quot;</span>));
<a name="l00303"></a>00303 <span class="preprocessor">        #if !defined(__WXOSX_COCOA__)</span>
<a name="l00304"></a>00304 <span class="preprocessor"></span>            menu-&gt;AppendSeparator();
<a name="l00305"></a>00305 <span class="preprocessor">        #endif</span>
<a name="l00306"></a>00306 <span class="preprocessor"></span>        <span class="comment">// on the Mac the wxID_EXIT item is moved to the app menu and the app name is appended to &quot;Quit &quot;</span>
<a name="l00307"></a>00307         menu-&gt;Append(wxID_EXIT, _(<span class="stringliteral">&quot;Quit&quot;</span>) + <a class="code" href="prefs_8cpp.html#ab9798965988e2083acef3da70016317f">GetAccelerator</a>(<a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a0d23c152db0c24154c6a13303a6151a4">DO_QUIT</a>));
<a name="l00308"></a>00308         menuBar-&gt;Append(menu, _(<span class="stringliteral">&quot;&amp;File&quot;</span>));
<a name="l00309"></a>00309     }
<a name="l00310"></a>00310     {   <span class="comment">// edit menu:</span>
<a name="l00311"></a>00311         wxMenu *menu = <span class="keyword">new</span> wxMenu;
<a name="l00312"></a>00312         menu-&gt;Append(wxID_CUT, _(<span class="stringliteral">&quot;Cut&quot;</span>) + <a class="code" href="prefs_8cpp.html#ab9798965988e2083acef3da70016317f">GetAccelerator</a>(<a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a86e6bb0ed1ed8e2b71aeee759d04f751">DO_CUT</a>), _(<span class="stringliteral">&quot;Cut the selection and save it to the clipboard&quot;</span>));
<a name="l00313"></a>00313         menu-&gt;Append(wxID_COPY, _(<span class="stringliteral">&quot;Copy&quot;</span>) + <a class="code" href="prefs_8cpp.html#ab9798965988e2083acef3da70016317f">GetAccelerator</a>(<a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a66ab504cb136ee10d90b5041b69b1072">DO_COPY</a>), _(<span class="stringliteral">&quot;Copy the selection to the clipboard&quot;</span>));
<a name="l00314"></a>00314         menu-&gt;Append(wxID_PASTE, _(<span class="stringliteral">&quot;Paste&quot;</span>) + <a class="code" href="prefs_8cpp.html#ab9798965988e2083acef3da70016317f">GetAccelerator</a>(<a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a57db23febf9d70735b2d5429f9322921">DO_PASTE</a>), _(<span class="stringliteral">&quot;Paste in the contents of the clipboard&quot;</span>));
<a name="l00315"></a>00315         menu-&gt;Append(wxID_CLEAR, _(<span class="stringliteral">&quot;Clear&quot;</span>) + <a class="code" href="prefs_8cpp.html#ab9798965988e2083acef3da70016317f">GetAccelerator</a>(<a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62ad1502fb1fa8a6db8f0d5eab8c5ea1795">DO_CLEAR</a>), _(<span class="stringliteral">&quot;Clear the selection&quot;</span>));
<a name="l00316"></a>00316         menu-&gt;AppendSeparator();
<a name="l00317"></a>00317         menu-&gt;Append(wxID_SELECTALL, _(<span class="stringliteral">&quot;Select All&quot;</span>) + <a class="code" href="prefs_8cpp.html#ab9798965988e2083acef3da70016317f">GetAccelerator</a>(<a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a5e89d8bab01100c776f98476f132750c">DO_SELALL</a>), _(<span class="stringliteral">&quot;Select everything&quot;</span>));
<a name="l00318"></a>00318         menuBar-&gt;Append(menu, _(<span class="stringliteral">&quot;&amp;Edit&quot;</span>));
<a name="l00319"></a>00319     }
<a name="l00320"></a>00320     {   <span class="comment">// view menu:</span>
<a name="l00321"></a>00321         wxMenu *menu = <span class="keyword">new</span> wxMenu;
<a name="l00322"></a>00322         menu-&gt;Append(<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a414589df96055cbbf92f287fc135dcbf">ID::FullScreen</a>, _(<span class="stringliteral">&quot;Full Screen&quot;</span>) + <a class="code" href="prefs_8cpp.html#ab9798965988e2083acef3da70016317f">GetAccelerator</a>(<a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a14ccfd2e63a339d4172bda3ad550fff2">DO_FULLSCREEN</a>), _(<span class="stringliteral">&quot;Toggle full screen mode&quot;</span>));
<a name="l00323"></a>00323         menu-&gt;Append(<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a427c0b326c042c60a407421b66c543fa">ID::FitPattern</a>, _(<span class="stringliteral">&quot;Fit Pattern&quot;</span>) + <a class="code" href="prefs_8cpp.html#ab9798965988e2083acef3da70016317f">GetAccelerator</a>(<a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a4b6a631192c5074db6357ebea2a4caf0">DO_FIT</a>), _(<span class="stringliteral">&quot;Restore view so all of pattern is visible&quot;</span>));
<a name="l00324"></a>00324         menu-&gt;AppendCheckItem(<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994ac939d32eac9bad1c9c238c92526f6143">ID::Wireframe</a>, _(<span class="stringliteral">&quot;Wireframe&quot;</span>) + <a class="code" href="prefs_8cpp.html#ab9798965988e2083acef3da70016317f">GetAccelerator</a>(<a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a069bd47d4f1f5762840246bb5a52bebf">DO_WIREFRAME</a>), _(<span class="stringliteral">&quot;Wireframe or surface view&quot;</span>));
<a name="l00325"></a>00325         menu-&gt;AppendSeparator();
<a name="l00326"></a>00326         menu-&gt;AppendCheckItem(<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994acb63579b388e2e1b0fa5117d6bc55e08">ID::PatternsPane</a>, _(<span class="stringliteral">&quot;&amp;Patterns Pane&quot;</span>) + <a class="code" href="prefs_8cpp.html#ab9798965988e2083acef3da70016317f">GetAccelerator</a>(<a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a57a2af46aa8cd3deb36042aa2a05a4f0">DO_PATTERNS</a>), _(<span class="stringliteral">&quot;View the patterns pane&quot;</span>));
<a name="l00327"></a>00327         menu-&gt;AppendCheckItem(<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a9a7b8f50f338bc1f33bbb46a265c66b2">ID::InfoPane</a>, _(<span class="stringliteral">&quot;&amp;Info Pane&quot;</span>) + <a class="code" href="prefs_8cpp.html#ab9798965988e2083acef3da70016317f">GetAccelerator</a>(<a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a3b10246f0f8338327b892109a70eca29">DO_INFO</a>), _(<span class="stringliteral">&quot;View the info pane&quot;</span>));
<a name="l00328"></a>00328         menu-&gt;AppendCheckItem(<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994aa793fe9cd53e4212456e78a881d61e73">ID::HelpPane</a>, _(<span class="stringliteral">&quot;&amp;Help Pane&quot;</span>) + <a class="code" href="prefs_8cpp.html#ab9798965988e2083acef3da70016317f">GetAccelerator</a>(<a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a150b825efd182d9c95b587c9ef5516b9">DO_HELP</a>), _(<span class="stringliteral">&quot;View the help pane&quot;</span>));
<a name="l00329"></a>00329         menu-&gt;AppendSeparator();
<a name="l00330"></a>00330         menu-&gt;Append(<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a970f2597ef339a100a5499c8bb8521c8">ID::RestoreDefaultPerspective</a>, _(<span class="stringliteral">&quot;&amp;Restore Default Layout&quot;</span>) + <a class="code" href="prefs_8cpp.html#ab9798965988e2083acef3da70016317f">GetAccelerator</a>(<a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62afb76022044b62bb892c1ee65ac4ef721">DO_RESTORE</a>), _(<span class="stringliteral">&quot;Put the windows back where they were&quot;</span>));
<a name="l00331"></a>00331         menu-&gt;AppendSeparator();
<a name="l00332"></a>00332         menu-&gt;Append(<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a877fbb5ffc961960113e5daaa2cf81b2">ID::ChangeActiveChemical</a>, _(<span class="stringliteral">&quot;&amp;Change Active Chemical...&quot;</span>) + <a class="code" href="prefs_8cpp.html#ab9798965988e2083acef3da70016317f">GetAccelerator</a>(<a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a776300076489934b1008c8d05602a494">DO_CHEMICAL</a>), _(<span class="stringliteral">&quot;Change which chemical is being visualized&quot;</span>));
<a name="l00333"></a>00333         menuBar-&gt;Append(menu, _(<span class="stringliteral">&quot;&amp;View&quot;</span>));
<a name="l00334"></a>00334     }
<a name="l00335"></a>00335     {   <span class="comment">// action menu:</span>
<a name="l00336"></a>00336         wxMenu *menu = <span class="keyword">new</span> wxMenu;
<a name="l00337"></a>00337         menu-&gt;Append(<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a29ce194c83647cde2066a129499a28b1">ID::Step1</a>, _(<span class="stringliteral">&quot;Step by 1&quot;</span>) + <a class="code" href="prefs_8cpp.html#ab9798965988e2083acef3da70016317f">GetAccelerator</a>(<a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a5b6cbabe6909263c772ceb091fb2edcd">DO_STEP1</a>), _(<span class="stringliteral">&quot;Advance the simulation by a single timestep&quot;</span>));
<a name="l00338"></a>00338         menu-&gt;Append(<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994aabc39ee10e4d33f32ba11dd7773ad781">ID::StepN</a>, _(<span class="stringliteral">&quot;Step by N&quot;</span>) + <a class="code" href="prefs_8cpp.html#ab9798965988e2083acef3da70016317f">GetAccelerator</a>(<a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62af6d9327fcfb8264f43b07cb94d66ec10">DO_STEPN</a>), _(<span class="stringliteral">&quot;Advance the simulation by timesteps per render&quot;</span>));
<a name="l00339"></a>00339         menu-&gt;Append(<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a7fa86a9ca58943a68ee72c2278d7091f">ID::RunStop</a>, _(<span class="stringliteral">&quot;Run&quot;</span>) + <a class="code" href="prefs_8cpp.html#ab9798965988e2083acef3da70016317f">GetAccelerator</a>(<a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62ad6773bc2d8b3a475b59775af5afc215c">DO_RUNSTOP</a>), _(<span class="stringliteral">&quot;Start running the simulation&quot;</span>));
<a name="l00340"></a>00340         menu-&gt;AppendSeparator();
<a name="l00341"></a>00341         menu-&gt;Append(<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994ac6fcd8a484e837c655a4dfbbe689c12c">ID::Faster</a>, _(<span class="stringliteral">&quot;Run Faster&quot;</span>) + <a class="code" href="prefs_8cpp.html#ab9798965988e2083acef3da70016317f">GetAccelerator</a>(<a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a389cee4c4147fecd61a4d134396e2e72">DO_FASTER</a>),_(<span class="stringliteral">&quot;Run with more timesteps between each render&quot;</span>));
<a name="l00342"></a>00342         menu-&gt;Append(<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a9ec4f0f78fdccdd3937c37932871cb31">ID::Slower</a>, _(<span class="stringliteral">&quot;Run Slower&quot;</span>) + <a class="code" href="prefs_8cpp.html#ab9798965988e2083acef3da70016317f">GetAccelerator</a>(<a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a53386a419f01d0b75372910dc9260c7e">DO_SLOWER</a>),_(<span class="stringliteral">&quot;Run with fewer timesteps between each render&quot;</span>));
<a name="l00343"></a>00343         menu-&gt;Append(<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a34de4b7050e8e026745a5287938fd874">ID::ChangeRunningSpeed</a>, _(<span class="stringliteral">&quot;Change Running Speed...&quot;</span>) + <a class="code" href="prefs_8cpp.html#ab9798965988e2083acef3da70016317f">GetAccelerator</a>(<a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62ae99153a35a4d051301adf666e9263afe">DO_CHANGESPEED</a>),_(<span class="stringliteral">&quot;Change the number of timesteps between each render&quot;</span>));
<a name="l00344"></a>00344         menu-&gt;AppendSeparator();
<a name="l00345"></a>00345         menu-&gt;Append(<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994ae64df26aa1aa17c056626418eeba266c">ID::Reset</a>, _(<span class="stringliteral">&quot;Reset&quot;</span>) + <a class="code" href="prefs_8cpp.html#ab9798965988e2083acef3da70016317f">GetAccelerator</a>(<a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a4165bc81d865b678b2f9b7410eed6018">DO_RESET</a>), _(<span class="stringliteral">&quot;Go back to the starting pattern&quot;</span>));
<a name="l00346"></a>00346         menu-&gt;Append(<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a8b6dde37a380581b5c30d1d5f912f183">ID::GenerateInitialPattern</a>, _(<span class="stringliteral">&quot;Generate Initial &amp;Pattern&quot;</span>) + <a class="code" href="prefs_8cpp.html#ab9798965988e2083acef3da70016317f">GetAccelerator</a>(<a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a4fe766d76d47511ceac02eff795a8b58">DO_GENPATT</a>), _(<span class="stringliteral">&quot;Run the Initial Pattern Generator&quot;</span>));
<a name="l00347"></a>00347         menu-&gt;Append(<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a549e30966f04ac0c4348ea12a1d7282a">ID::Blank</a>, _(<span class="stringliteral">&quot;&amp;Blank&quot;</span>) + <a class="code" href="prefs_8cpp.html#ab9798965988e2083acef3da70016317f">GetAccelerator</a>(<a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a00385d86c86e7885de37c86cf08587fc">DO_BLANK</a>), _(<span class="stringliteral">&quot;Sets every value to zero&quot;</span>));
<a name="l00348"></a>00348         menu-&gt;AppendSeparator();
<a name="l00349"></a>00349         menu-&gt;Append(<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a7755c932c23e416eff7e29e82276dc87">ID::AddParameter</a>, _(<span class="stringliteral">&quot;&amp;Add Parameter...&quot;</span>) + <a class="code" href="prefs_8cpp.html#ab9798965988e2083acef3da70016317f">GetAccelerator</a>(<a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62aa4d123ec804f00f2a2e6668d0c3770fe">DO_ADDPARAM</a>),_(<span class="stringliteral">&quot;Add a new named parameter&quot;</span>));
<a name="l00350"></a>00350         menu-&gt;Append(<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a9377f837fdf3eb370dd4d06d34dd1e29">ID::DeleteParameter</a>, _(<span class="stringliteral">&quot;&amp;Delete Parameter...&quot;</span>) + <a class="code" href="prefs_8cpp.html#ab9798965988e2083acef3da70016317f">GetAccelerator</a>(<a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a2d72ebc020c77a64e833c939c6dabbd6">DO_DELPARAM</a>),_(<span class="stringliteral">&quot;Delete one of the parameters&quot;</span>));
<a name="l00351"></a>00351         menu-&gt;Append(<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a9fa971bdea3dff48c7f2500cc9d0a693">ID::ViewFullKernel</a>, _(<span class="stringliteral">&quot;View Full Kernel&quot;</span>) + <a class="code" href="prefs_8cpp.html#ab9798965988e2083acef3da70016317f">GetAccelerator</a>(<a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a2f1156f3997ca07f6a87461122ee21d8">DO_VIEWKERNEL</a>),_(<span class="stringliteral">&quot;Shows the full OpenCL kernel as expanded from the formula&quot;</span>));
<a name="l00352"></a>00352         menu-&gt;AppendSeparator();
<a name="l00353"></a>00353         menu-&gt;Append(<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a82d526382ae3e9f7b1ecf5274d3c265f">ID::SelectOpenCLDevice</a>, _(<span class="stringliteral">&quot;Select &amp;OpenCL Device...&quot;</span>) + <a class="code" href="prefs_8cpp.html#ab9798965988e2083acef3da70016317f">GetAccelerator</a>(<a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62acb4c9b11dea3500cc66f3f402c084a2a">DO_DEVICE</a>), _(<span class="stringliteral">&quot;Choose which OpenCL device to run on&quot;</span>));
<a name="l00354"></a>00354         menu-&gt;Append(<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a25785909b339d2424ba3e06092aea24d">ID::OpenCLDiagnostics</a>, _(<span class="stringliteral">&quot;Show Open&amp;CL Diagnostics...&quot;</span>) + <a class="code" href="prefs_8cpp.html#ab9798965988e2083acef3da70016317f">GetAccelerator</a>(<a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a47d344b75c0413566f55457e40d54914">DO_OPENCL</a>), _(<span class="stringliteral">&quot;Show the available OpenCL devices and their attributes&quot;</span>));
<a name="l00355"></a>00355         menuBar-&gt;Append(menu, _(<span class="stringliteral">&quot;&amp;Action&quot;</span>));
<a name="l00356"></a>00356     }
<a name="l00357"></a>00357     {   <span class="comment">// help menu:</span>
<a name="l00358"></a>00358         wxMenu *menu = <span class="keyword">new</span> wxMenu;
<a name="l00359"></a>00359         menu-&gt;Append(wxID_HELP,        _(<span class="stringliteral">&quot;Contents&quot;</span>));
<a name="l00360"></a>00360         menu-&gt;Append(<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994ae4da177bc93aa9c32cd1c4c7e5df05f7">ID::HelpQuick</a>,    _(<span class="stringliteral">&quot;Quick Start&quot;</span>));
<a name="l00361"></a>00361         menu-&gt;Append(<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a11b4d5cc94f2a3b6cee7cb09da2126d6">ID::HelpIntro</a>,    _(<span class="stringliteral">&quot;Introduction to RD&quot;</span>));
<a name="l00362"></a>00362         menu-&gt;AppendSeparator();
<a name="l00363"></a>00363         menu-&gt;Append(<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a2e16df9987ffe628f9c3379f468762b4">ID::HelpTips</a>,     _(<span class="stringliteral">&quot;Hints and Tips&quot;</span>));
<a name="l00364"></a>00364         menu-&gt;Append(<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a19e87388929f7a4f3d961de8105c5f6d">ID::HelpKeyboard</a>, _(<span class="stringliteral">&quot;Keyboard Shortcuts&quot;</span>));
<a name="l00365"></a>00365         menu-&gt;Append(<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a4c430f7f8809a8418a14a2641b48719a">ID::HelpMouse</a>,    _(<span class="stringliteral">&quot;Mouse Shortcuts&quot;</span>));
<a name="l00366"></a>00366         menu-&gt;AppendSeparator();
<a name="l00367"></a>00367         menu-&gt;Append(<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a34623182ac086372c85925d0939f666b">ID::HelpFile</a>,     _(<span class="stringliteral">&quot;File Menu&quot;</span>));
<a name="l00368"></a>00368         menu-&gt;Append(<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994ab5e85cc7435ed3454f3f5b980ed96e3d">ID::HelpEdit</a>,     _(<span class="stringliteral">&quot;Edit Menu&quot;</span>));
<a name="l00369"></a>00369         menu-&gt;Append(<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994aa6e5d26454218360dd70852ca324bec2">ID::HelpView</a>,     _(<span class="stringliteral">&quot;View Menu&quot;</span>));
<a name="l00370"></a>00370         menu-&gt;Append(<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a11c4f11523bb33079a18947830fa827e">ID::HelpAction</a>,   _(<span class="stringliteral">&quot;Action Menu&quot;</span>));
<a name="l00371"></a>00371         menu-&gt;Append(<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a34a6d520118d6a6012bd9e8f0f9a1560">ID::HelpHelp</a>,     _(<span class="stringliteral">&quot;Help Menu&quot;</span>));
<a name="l00372"></a>00372         menu-&gt;AppendSeparator();
<a name="l00373"></a>00373         menu-&gt;Append(<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a05b3c81109c55177ad668803cb8c6e1a">ID::HelpFormats</a>,  _(<span class="stringliteral">&quot;File Formats&quot;</span>));
<a name="l00374"></a>00374         menu-&gt;Append(<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a99d9508355ab71324cf773c2b607a41f">ID::HelpProblems</a>, _(<span class="stringliteral">&quot;Known Problems&quot;</span>));
<a name="l00375"></a>00375         menu-&gt;Append(<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a9f852fa906fbd919f0dd378129029422">ID::HelpChanges</a>,  _(<span class="stringliteral">&quot;Changes&quot;</span>));
<a name="l00376"></a>00376         menu-&gt;Append(<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a5aea20957851faa34cfbf82d59895b56">ID::HelpCredits</a>,  _(<span class="stringliteral">&quot;Credits&quot;</span>));
<a name="l00377"></a>00377         menu-&gt;AppendSeparator();
<a name="l00378"></a>00378         menu-&gt;Append(wxID_ABOUT,       _(<span class="stringliteral">&quot;&amp;About Ready&quot;</span>) + <a class="code" href="prefs_8cpp.html#ab9798965988e2083acef3da70016317f">GetAccelerator</a>(<a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a6c41bc6a32c0c5bb09a732a21cfccf4f">DO_ABOUT</a>));
<a name="l00379"></a>00379         menuBar-&gt;Append(menu, _(<span class="stringliteral">&quot;&amp;Help&quot;</span>));
<a name="l00380"></a>00380     }
<a name="l00381"></a>00381     SetMenuBar(menuBar);
<a name="l00382"></a>00382 }
<a name="l00383"></a>00383 
<a name="l00384"></a>00384 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l00385"></a>00385 
<a name="l00386"></a>00386 <span class="preprocessor">#ifdef __WXMAC__</span>
<a name="l00387"></a>00387 <span class="preprocessor"></span>    <span class="comment">// smaller toolbar bitmaps look much nicer on Mac</span>
<a name="l00388"></a>00388 <span class="preprocessor">    #undef wxART_TOOLBAR</span>
<a name="l00389"></a>00389 <span class="preprocessor"></span><span class="preprocessor">    #define wxART_TOOLBAR wxART_BUTTON</span>
<a name="l00390"></a>00390 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l00391"></a>00391 <span class="preprocessor"></span>
<a name="l00392"></a><a class="code" href="classMyFrame.html#ad18dcc0ba063d7b92ac9bb99eb92bebf">00392</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#ad18dcc0ba063d7b92ac9bb99eb92bebf">MyFrame::InitializeToolbars</a>()
<a name="l00393"></a>00393 {
<a name="l00394"></a>00394     {   <span class="comment">// file menu items</span>
<a name="l00395"></a>00395         wxAuiToolBar *tb = <span class="keyword">new</span> wxAuiToolBar(<span class="keyword">this</span>,<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a5dac25d358c2adfb6c19008ebfa48ccf">ID::FileToolbar</a>);
<a name="l00396"></a>00396         tb-&gt;AddTool(wxID_NEW,wxEmptyString,wxArtProvider::GetBitmap(wxART_NEW,wxART_TOOLBAR),_(<span class="stringliteral">&quot;Create a new pattern&quot;</span>));
<a name="l00397"></a>00397         tb-&gt;AddTool(wxID_OPEN,wxEmptyString,wxArtProvider::GetBitmap(wxART_FILE_OPEN,wxART_TOOLBAR),_(<span class="stringliteral">&quot;Choose a pattern file to open&quot;</span>));
<a name="l00398"></a>00398         tb-&gt;AddTool(wxID_SAVE,wxEmptyString,wxArtProvider::GetBitmap(wxART_FILE_SAVE,wxART_TOOLBAR),_(<span class="stringliteral">&quot;Save the current pattern&quot;</span>));
<a name="l00399"></a>00399 <span class="preprocessor">        #ifdef __WXMAC__</span>
<a name="l00400"></a>00400 <span class="preprocessor"></span>            tb-&gt;SetToolBorderPadding(10);
<a name="l00401"></a>00401 <span class="preprocessor">        #endif</span>
<a name="l00402"></a>00402 <span class="preprocessor"></span>        this-&gt;aui_mgr.AddPane(tb,wxAuiPaneInfo().ToolbarPane().Top().Name(<a class="code" href="frame_8cpp.html#adb2d02d23949d250b57d1b3e00210c70">PaneName</a>(<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a5dac25d358c2adfb6c19008ebfa48ccf">ID::FileToolbar</a>))
<a name="l00403"></a>00403             .Position(0).Caption(_(<span class="stringliteral">&quot;File tools&quot;</span>)));
<a name="l00404"></a>00404     }
<a name="l00405"></a>00405     {   <span class="comment">// action menu items</span>
<a name="l00406"></a>00406         this-&gt;action_toolbar = <span class="keyword">new</span> wxAuiToolBar(<span class="keyword">this</span>,<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994ac5933a5c56a2cda5c854446f3256ff91">ID::ActionToolbar</a>);
<a name="l00407"></a>00407         this-&gt;action_toolbar-&gt;AddTool(<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a29ce194c83647cde2066a129499a28b1">ID::Step1</a>,wxEmptyString,wxArtProvider::GetBitmap(wxART_PLUS,wxART_TOOLBAR),
<a name="l00408"></a>00408             _(<span class="stringliteral">&quot;Step by 1&quot;</span>));
<a name="l00409"></a>00409         this-&gt;action_toolbar-&gt;AddTool(<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a7fa86a9ca58943a68ee72c2278d7091f">ID::RunStop</a>,wxEmptyString,wxArtProvider::GetBitmap(wxART_GO_FORWARD,wxART_TOOLBAR),
<a name="l00410"></a>00410             _(<span class="stringliteral">&quot;Start running the simulation&quot;</span>));
<a name="l00411"></a>00411         this-&gt;action_toolbar-&gt;AddTool(<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994ae64df26aa1aa17c056626418eeba266c">ID::Reset</a>,wxEmptyString,wxArtProvider::GetBitmap(wxART_GOTO_FIRST,wxART_TOOLBAR),
<a name="l00412"></a>00412             _(<span class="stringliteral">&quot;Go back to the starting pattern&quot;</span>));
<a name="l00413"></a>00413         this-&gt;action_toolbar-&gt;AddTool(<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a8b6dde37a380581b5c30d1d5f912f183">ID::GenerateInitialPattern</a>,wxEmptyString,wxArtProvider::GetBitmap(wxART_EXECUTABLE_FILE,wxART_TOOLBAR),
<a name="l00414"></a>00414             _(<span class="stringliteral">&quot;Run the Initial Pattern Generator&quot;</span>));
<a name="l00415"></a>00415 <span class="preprocessor">        #ifdef __WXMAC__</span>
<a name="l00416"></a>00416 <span class="preprocessor"></span>            this-&gt;action_toolbar-&gt;SetToolBorderPadding(10);
<a name="l00417"></a>00417 <span class="preprocessor">        #endif</span>
<a name="l00418"></a>00418 <span class="preprocessor"></span>        this-&gt;aui_mgr.AddPane(this-&gt;action_toolbar,wxAuiPaneInfo().ToolbarPane().Top()
<a name="l00419"></a>00419             .Name(<a class="code" href="frame_8cpp.html#adb2d02d23949d250b57d1b3e00210c70">PaneName</a>(<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994ac5933a5c56a2cda5c854446f3256ff91">ID::ActionToolbar</a>)).Position(1).Caption(_(<span class="stringliteral">&quot;Action tools&quot;</span>)));
<a name="l00420"></a>00420     }
<a name="l00421"></a>00421 }
<a name="l00422"></a>00422 
<a name="l00423"></a>00423 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l00424"></a>00424 
<a name="l00425"></a><a class="code" href="classMyFrame.html#aa3c6e7102c269c79b734517e5da97ed2">00425</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#aa3c6e7102c269c79b734517e5da97ed2">MyFrame::InitializePatternsPane</a>()
<a name="l00426"></a>00426 {
<a name="l00427"></a>00427     this-&gt;patterns_panel = <span class="keyword">new</span> <a class="code" href="classPatternsPanel.html" title="The patterns panel lets users click on pattern files.">PatternsPanel</a>(<span class="keyword">this</span>,wxID_ANY);
<a name="l00428"></a>00428     this-&gt;aui_mgr.AddPane(this-&gt;patterns_panel,
<a name="l00429"></a>00429                   wxAuiPaneInfo()
<a name="l00430"></a>00430                   .Name(<a class="code" href="frame_8cpp.html#adb2d02d23949d250b57d1b3e00210c70">PaneName</a>(<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994acb63579b388e2e1b0fa5117d6bc55e08">ID::PatternsPane</a>))
<a name="l00431"></a>00431                   .Caption(_(<span class="stringliteral">&quot;Patterns Pane&quot;</span>))
<a name="l00432"></a>00432                   .Left()
<a name="l00433"></a>00433                   .BestSize(220,600)
<a name="l00434"></a>00434                   .Position(0)
<a name="l00435"></a>00435                   );
<a name="l00436"></a>00436 }
<a name="l00437"></a>00437 
<a name="l00438"></a>00438 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l00439"></a>00439 
<a name="l00440"></a><a class="code" href="classMyFrame.html#a843de9600d3363f8c49aeacca8fcefe9">00440</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#a843de9600d3363f8c49aeacca8fcefe9">MyFrame::InitializeInfoPane</a>()
<a name="l00441"></a>00441 {
<a name="l00442"></a>00442     this-&gt;info_panel = <span class="keyword">new</span> <a class="code" href="classInfoPanel.html" title="This panel allows the user to change the parameters of an RD system.">InfoPanel</a>(<span class="keyword">this</span>,wxID_ANY);
<a name="l00443"></a>00443     this-&gt;aui_mgr.AddPane(this-&gt;info_panel,
<a name="l00444"></a>00444                   wxAuiPaneInfo()
<a name="l00445"></a>00445                   .Name(<a class="code" href="frame_8cpp.html#adb2d02d23949d250b57d1b3e00210c70">PaneName</a>(<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a9a7b8f50f338bc1f33bbb46a265c66b2">ID::InfoPane</a>))
<a name="l00446"></a>00446                   .Caption(_(<span class="stringliteral">&quot;Info Pane&quot;</span>))
<a name="l00447"></a>00447                   .Right()
<a name="l00448"></a>00448                   .BestSize(500,300)
<a name="l00449"></a>00449                   .Position(0)
<a name="l00450"></a>00450                   );
<a name="l00451"></a>00451 }
<a name="l00452"></a>00452 
<a name="l00453"></a>00453 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l00454"></a>00454 
<a name="l00455"></a><a class="code" href="classMyFrame.html#a5e712e937780b265b60781518399df4e">00455</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#a5e712e937780b265b60781518399df4e">MyFrame::UpdateInfoPane</a>()
<a name="l00456"></a>00456 {
<a name="l00457"></a>00457     this-&gt;info_panel-&gt;Update(this-&gt;system);
<a name="l00458"></a>00458 }
<a name="l00459"></a>00459 
<a name="l00460"></a>00460 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l00461"></a>00461 
<a name="l00462"></a><a class="code" href="classMyFrame.html#a810d4a6ef18c288fc6c7bab3d8cbea14">00462</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#a810d4a6ef18c288fc6c7bab3d8cbea14">MyFrame::InitializeHelpPane</a>()
<a name="l00463"></a>00463 {
<a name="l00464"></a>00464     this-&gt;help_panel = <span class="keyword">new</span> <a class="code" href="classHelpPanel.html" title="The help panel displays .html files (stored in the Help folder or elsewhere).">HelpPanel</a>(<span class="keyword">this</span>,wxID_ANY);
<a name="l00465"></a>00465     this-&gt;aui_mgr.AddPane(this-&gt;help_panel,
<a name="l00466"></a>00466                   wxAuiPaneInfo()
<a name="l00467"></a>00467                   .Name(<a class="code" href="frame_8cpp.html#adb2d02d23949d250b57d1b3e00210c70">PaneName</a>(<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994aa793fe9cd53e4212456e78a881d61e73">ID::HelpPane</a>))
<a name="l00468"></a>00468                   .Caption(_(<span class="stringliteral">&quot;Help Pane&quot;</span>))
<a name="l00469"></a>00469                   .Right()
<a name="l00470"></a>00470                   .BestSize(500,300)
<a name="l00471"></a>00471                   .Position(1)
<a name="l00472"></a>00472                   );
<a name="l00473"></a>00473 }
<a name="l00474"></a>00474 
<a name="l00475"></a>00475 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l00476"></a>00476 
<a name="l00477"></a>00477 <span class="preprocessor">#if wxUSE_DRAG_AND_DROP</span>
<a name="l00478"></a>00478 <span class="preprocessor"></span>
<a name="l00479"></a>00479 <span class="comment">// derive a simple class for handling dropped files</span>
<a name="l00480"></a>00480 <span class="keyword">class </span>DnDFile : <span class="keyword">public</span> wxFileDropTarget
<a name="l00481"></a>00481 {
<a name="l00482"></a>00482 <span class="keyword">public</span>:
<a name="l00483"></a>00483     DnDFile() {}
<a name="l00484"></a>00484     <span class="keyword">virtual</span> <span class="keywordtype">bool</span> OnDropFiles(wxCoord x, wxCoord y, <span class="keyword">const</span> wxArrayString&amp; filenames);
<a name="l00485"></a>00485 };
<a name="l00486"></a>00486 
<a name="l00487"></a>00487 <span class="keywordtype">bool</span> DnDFile::OnDropFiles(wxCoord, wxCoord, <span class="keyword">const</span> wxArrayString&amp; filenames)
<a name="l00488"></a>00488 {
<a name="l00489"></a>00489     <a class="code" href="classMyFrame.html" title="The wxFrame-derived top-level window for the Ready GUI.">MyFrame</a>* frameptr = wxGetApp().currframe;
<a name="l00490"></a>00490 
<a name="l00491"></a>00491     <span class="comment">// bring app to front</span>
<a name="l00492"></a>00492 <span class="preprocessor">    #ifdef __WXMAC__</span>
<a name="l00493"></a>00493 <span class="preprocessor"></span>        ProcessSerialNumber process;
<a name="l00494"></a>00494         <span class="keywordflow">if</span> ( GetCurrentProcess(&amp;process) == noErr ) SetFrontProcess(&amp;process);
<a name="l00495"></a>00495 <span class="preprocessor">    #endif</span>
<a name="l00496"></a>00496 <span class="preprocessor"></span><span class="preprocessor">    #ifdef __WXMSW__</span>
<a name="l00497"></a>00497 <span class="preprocessor"></span>        SetForegroundWindow( (HWND)frameptr-&gt;GetHandle() );
<a name="l00498"></a>00498 <span class="preprocessor">    #endif</span>
<a name="l00499"></a>00499 <span class="preprocessor"></span>    frameptr-&gt;Raise();
<a name="l00500"></a>00500    
<a name="l00501"></a>00501     <span class="keywordtype">size_t</span> numfiles = filenames.GetCount();
<a name="l00502"></a>00502     <span class="keywordflow">for</span> ( <span class="keywordtype">size_t</span> n = 0; n &lt; numfiles; n++ ) {
<a name="l00503"></a>00503         frameptr-&gt;<a class="code" href="classMyFrame.html#a436d29334a575795c92361ba33bf06c3">OpenFile</a>(filenames[n]);
<a name="l00504"></a>00504     }
<a name="l00505"></a>00505     <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00506"></a>00506 }
<a name="l00507"></a>00507 
<a name="l00508"></a>00508 <span class="preprocessor">#endif // wxUSE_DRAG_AND_DROP</span>
<a name="l00509"></a>00509 <span class="preprocessor"></span>
<a name="l00510"></a>00510 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l00511"></a>00511 
<a name="l00512"></a><a class="code" href="classMyFrame.html#aadb4cf00bea27ef97342047b36ee6d1f">00512</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#aadb4cf00bea27ef97342047b36ee6d1f">MyFrame::InitializeRenderPane</a>()
<a name="l00513"></a>00513 {
<a name="l00514"></a>00514     <span class="comment">// for now the VTK window goes in the center pane (always visible) - we got problems when had in a floating pane</span>
<a name="l00515"></a>00515     vtkObject::GlobalWarningDisplayOff(); <span class="comment">// (can turn on for debugging)</span>
<a name="l00516"></a>00516     this-&gt;pVTKWindow = <span class="keyword">new</span> <a class="code" href="classwxVTKRenderWindowInteractor.html">wxVTKRenderWindowInteractor</a>(<span class="keyword">this</span>,wxID_ANY);
<a name="l00517"></a>00517     this-&gt;aui_mgr.AddPane(this-&gt;pVTKWindow,
<a name="l00518"></a>00518                   wxAuiPaneInfo()
<a name="l00519"></a>00519                   .Name(<a class="code" href="frame_8cpp.html#adb2d02d23949d250b57d1b3e00210c70">PaneName</a>(<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a67f9b0b6dcbe03c4ba95bd0755a05617">ID::CanvasPane</a>))
<a name="l00520"></a>00520                   <span class="comment">// AKT TODO!!! why don&#39;t we see caption??? (it would be nice to see when it has focus)</span>
<a name="l00521"></a>00521                   .Caption(_(<span class="stringliteral">&quot;Render Pane&quot;</span>)).CaptionVisible()
<a name="l00522"></a>00522                   .CenterPane()
<a name="l00523"></a>00523                   .BestSize(400,400)
<a name="l00524"></a>00524                   );
<a name="l00525"></a>00525 
<a name="l00526"></a>00526 <span class="preprocessor">    #if wxUSE_DRAG_AND_DROP</span>
<a name="l00527"></a>00527 <span class="preprocessor"></span>        <span class="comment">// let users drag-and-drop pattern files onto the render pane</span>
<a name="l00528"></a>00528         this-&gt;pVTKWindow-&gt;SetDropTarget(<span class="keyword">new</span> DnDFile());
<a name="l00529"></a>00529 <span class="preprocessor">    #endif</span>
<a name="l00530"></a>00530 <span class="preprocessor"></span>
<a name="l00531"></a>00531     <span class="comment">// install event handlers to detect keyboard shortcuts when render window has focus</span>
<a name="l00532"></a>00532     this-&gt;pVTKWindow-&gt;Connect(wxEVT_KEY_DOWN, wxKeyEventHandler(<a class="code" href="classMyFrame.html#ac0457b9e23e582141215c35e5d42d97c">MyFrame::OnKeyDown</a>), NULL, <span class="keyword">this</span>);
<a name="l00533"></a>00533     this-&gt;pVTKWindow-&gt;Connect(wxEVT_CHAR, wxKeyEventHandler(<a class="code" href="classMyFrame.html#a7d2dd27713dc21ead65462aeca0d0d75">MyFrame::OnChar</a>), NULL, <span class="keyword">this</span>);
<a name="l00534"></a>00534 }
<a name="l00535"></a>00535 
<a name="l00536"></a>00536 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l00537"></a>00537 
<a name="l00538"></a><a class="code" href="classMyFrame.html#a56af1181b6f87b92e35dcbbd450dd5f2">00538</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#a56af1181b6f87b92e35dcbbd450dd5f2">MyFrame::LoadSettings</a>()
<a name="l00539"></a>00539 {
<a name="l00540"></a>00540     <span class="comment">// use global info set by GetPrefs()</span>
<a name="l00541"></a>00541     this-&gt;SetPosition(wxPoint(<a class="code" href="prefs_8cpp.html#a26b11189d93fef33172f1a2a1d174188">mainx</a>,<a class="code" href="prefs_8cpp.html#a8b015efaa4cb16287077ac74b60ad67a">mainy</a>));
<a name="l00542"></a>00542     this-&gt;SetSize(<a class="code" href="prefs_8cpp.html#a7b08ad54bec54f213c5ed4c1d8749548">mainwd</a>,<a class="code" href="prefs_8cpp.html#afd8ee1110367c04cc21e2219607b7a7b">mainht</a>);
<a name="l00543"></a>00543     <span class="keywordflow">if</span> (<a class="code" href="prefs_8cpp.html#a9c5a9f65dc02b9e7ed8abef92565e5fa">auilayout</a>.length() &gt; 0) this-&gt;aui_mgr.LoadPerspective(<a class="code" href="prefs_8cpp.html#a9c5a9f65dc02b9e7ed8abef92565e5fa">auilayout</a>);
<a name="l00544"></a>00544 }
<a name="l00545"></a>00545 
<a name="l00546"></a>00546 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l00547"></a>00547 
<a name="l00548"></a><a class="code" href="classMyFrame.html#a41c4b3fdce4d573112daac75a9fda896">00548</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#a41c4b3fdce4d573112daac75a9fda896">MyFrame::SaveSettings</a>()
<a name="l00549"></a>00549 {
<a name="l00550"></a>00550     <span class="keywordflow">if</span> (fullscreen) {
<a name="l00551"></a>00551         <span class="comment">// use auilayout saved earlier in OnFullScreen</span>
<a name="l00552"></a>00552     } <span class="keywordflow">else</span> {
<a name="l00553"></a>00553         <a class="code" href="prefs_8cpp.html#a9c5a9f65dc02b9e7ed8abef92565e5fa">auilayout</a> = this-&gt;aui_mgr.SavePerspective();
<a name="l00554"></a>00554     }
<a name="l00555"></a>00555     <a class="code" href="prefs_8cpp.html#a36a6fcc2c220a813bd9f3057c8c8bfc1">SavePrefs</a>();
<a name="l00556"></a>00556 }
<a name="l00557"></a>00557 
<a name="l00558"></a>00558 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l00559"></a>00559 
<a name="l00560"></a><a class="code" href="classMyFrame.html#a9e6c4824efad3aa9f4c3a3025a616e2d">00560</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#a9e6c4824efad3aa9f4c3a3025a616e2d">MyFrame::OnQuit</a>(wxCommandEvent&amp; WXUNUSED(event))
<a name="l00561"></a>00561 {
<a name="l00562"></a>00562     <span class="keywordflow">if</span>(UserWantsToCancelWhenAskedIfWantsToSave()) <span class="keywordflow">return</span>;
<a name="l00563"></a>00563     Close(<span class="keyword">true</span>);
<a name="l00564"></a>00564 }
<a name="l00565"></a>00565 
<a name="l00566"></a>00566 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l00567"></a>00567 
<a name="l00568"></a><a class="code" href="classMyFrame.html#ab470cba0c5d8d46980c602589d556ee5">00568</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#ab470cba0c5d8d46980c602589d556ee5">MyFrame::OnAbout</a>(wxCommandEvent&amp; WXUNUSED(event))
<a name="l00569"></a>00569 {
<a name="l00570"></a>00570     <a class="code" href="HelpPanel_8cpp.html#a69114324160abe189b7412b8a56308f9">ShowAboutBox</a>();
<a name="l00571"></a>00571 }
<a name="l00572"></a>00572 
<a name="l00573"></a>00573 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l00574"></a>00574 
<a name="l00575"></a><a class="code" href="classMyFrame.html#a96aaaff9d90a787f70587d5d9184f27b">00575</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#a96aaaff9d90a787f70587d5d9184f27b">MyFrame::OnCut</a>(wxCommandEvent&amp; event)
<a name="l00576"></a>00576 {
<a name="l00577"></a>00577     <span class="comment">// action depends on which pane has focus</span>
<a name="l00578"></a>00578     <span class="keywordflow">if</span> (this-&gt;info_panel-&gt;HtmlHasFocus()) <span class="keywordflow">return</span>;
<a name="l00579"></a>00579     <span class="keywordflow">if</span> (this-&gt;help_panel-&gt;HtmlHasFocus()) <span class="keywordflow">return</span>;
<a name="l00580"></a>00580     <span class="keyword">event</span>.Skip();
<a name="l00581"></a>00581 }
<a name="l00582"></a>00582 
<a name="l00583"></a>00583 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l00584"></a>00584 
<a name="l00585"></a><a class="code" href="classMyFrame.html#a5a67d598f37e13825032c15ce275e30d">00585</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#a5a67d598f37e13825032c15ce275e30d">MyFrame::OnCopy</a>(wxCommandEvent&amp; event)
<a name="l00586"></a>00586 {
<a name="l00587"></a>00587     <span class="comment">// action depends on which pane has focus</span>
<a name="l00588"></a>00588     <span class="keywordflow">if</span> (this-&gt;info_panel-&gt;HtmlHasFocus()) {
<a name="l00589"></a>00589         this-&gt;info_panel-&gt;CopySelection();
<a name="l00590"></a>00590         <span class="keywordflow">return</span>;
<a name="l00591"></a>00591     }
<a name="l00592"></a>00592     <span class="keywordflow">if</span> (this-&gt;help_panel-&gt;HtmlHasFocus()) {
<a name="l00593"></a>00593         this-&gt;help_panel-&gt;CopySelection();
<a name="l00594"></a>00594         <span class="keywordflow">return</span>;
<a name="l00595"></a>00595     }
<a name="l00596"></a>00596     <span class="keyword">event</span>.Skip();
<a name="l00597"></a>00597 }
<a name="l00598"></a>00598 
<a name="l00599"></a>00599 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l00600"></a>00600 
<a name="l00601"></a><a class="code" href="classMyFrame.html#a6b7eb93dc671ae87351d9555f5b0d0d5">00601</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#a6b7eb93dc671ae87351d9555f5b0d0d5">MyFrame::OnPaste</a>(wxCommandEvent&amp; event)
<a name="l00602"></a>00602 {
<a name="l00603"></a>00603     <span class="comment">// action depends on which pane has focus</span>
<a name="l00604"></a>00604     <span class="keywordflow">if</span> (this-&gt;info_panel-&gt;HtmlHasFocus()) <span class="keywordflow">return</span>;
<a name="l00605"></a>00605     <span class="keywordflow">if</span> (this-&gt;help_panel-&gt;HtmlHasFocus()) <span class="keywordflow">return</span>;
<a name="l00606"></a>00606     <span class="keyword">event</span>.Skip();
<a name="l00607"></a>00607 }
<a name="l00608"></a>00608 
<a name="l00609"></a>00609 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l00610"></a>00610 
<a name="l00611"></a><a class="code" href="classMyFrame.html#ac12aa086bdab2c68f62c9b52f819f88c">00611</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#ac12aa086bdab2c68f62c9b52f819f88c">MyFrame::OnUpdatePaste</a>(wxUpdateUIEvent&amp; event)
<a name="l00612"></a>00612 {
<a name="l00613"></a>00613     <span class="keyword">event</span>.Enable(<a class="code" href="wxutils_8cpp.html#a9207b602b6bd12d3c7283558f80e5dc8">ClipboardHasText</a>());
<a name="l00614"></a>00614 }
<a name="l00615"></a>00615 
<a name="l00616"></a>00616 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l00617"></a>00617 
<a name="l00618"></a><a class="code" href="classMyFrame.html#ae65e6947cf2f55d5a10391f69d1b0557">00618</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#ae65e6947cf2f55d5a10391f69d1b0557">MyFrame::OnClear</a>(wxCommandEvent&amp; event)
<a name="l00619"></a>00619 {
<a name="l00620"></a>00620     <span class="comment">// action depends on which pane has focus</span>
<a name="l00621"></a>00621     <span class="keywordflow">if</span> (this-&gt;info_panel-&gt;HtmlHasFocus()) <span class="keywordflow">return</span>;
<a name="l00622"></a>00622     <span class="keywordflow">if</span> (this-&gt;help_panel-&gt;HtmlHasFocus()) <span class="keywordflow">return</span>;
<a name="l00623"></a>00623     <span class="keyword">event</span>.Skip();
<a name="l00624"></a>00624 }
<a name="l00625"></a>00625 
<a name="l00626"></a>00626 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l00627"></a>00627 
<a name="l00628"></a><a class="code" href="classMyFrame.html#a23a6bc0797a79648a27a18c5ecb6bb7d">00628</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#a23a6bc0797a79648a27a18c5ecb6bb7d">MyFrame::OnSelectAll</a>(wxCommandEvent&amp; event)
<a name="l00629"></a>00629 {
<a name="l00630"></a>00630     <span class="comment">// action depends on which pane has focus</span>
<a name="l00631"></a>00631     <span class="keywordflow">if</span> (this-&gt;info_panel-&gt;HtmlHasFocus()) {
<a name="l00632"></a>00632         this-&gt;info_panel-&gt;SelectAllText();
<a name="l00633"></a>00633         <span class="keywordflow">return</span>;
<a name="l00634"></a>00634     }
<a name="l00635"></a>00635     <span class="keywordflow">if</span> (this-&gt;help_panel-&gt;HtmlHasFocus()) {
<a name="l00636"></a>00636         this-&gt;help_panel-&gt;SelectAllText();
<a name="l00637"></a>00637         <span class="keywordflow">return</span>;
<a name="l00638"></a>00638     }
<a name="l00639"></a>00639     <span class="keyword">event</span>.Skip();
<a name="l00640"></a>00640 }
<a name="l00641"></a>00641 
<a name="l00642"></a>00642 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l00643"></a>00643 
<a name="l00644"></a><a class="code" href="classMyFrame.html#aedf9dc8c2a723fd8de16d90596500b50">00644</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#aedf9dc8c2a723fd8de16d90596500b50">MyFrame::OnFullScreen</a>(wxCommandEvent&amp; event)
<a name="l00645"></a>00645 {
<a name="l00646"></a>00646     <span class="keyword">static</span> <span class="keywordtype">bool</span> restorestatus;  <span class="comment">// restore the status bar?</span>
<a name="l00647"></a>00647     
<a name="l00648"></a>00648     wxStatusBar* statusbar = GetStatusBar();
<a name="l00649"></a>00649     
<a name="l00650"></a>00650     <span class="keywordflow">if</span> (!fullscreen) {
<a name="l00651"></a>00651         <span class="comment">// save current location and size for use in SavePrefs</span>
<a name="l00652"></a>00652         wxRect r = GetRect();
<a name="l00653"></a>00653         <a class="code" href="prefs_8cpp.html#a26b11189d93fef33172f1a2a1d174188">mainx</a> = r.x;
<a name="l00654"></a>00654         <a class="code" href="prefs_8cpp.html#a8b015efaa4cb16287077ac74b60ad67a">mainy</a> = r.y;
<a name="l00655"></a>00655         <a class="code" href="prefs_8cpp.html#a7b08ad54bec54f213c5ed4c1d8749548">mainwd</a> = r.width;
<a name="l00656"></a>00656         <a class="code" href="prefs_8cpp.html#afd8ee1110367c04cc21e2219607b7a7b">mainht</a> = r.height;
<a name="l00657"></a>00657         <span class="comment">// also save current perspective</span>
<a name="l00658"></a>00658         <a class="code" href="prefs_8cpp.html#a9c5a9f65dc02b9e7ed8abef92565e5fa">auilayout</a> = this-&gt;aui_mgr.SavePerspective();
<a name="l00659"></a>00659     } <span class="keywordflow">else</span> {
<a name="l00660"></a>00660         <span class="comment">// restore status bar before calling ShowFullScreen (so we see status text in Mac app)</span>
<a name="l00661"></a>00661         <span class="keywordflow">if</span> (restorestatus) statusbar-&gt;Show();
<a name="l00662"></a>00662     }
<a name="l00663"></a>00663 
<a name="l00664"></a>00664     fullscreen = !fullscreen;
<a name="l00665"></a>00665     ShowFullScreen(fullscreen, wxFULLSCREEN_NOMENUBAR | wxFULLSCREEN_NOBORDER | wxFULLSCREEN_NOCAPTION);
<a name="l00666"></a>00666 
<a name="l00667"></a>00667     <span class="keywordflow">if</span> (fullscreen) {
<a name="l00668"></a>00668         <span class="comment">// hide the status bar</span>
<a name="l00669"></a>00669         restorestatus = statusbar &amp;&amp; statusbar-&gt;IsShown();
<a name="l00670"></a>00670         <span class="keywordflow">if</span> (restorestatus) statusbar-&gt;Hide();
<a name="l00671"></a>00671 
<a name="l00672"></a>00672         <span class="comment">// hide all currently shown panes</span>
<a name="l00673"></a>00673         wxAuiPaneInfo &amp;pattpane = this-&gt;aui_mgr.GetPane(<a class="code" href="frame_8cpp.html#adb2d02d23949d250b57d1b3e00210c70">PaneName</a>(<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994acb63579b388e2e1b0fa5117d6bc55e08">ID::PatternsPane</a>));
<a name="l00674"></a>00674         wxAuiPaneInfo &amp;infopane = this-&gt;aui_mgr.GetPane(<a class="code" href="frame_8cpp.html#adb2d02d23949d250b57d1b3e00210c70">PaneName</a>(<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a9a7b8f50f338bc1f33bbb46a265c66b2">ID::InfoPane</a>));
<a name="l00675"></a>00675         wxAuiPaneInfo &amp;helppane = this-&gt;aui_mgr.GetPane(<a class="code" href="frame_8cpp.html#adb2d02d23949d250b57d1b3e00210c70">PaneName</a>(<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994aa793fe9cd53e4212456e78a881d61e73">ID::HelpPane</a>));
<a name="l00676"></a>00676         wxAuiPaneInfo &amp;filepane = this-&gt;aui_mgr.GetPane(<a class="code" href="frame_8cpp.html#adb2d02d23949d250b57d1b3e00210c70">PaneName</a>(<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a5dac25d358c2adfb6c19008ebfa48ccf">ID::FileToolbar</a>));
<a name="l00677"></a>00677         wxAuiPaneInfo &amp;actionpane = this-&gt;aui_mgr.GetPane(<a class="code" href="frame_8cpp.html#adb2d02d23949d250b57d1b3e00210c70">PaneName</a>(<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994ac5933a5c56a2cda5c854446f3256ff91">ID::ActionToolbar</a>));
<a name="l00678"></a>00678         
<a name="l00679"></a>00679         <span class="keywordflow">if</span> (pattpane.IsOk() &amp;&amp; pattpane.IsShown()) pattpane.Show(<span class="keyword">false</span>);
<a name="l00680"></a>00680         <span class="keywordflow">if</span> (infopane.IsOk() &amp;&amp; infopane.IsShown()) infopane.Show(<span class="keyword">false</span>);
<a name="l00681"></a>00681         <span class="keywordflow">if</span> (helppane.IsOk() &amp;&amp; helppane.IsShown()) helppane.Show(<span class="keyword">false</span>);
<a name="l00682"></a>00682         <span class="keywordflow">if</span> (filepane.IsOk() &amp;&amp; filepane.IsShown()) filepane.Show(<span class="keyword">false</span>);
<a name="l00683"></a>00683         <span class="keywordflow">if</span> (actionpane.IsOk() &amp;&amp; actionpane.IsShown()) actionpane.Show(<span class="keyword">false</span>);
<a name="l00684"></a>00684         
<a name="l00685"></a>00685         <span class="comment">// ensure the render window sees keyboard shortcuts</span>
<a name="l00686"></a>00686         this-&gt;pVTKWindow-&gt;SetFocus();
<a name="l00687"></a>00687 
<a name="l00688"></a>00688     } <span class="keywordflow">else</span> {
<a name="l00689"></a>00689         <span class="comment">// restore saved perspective</span>
<a name="l00690"></a>00690         this-&gt;aui_mgr.LoadPerspective(<a class="code" href="prefs_8cpp.html#a9c5a9f65dc02b9e7ed8abef92565e5fa">auilayout</a>);
<a name="l00691"></a>00691     }
<a name="l00692"></a>00692     
<a name="l00693"></a>00693     this-&gt;aui_mgr.Update();
<a name="l00694"></a>00694 }
<a name="l00695"></a>00695 
<a name="l00696"></a>00696 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l00697"></a>00697 
<a name="l00698"></a><a class="code" href="classMyFrame.html#afa6b1e7abbc33e4c1a487e796f2f183b">00698</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#afa6b1e7abbc33e4c1a487e796f2f183b">MyFrame::OnFitPattern</a>(wxCommandEvent&amp; event)
<a name="l00699"></a>00699 {
<a name="l00700"></a>00700     <span class="comment">// reset the active camera in all the renderers in this render window</span>
<a name="l00701"></a>00701     vtkRenderWindow* renWin = this-&gt;pVTKWindow-&gt;GetRenderWindow();
<a name="l00702"></a>00702     renWin-&gt;GetRenderers()-&gt;InitTraversal();
<a name="l00703"></a>00703     vtkRenderer *ren;
<a name="l00704"></a>00704     <span class="keywordflow">while</span>(ren = renWin-&gt;GetRenderers()-&gt;GetNextItem())
<a name="l00705"></a>00705         ren-&gt;ResetCamera();
<a name="l00706"></a>00706     this-&gt;Refresh(<span class="keyword">false</span>);
<a name="l00707"></a>00707 }
<a name="l00708"></a>00708 
<a name="l00709"></a>00709 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l00710"></a>00710 
<a name="l00711"></a><a class="code" href="classMyFrame.html#a79715a0026a2ba48bffc82408d5486eb">00711</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#a79715a0026a2ba48bffc82408d5486eb">MyFrame::OnWireframe</a>(wxCommandEvent&amp; event)
<a name="l00712"></a>00712 {
<a name="l00713"></a>00713     <span class="keywordtype">bool</span> wireframe = this-&gt;render_settings.GetProperty(<span class="stringliteral">&quot;use_wireframe&quot;</span>).GetBool();
<a name="l00714"></a>00714     wireframe = !wireframe;
<a name="l00715"></a>00715     this-&gt;render_settings.GetProperty(<span class="stringliteral">&quot;use_wireframe&quot;</span>).SetBool(wireframe);
<a name="l00716"></a>00716     <a class="code" href="vtk__pipeline_8cpp.html#a83eef6bea304823921ff32ce0afb6d2b">InitializeVTKPipeline</a>(this-&gt;pVTKWindow,this-&gt;system,this-&gt;render_settings,<span class="keyword">false</span>);
<a name="l00717"></a>00717     this-&gt;UpdateInfoPane();
<a name="l00718"></a>00718     this-&gt;Refresh(<span class="keyword">false</span>);
<a name="l00719"></a>00719 }
<a name="l00720"></a>00720 
<a name="l00721"></a>00721 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l00722"></a>00722 
<a name="l00723"></a><a class="code" href="classMyFrame.html#a43362d67fa9bc3454691762cb1e55b54">00723</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#a43362d67fa9bc3454691762cb1e55b54">MyFrame::OnUpdateWireframe</a>(wxUpdateUIEvent&amp; event)
<a name="l00724"></a>00724 {
<a name="l00725"></a>00725     <span class="keyword">event</span>.Check(this-&gt;render_settings.GetProperty(<span class="stringliteral">&quot;use_wireframe&quot;</span>).GetBool());
<a name="l00726"></a>00726 }
<a name="l00727"></a>00727 
<a name="l00728"></a>00728 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l00729"></a>00729 
<a name="l00730"></a><a class="code" href="classMyFrame.html#afde773529f2d2d6b619683c3349b8808">00730</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#afde773529f2d2d6b619683c3349b8808">MyFrame::OnToggleViewPane</a>(wxCommandEvent&amp; event)
<a name="l00731"></a>00731 {
<a name="l00732"></a>00732     wxAuiPaneInfo &amp;pane = this-&gt;aui_mgr.GetPane(<a class="code" href="frame_8cpp.html#adb2d02d23949d250b57d1b3e00210c70">PaneName</a>(event.GetId()));
<a name="l00733"></a>00733     <span class="keywordflow">if</span>(!pane.IsOk()) <span class="keywordflow">return</span>;
<a name="l00734"></a>00734     pane.Show(!pane.IsShown());
<a name="l00735"></a>00735     this-&gt;aui_mgr.Update();
<a name="l00736"></a>00736 }
<a name="l00737"></a>00737 
<a name="l00738"></a>00738 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l00739"></a>00739 
<a name="l00740"></a><a class="code" href="classMyFrame.html#ae6b2e6360847eafb8e030e1c1c0174ad">00740</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#ae6b2e6360847eafb8e030e1c1c0174ad">MyFrame::OnUpdateViewPane</a>(wxUpdateUIEvent&amp; event)
<a name="l00741"></a>00741 {
<a name="l00742"></a>00742     wxAuiPaneInfo &amp;pane = this-&gt;aui_mgr.GetPane(<a class="code" href="frame_8cpp.html#adb2d02d23949d250b57d1b3e00210c70">PaneName</a>(event.GetId()));
<a name="l00743"></a>00743     <span class="keywordflow">if</span>(!pane.IsOk()) <span class="keywordflow">return</span>;
<a name="l00744"></a>00744     <span class="keyword">event</span>.Check(pane.IsShown());
<a name="l00745"></a>00745 }
<a name="l00746"></a>00746 
<a name="l00747"></a>00747 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l00748"></a>00748 
<a name="l00749"></a><a class="code" href="classMyFrame.html#a97767bd1acede9a4755cda62741a6cf6">00749</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#a97767bd1acede9a4755cda62741a6cf6">MyFrame::OnOpenCLDiagnostics</a>(wxCommandEvent&amp; event)
<a name="l00750"></a>00750 {
<a name="l00751"></a>00751     <span class="comment">// TODO: merge this with SelectOpenCLDevice?</span>
<a name="l00752"></a>00752     wxString txt;
<a name="l00753"></a>00753     {
<a name="l00754"></a>00754         wxBusyCursor busy;
<a name="l00755"></a>00755         txt = wxString(<a class="code" href="namespaceOpenCL__utils.html#af6a3ee46b7c1f42b9f5a18d9de6b5f10" title="Returns a full report on the available OpenCL devices.">OpenCL_utils::GetOpenCLDiagnostics</a>().c_str(),wxConvUTF8);
<a name="l00756"></a>00756     }
<a name="l00757"></a>00757     <a class="code" href="classMonospaceMessageBox.html" title="Displays a block of text in a monospace font.">MonospaceMessageBox</a>(txt,_(<span class="stringliteral">&quot;OpenCL diagnostics&quot;</span>),wxART_INFORMATION);
<a name="l00758"></a>00758 }
<a name="l00759"></a>00759 
<a name="l00760"></a>00760 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l00761"></a>00761 
<a name="l00762"></a><a class="code" href="classMyFrame.html#ade1ee7abd7620c01deeafaee1c75a79d">00762</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#ade1ee7abd7620c01deeafaee1c75a79d">MyFrame::OnSize</a>(wxSizeEvent&amp; event)
<a name="l00763"></a>00763 {
<a name="l00764"></a>00764 <span class="preprocessor">#ifdef __WXMSW__</span>
<a name="l00765"></a>00765 <span class="preprocessor"></span>    <span class="keywordflow">if</span>(this-&gt;pVTKWindow) {
<a name="l00766"></a>00766         <span class="comment">// save current location and size for use in SavePrefs if app</span>
<a name="l00767"></a>00767         <span class="comment">// is closed when window is minimized</span>
<a name="l00768"></a>00768         wxRect r = GetRect();
<a name="l00769"></a>00769         <a class="code" href="prefs_8cpp.html#a26b11189d93fef33172f1a2a1d174188">mainx</a> = r.x;
<a name="l00770"></a>00770         <a class="code" href="prefs_8cpp.html#a8b015efaa4cb16287077ac74b60ad67a">mainy</a> = r.y;
<a name="l00771"></a>00771         <a class="code" href="prefs_8cpp.html#a7b08ad54bec54f213c5ed4c1d8749548">mainwd</a> = r.width;
<a name="l00772"></a>00772         <a class="code" href="prefs_8cpp.html#afd8ee1110367c04cc21e2219607b7a7b">mainht</a> = r.height;
<a name="l00773"></a>00773     }
<a name="l00774"></a>00774 <span class="preprocessor">#endif</span>
<a name="l00775"></a>00775 <span class="preprocessor"></span>
<a name="l00776"></a>00776     <span class="comment">// trigger a redraw</span>
<a name="l00777"></a>00777     <span class="keywordflow">if</span>(this-&gt;pVTKWindow) this-&gt;pVTKWindow-&gt;Refresh(<span class="keyword">false</span>);
<a name="l00778"></a>00778     
<a name="l00779"></a>00779     <span class="comment">// need this to move and resize status bar in Mac app</span>
<a name="l00780"></a>00780     <span class="keyword">event</span>.Skip();
<a name="l00781"></a>00781 }
<a name="l00782"></a>00782 
<a name="l00783"></a>00783 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l00784"></a>00784 
<a name="l00785"></a><a class="code" href="classMyFrame.html#aa4f7b2abb9bcde53ea6ee6235179888d">00785</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#aa4f7b2abb9bcde53ea6ee6235179888d">MyFrame::OnScreenshot</a>(wxCommandEvent&amp; event)
<a name="l00786"></a>00786 {
<a name="l00787"></a>00787     <span class="comment">// find an unused filename</span>
<a name="l00788"></a>00788     <span class="keyword">const</span> wxString default_filename_root = _(<span class="stringliteral">&quot;Ready_screenshot_&quot;</span>);
<a name="l00789"></a>00789     <span class="keyword">const</span> wxString default_filename_ext = _T(<span class="stringliteral">&quot;png&quot;</span>);
<a name="l00790"></a>00790     <span class="keywordtype">int</span> unused_value = 0;
<a name="l00791"></a>00791     wxString filename;
<a name="l00792"></a>00792     wxString extension,folder;
<a name="l00793"></a>00793     folder = <a class="code" href="prefs_8cpp.html#aecf1f655ef78e68e956e57878e7ea48d">screenshotdir</a>;
<a name="l00794"></a>00794     <span class="keywordflow">do</span> {
<a name="l00795"></a>00795         filename = default_filename_root;
<a name="l00796"></a>00796         filename &lt;&lt; wxString::Format(_(<span class="stringliteral">&quot;%04d.&quot;</span>),unused_value) &lt;&lt; default_filename_ext;
<a name="l00797"></a>00797         unused_value++;
<a name="l00798"></a>00798     } <span class="keywordflow">while</span>(::wxFileExists(folder+_T(<span class="stringliteral">&quot;/&quot;</span>)+filename));
<a name="l00799"></a>00799 
<a name="l00800"></a>00800     <span class="comment">// ask the user for confirmation</span>
<a name="l00801"></a>00801     <span class="keywordtype">bool</span> accepted = <span class="keyword">true</span>;
<a name="l00802"></a>00802     <span class="keywordflow">do</span> {
<a name="l00803"></a>00803         filename = wxFileSelector(_(<span class="stringliteral">&quot;Specify the screenshot filename&quot;</span>),folder,filename,default_filename_ext,
<a name="l00804"></a>00804             _(<span class="stringliteral">&quot;PNG files (*.png)|*.png|JPG files (*.jpg)|*.jpg&quot;</span>),
<a name="l00805"></a>00805             wxFD_SAVE|wxFD_OVERWRITE_PROMPT);
<a name="l00806"></a>00806         <span class="keywordflow">if</span>(filename.empty()) <span class="keywordflow">return</span>; <span class="comment">// user cancelled</span>
<a name="l00807"></a>00807         <span class="comment">// validate</span>
<a name="l00808"></a>00808         wxFileName::SplitPath(filename,&amp;folder,NULL,&amp;extension);
<a name="l00809"></a>00809         <span class="keywordflow">if</span>(extension!=_T(<span class="stringliteral">&quot;png&quot;</span>) &amp;&amp; extension!=_T(<span class="stringliteral">&quot;jpg&quot;</span>))
<a name="l00810"></a>00810         {
<a name="l00811"></a>00811             wxMessageBox(_(<span class="stringliteral">&quot;Unsupported format&quot;</span>));
<a name="l00812"></a>00812             accepted = <span class="keyword">false</span>;
<a name="l00813"></a>00813         }
<a name="l00814"></a>00814     } <span class="keywordflow">while</span>(!accepted);
<a name="l00815"></a>00815 
<a name="l00816"></a>00816     <a class="code" href="prefs_8cpp.html#aecf1f655ef78e68e956e57878e7ea48d">screenshotdir</a> = folder;
<a name="l00817"></a>00817 
<a name="l00818"></a>00818     vtkSmartPointer&lt;vtkWindowToImageFilter&gt; screenshot = vtkSmartPointer&lt;vtkWindowToImageFilter&gt;::New();
<a name="l00819"></a>00819     screenshot-&gt;SetInput(this-&gt;pVTKWindow-&gt;GetRenderWindow());
<a name="l00820"></a>00820 
<a name="l00821"></a>00821     vtkSmartPointer&lt;vtkImageWriter&gt; writer;
<a name="l00822"></a>00822     <span class="keywordflow">if</span>(extension==_T(<span class="stringliteral">&quot;png&quot;</span>)) writer = vtkSmartPointer&lt;vtkPNGWriter&gt;::New();
<a name="l00823"></a>00823     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(extension==_T(<span class="stringliteral">&quot;jpg&quot;</span>)) writer = vtkSmartPointer&lt;vtkJPEGWriter&gt;::New();
<a name="l00824"></a>00824     writer-&gt;SetFileName(filename.mb_str());
<a name="l00825"></a>00825     writer-&gt;SetInputConnection(screenshot-&gt;GetOutputPort());
<a name="l00826"></a>00826     writer-&gt;Write();
<a name="l00827"></a>00827 }
<a name="l00828"></a>00828 
<a name="l00829"></a>00829 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l00830"></a>00830 
<a name="l00831"></a><a class="code" href="classMyFrame.html#a189588e62a253e87d392a42ad9da4be6">00831</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#a189588e62a253e87d392a42ad9da4be6">MyFrame::OnAddMyPatterns</a>(wxCommandEvent&amp; event)
<a name="l00832"></a>00832 {
<a name="l00833"></a>00833     <span class="comment">// first make sure the patterns pane is visible</span>
<a name="l00834"></a>00834     wxAuiPaneInfo &amp;pane = this-&gt;aui_mgr.GetPane(<a class="code" href="frame_8cpp.html#adb2d02d23949d250b57d1b3e00210c70">PaneName</a>(<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994acb63579b388e2e1b0fa5117d6bc55e08">ID::PatternsPane</a>));
<a name="l00835"></a>00835     <span class="keywordflow">if</span>(pane.IsOk() &amp;&amp; !pane.IsShown()) {
<a name="l00836"></a>00836         pane.Show();
<a name="l00837"></a>00837         this-&gt;aui_mgr.Update();
<a name="l00838"></a>00838     }
<a name="l00839"></a>00839 
<a name="l00840"></a>00840     wxDirDialog dirdlg(<span class="keyword">this</span>, _(<span class="stringliteral">&quot;Choose your pattern folder&quot;</span>), <a class="code" href="prefs_8cpp.html#a91188f84b92fb18a365b824f1d78c07f">userdir</a>, wxDD_NEW_DIR_BUTTON);
<a name="l00841"></a>00841     <span class="keywordflow">if</span> (dirdlg.ShowModal() == wxID_OK) {
<a name="l00842"></a>00842         <a class="code" href="prefs_8cpp.html#a91188f84b92fb18a365b824f1d78c07f">userdir</a> = dirdlg.GetPath();
<a name="l00843"></a>00843         this-&gt;patterns_panel-&gt;BuildTree();
<a name="l00844"></a>00844     }
<a name="l00845"></a>00845 }
<a name="l00846"></a>00846 
<a name="l00847"></a>00847 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l00848"></a>00848 
<a name="l00849"></a><a class="code" href="classMyFrame.html#a086401ec370582814bad574a1b077cfa">00849</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#a086401ec370582814bad574a1b077cfa">MyFrame::SetCurrentRDSystem</a>(<a class="code" href="classAbstractRD.html" title="Abstract base class for all reaction-diffusion systems.">AbstractRD</a>* sys)
<a name="l00850"></a>00850 {
<a name="l00851"></a>00851     <span class="keyword">delete</span> this-&gt;system;
<a name="l00852"></a>00852     this-&gt;system = sys;
<a name="l00853"></a>00853     <span class="keywordtype">int</span> iChem = <a class="code" href="utils_8cpp.html#a68e90099fe736c151fdf42384c533550">IndexFromChemicalName</a>(this-&gt;render_settings.GetProperty(<span class="stringliteral">&quot;active_chemical&quot;</span>).GetChemical());
<a name="l00854"></a>00854     iChem = min(iChem,this-&gt;system-&gt;GetNumberOfChemicals()-1); <span class="comment">// ensure is in valid range</span>
<a name="l00855"></a>00855     this-&gt;render_settings.GetProperty(<span class="stringliteral">&quot;active_chemical&quot;</span>).SetChemical(<a class="code" href="utils_8cpp.html#afd49013680a14bc8e1bfb0c79b80972f" title="a, b, c, ... z, aa, ab, ...">GetChemicalName</a>(iChem));
<a name="l00856"></a>00856     <a class="code" href="vtk__pipeline_8cpp.html#a83eef6bea304823921ff32ce0afb6d2b">InitializeVTKPipeline</a>(this-&gt;pVTKWindow,this-&gt;system,this-&gt;render_settings,<span class="keyword">true</span>);
<a name="l00857"></a>00857     this-&gt;is_running = <span class="keyword">false</span>;
<a name="l00858"></a>00858     this-&gt;info_panel-&gt;ResetPosition();
<a name="l00859"></a>00859     this-&gt;UpdateWindows();
<a name="l00860"></a>00860 }
<a name="l00861"></a>00861 
<a name="l00862"></a>00862 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l00863"></a>00863 
<a name="l00864"></a><a class="code" href="classMyFrame.html#a74e7806af7f4ab7204f6b7e3b27fe6d9">00864</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#a74e7806af7f4ab7204f6b7e3b27fe6d9">MyFrame::UpdateWindowTitle</a>()
<a name="l00865"></a>00865 {
<a name="l00866"></a>00866     wxString name = this-&gt;system-&gt;GetFilename();
<a name="l00867"></a>00867     <span class="keywordflow">if</span> (name.IsEmpty()) {
<a name="l00868"></a>00868         <span class="comment">// this should probably never happen</span>
<a name="l00869"></a>00869         name = _(<span class="stringliteral">&quot;unknown&quot;</span>);
<a name="l00870"></a>00870     } <span class="keywordflow">else</span> {
<a name="l00871"></a>00871         <span class="comment">// just show file&#39;s name, not full path</span>
<a name="l00872"></a>00872         name = name.AfterLast(wxFILE_SEP_PATH);
<a name="l00873"></a>00873     }
<a name="l00874"></a>00874     
<a name="l00875"></a>00875     <span class="keywordflow">if</span> (this-&gt;system-&gt;IsModified()) {
<a name="l00876"></a>00876         <span class="comment">// prepend asterisk to indicate the current system has been modified</span>
<a name="l00877"></a>00877         <span class="comment">// (this is consistent with Golly and other Win/Linux apps)</span>
<a name="l00878"></a>00878         name = _T(<span class="stringliteral">&quot;*&quot;</span>) + name;
<a name="l00879"></a>00879     }
<a name="l00880"></a>00880     
<a name="l00881"></a>00881 <span class="preprocessor">    #ifdef __WXMAC__</span>
<a name="l00882"></a>00882 <span class="preprocessor"></span>        <span class="comment">// Mac apps don&#39;t show app name in window title</span>
<a name="l00883"></a>00883         this-&gt;SetTitle(name);
<a name="l00884"></a>00884 <span class="preprocessor">    #else</span>
<a name="l00885"></a>00885 <span class="preprocessor"></span>        <span class="comment">// Win/Linux apps usually append the app name to the file name</span>
<a name="l00886"></a>00886         this-&gt;SetTitle(name + _T(<span class="stringliteral">&quot; - Ready&quot;</span>));
<a name="l00887"></a>00887 <span class="preprocessor">    #endif</span>
<a name="l00888"></a>00888 <span class="preprocessor"></span>}
<a name="l00889"></a>00889 
<a name="l00890"></a>00890 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l00891"></a>00891 
<a name="l00892"></a><a class="code" href="classMyFrame.html#af51a2749c9de332c8af5fdb0e8cf7166">00892</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#af51a2749c9de332c8af5fdb0e8cf7166">MyFrame::UpdateWindows</a>()
<a name="l00893"></a>00893 {
<a name="l00894"></a>00894     this-&gt;SetStatusBarText();
<a name="l00895"></a>00895     this-&gt;UpdateInfoPane();
<a name="l00896"></a>00896     this-&gt;UpdateWindowTitle();
<a name="l00897"></a>00897     this-&gt;UpdateToolbars();
<a name="l00898"></a>00898     this-&gt;Refresh(<span class="keyword">false</span>);
<a name="l00899"></a>00899 }
<a name="l00900"></a>00900 
<a name="l00901"></a>00901 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l00902"></a>00902 
<a name="l00903"></a><a class="code" href="classMyFrame.html#a6ef220dbc111e7954d43a079c7a0ef31">00903</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#a6ef220dbc111e7954d43a079c7a0ef31">MyFrame::OnStep</a>(wxCommandEvent&amp; event)
<a name="l00904"></a>00904 {
<a name="l00905"></a>00905     <span class="keywordflow">if</span> (this-&gt;is_running)
<a name="l00906"></a>00906         <span class="keywordflow">return</span>;
<a name="l00907"></a>00907     
<a name="l00908"></a>00908     <span class="keywordflow">if</span> (this-&gt;system-&gt;GetTimestepsTaken() == 0)
<a name="l00909"></a>00909     {
<a name="l00910"></a>00910         this-&gt;system-&gt;SaveStartingPattern();
<a name="l00911"></a>00911     
<a name="l00912"></a>00912         <span class="comment">// reset the initial number of steps used by system-&gt;Update in OnIdle</span>
<a name="l00913"></a>00913         num_steps = 50;
<a name="l00914"></a>00914         <span class="comment">// 50 is half the initial timesteps_per_render value used in most</span>
<a name="l00915"></a>00915         <span class="comment">// pattern files, but really we could choose any small number &gt; 0</span>
<a name="l00916"></a>00916     }
<a name="l00917"></a>00917 
<a name="l00918"></a>00918     <span class="keywordflow">try</span>
<a name="l00919"></a>00919     {
<a name="l00920"></a>00920         <span class="keywordflow">if</span> (event.GetId() == <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a29ce194c83647cde2066a129499a28b1">ID::Step1</a>) {
<a name="l00921"></a>00921             this-&gt;system-&gt;Update(1);
<a name="l00922"></a>00922         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (event.GetId() == <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994aabc39ee10e4d33f32ba11dd7773ad781">ID::StepN</a>) {
<a name="l00923"></a>00923             <span class="comment">// timesteps_per_render might be huge, so don&#39;t do this:</span>
<a name="l00924"></a>00924             <span class="comment">// this-&gt;system-&gt;Update(this-&gt;render_settings.GetProperty(&quot;timesteps_per_render&quot;).GetInt());</span>
<a name="l00925"></a>00925             <span class="comment">// instead we let OnIdle do the stepping, but stop at next render</span>
<a name="l00926"></a>00926             this-&gt;is_running = <span class="keyword">true</span>;
<a name="l00927"></a>00927             steps_since_last_render = 0;
<a name="l00928"></a>00928             accumulated_time = 0.0;
<a name="l00929"></a>00929             do_one_render = <span class="keyword">true</span>;
<a name="l00930"></a>00930         }
<a name="l00931"></a>00931     }
<a name="l00932"></a>00932     <span class="keywordflow">catch</span>(<span class="keyword">const</span> exception&amp; e)
<a name="l00933"></a>00933     {
<a name="l00934"></a>00934         <a class="code" href="classMonospaceMessageBox.html" title="Displays a block of text in a monospace font.">MonospaceMessageBox</a>(_(<span class="stringliteral">&quot;An error occurred when running the simulation:\n\n&quot;</span>)+wxString(e.what(),wxConvUTF8),_(<span class="stringliteral">&quot;Error&quot;</span>),wxART_ERROR);
<a name="l00935"></a>00935     }
<a name="l00936"></a>00936     <span class="keywordflow">catch</span>(...)
<a name="l00937"></a>00937     {
<a name="l00938"></a>00938         wxMessageBox(_(<span class="stringliteral">&quot;An unknown error occurred when running the simulation&quot;</span>));
<a name="l00939"></a>00939     }
<a name="l00940"></a>00940     
<a name="l00941"></a>00941     this-&gt;SetStatusBarText();
<a name="l00942"></a>00942     Refresh(<span class="keyword">false</span>);
<a name="l00943"></a>00943 }
<a name="l00944"></a>00944 
<a name="l00945"></a>00945 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l00946"></a>00946 
<a name="l00947"></a><a class="code" href="classMyFrame.html#a6ddede5bb58b853a17e7635a17e2612b">00947</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#a6ddede5bb58b853a17e7635a17e2612b">MyFrame::OnUpdateStep</a>(wxUpdateUIEvent&amp; event)
<a name="l00948"></a>00948 {
<a name="l00949"></a>00949     <span class="comment">// Step1 or StepN</span>
<a name="l00950"></a>00950     <span class="keyword">event</span>.Enable(!this-&gt;is_running);
<a name="l00951"></a>00951 }
<a name="l00952"></a>00952 
<a name="l00953"></a>00953 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l00954"></a>00954 
<a name="l00955"></a><a class="code" href="classMyFrame.html#a876746aaf753afa88cc773b27ec92004">00955</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#a876746aaf753afa88cc773b27ec92004">MyFrame::OnRunStop</a>(wxCommandEvent&amp; event)
<a name="l00956"></a>00956 {
<a name="l00957"></a>00957     <span class="keywordflow">if</span> (this-&gt;is_running) {
<a name="l00958"></a>00958         this-&gt;is_running = <span class="keyword">false</span>;
<a name="l00959"></a>00959         this-&gt;SetStatusBarText();
<a name="l00960"></a>00960     } <span class="keywordflow">else</span> {
<a name="l00961"></a>00961         this-&gt;is_running = <span class="keyword">true</span>;
<a name="l00962"></a>00962     }
<a name="l00963"></a>00963     this-&gt;UpdateToolbars();
<a name="l00964"></a>00964     Refresh(<span class="keyword">false</span>);
<a name="l00965"></a>00965     
<a name="l00966"></a>00966     <span class="keywordflow">if</span> (this-&gt;is_running) {
<a name="l00967"></a>00967         <span class="keywordflow">if</span> (this-&gt;system-&gt;GetTimestepsTaken() == 0)
<a name="l00968"></a>00968         {
<a name="l00969"></a>00969             this-&gt;system-&gt;SaveStartingPattern();
<a name="l00970"></a>00970     
<a name="l00971"></a>00971             <span class="comment">// reset the initial number of steps used by system-&gt;Update in OnIdle</span>
<a name="l00972"></a>00972             num_steps = 50;
<a name="l00973"></a>00973             <span class="comment">// 50 is half the initial timesteps_per_render value used in most</span>
<a name="l00974"></a>00974             <span class="comment">// pattern files, but really we could choose any small number &gt; 0</span>
<a name="l00975"></a>00975         }
<a name="l00976"></a>00976         steps_since_last_render = 0;
<a name="l00977"></a>00977         accumulated_time = 0.0;
<a name="l00978"></a>00978         do_one_render = <span class="keyword">false</span>;
<a name="l00979"></a>00979     }
<a name="l00980"></a>00980 }
<a name="l00981"></a>00981 
<a name="l00982"></a>00982 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l00983"></a>00983 
<a name="l00984"></a><a class="code" href="classMyFrame.html#ad413507c0c9ddd8aedebfbb2bc86b8f8">00984</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#ad413507c0c9ddd8aedebfbb2bc86b8f8">MyFrame::OnUpdateRunStop</a>(wxUpdateUIEvent&amp; event)
<a name="l00985"></a>00985 {
<a name="l00986"></a>00986     wxMenuBar* mbar = GetMenuBar();
<a name="l00987"></a>00987     <span class="keywordflow">if</span> (mbar) {
<a name="l00988"></a>00988         <span class="keywordflow">if</span> (this-&gt;is_running) {
<a name="l00989"></a>00989             mbar-&gt;SetLabel(<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a7fa86a9ca58943a68ee72c2278d7091f">ID::RunStop</a>, _(<span class="stringliteral">&quot;Stop&quot;</span>) + <a class="code" href="prefs_8cpp.html#ab9798965988e2083acef3da70016317f">GetAccelerator</a>(<a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62ad6773bc2d8b3a475b59775af5afc215c">DO_RUNSTOP</a>));
<a name="l00990"></a>00990             mbar-&gt;SetHelpString(<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a7fa86a9ca58943a68ee72c2278d7091f">ID::RunStop</a>,_(<span class="stringliteral">&quot;Stop running the simulation&quot;</span>));
<a name="l00991"></a>00991         } <span class="keywordflow">else</span> {
<a name="l00992"></a>00992             mbar-&gt;SetLabel(<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a7fa86a9ca58943a68ee72c2278d7091f">ID::RunStop</a>, _(<span class="stringliteral">&quot;Run&quot;</span>) + <a class="code" href="prefs_8cpp.html#ab9798965988e2083acef3da70016317f">GetAccelerator</a>(<a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62ad6773bc2d8b3a475b59775af5afc215c">DO_RUNSTOP</a>));
<a name="l00993"></a>00993             mbar-&gt;SetHelpString(<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a7fa86a9ca58943a68ee72c2278d7091f">ID::RunStop</a>,_(<span class="stringliteral">&quot;Start running the simulation&quot;</span>));
<a name="l00994"></a>00994         }
<a name="l00995"></a>00995     }
<a name="l00996"></a>00996 }
<a name="l00997"></a>00997 
<a name="l00998"></a>00998 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l00999"></a>00999 
<a name="l01000"></a><a class="code" href="classMyFrame.html#ac2f496c3047e2e16f892a8eedecdc945">01000</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#ac2f496c3047e2e16f892a8eedecdc945">MyFrame::UpdateToolbars</a>()
<a name="l01001"></a>01001 {
<a name="l01002"></a>01002     this-&gt;action_toolbar-&gt;FindTool(<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a7fa86a9ca58943a68ee72c2278d7091f">ID::RunStop</a>)-&gt;SetBitmap( 
<a name="l01003"></a>01003         this-&gt;is_running ? wxArtProvider::GetBitmap(wxART_CROSS_MARK,wxART_TOOLBAR)
<a name="l01004"></a>01004                          : wxArtProvider::GetBitmap(wxART_GO_FORWARD,wxART_TOOLBAR) );
<a name="l01005"></a>01005     
<a name="l01006"></a>01006     this-&gt;action_toolbar-&gt;FindTool(<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a7fa86a9ca58943a68ee72c2278d7091f">ID::RunStop</a>)-&gt;SetShortHelp( 
<a name="l01007"></a>01007         this-&gt;is_running ? _(<span class="stringliteral">&quot;Stop running the simulation&quot;</span>)
<a name="l01008"></a>01008                          : _(<span class="stringliteral">&quot;Start running the simulation&quot;</span>) );
<a name="l01009"></a>01009 }
<a name="l01010"></a>01010 
<a name="l01011"></a>01011 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l01012"></a>01012 
<a name="l01013"></a><a class="code" href="classMyFrame.html#ae2229e75383faa860ed7fa15f5069a5f">01013</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#ae2229e75383faa860ed7fa15f5069a5f">MyFrame::OnReset</a>(wxCommandEvent&amp; event)
<a name="l01014"></a>01014 {
<a name="l01015"></a>01015     <span class="keywordflow">if</span>(this-&gt;system-&gt;GetTimestepsTaken() &gt; 0) 
<a name="l01016"></a>01016     {
<a name="l01017"></a>01017         <span class="comment">// restore pattern and other info saved by SaveStartingPattern() which</span>
<a name="l01018"></a>01018         <span class="comment">// was called in OnStep/OnRunStop when GetTimestepsTaken() was 0</span>
<a name="l01019"></a>01019         this-&gt;system-&gt;RestoreStartingPattern();
<a name="l01020"></a>01020         this-&gt;is_running = <span class="keyword">false</span>;
<a name="l01021"></a>01021         this-&gt;UpdateWindows();
<a name="l01022"></a>01022     }
<a name="l01023"></a>01023 }
<a name="l01024"></a>01024 
<a name="l01025"></a>01025 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l01026"></a>01026 
<a name="l01027"></a><a class="code" href="classMyFrame.html#a3e48390dfa340659c39155d9f7a0285c">01027</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#a3e48390dfa340659c39155d9f7a0285c">MyFrame::OnUpdateReset</a>(wxUpdateUIEvent&amp; event)
<a name="l01028"></a>01028 {
<a name="l01029"></a>01029     <span class="keyword">event</span>.Enable(this-&gt;system-&gt;GetTimestepsTaken() &gt; 0);
<a name="l01030"></a>01030 }
<a name="l01031"></a>01031 
<a name="l01032"></a>01032 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l01033"></a>01033 
<a name="l01034"></a><a class="code" href="classMyFrame.html#a8f3b6893451e61b3b547ca20772cb982">01034</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#a8f3b6893451e61b3b547ca20772cb982">MyFrame::CheckFocus</a>()
<a name="l01035"></a>01035 {
<a name="l01036"></a>01036     <span class="comment">// ensure one of our panes has the focus so keyboard shortcuts always work</span>
<a name="l01037"></a>01037     <span class="keywordflow">if</span> ( this-&gt;pVTKWindow-&gt;HasFocus() ||
<a name="l01038"></a>01038          this-&gt;patterns_panel-&gt;TreeHasFocus() ||
<a name="l01039"></a>01039          this-&gt;info_panel-&gt;HtmlHasFocus() ||
<a name="l01040"></a>01040          this-&gt;help_panel-&gt;HtmlHasFocus() ) {
<a name="l01041"></a>01041         <span class="comment">// good, no need to change focus</span>
<a name="l01042"></a>01042     } <span class="keywordflow">else</span> {
<a name="l01043"></a>01043         <span class="comment">// best to restore focus to render window</span>
<a name="l01044"></a>01044         this-&gt;pVTKWindow-&gt;SetFocus();
<a name="l01045"></a>01045     }
<a name="l01046"></a>01046 }
<a name="l01047"></a>01047 
<a name="l01048"></a>01048 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l01049"></a>01049 
<a name="l01050"></a><a class="code" href="classMyFrame.html#a58d9c1d5b2197bfac0be4a55ccc3efa7">01050</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#a58d9c1d5b2197bfac0be4a55ccc3efa7">MyFrame::OnIdle</a>(wxIdleEvent&amp; event)
<a name="l01051"></a>01051 {
<a name="l01052"></a>01052 <span class="preprocessor">    #ifdef __WXMAC__</span>
<a name="l01053"></a>01053 <span class="preprocessor"></span>        <span class="comment">// do NOT do this in the Win app (buttons in Info/Help pane won&#39;t work)</span>
<a name="l01054"></a>01054         <span class="keywordflow">if</span> (this-&gt;IsActive()) this-&gt;CheckFocus();
<a name="l01055"></a>01055 <span class="preprocessor">    #endif</span>
<a name="l01056"></a>01056 <span class="preprocessor"></span>    
<a name="l01057"></a>01057     <span class="comment">// we drive our simulation loop via idle events</span>
<a name="l01058"></a>01058     <span class="keywordflow">if</span> (this-&gt;is_running)
<a name="l01059"></a>01059     {
<a name="l01060"></a>01060         <span class="comment">// ensure num_steps &lt;= timesteps_per_render</span>
<a name="l01061"></a>01061         <span class="keywordtype">int</span> timesteps_per_render = this-&gt;render_settings.GetProperty(<span class="stringliteral">&quot;timesteps_per_render&quot;</span>).GetInt();
<a name="l01062"></a>01062         <span class="keywordflow">if</span> (num_steps &gt; timesteps_per_render) num_steps = timesteps_per_render;
<a name="l01063"></a>01063 
<a name="l01064"></a>01064         <span class="comment">// use temp_steps for the actual system-&gt;Update call because it might be &lt; num_steps</span>
<a name="l01065"></a>01065         <span class="keywordtype">int</span> temp_steps = num_steps;
<a name="l01066"></a>01066         <span class="keywordflow">if</span> (steps_since_last_render + temp_steps &gt; timesteps_per_render) {
<a name="l01067"></a>01067             <span class="comment">// do final steps of this rendering phase</span>
<a name="l01068"></a>01068             temp_steps = timesteps_per_render - steps_since_last_render;
<a name="l01069"></a>01069         }
<a name="l01070"></a>01070         
<a name="l01071"></a>01071         <span class="keywordtype">double</span> time_before = <a class="code" href="utils_8cpp.html#a1287a1eb9d39297d5f181e01acc9de18">get_time_in_seconds</a>();
<a name="l01072"></a>01072         
<a name="l01073"></a>01073         <span class="keywordflow">try</span> 
<a name="l01074"></a>01074         {
<a name="l01075"></a>01075             this-&gt;system-&gt;Update(temp_steps);
<a name="l01076"></a>01076         }
<a name="l01077"></a>01077         <span class="keywordflow">catch</span>(<span class="keyword">const</span> exception&amp; e)
<a name="l01078"></a>01078         {
<a name="l01079"></a>01079             this-&gt;is_running = <span class="keyword">false</span>;
<a name="l01080"></a>01080             this-&gt;SetStatusBarText();
<a name="l01081"></a>01081             this-&gt;UpdateToolbars();
<a name="l01082"></a>01082             <a class="code" href="classMonospaceMessageBox.html" title="Displays a block of text in a monospace font.">MonospaceMessageBox</a>(_(<span class="stringliteral">&quot;An error occurred when running the simulation:\n\n&quot;</span>)+wxString(e.what(),wxConvUTF8),_(<span class="stringliteral">&quot;Error&quot;</span>),wxART_ERROR);
<a name="l01083"></a>01083         }
<a name="l01084"></a>01084         <span class="keywordflow">catch</span>(...)
<a name="l01085"></a>01085         {
<a name="l01086"></a>01086             this-&gt;is_running = <span class="keyword">false</span>;
<a name="l01087"></a>01087             this-&gt;SetStatusBarText();
<a name="l01088"></a>01088             this-&gt;UpdateToolbars();
<a name="l01089"></a>01089             wxMessageBox(_(<span class="stringliteral">&quot;An unknown error occurred when running the simulation&quot;</span>));
<a name="l01090"></a>01090         }
<a name="l01091"></a>01091         
<a name="l01092"></a>01092         <span class="keywordtype">double</span> time_diff = <a class="code" href="utils_8cpp.html#a1287a1eb9d39297d5f181e01acc9de18">get_time_in_seconds</a>() - time_before;
<a name="l01093"></a>01093         
<a name="l01094"></a>01094         <span class="comment">// note that we don&#39;t change num_steps if temp_steps &lt; num_steps</span>
<a name="l01095"></a>01095         <span class="keywordflow">if</span> (num_steps == temp_steps) {
<a name="l01096"></a>01096             <span class="comment">// if the above system-&gt;Update was quick then we&#39;ll use more steps in the next call,</span>
<a name="l01097"></a>01097             <span class="comment">// otherwise we&#39;ll use less steps so that the app remains responsive</span>
<a name="l01098"></a>01098             <span class="keywordflow">if</span> (time_diff &lt; 0.1) {
<a name="l01099"></a>01099                 num_steps *= 2;
<a name="l01100"></a>01100                 <span class="keywordflow">if</span> (num_steps &gt; timesteps_per_render) num_steps = timesteps_per_render;
<a name="l01101"></a>01101             } <span class="keywordflow">else</span> {
<a name="l01102"></a>01102                 num_steps /= 2;
<a name="l01103"></a>01103                 <span class="keywordflow">if</span> (num_steps &lt; 1) num_steps = 1;
<a name="l01104"></a>01104             }
<a name="l01105"></a>01105         }
<a name="l01106"></a>01106         
<a name="l01107"></a>01107         accumulated_time += time_diff;
<a name="l01108"></a>01108         steps_since_last_render += temp_steps;
<a name="l01109"></a>01109         
<a name="l01110"></a>01110         <span class="keywordflow">if</span> (steps_since_last_render &gt;= timesteps_per_render) {
<a name="l01111"></a>01111             <span class="comment">// it&#39;s time to render what we&#39;ve computed so far</span>
<a name="l01112"></a>01112             <span class="keywordtype">int</span> n_cells = this-&gt;system-&gt;GetNumberOfCells();
<a name="l01113"></a>01113             <span class="keywordflow">if</span> (accumulated_time == 0.0)
<a name="l01114"></a>01114                 accumulated_time = 0.000001;  <span class="comment">// unlikely, but play safe</span>
<a name="l01115"></a>01115             this-&gt;frames_per_second = steps_since_last_render / accumulated_time;
<a name="l01116"></a>01116             this-&gt;million_cell_generations_per_second = this-&gt;frames_per_second * n_cells / 1e6;
<a name="l01117"></a>01117 
<a name="l01118"></a>01118             <span class="keywordflow">if</span>(this-&gt;is_recording)
<a name="l01119"></a>01119                 this-&gt;RecordFrame();
<a name="l01120"></a>01120        
<a name="l01121"></a>01121             this-&gt;pVTKWindow-&gt;Refresh(<span class="keyword">false</span>);
<a name="l01122"></a>01122             this-&gt;SetStatusBarText();
<a name="l01123"></a>01123             
<a name="l01124"></a>01124             <span class="keywordflow">if</span> (do_one_render) {
<a name="l01125"></a>01125                 <span class="comment">// user selected Step by N so stop now</span>
<a name="l01126"></a>01126                 this-&gt;is_running = <span class="keyword">false</span>;
<a name="l01127"></a>01127                 this-&gt;SetStatusBarText();
<a name="l01128"></a>01128                 this-&gt;UpdateToolbars();
<a name="l01129"></a>01129             } <span class="keywordflow">else</span> {
<a name="l01130"></a>01130                 <span class="comment">// keep simulating</span>
<a name="l01131"></a>01131                 steps_since_last_render = 0;
<a name="l01132"></a>01132                 accumulated_time = 0.0;
<a name="l01133"></a>01133             }
<a name="l01134"></a>01134         }
<a name="l01135"></a>01135         
<a name="l01136"></a>01136         <span class="keyword">event</span>.RequestMore(); <span class="comment">// trigger another idle event</span>
<a name="l01137"></a>01137     }
<a name="l01138"></a>01138     
<a name="l01139"></a>01139     <span class="keyword">event</span>.Skip();
<a name="l01140"></a>01140 }
<a name="l01141"></a>01141 
<a name="l01142"></a>01142 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l01143"></a>01143 
<a name="l01144"></a><a class="code" href="classMyFrame.html#a096a2bc6cbb76046bc4e3a15c1ee7183">01144</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#a096a2bc6cbb76046bc4e3a15c1ee7183">MyFrame::SetStatusBarText</a>()
<a name="l01145"></a>01145 {
<a name="l01146"></a>01146     wxString txt;
<a name="l01147"></a>01147     <span class="keywordflow">if</span>(this-&gt;is_running) txt &lt;&lt; _(<span class="stringliteral">&quot;Running.&quot;</span>);
<a name="l01148"></a>01148     <span class="keywordflow">else</span> txt &lt;&lt; _(<span class="stringliteral">&quot;Stopped.&quot;</span>);
<a name="l01149"></a>01149     txt &lt;&lt; _(<span class="stringliteral">&quot; Timesteps: &quot;</span>) &lt;&lt; this-&gt;system-&gt;GetTimestepsTaken();
<a name="l01150"></a>01150     txt &lt;&lt; _T(<span class="stringliteral">&quot;   (&quot;</span>) &lt;&lt; wxString::Format(_T(<span class="stringliteral">&quot;%.0f&quot;</span>),this-&gt;frames_per_second)
<a name="l01151"></a>01151         &lt;&lt; _(<span class="stringliteral">&quot; computed frames per second, &quot;</span>)
<a name="l01152"></a>01152         &lt;&lt; wxString::Format(_T(<span class="stringliteral">&quot;%.0f&quot;</span>),this-&gt;million_cell_generations_per_second)
<a name="l01153"></a>01153         &lt;&lt; _T(<span class="stringliteral">&quot; mcgs)&quot;</span>);
<a name="l01154"></a>01154     <span class="comment">/* DEBUG</span>
<a name="l01155"></a>01155 <span class="comment">    txt &lt;&lt; wxString::Format(_T(&quot;  num_steps=%d&quot;), num_steps)</span>
<a name="l01156"></a>01156 <span class="comment">        &lt;&lt; wxString::Format(_T(&quot;  tpr=%d&quot;), this-&gt;render_settings.GetProperty(&quot;timesteps_per_render&quot;).GetInt());</span>
<a name="l01157"></a>01157 <span class="comment">    */</span>
<a name="l01158"></a>01158     SetStatusText(txt);
<a name="l01159"></a>01159 }
<a name="l01160"></a>01160 
<a name="l01161"></a>01161 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l01162"></a>01162 
<a name="l01163"></a><a class="code" href="classMyFrame.html#a56f2c479de5f3c59ffb2bc1e2cb78bc7">01163</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#a56f2c479de5f3c59ffb2bc1e2cb78bc7">MyFrame::OnRestoreDefaultPerspective</a>(wxCommandEvent&amp; event)
<a name="l01164"></a>01164 {
<a name="l01165"></a>01165     this-&gt;aui_mgr.LoadPerspective(this-&gt;default_perspective);
<a name="l01166"></a>01166 }
<a name="l01167"></a>01167 
<a name="l01168"></a>01168 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l01169"></a>01169 
<a name="l01170"></a><a class="code" href="classMyFrame.html#aafe47efa230f33628ceae2aebe3394cc">01170</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#aafe47efa230f33628ceae2aebe3394cc">MyFrame::OnGenerateInitialPattern</a>(wxCommandEvent&amp; event)
<a name="l01171"></a>01171 {
<a name="l01172"></a>01172     <span class="keywordflow">try</span>
<a name="l01173"></a>01173     {
<a name="l01174"></a>01174         this-&gt;system-&gt;GenerateInitialPattern();
<a name="l01175"></a>01175     }
<a name="l01176"></a>01176     <span class="keywordflow">catch</span>(<span class="keyword">const</span> exception&amp; e)
<a name="l01177"></a>01177     {
<a name="l01178"></a>01178         <a class="code" href="classMonospaceMessageBox.html" title="Displays a block of text in a monospace font.">MonospaceMessageBox</a>(_(<span class="stringliteral">&quot;Generating an initial pattern caused an error:\n\n&quot;</span>)+wxString(e.what(),wxConvUTF8),_(<span class="stringliteral">&quot;Error&quot;</span>),wxART_ERROR);
<a name="l01179"></a>01179     }
<a name="l01180"></a>01180     <span class="keywordflow">catch</span>(...)
<a name="l01181"></a>01181     {
<a name="l01182"></a>01182         wxMessageBox(_(<span class="stringliteral">&quot;Generating an initial pattern caused an unknown error&quot;</span>));
<a name="l01183"></a>01183     }
<a name="l01184"></a>01184     <span class="comment">// (we allow the user to proceed because they might now want to change other things to match)</span>
<a name="l01185"></a>01185 
<a name="l01186"></a>01186     this-&gt;is_running = <span class="keyword">false</span>;
<a name="l01187"></a>01187     this-&gt;UpdateWindows();
<a name="l01188"></a>01188 }
<a name="l01189"></a>01189 
<a name="l01190"></a>01190 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l01191"></a>01191 
<a name="l01192"></a><a class="code" href="classMyFrame.html#afa0f14ee2bdd4f9fb69d66315e056384">01192</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#afa0f14ee2bdd4f9fb69d66315e056384">MyFrame::OnSelectOpenCLDevice</a>(wxCommandEvent&amp; event)
<a name="l01193"></a>01193 {
<a name="l01194"></a>01194     <span class="comment">// TODO: merge this with GetOpenCL diagnostics?</span>
<a name="l01195"></a>01195     wxArrayString choices;
<a name="l01196"></a>01196     <span class="keywordtype">int</span> iOldSelection;
<a name="l01197"></a>01197     <span class="keywordtype">int</span> np;
<a name="l01198"></a>01198     <span class="keywordflow">try</span> 
<a name="l01199"></a>01199     {
<a name="l01200"></a>01200         np = <a class="code" href="namespaceOpenCL__utils.html#a17e5ec4397c2d70c8430f17ec53d83d5" title="Returns the number of OpenCL platforms (from vendors) that are available.">OpenCL_utils::GetNumberOfPlatforms</a>();
<a name="l01201"></a>01201     }
<a name="l01202"></a>01202     <span class="keywordflow">catch</span>(<span class="keyword">const</span> exception&amp; e)
<a name="l01203"></a>01203     {
<a name="l01204"></a>01204         wxMessageBox(_(<span class="stringliteral">&quot;OpenCL not available: &quot;</span>)+
<a name="l01205"></a>01205             wxString(e.what(),wxConvUTF8));
<a name="l01206"></a>01206         <span class="keywordflow">return</span>;
<a name="l01207"></a>01207     }
<a name="l01208"></a>01208     <span class="keywordflow">catch</span>(...)
<a name="l01209"></a>01209     {
<a name="l01210"></a>01210         wxMessageBox(_(<span class="stringliteral">&quot;OpenCL not available&quot;</span>));
<a name="l01211"></a>01211         <span class="keywordflow">return</span>;
<a name="l01212"></a>01212     }
<a name="l01213"></a>01213     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> ip=0;ip&lt;np;ip++)
<a name="l01214"></a>01214     {
<a name="l01215"></a>01215         <span class="keywordtype">int</span> nd = <a class="code" href="namespaceOpenCL__utils.html#ae182ffd5ff716e80e9d19dd3b2409daf" title="Returns the number of OpenCL devices available on this platform.">OpenCL_utils::GetNumberOfDevices</a>(ip);
<a name="l01216"></a>01216         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> <span class="keywordtype">id</span>=0;<span class="keywordtype">id</span>&lt;nd;<span class="keywordtype">id</span>++)
<a name="l01217"></a>01217         {
<a name="l01218"></a>01218             <span class="keywordflow">if</span>(ip==<a class="code" href="prefs_8cpp.html#a0de6a378ca700dd877cab59c65ba2f7b">opencl_platform</a> &amp;&amp; <span class="keywordtype">id</span>==<a class="code" href="prefs_8cpp.html#a11d0cbab21425e351638f4bf2cc72874">opencl_device</a>)
<a name="l01219"></a>01219                 iOldSelection = (int)choices.size();
<a name="l01220"></a>01220             wxString s(<a class="code" href="namespaceOpenCL__utils.html#a8d16f21d70ff47eeeefa7f8b3f3e897c" title="Returns a description of this platform.">OpenCL_utils::GetPlatformDescription</a>(ip).c_str(),wxConvUTF8);
<a name="l01221"></a>01221             s &lt;&lt; _T(<span class="stringliteral">&quot; : &quot;</span>) &lt;&lt; wxString(<a class="code" href="namespaceOpenCL__utils.html#a7ad04228a76befc69c19c55b15aca091" title="Returns a description of this device.">OpenCL_utils::GetDeviceDescription</a>(ip,<span class="keywordtype">id</span>).c_str(),wxConvUTF8);
<a name="l01222"></a>01222             choices.Add(s);
<a name="l01223"></a>01223         }
<a name="l01224"></a>01224     }
<a name="l01225"></a>01225     wxSingleChoiceDialog dlg(<span class="keyword">this</span>,_(<span class="stringliteral">&quot;Select the OpenCL device to use:&quot;</span>),_(<span class="stringliteral">&quot;Select OpenCL device&quot;</span>),
<a name="l01226"></a>01226         choices);
<a name="l01227"></a>01227     dlg.SetSelection(iOldSelection);
<a name="l01228"></a>01228     <span class="keywordflow">if</span>(dlg.ShowModal()!=wxID_OK) <span class="keywordflow">return</span>;
<a name="l01229"></a>01229     <span class="keywordtype">int</span> iNewSelection = dlg.GetSelection();
<a name="l01230"></a>01230     <span class="keywordflow">if</span>(iNewSelection != iOldSelection)
<a name="l01231"></a>01231         wxMessageBox(_(<span class="stringliteral">&quot;The selected device will be used the next time an OpenCL pattern is loaded.&quot;</span>));
<a name="l01232"></a>01232     <span class="keywordtype">int</span> dc = 0;
<a name="l01233"></a>01233     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> ip=0;ip&lt;np;ip++)
<a name="l01234"></a>01234     {
<a name="l01235"></a>01235         <span class="keywordtype">int</span> nd = <a class="code" href="namespaceOpenCL__utils.html#ae182ffd5ff716e80e9d19dd3b2409daf" title="Returns the number of OpenCL devices available on this platform.">OpenCL_utils::GetNumberOfDevices</a>(ip);
<a name="l01236"></a>01236         <span class="keywordflow">if</span>(iNewSelection &lt; nd)
<a name="l01237"></a>01237         {
<a name="l01238"></a>01238             <a class="code" href="prefs_8cpp.html#a0de6a378ca700dd877cab59c65ba2f7b">opencl_platform</a> = ip;
<a name="l01239"></a>01239             <a class="code" href="prefs_8cpp.html#a11d0cbab21425e351638f4bf2cc72874">opencl_device</a> = iNewSelection;
<a name="l01240"></a>01240             <span class="keywordflow">break</span>;
<a name="l01241"></a>01241         }
<a name="l01242"></a>01242         iNewSelection -= nd;
<a name="l01243"></a>01243     }
<a name="l01244"></a>01244     <span class="comment">// TODO: hot-change the current RD system</span>
<a name="l01245"></a>01245 }
<a name="l01246"></a>01246 
<a name="l01247"></a>01247 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l01248"></a>01248 
<a name="l01249"></a><a class="code" href="classMyFrame.html#a63b23742f9322a0ae726aa2a29eae96d">01249</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#a63b23742f9322a0ae726aa2a29eae96d">MyFrame::OnHelp</a>(wxCommandEvent&amp; event)
<a name="l01250"></a>01250 {
<a name="l01251"></a>01251     <span class="keywordtype">int</span> <span class="keywordtype">id</span> = <span class="keyword">event</span>.GetId();
<a name="l01252"></a>01252     <span class="keywordflow">switch</span> (<span class="keywordtype">id</span>)
<a name="l01253"></a>01253     {
<a name="l01254"></a>01254         <span class="keywordflow">case</span> wxID_HELP:         this-&gt;help_panel-&gt;ShowHelp(_(<span class="stringliteral">&quot;Help/index.html&quot;</span>)); <span class="keywordflow">break</span>;
<a name="l01255"></a>01255         <span class="keywordflow">case</span> <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994ae4da177bc93aa9c32cd1c4c7e5df05f7">ID::HelpQuick</a>:     this-&gt;help_panel-&gt;ShowHelp(_(<span class="stringliteral">&quot;Help/quickstart.html&quot;</span>)); <span class="keywordflow">break</span>;
<a name="l01256"></a>01256         <span class="keywordflow">case</span> <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a11b4d5cc94f2a3b6cee7cb09da2126d6">ID::HelpIntro</a>:     this-&gt;help_panel-&gt;ShowHelp(_(<span class="stringliteral">&quot;Help/introduction.html&quot;</span>)); <span class="keywordflow">break</span>;
<a name="l01257"></a>01257         <span class="keywordflow">case</span> <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a2e16df9987ffe628f9c3379f468762b4">ID::HelpTips</a>:      this-&gt;help_panel-&gt;ShowHelp(_(<span class="stringliteral">&quot;Help/tips.html&quot;</span>)); <span class="keywordflow">break</span>;
<a name="l01258"></a>01258         <span class="keywordflow">case</span> <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a19e87388929f7a4f3d961de8105c5f6d">ID::HelpKeyboard</a>:  this-&gt;help_panel-&gt;ShowHelp(<a class="code" href="HelpPanel_8hpp.html#a9db5413b8fd829de0db28738ccfdea90">SHOW_KEYBOARD_SHORTCUTS</a>); <span class="keywordflow">break</span>;
<a name="l01259"></a>01259         <span class="keywordflow">case</span> <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a4c430f7f8809a8418a14a2641b48719a">ID::HelpMouse</a>:     this-&gt;help_panel-&gt;ShowHelp(_(<span class="stringliteral">&quot;Help/mouse.html&quot;</span>)); <span class="keywordflow">break</span>;
<a name="l01260"></a>01260         <span class="keywordflow">case</span> <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a34623182ac086372c85925d0939f666b">ID::HelpFile</a>:      this-&gt;help_panel-&gt;ShowHelp(_(<span class="stringliteral">&quot;Help/file.html&quot;</span>)); <span class="keywordflow">break</span>;
<a name="l01261"></a>01261         <span class="keywordflow">case</span> <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994ab5e85cc7435ed3454f3f5b980ed96e3d">ID::HelpEdit</a>:      this-&gt;help_panel-&gt;ShowHelp(_(<span class="stringliteral">&quot;Help/edit.html&quot;</span>)); <span class="keywordflow">break</span>;
<a name="l01262"></a>01262         <span class="keywordflow">case</span> <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994aa6e5d26454218360dd70852ca324bec2">ID::HelpView</a>:      this-&gt;help_panel-&gt;ShowHelp(_(<span class="stringliteral">&quot;Help/view.html&quot;</span>)); <span class="keywordflow">break</span>;
<a name="l01263"></a>01263         <span class="keywordflow">case</span> <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a11c4f11523bb33079a18947830fa827e">ID::HelpAction</a>:    this-&gt;help_panel-&gt;ShowHelp(_(<span class="stringliteral">&quot;Help/action.html&quot;</span>)); <span class="keywordflow">break</span>;
<a name="l01264"></a>01264         <span class="keywordflow">case</span> <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a34a6d520118d6a6012bd9e8f0f9a1560">ID::HelpHelp</a>:      this-&gt;help_panel-&gt;ShowHelp(_(<span class="stringliteral">&quot;Help/help.html&quot;</span>)); <span class="keywordflow">break</span>;
<a name="l01265"></a>01265         <span class="keywordflow">case</span> <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a05b3c81109c55177ad668803cb8c6e1a">ID::HelpFormats</a>:   this-&gt;help_panel-&gt;ShowHelp(_(<span class="stringliteral">&quot;Help/formats.html&quot;</span>)); <span class="keywordflow">break</span>;
<a name="l01266"></a>01266         <span class="keywordflow">case</span> <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a99d9508355ab71324cf773c2b607a41f">ID::HelpProblems</a>:  this-&gt;help_panel-&gt;ShowHelp(_(<span class="stringliteral">&quot;Help/problems.html&quot;</span>)); <span class="keywordflow">break</span>;
<a name="l01267"></a>01267         <span class="keywordflow">case</span> <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a9f852fa906fbd919f0dd378129029422">ID::HelpChanges</a>:   this-&gt;help_panel-&gt;ShowHelp(_(<span class="stringliteral">&quot;Help/changes.html&quot;</span>)); <span class="keywordflow">break</span>;
<a name="l01268"></a>01268         <span class="keywordflow">case</span> <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a5aea20957851faa34cfbf82d59895b56">ID::HelpCredits</a>:   this-&gt;help_panel-&gt;ShowHelp(_(<span class="stringliteral">&quot;Help/credits.html&quot;</span>)); <span class="keywordflow">break</span>;
<a name="l01269"></a>01269         <span class="keywordflow">default</span>:
<a name="l01270"></a>01270             wxMessageBox(_(<span class="stringliteral">&quot;Bug: Unexpected ID in OnHelp!&quot;</span>));
<a name="l01271"></a>01271             <span class="keywordflow">return</span>;
<a name="l01272"></a>01272     }
<a name="l01273"></a>01273     
<a name="l01274"></a>01274     wxAuiPaneInfo &amp;pane = this-&gt;aui_mgr.GetPane(<a class="code" href="frame_8cpp.html#adb2d02d23949d250b57d1b3e00210c70">PaneName</a>(<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994aa793fe9cd53e4212456e78a881d61e73">ID::HelpPane</a>));
<a name="l01275"></a>01275     <span class="keywordflow">if</span>(pane.IsOk() &amp;&amp; !pane.IsShown()) {
<a name="l01276"></a>01276         pane.Show();
<a name="l01277"></a>01277         this-&gt;aui_mgr.Update();
<a name="l01278"></a>01278     }
<a name="l01279"></a>01279 }
<a name="l01280"></a>01280 
<a name="l01281"></a>01281 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l01282"></a>01282 
<a name="l01283"></a><a class="code" href="classMyFrame.html#a68e2ef8eac733779aff5b7028dc8c6be">01283</a> wxString <a class="code" href="classMyFrame.html#a68e2ef8eac733779aff5b7028dc8c6be">MyFrame::SavePatternDialog</a>()
<a name="l01284"></a>01284 {
<a name="l01285"></a>01285     wxString filename = wxEmptyString;
<a name="l01286"></a>01286     wxString currname = this-&gt;system-&gt;GetFilename();
<a name="l01287"></a>01287     currname = currname.AfterLast(wxFILE_SEP_PATH);
<a name="l01288"></a>01288 
<a name="l01289"></a>01289     wxString extension(this-&gt;system-&gt;GetFileExtension().c_str(),wxConvUTF8);
<a name="l01290"></a>01290     wxString extension_description = _(<span class="stringliteral">&quot;Extended VTK files (*.&quot;</span>)+extension +_T(<span class="stringliteral">&quot;)|*.&quot;</span>)+extension;
<a name="l01291"></a>01291     
<a name="l01292"></a>01292     wxFileDialog savedlg(<span class="keyword">this</span>, _(<span class="stringliteral">&quot;Specify the pattern filename&quot;</span>), <a class="code" href="prefs_8cpp.html#adc6c83c9ee4250d0b1f2b2b9f33fa777">opensavedir</a>, currname,
<a name="l01293"></a>01293                          extension_description,
<a name="l01294"></a>01294                          wxFD_SAVE | wxFD_OVERWRITE_PROMPT);
<a name="l01295"></a>01295 <span class="preprocessor">    #ifdef __WXGTK__</span>
<a name="l01296"></a>01296 <span class="preprocessor"></span>        <span class="comment">// opensavedir is ignored above (bug in wxGTK 2.8.0???)</span>
<a name="l01297"></a>01297         savedlg.SetDirectory(<a class="code" href="prefs_8cpp.html#adc6c83c9ee4250d0b1f2b2b9f33fa777">opensavedir</a>);
<a name="l01298"></a>01298 <span class="preprocessor">    #endif</span>
<a name="l01299"></a>01299 <span class="preprocessor"></span>    <span class="keywordflow">if</span>(savedlg.ShowModal() == wxID_OK) {
<a name="l01300"></a>01300         wxFileName fullpath( savedlg.GetPath() );
<a name="l01301"></a>01301         <a class="code" href="prefs_8cpp.html#adc6c83c9ee4250d0b1f2b2b9f33fa777">opensavedir</a> = fullpath.GetPath();
<a name="l01302"></a>01302         filename = savedlg.GetPath();
<a name="l01303"></a>01303     }
<a name="l01304"></a>01304     
<a name="l01305"></a>01305     <span class="keywordflow">return</span> filename;
<a name="l01306"></a>01306 }
<a name="l01307"></a>01307 
<a name="l01308"></a>01308 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l01309"></a>01309 
<a name="l01310"></a><a class="code" href="classMyFrame.html#a06843eec325e9393b35b542944cb31b9">01310</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#a06843eec325e9393b35b542944cb31b9">MyFrame::OnSavePattern</a>(wxCommandEvent&amp; event)
<a name="l01311"></a>01311 {
<a name="l01312"></a>01312     wxString filename = SavePatternDialog();
<a name="l01313"></a>01313     <span class="keywordflow">if</span>(!filename.empty()) SaveFile(filename);
<a name="l01314"></a>01314 }
<a name="l01315"></a>01315 
<a name="l01316"></a>01316 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l01317"></a>01317 
<a name="l01318"></a><a class="code" href="classMyFrame.html#a610f889b7182018a80c927d4ea93897d">01318</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#a610f889b7182018a80c927d4ea93897d">MyFrame::SaveFile</a>(<span class="keyword">const</span> wxString&amp; path)
<a name="l01319"></a>01319 {
<a name="l01320"></a>01320     wxBusyCursor busy;
<a name="l01321"></a>01321 
<a name="l01322"></a>01322     this-&gt;system-&gt;SaveFile(path.mb_str(),this-&gt;render_settings);
<a name="l01323"></a>01323 
<a name="l01324"></a>01324     AddRecentPattern(path);
<a name="l01325"></a>01325     this-&gt;system-&gt;SetFilename(<span class="keywordtype">string</span>(path.mb_str()));
<a name="l01326"></a>01326     this-&gt;system-&gt;SetModified(<span class="keyword">false</span>);
<a name="l01327"></a>01327     this-&gt;UpdateWindowTitle();
<a name="l01328"></a>01328 }
<a name="l01329"></a>01329 
<a name="l01330"></a>01330 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l01331"></a>01331 
<a name="l01332"></a><a class="code" href="classMyFrame.html#af1bae8e07814a9375a27844eb1b65b09">01332</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#af1bae8e07814a9375a27844eb1b65b09">MyFrame::OnNewPattern</a>(wxCommandEvent&amp; event)
<a name="l01333"></a>01333 {
<a name="l01334"></a>01334     this-&gt;InitializeDefaultRenderSettings();
<a name="l01335"></a>01335     <span class="keywordflow">if</span>(this-&gt;system == NULL) {
<a name="l01336"></a>01336         <span class="comment">// initial call from MyFrame::MyFrame</span>
<a name="l01337"></a>01337         <a class="code" href="classGrayScottImageRD.html" title="An inbuilt implementation: n-dimensional Gray-Scott.">GrayScottImageRD</a> *s = <span class="keyword">new</span> <a class="code" href="classGrayScottImageRD.html" title="An inbuilt implementation: n-dimensional Gray-Scott.">GrayScottImageRD</a>();
<a name="l01338"></a>01338         s-&gt;<a class="code" href="classImageRD.html#a5bfabf85d8f8e8ea604fe982e32d1cd5">SetDimensionsAndNumberOfChemicals</a>(30,25,20,2);
<a name="l01339"></a>01339         s-&gt;<a class="code" href="classAbstractRD.html#a6bcf10c119c33cde1604bdc33a19a8e9">SetModified</a>(<span class="keyword">false</span>);
<a name="l01340"></a>01340         s-&gt;<a class="code" href="classAbstractRD.html#a1ac0701d5f1d0ce7a65ce08f19d4d6e7">SetFilename</a>(<span class="stringliteral">&quot;untitled&quot;</span>);
<a name="l01341"></a>01341         s-&gt;<a class="code" href="classImageRD.html#ad1315e99af6900fbb7fd620e4827fda3">GenerateInitialPattern</a>();
<a name="l01342"></a>01342         this-&gt;SetCurrentRDSystem(s);
<a name="l01343"></a>01343         <span class="keywordflow">return</span>;
<a name="l01344"></a>01344     }
<a name="l01345"></a>01345 
<a name="l01346"></a>01346     <span class="keywordflow">if</span>(UserWantsToCancelWhenAskedIfWantsToSave()) <span class="keywordflow">return</span>;
<a name="l01347"></a>01347 
<a name="l01348"></a>01348     <span class="comment">// ask user what type of dataset to generate:</span>
<a name="l01349"></a>01349     <span class="keywordtype">int</span> sel;
<a name="l01350"></a>01350     {
<a name="l01351"></a>01351         <span class="keyword">const</span> <span class="keywordtype">int</span> N_CHOICES = 11;
<a name="l01352"></a>01352         wxString dataset_types[N_CHOICES] = { _(<span class="stringliteral">&quot;1D image strip&quot;</span>), _(<span class="stringliteral">&quot;2D image&quot;</span>), _(<span class="stringliteral">&quot;3D image volume&quot;</span>), 
<a name="l01353"></a>01353             _(<span class="stringliteral">&quot;Geodesic sphere&quot;</span>), _(<span class="stringliteral">&quot;Torus&quot;</span>), _(<span class="stringliteral">&quot;Tetrahedral mesh&quot;</span>), _(<span class="stringliteral">&quot;Triangular mesh&quot;</span>), _(<span class="stringliteral">&quot;Hexagonal mesh&quot;</span>),
<a name="l01354"></a>01354             _(<span class="stringliteral">&quot;Rhombille tiling&quot;</span>), _(<span class="stringliteral">&quot;Penrose tiling (rhombi)&quot;</span>), _(<span class="stringliteral">&quot;Penrose tiling (darts and kites)&quot;</span>)  };
<a name="l01355"></a>01355         wxSingleChoiceDialog dlg(<span class="keyword">this</span>,_(<span class="stringliteral">&quot;Select a pattern type:&quot;</span>),_(<span class="stringliteral">&quot;New Pattern&quot;</span>),N_CHOICES,dataset_types);
<a name="l01356"></a>01356         dlg.SetSelection(1); <span class="comment">// default selection</span>
<a name="l01357"></a>01357         <span class="keywordflow">if</span>(dlg.ShowModal()!=wxID_OK) <span class="keywordflow">return</span>;
<a name="l01358"></a>01358         sel = dlg.GetSelection();
<a name="l01359"></a>01359     }
<a name="l01360"></a>01360     <a class="code" href="classAbstractRD.html" title="Abstract base class for all reaction-diffusion systems.">AbstractRD</a> *sys;
<a name="l01361"></a>01361     <span class="keywordflow">try</span> 
<a name="l01362"></a>01362     {
<a name="l01363"></a>01363         <span class="keywordflow">switch</span>(sel)
<a name="l01364"></a>01364         {
<a name="l01365"></a>01365             <span class="keywordflow">case</span> 0: <span class="comment">// 1D image</span>
<a name="l01366"></a>01366             {
<a name="l01367"></a>01367                                 <a class="code" href="classImageRD.html" title="Base class for image-based systems.">ImageRD</a> *image_sys;
<a name="l01368"></a>01368                                 <span class="keywordflow">if</span>(this-&gt;is_opencl_available)
<a name="l01369"></a>01369                                         image_sys = <span class="keyword">new</span> <a class="code" href="classFormulaOpenCLImageRD.html" title="An RD system that uses an OpenCL formula snippet.">FormulaOpenCLImageRD</a>(<a class="code" href="prefs_8cpp.html#a0de6a378ca700dd877cab59c65ba2f7b">opencl_platform</a>,<a class="code" href="prefs_8cpp.html#a11d0cbab21425e351638f4bf2cc72874">opencl_device</a>);
<a name="l01370"></a>01370                                 <span class="keywordflow">else</span>
<a name="l01371"></a>01371                                         image_sys = <span class="keyword">new</span> <a class="code" href="classGrayScottImageRD.html" title="An inbuilt implementation: n-dimensional Gray-Scott.">GrayScottImageRD</a>();
<a name="l01372"></a>01372                 image_sys-&gt;<a class="code" href="classImageRD.html#a5bfabf85d8f8e8ea604fe982e32d1cd5">SetDimensionsAndNumberOfChemicals</a>(128,1,1,2);
<a name="l01373"></a>01373                 sys = image_sys;
<a name="l01374"></a>01374                 this-&gt;render_settings.GetProperty(<span class="stringliteral">&quot;active_chemical&quot;</span>).SetChemical(<span class="stringliteral">&quot;b&quot;</span>);
<a name="l01375"></a>01375                 wxMessageBox(_(<span class="stringliteral">&quot;Created a 128x1x1 image. The dimensions can be edited in the Info Pane.&quot;</span>));
<a name="l01376"></a>01376                 <span class="keywordflow">break</span>;
<a name="l01377"></a>01377             }
<a name="l01378"></a>01378             <span class="keywordflow">case</span> 1: <span class="comment">// 2D image</span>
<a name="l01379"></a>01379             {
<a name="l01380"></a>01380                                 <a class="code" href="classImageRD.html" title="Base class for image-based systems.">ImageRD</a> *image_sys;
<a name="l01381"></a>01381                                 <span class="keywordflow">if</span>(this-&gt;is_opencl_available)
<a name="l01382"></a>01382                                         image_sys = <span class="keyword">new</span> <a class="code" href="classFormulaOpenCLImageRD.html" title="An RD system that uses an OpenCL formula snippet.">FormulaOpenCLImageRD</a>(<a class="code" href="prefs_8cpp.html#a0de6a378ca700dd877cab59c65ba2f7b">opencl_platform</a>,<a class="code" href="prefs_8cpp.html#a11d0cbab21425e351638f4bf2cc72874">opencl_device</a>);
<a name="l01383"></a>01383                                 <span class="keywordflow">else</span>
<a name="l01384"></a>01384                                         image_sys = <span class="keyword">new</span> <a class="code" href="classGrayScottImageRD.html" title="An inbuilt implementation: n-dimensional Gray-Scott.">GrayScottImageRD</a>();
<a name="l01385"></a>01385                 image_sys-&gt;<a class="code" href="classImageRD.html#a5bfabf85d8f8e8ea604fe982e32d1cd5">SetDimensionsAndNumberOfChemicals</a>(128,128,1,2);
<a name="l01386"></a>01386                 sys = image_sys;
<a name="l01387"></a>01387                 this-&gt;render_settings.GetProperty(<span class="stringliteral">&quot;active_chemical&quot;</span>).SetChemical(<span class="stringliteral">&quot;b&quot;</span>);
<a name="l01388"></a>01388                 wxMessageBox(_(<span class="stringliteral">&quot;Created a 128x128x1 image. The dimensions can be edited in the Info Pane.&quot;</span>));
<a name="l01389"></a>01389                 <span class="keywordflow">break</span>;
<a name="l01390"></a>01390             }
<a name="l01391"></a>01391             <span class="keywordflow">case</span> 2: <span class="comment">// 3D image</span>
<a name="l01392"></a>01392             {
<a name="l01393"></a>01393                                 <a class="code" href="classImageRD.html" title="Base class for image-based systems.">ImageRD</a> *image_sys;
<a name="l01394"></a>01394                                 <span class="keywordflow">if</span>(this-&gt;is_opencl_available)
<a name="l01395"></a>01395                                         image_sys = <span class="keyword">new</span> <a class="code" href="classFormulaOpenCLImageRD.html" title="An RD system that uses an OpenCL formula snippet.">FormulaOpenCLImageRD</a>(<a class="code" href="prefs_8cpp.html#a0de6a378ca700dd877cab59c65ba2f7b">opencl_platform</a>,<a class="code" href="prefs_8cpp.html#a11d0cbab21425e351638f4bf2cc72874">opencl_device</a>);
<a name="l01396"></a>01396                                 <span class="keywordflow">else</span>
<a name="l01397"></a>01397                                         image_sys = <span class="keyword">new</span> <a class="code" href="classGrayScottImageRD.html" title="An inbuilt implementation: n-dimensional Gray-Scott.">GrayScottImageRD</a>();
<a name="l01398"></a>01398                 image_sys-&gt;<a class="code" href="classImageRD.html#a5bfabf85d8f8e8ea604fe982e32d1cd5">SetDimensionsAndNumberOfChemicals</a>(32,32,32,2);
<a name="l01399"></a>01399                 sys = image_sys;
<a name="l01400"></a>01400                 this-&gt;render_settings.GetProperty(<span class="stringliteral">&quot;active_chemical&quot;</span>).SetChemical(<span class="stringliteral">&quot;b&quot;</span>);
<a name="l01401"></a>01401                 wxMessageBox(_(<span class="stringliteral">&quot;Created a 32x32x32 image. The dimensions can be edited in the Info Pane.&quot;</span>));
<a name="l01402"></a>01402                 <span class="keywordflow">break</span>;
<a name="l01403"></a>01403             }
<a name="l01404"></a>01404             <span class="keywordflow">case</span> 3: <span class="comment">// geodesic sphere</span>
<a name="l01405"></a>01405             {
<a name="l01406"></a>01406                 <span class="keywordtype">int</span> divs;
<a name="l01407"></a>01407                 {
<a name="l01408"></a>01408                     <span class="keyword">const</span> <span class="keywordtype">int</span> N_CHOICES=9;
<a name="l01409"></a>01409                     <span class="keywordtype">int</span> div_choices[N_CHOICES] = {2,3,4,5,6,7,8,9,10};
<a name="l01410"></a>01410                     wxString div_descriptions[N_CHOICES];
<a name="l01411"></a>01411                     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;N_CHOICES;i++)
<a name="l01412"></a>01412                         div_descriptions[i] = wxString::Format(<span class="stringliteral">&quot;%d subdivisions - %d cells&quot;</span>,div_choices[i],20&lt;&lt;(div_choices[i]*2));
<a name="l01413"></a>01413                     wxSingleChoiceDialog dlg(<span class="keyword">this</span>,_(<span class="stringliteral">&quot;Select the number of subdivisions:&quot;</span>),_(<span class="stringliteral">&quot;Geodesic sphere options&quot;</span>),N_CHOICES,div_descriptions);
<a name="l01414"></a>01414                     dlg.SetSelection(0); <span class="comment">// default selection</span>
<a name="l01415"></a>01415                     <span class="keywordflow">if</span>(dlg.ShowModal()!=wxID_OK) <span class="keywordflow">return</span>;
<a name="l01416"></a>01416                     divs = div_choices[dlg.GetSelection()];
<a name="l01417"></a>01417                 }
<a name="l01418"></a>01418                 wxBusyCursor busy;
<a name="l01419"></a>01419                 vtkSmartPointer&lt;vtkUnstructuredGrid&gt; mesh = vtkSmartPointer&lt;vtkUnstructuredGrid&gt;::New();
<a name="l01420"></a>01420                 <a class="code" href="namespaceMeshGenerators.html#ab6a64909fa2806c0f4fc1a481686b153" title="Subdivides an icosahedron to get a sphere covered with triangles.">MeshGenerators::GetGeodesicSphere</a>(divs,mesh,2);
<a name="l01421"></a>01421                 <a class="code" href="classMeshRD.html" title="Base class for mesh-based systems.">MeshRD</a> *mesh_sys;
<a name="l01422"></a>01422                 <span class="keywordflow">if</span>(this-&gt;is_opencl_available)
<a name="l01423"></a>01423                                         mesh_sys = <span class="keyword">new</span> <a class="code" href="classFormulaOpenCLMeshRD.html" title="An RD system that uses an OpenCL formula snippet.">FormulaOpenCLMeshRD</a>(<a class="code" href="prefs_8cpp.html#a0de6a378ca700dd877cab59c65ba2f7b">opencl_platform</a>,<a class="code" href="prefs_8cpp.html#a11d0cbab21425e351638f4bf2cc72874">opencl_device</a>);
<a name="l01424"></a>01424                                 <span class="keywordflow">else</span>
<a name="l01425"></a>01425                                         mesh_sys = <span class="keyword">new</span> <a class="code" href="classGrayScottMeshRD.html" title="A non-OpenCL mesh implementation, just as an example.">GrayScottMeshRD</a>();
<a name="l01426"></a>01426                 mesh_sys-&gt;<a class="code" href="classMeshRD.html#a86710329396780b3bf7a6f92e975cdb5">CopyFromMesh</a>(mesh);
<a name="l01427"></a>01427                 sys = mesh_sys;
<a name="l01428"></a>01428                 this-&gt;render_settings.GetProperty(<span class="stringliteral">&quot;slice_3D&quot;</span>).SetBool(<span class="keyword">false</span>);
<a name="l01429"></a>01429                 this-&gt;render_settings.GetProperty(<span class="stringliteral">&quot;active_chemical&quot;</span>).SetChemical(<span class="stringliteral">&quot;b&quot;</span>);
<a name="l01430"></a>01430                 <span class="keywordflow">break</span>;
<a name="l01431"></a>01431             }
<a name="l01432"></a>01432             <span class="keywordflow">case</span> 4: <span class="comment">// torus</span>
<a name="l01433"></a>01433             {
<a name="l01434"></a>01434                 <span class="keywordtype">int</span> nx,ny;
<a name="l01435"></a>01435                 {
<a name="l01436"></a>01436                     <span class="keyword">const</span> <span class="keywordtype">int</span> N_CHOICES=4;
<a name="l01437"></a>01437                     <span class="keywordtype">int</span> x_choices[N_CHOICES] = {100,160,200,500};
<a name="l01438"></a>01438                     <span class="keywordtype">int</span> y_choices[N_CHOICES] = {125,200,250,625};
<a name="l01439"></a>01439                     <span class="keywordtype">int</span> cells[N_CHOICES] = {12500,32000,50000,312500};
<a name="l01440"></a>01440                     wxString div_descriptions[N_CHOICES];
<a name="l01441"></a>01441                     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;N_CHOICES;i++)
<a name="l01442"></a>01442                         div_descriptions[i] = wxString::Format(<span class="stringliteral">&quot;%dx%d - %d cells&quot;</span>,x_choices[i],y_choices[i],cells[i]);
<a name="l01443"></a>01443                     wxSingleChoiceDialog dlg(<span class="keyword">this</span>,_(<span class="stringliteral">&quot;Select the resolution:&quot;</span>),_(<span class="stringliteral">&quot;Torus tiling options&quot;</span>),N_CHOICES,div_descriptions);
<a name="l01444"></a>01444                     dlg.SetSelection(2); <span class="comment">// default selection</span>
<a name="l01445"></a>01445                     <span class="keywordflow">if</span>(dlg.ShowModal()!=wxID_OK) <span class="keywordflow">return</span>;
<a name="l01446"></a>01446                     nx = x_choices[dlg.GetSelection()];
<a name="l01447"></a>01447                     ny = y_choices[dlg.GetSelection()];
<a name="l01448"></a>01448                 }
<a name="l01449"></a>01449                 vtkSmartPointer&lt;vtkUnstructuredGrid&gt; mesh = vtkSmartPointer&lt;vtkUnstructuredGrid&gt;::New();
<a name="l01450"></a>01450                 <a class="code" href="namespaceMeshGenerators.html#ad54c367c9b1ebadbcdc980212b647ebd" title="Subdivides a torus with quadrilaterals.">MeshGenerators::GetTorus</a>(nx,ny,mesh,2);
<a name="l01451"></a>01451                 <a class="code" href="classMeshRD.html" title="Base class for mesh-based systems.">MeshRD</a> *mesh_sys;
<a name="l01452"></a>01452                 <span class="keywordflow">if</span>(this-&gt;is_opencl_available)
<a name="l01453"></a>01453                                         mesh_sys = <span class="keyword">new</span> <a class="code" href="classFormulaOpenCLMeshRD.html" title="An RD system that uses an OpenCL formula snippet.">FormulaOpenCLMeshRD</a>(<a class="code" href="prefs_8cpp.html#a0de6a378ca700dd877cab59c65ba2f7b">opencl_platform</a>,<a class="code" href="prefs_8cpp.html#a11d0cbab21425e351638f4bf2cc72874">opencl_device</a>);
<a name="l01454"></a>01454                                 <span class="keywordflow">else</span>
<a name="l01455"></a>01455                                         mesh_sys = <span class="keyword">new</span> <a class="code" href="classGrayScottMeshRD.html" title="A non-OpenCL mesh implementation, just as an example.">GrayScottMeshRD</a>();
<a name="l01456"></a>01456                 mesh_sys-&gt;<a class="code" href="classMeshRD.html#a86710329396780b3bf7a6f92e975cdb5">CopyFromMesh</a>(mesh);
<a name="l01457"></a>01457                 sys = mesh_sys;
<a name="l01458"></a>01458                 this-&gt;render_settings.GetProperty(<span class="stringliteral">&quot;slice_3D&quot;</span>).SetBool(<span class="keyword">false</span>);
<a name="l01459"></a>01459                 this-&gt;render_settings.GetProperty(<span class="stringliteral">&quot;active_chemical&quot;</span>).SetChemical(<span class="stringliteral">&quot;b&quot;</span>);
<a name="l01460"></a>01460                 <span class="keywordflow">break</span>;
<a name="l01461"></a>01461             }
<a name="l01462"></a>01462             <span class="keywordflow">case</span> 5: <span class="comment">// tetrahedral mesh</span>
<a name="l01463"></a>01463             {
<a name="l01464"></a>01464                 <span class="keywordtype">int</span> npts;
<a name="l01465"></a>01465                 {
<a name="l01466"></a>01466                     <span class="keyword">const</span> <span class="keywordtype">int</span> N_CHOICES=5;
<a name="l01467"></a>01467                     <span class="keywordtype">int</span> choices[N_CHOICES] = {500,1000,1500,2000,5000};
<a name="l01468"></a>01468                     wxString div_descriptions[N_CHOICES];
<a name="l01469"></a>01469                     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;N_CHOICES;i++)
<a name="l01470"></a>01470                         div_descriptions[i] = wxString::Format(<span class="stringliteral">&quot;%d points - approximately %d cells&quot;</span>,choices[i],choices[i]*6);
<a name="l01471"></a>01471                     wxSingleChoiceDialog dlg(<span class="keyword">this</span>,_(<span class="stringliteral">&quot;Select the number of points:&quot;</span>),_(<span class="stringliteral">&quot;Tetrahedral mesh options&quot;</span>),N_CHOICES,div_descriptions);
<a name="l01472"></a>01472                     dlg.SetSelection(1); <span class="comment">// default selection</span>
<a name="l01473"></a>01473                     <span class="keywordflow">if</span>(dlg.ShowModal()!=wxID_OK) <span class="keywordflow">return</span>;
<a name="l01474"></a>01474                     npts = choices[dlg.GetSelection()];
<a name="l01475"></a>01475                 }
<a name="l01476"></a>01476                 vtkSmartPointer&lt;vtkUnstructuredGrid&gt; mesh = vtkSmartPointer&lt;vtkUnstructuredGrid&gt;::New();
<a name="l01477"></a>01477                 <a class="code" href="namespaceMeshGenerators.html#a82f55cad06fde1c843ca2632265a10ab" title="Applies the Delaunay algorith to scattered points to get a mesh of tetrahedra.">MeshGenerators::GetTetrahedralMesh</a>(npts,mesh,2);
<a name="l01478"></a>01478                 <a class="code" href="classMeshRD.html" title="Base class for mesh-based systems.">MeshRD</a> *mesh_sys;
<a name="l01479"></a>01479                 <span class="keywordflow">if</span>(this-&gt;is_opencl_available)
<a name="l01480"></a>01480                                         mesh_sys = <span class="keyword">new</span> <a class="code" href="classFormulaOpenCLMeshRD.html" title="An RD system that uses an OpenCL formula snippet.">FormulaOpenCLMeshRD</a>(<a class="code" href="prefs_8cpp.html#a0de6a378ca700dd877cab59c65ba2f7b">opencl_platform</a>,<a class="code" href="prefs_8cpp.html#a11d0cbab21425e351638f4bf2cc72874">opencl_device</a>);
<a name="l01481"></a>01481                                 <span class="keywordflow">else</span>
<a name="l01482"></a>01482                                         mesh_sys = <span class="keyword">new</span> <a class="code" href="classGrayScottMeshRD.html" title="A non-OpenCL mesh implementation, just as an example.">GrayScottMeshRD</a>();
<a name="l01483"></a>01483                 mesh_sys-&gt;<a class="code" href="classMeshRD.html#a86710329396780b3bf7a6f92e975cdb5">CopyFromMesh</a>(mesh);
<a name="l01484"></a>01484                 sys = mesh_sys;
<a name="l01485"></a>01485                 this-&gt;render_settings.GetProperty(<span class="stringliteral">&quot;active_chemical&quot;</span>).SetChemical(<span class="stringliteral">&quot;b&quot;</span>);
<a name="l01486"></a>01486                 this-&gt;render_settings.GetProperty(<span class="stringliteral">&quot;slice_3D_axis&quot;</span>).SetAxis(<span class="stringliteral">&quot;y&quot;</span>);
<a name="l01487"></a>01487                 <span class="keywordflow">break</span>;
<a name="l01488"></a>01488             }
<a name="l01489"></a>01489             <span class="keywordflow">case</span> 6: <span class="comment">// triangular mesh</span>
<a name="l01490"></a>01490             {
<a name="l01491"></a>01491                 <span class="keywordtype">int</span> n;
<a name="l01492"></a>01492                 {
<a name="l01493"></a>01493                     <span class="keyword">const</span> <span class="keywordtype">int</span> N_CHOICES=5;
<a name="l01494"></a>01494                     <span class="keywordtype">int</span> choices[N_CHOICES] = {30,50,100,200,500};
<a name="l01495"></a>01495                     <span class="keywordtype">int</span> cells[N_CHOICES] = {1682,4802,19602,79202,498002};
<a name="l01496"></a>01496                     wxString div_descriptions[N_CHOICES];
<a name="l01497"></a>01497                     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;N_CHOICES;i++)
<a name="l01498"></a>01498                         div_descriptions[i] = wxString::Format(<span class="stringliteral">&quot;%dx%d - %d cells&quot;</span>,choices[i],choices[i],cells[i]);
<a name="l01499"></a>01499                     wxSingleChoiceDialog dlg(<span class="keyword">this</span>,_(<span class="stringliteral">&quot;Select the grid size:&quot;</span>),_(<span class="stringliteral">&quot;Triangular mesh options&quot;</span>),N_CHOICES,div_descriptions);
<a name="l01500"></a>01500                     dlg.SetSelection(1); <span class="comment">// default selection</span>
<a name="l01501"></a>01501                     <span class="keywordflow">if</span>(dlg.ShowModal()!=wxID_OK) <span class="keywordflow">return</span>;
<a name="l01502"></a>01502                     n = choices[dlg.GetSelection()];
<a name="l01503"></a>01503                 }
<a name="l01504"></a>01504                 vtkSmartPointer&lt;vtkUnstructuredGrid&gt; mesh = vtkSmartPointer&lt;vtkUnstructuredGrid&gt;::New();
<a name="l01505"></a>01505                 <a class="code" href="namespaceMeshGenerators.html#a5998e324113ab7eec361ac6cb7944103" title="Makes a planar mesh of triangles.">MeshGenerators::GetTriangularMesh</a>(n,n,mesh,2);
<a name="l01506"></a>01506                 <a class="code" href="classMeshRD.html" title="Base class for mesh-based systems.">MeshRD</a> *mesh_sys;
<a name="l01507"></a>01507                 <span class="keywordflow">if</span>(this-&gt;is_opencl_available)
<a name="l01508"></a>01508                                         mesh_sys = <span class="keyword">new</span> <a class="code" href="classFormulaOpenCLMeshRD.html" title="An RD system that uses an OpenCL formula snippet.">FormulaOpenCLMeshRD</a>(<a class="code" href="prefs_8cpp.html#a0de6a378ca700dd877cab59c65ba2f7b">opencl_platform</a>,<a class="code" href="prefs_8cpp.html#a11d0cbab21425e351638f4bf2cc72874">opencl_device</a>);
<a name="l01509"></a>01509                                 <span class="keywordflow">else</span>
<a name="l01510"></a>01510                                         mesh_sys = <span class="keyword">new</span> <a class="code" href="classGrayScottMeshRD.html" title="A non-OpenCL mesh implementation, just as an example.">GrayScottMeshRD</a>();
<a name="l01511"></a>01511                 mesh_sys-&gt;<a class="code" href="classMeshRD.html#a86710329396780b3bf7a6f92e975cdb5">CopyFromMesh</a>(mesh);
<a name="l01512"></a>01512                 sys = mesh_sys;
<a name="l01513"></a>01513                 this-&gt;render_settings.GetProperty(<span class="stringliteral">&quot;active_chemical&quot;</span>).SetChemical(<span class="stringliteral">&quot;b&quot;</span>);
<a name="l01514"></a>01514                 this-&gt;render_settings.GetProperty(<span class="stringliteral">&quot;slice_3D&quot;</span>).SetBool(<span class="keyword">false</span>);
<a name="l01515"></a>01515                 this-&gt;render_settings.GetProperty(<span class="stringliteral">&quot;show_cell_edges&quot;</span>).SetBool(<span class="keyword">true</span>);
<a name="l01516"></a>01516                 this-&gt;render_settings.GetProperty(<span class="stringliteral">&quot;use_image_interpolation&quot;</span>).SetBool(<span class="keyword">false</span>);
<a name="l01517"></a>01517                 <span class="keywordflow">break</span>;
<a name="l01518"></a>01518             }
<a name="l01519"></a>01519             <span class="keywordflow">case</span> 7: <span class="comment">// hexagonal mesh</span>
<a name="l01520"></a>01520             {
<a name="l01521"></a>01521                 <span class="keywordtype">int</span> n;
<a name="l01522"></a>01522                 {
<a name="l01523"></a>01523                     <span class="keyword">const</span> <span class="keywordtype">int</span> N_CHOICES=4;
<a name="l01524"></a>01524                     <span class="keywordtype">int</span> choices[N_CHOICES] = {100,150,200,500};
<a name="l01525"></a>01525                     <span class="keywordtype">int</span> cells[N_CHOICES] = {3185,7326,13068,82668};
<a name="l01526"></a>01526                     wxString div_descriptions[N_CHOICES];
<a name="l01527"></a>01527                     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;N_CHOICES;i++)
<a name="l01528"></a>01528                         div_descriptions[i] = wxString::Format(<span class="stringliteral">&quot;%dx%d - %d cells&quot;</span>,choices[i],choices[i],cells[i]);
<a name="l01529"></a>01529                     wxSingleChoiceDialog dlg(<span class="keyword">this</span>,_(<span class="stringliteral">&quot;Select the grid size:&quot;</span>),_(<span class="stringliteral">&quot;Hexagonal mesh options&quot;</span>),N_CHOICES,div_descriptions);
<a name="l01530"></a>01530                     dlg.SetSelection(0); <span class="comment">// default selection</span>
<a name="l01531"></a>01531                     <span class="keywordflow">if</span>(dlg.ShowModal()!=wxID_OK) <span class="keywordflow">return</span>;
<a name="l01532"></a>01532                     n = choices[dlg.GetSelection()];
<a name="l01533"></a>01533                 }
<a name="l01534"></a>01534                 vtkSmartPointer&lt;vtkUnstructuredGrid&gt; mesh = vtkSmartPointer&lt;vtkUnstructuredGrid&gt;::New();
<a name="l01535"></a>01535                 <a class="code" href="namespaceMeshGenerators.html#a2786a507f59b9020da8b92fb2aa3a074" title="Makes a planar mesh of hexagons.">MeshGenerators::GetHexagonalMesh</a>(n,n,mesh,2);
<a name="l01536"></a>01536                 <a class="code" href="classMeshRD.html" title="Base class for mesh-based systems.">MeshRD</a> *mesh_sys;
<a name="l01537"></a>01537                 <span class="keywordflow">if</span>(this-&gt;is_opencl_available)
<a name="l01538"></a>01538                                         mesh_sys = <span class="keyword">new</span> <a class="code" href="classFormulaOpenCLMeshRD.html" title="An RD system that uses an OpenCL formula snippet.">FormulaOpenCLMeshRD</a>(<a class="code" href="prefs_8cpp.html#a0de6a378ca700dd877cab59c65ba2f7b">opencl_platform</a>,<a class="code" href="prefs_8cpp.html#a11d0cbab21425e351638f4bf2cc72874">opencl_device</a>);
<a name="l01539"></a>01539                                 <span class="keywordflow">else</span>
<a name="l01540"></a>01540                                         mesh_sys = <span class="keyword">new</span> <a class="code" href="classGrayScottMeshRD.html" title="A non-OpenCL mesh implementation, just as an example.">GrayScottMeshRD</a>();
<a name="l01541"></a>01541                 mesh_sys-&gt;<a class="code" href="classMeshRD.html#a86710329396780b3bf7a6f92e975cdb5">CopyFromMesh</a>(mesh);
<a name="l01542"></a>01542                 sys = mesh_sys;
<a name="l01543"></a>01543                 this-&gt;render_settings.GetProperty(<span class="stringliteral">&quot;active_chemical&quot;</span>).SetChemical(<span class="stringliteral">&quot;b&quot;</span>);
<a name="l01544"></a>01544                 this-&gt;render_settings.GetProperty(<span class="stringliteral">&quot;slice_3D&quot;</span>).SetBool(<span class="keyword">false</span>);
<a name="l01545"></a>01545                 this-&gt;render_settings.GetProperty(<span class="stringliteral">&quot;show_cell_edges&quot;</span>).SetBool(<span class="keyword">true</span>);
<a name="l01546"></a>01546                 this-&gt;render_settings.GetProperty(<span class="stringliteral">&quot;use_image_interpolation&quot;</span>).SetBool(<span class="keyword">false</span>);
<a name="l01547"></a>01547                 <span class="keywordflow">break</span>;
<a name="l01548"></a>01548             }
<a name="l01549"></a>01549             <span class="keywordflow">case</span> 8: <span class="comment">// rhombille tiling</span>
<a name="l01550"></a>01550             {
<a name="l01551"></a>01551                 <span class="keywordtype">int</span> n;
<a name="l01552"></a>01552                 {
<a name="l01553"></a>01553                     <span class="keyword">const</span> <span class="keywordtype">int</span> N_CHOICES=5;
<a name="l01554"></a>01554                     <span class="keywordtype">int</span> choices[N_CHOICES] = {50,75,100,150,200};
<a name="l01555"></a>01555                     <span class="keywordtype">int</span> cells[N_CHOICES] = {2304,5367,9555,21978,39204};
<a name="l01556"></a>01556                     wxString div_descriptions[N_CHOICES];
<a name="l01557"></a>01557                     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;N_CHOICES;i++)
<a name="l01558"></a>01558                         div_descriptions[i] = wxString::Format(<span class="stringliteral">&quot;%dx%d - %d cells&quot;</span>,choices[i],choices[i],cells[i]);
<a name="l01559"></a>01559                     wxSingleChoiceDialog dlg(<span class="keyword">this</span>,_(<span class="stringliteral">&quot;Select the grid size:&quot;</span>),_(<span class="stringliteral">&quot;Rhombille mesh options&quot;</span>),N_CHOICES,div_descriptions);
<a name="l01560"></a>01560                     dlg.SetSelection(0); <span class="comment">// default selection</span>
<a name="l01561"></a>01561                     <span class="keywordflow">if</span>(dlg.ShowModal()!=wxID_OK) <span class="keywordflow">return</span>;
<a name="l01562"></a>01562                     n = choices[dlg.GetSelection()];
<a name="l01563"></a>01563                 }
<a name="l01564"></a>01564                 vtkSmartPointer&lt;vtkUnstructuredGrid&gt; mesh = vtkSmartPointer&lt;vtkUnstructuredGrid&gt;::New();
<a name="l01565"></a>01565                 <a class="code" href="namespaceMeshGenerators.html#aec0d732a464d810896e08c4a3047872b" title="Makes a planar mesh using the rhombille tiling.">MeshGenerators::GetRhombilleTiling</a>(n,n,mesh,2);
<a name="l01566"></a>01566                 <a class="code" href="classMeshRD.html" title="Base class for mesh-based systems.">MeshRD</a> *mesh_sys;
<a name="l01567"></a>01567                 <span class="keywordflow">if</span>(this-&gt;is_opencl_available)
<a name="l01568"></a>01568                                         mesh_sys = <span class="keyword">new</span> <a class="code" href="classFormulaOpenCLMeshRD.html" title="An RD system that uses an OpenCL formula snippet.">FormulaOpenCLMeshRD</a>(<a class="code" href="prefs_8cpp.html#a0de6a378ca700dd877cab59c65ba2f7b">opencl_platform</a>,<a class="code" href="prefs_8cpp.html#a11d0cbab21425e351638f4bf2cc72874">opencl_device</a>);
<a name="l01569"></a>01569                                 <span class="keywordflow">else</span>
<a name="l01570"></a>01570                                         mesh_sys = <span class="keyword">new</span> <a class="code" href="classGrayScottMeshRD.html" title="A non-OpenCL mesh implementation, just as an example.">GrayScottMeshRD</a>();
<a name="l01571"></a>01571                 mesh_sys-&gt;<a class="code" href="classMeshRD.html#a86710329396780b3bf7a6f92e975cdb5">CopyFromMesh</a>(mesh);
<a name="l01572"></a>01572                 sys = mesh_sys;
<a name="l01573"></a>01573                 this-&gt;render_settings.GetProperty(<span class="stringliteral">&quot;active_chemical&quot;</span>).SetChemical(<span class="stringliteral">&quot;b&quot;</span>);
<a name="l01574"></a>01574                 this-&gt;render_settings.GetProperty(<span class="stringliteral">&quot;slice_3D&quot;</span>).SetBool(<span class="keyword">false</span>);
<a name="l01575"></a>01575                 this-&gt;render_settings.GetProperty(<span class="stringliteral">&quot;show_cell_edges&quot;</span>).SetBool(<span class="keyword">true</span>);
<a name="l01576"></a>01576                 this-&gt;render_settings.GetProperty(<span class="stringliteral">&quot;use_image_interpolation&quot;</span>).SetBool(<span class="keyword">false</span>);
<a name="l01577"></a>01577                 <span class="keywordflow">break</span>;
<a name="l01578"></a>01578             }
<a name="l01579"></a>01579             <span class="keywordflow">case</span> 9: <span class="comment">// Penrose rhombi tiling</span>
<a name="l01580"></a>01580             {
<a name="l01581"></a>01581                 <span class="keywordtype">int</span> divs;
<a name="l01582"></a>01582                 {
<a name="l01583"></a>01583                     <span class="keyword">const</span> <span class="keywordtype">int</span> N_CHOICES=5;
<a name="l01584"></a>01584                     <span class="keywordtype">int</span> div_choices[N_CHOICES] = {5,7,8,9,10};
<a name="l01585"></a>01585                     <span class="keywordtype">int</span> cells[N_CHOICES] = {430,3010,7920,20800,54560};
<a name="l01586"></a>01586                     wxString div_descriptions[N_CHOICES];
<a name="l01587"></a>01587                     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;N_CHOICES;i++)
<a name="l01588"></a>01588                         div_descriptions[i] = wxString::Format(<span class="stringliteral">&quot;%d subdivisions - %d cells&quot;</span>,div_choices[i],cells[i]);
<a name="l01589"></a>01589                     wxSingleChoiceDialog dlg(<span class="keyword">this</span>,_(<span class="stringliteral">&quot;Select the number of subdivisions:&quot;</span>),_(<span class="stringliteral">&quot;Penrose tiling options&quot;</span>),N_CHOICES,div_descriptions);
<a name="l01590"></a>01590                     dlg.SetSelection(1); <span class="comment">// default selection</span>
<a name="l01591"></a>01591                     <span class="keywordflow">if</span>(dlg.ShowModal()!=wxID_OK) <span class="keywordflow">return</span>;
<a name="l01592"></a>01592                     divs = div_choices[dlg.GetSelection()];
<a name="l01593"></a>01593                 }
<a name="l01594"></a>01594                 vtkSmartPointer&lt;vtkUnstructuredGrid&gt; mesh = vtkSmartPointer&lt;vtkUnstructuredGrid&gt;::New();
<a name="l01595"></a>01595                 <a class="code" href="namespaceMeshGenerators.html#af2bb69dc1c3a600123649b5e2f7b76f4" title="Make a planar Penrose tiling, using either rhombi (type=0) or darts and kites (type=1).">MeshGenerators::GetPenroseTiling</a>(divs,0,mesh,2);
<a name="l01596"></a>01596                 <a class="code" href="classMeshRD.html" title="Base class for mesh-based systems.">MeshRD</a> *mesh_sys;
<a name="l01597"></a>01597                 <span class="keywordflow">if</span>(this-&gt;is_opencl_available)
<a name="l01598"></a>01598                                         mesh_sys = <span class="keyword">new</span> <a class="code" href="classFormulaOpenCLMeshRD.html" title="An RD system that uses an OpenCL formula snippet.">FormulaOpenCLMeshRD</a>(<a class="code" href="prefs_8cpp.html#a0de6a378ca700dd877cab59c65ba2f7b">opencl_platform</a>,<a class="code" href="prefs_8cpp.html#a11d0cbab21425e351638f4bf2cc72874">opencl_device</a>);
<a name="l01599"></a>01599                                 <span class="keywordflow">else</span>
<a name="l01600"></a>01600                                         mesh_sys = <span class="keyword">new</span> <a class="code" href="classGrayScottMeshRD.html" title="A non-OpenCL mesh implementation, just as an example.">GrayScottMeshRD</a>();
<a name="l01601"></a>01601                 mesh_sys-&gt;<a class="code" href="classMeshRD.html#a86710329396780b3bf7a6f92e975cdb5">CopyFromMesh</a>(mesh);
<a name="l01602"></a>01602                 sys = mesh_sys;
<a name="l01603"></a>01603                 this-&gt;render_settings.GetProperty(<span class="stringliteral">&quot;active_chemical&quot;</span>).SetChemical(<span class="stringliteral">&quot;b&quot;</span>);
<a name="l01604"></a>01604                 this-&gt;render_settings.GetProperty(<span class="stringliteral">&quot;slice_3D&quot;</span>).SetBool(<span class="keyword">false</span>);
<a name="l01605"></a>01605                 this-&gt;render_settings.GetProperty(<span class="stringliteral">&quot;show_cell_edges&quot;</span>).SetBool(<span class="keyword">true</span>);
<a name="l01606"></a>01606                 this-&gt;render_settings.GetProperty(<span class="stringliteral">&quot;use_image_interpolation&quot;</span>).SetBool(<span class="keyword">false</span>);
<a name="l01607"></a>01607                 <span class="keywordflow">break</span>;
<a name="l01608"></a>01608             }
<a name="l01609"></a>01609             <span class="keywordflow">case</span> 10: <span class="comment">// Penrose darts and kites tiling</span>
<a name="l01610"></a>01610             {
<a name="l01611"></a>01611                 <span class="keywordtype">int</span> divs;
<a name="l01612"></a>01612                 {
<a name="l01613"></a>01613                     <span class="keyword">const</span> <span class="keywordtype">int</span> N_CHOICES=5;
<a name="l01614"></a>01614                     <span class="keywordtype">int</span> div_choices[N_CHOICES] = {5,6,7,8,9};
<a name="l01615"></a>01615                     <span class="keywordtype">int</span> cells[N_CHOICES] = {705,1855,4885,12845,33705};
<a name="l01616"></a>01616                     wxString div_descriptions[N_CHOICES];
<a name="l01617"></a>01617                     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;N_CHOICES;i++)
<a name="l01618"></a>01618                         div_descriptions[i] = wxString::Format(<span class="stringliteral">&quot;%d subdivisions - %d cells&quot;</span>,div_choices[i],cells[i]);
<a name="l01619"></a>01619                     wxSingleChoiceDialog dlg(<span class="keyword">this</span>,_(<span class="stringliteral">&quot;Select the number of subdivisions:&quot;</span>),_(<span class="stringliteral">&quot;Penrose tiling options&quot;</span>),N_CHOICES,div_descriptions);
<a name="l01620"></a>01620                     dlg.SetSelection(2); <span class="comment">// default selection</span>
<a name="l01621"></a>01621                     <span class="keywordflow">if</span>(dlg.ShowModal()!=wxID_OK) <span class="keywordflow">return</span>;
<a name="l01622"></a>01622                     divs = div_choices[dlg.GetSelection()];
<a name="l01623"></a>01623                 }
<a name="l01624"></a>01624                 vtkSmartPointer&lt;vtkUnstructuredGrid&gt; mesh = vtkSmartPointer&lt;vtkUnstructuredGrid&gt;::New();
<a name="l01625"></a>01625                 <a class="code" href="namespaceMeshGenerators.html#af2bb69dc1c3a600123649b5e2f7b76f4" title="Make a planar Penrose tiling, using either rhombi (type=0) or darts and kites (type=1).">MeshGenerators::GetPenroseTiling</a>(divs,1,mesh,2);
<a name="l01626"></a>01626                 <a class="code" href="classMeshRD.html" title="Base class for mesh-based systems.">MeshRD</a> *mesh_sys;
<a name="l01627"></a>01627                 <span class="keywordflow">if</span>(this-&gt;is_opencl_available)
<a name="l01628"></a>01628                                         mesh_sys = <span class="keyword">new</span> <a class="code" href="classFormulaOpenCLMeshRD.html" title="An RD system that uses an OpenCL formula snippet.">FormulaOpenCLMeshRD</a>(<a class="code" href="prefs_8cpp.html#a0de6a378ca700dd877cab59c65ba2f7b">opencl_platform</a>,<a class="code" href="prefs_8cpp.html#a11d0cbab21425e351638f4bf2cc72874">opencl_device</a>);
<a name="l01629"></a>01629                                 <span class="keywordflow">else</span>
<a name="l01630"></a>01630                                         mesh_sys = <span class="keyword">new</span> <a class="code" href="classGrayScottMeshRD.html" title="A non-OpenCL mesh implementation, just as an example.">GrayScottMeshRD</a>();
<a name="l01631"></a>01631                 mesh_sys-&gt;<a class="code" href="classMeshRD.html#a86710329396780b3bf7a6f92e975cdb5">CopyFromMesh</a>(mesh);
<a name="l01632"></a>01632                 sys = mesh_sys;
<a name="l01633"></a>01633                 this-&gt;render_settings.GetProperty(<span class="stringliteral">&quot;active_chemical&quot;</span>).SetChemical(<span class="stringliteral">&quot;b&quot;</span>);
<a name="l01634"></a>01634                 this-&gt;render_settings.GetProperty(<span class="stringliteral">&quot;slice_3D&quot;</span>).SetBool(<span class="keyword">false</span>);
<a name="l01635"></a>01635                 this-&gt;render_settings.GetProperty(<span class="stringliteral">&quot;show_cell_edges&quot;</span>).SetBool(<span class="keyword">true</span>);
<a name="l01636"></a>01636                 this-&gt;render_settings.GetProperty(<span class="stringliteral">&quot;use_image_interpolation&quot;</span>).SetBool(<span class="keyword">false</span>);
<a name="l01637"></a>01637                 wxMessageBox(_(<span class="stringliteral">&quot;There&#39;s a problem with rendering concave polygons in OpenGL, so the display might be slightly corrupted.&quot;</span>));
<a name="l01638"></a>01638                 <span class="keywordflow">break</span>;
<a name="l01639"></a>01639             }
<a name="l01640"></a>01640             <span class="keywordflow">default</span>:
<a name="l01641"></a>01641             {
<a name="l01642"></a>01642                 wxMessageBox(_(<span class="stringliteral">&quot;Not currently supported&quot;</span>));
<a name="l01643"></a>01643                 <span class="keywordflow">return</span>;
<a name="l01644"></a>01644             }
<a name="l01645"></a>01645         }
<a name="l01646"></a>01646     }
<a name="l01647"></a>01647     <span class="keywordflow">catch</span>(<span class="keyword">const</span> exception&amp; e)
<a name="l01648"></a>01648     {
<a name="l01649"></a>01649         wxString message = _(<span class="stringliteral">&quot;Failed to create new pattern. Error:\n\n&quot;</span>);
<a name="l01650"></a>01650         message += wxString(e.what(),wxConvUTF8);
<a name="l01651"></a>01651         <a class="code" href="classMonospaceMessageBox.html" title="Displays a block of text in a monospace font.">MonospaceMessageBox</a>(message,_(<span class="stringliteral">&quot;Error creating new pattern&quot;</span>),wxART_ERROR);
<a name="l01652"></a>01652         <span class="keywordflow">return</span>;
<a name="l01653"></a>01653     }
<a name="l01654"></a>01654     <span class="keywordflow">catch</span>(...)
<a name="l01655"></a>01655     {
<a name="l01656"></a>01656         wxString message = _(<span class="stringliteral">&quot;Failed to create new pattern.&quot;</span>);
<a name="l01657"></a>01657         <a class="code" href="classMonospaceMessageBox.html" title="Displays a block of text in a monospace font.">MonospaceMessageBox</a>(message,_(<span class="stringliteral">&quot;Error creating pattern&quot;</span>),wxART_ERROR);
<a name="l01658"></a>01658         <span class="keywordflow">return</span>;
<a name="l01659"></a>01659     }
<a name="l01660"></a>01660     
<a name="l01661"></a>01661         sys-&gt;<a class="code" href="classAbstractRD.html#a3da00130c9bded5c65b891307486cecc" title="Create a generator suitable for Gray-Scott, so that new patterns can start working immediately...">CreateDefaultInitialPatternGenerator</a>();
<a name="l01662"></a>01662         sys-&gt;<a class="code" href="classAbstractRD.html#a434004b8c1197c3d82a8c0a89ebf09e1">GenerateInitialPattern</a>();
<a name="l01663"></a>01663         this-&gt;SetCurrentRDSystem(sys);
<a name="l01664"></a>01664 
<a name="l01665"></a>01665     this-&gt;system-&gt;SetFilename(<span class="stringliteral">&quot;untitled&quot;</span>);
<a name="l01666"></a>01666     this-&gt;system-&gt;SetModified(<span class="keyword">false</span>);
<a name="l01667"></a>01667     this-&gt;UpdateWindows();
<a name="l01668"></a>01668 }
<a name="l01669"></a>01669 
<a name="l01670"></a>01670 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l01671"></a>01671 
<a name="l01672"></a><a class="code" href="classMyFrame.html#a6f02cf3b0fc388971523943457c5cc36">01672</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#a6f02cf3b0fc388971523943457c5cc36">MyFrame::OnOpenPattern</a>(wxCommandEvent&amp; event)
<a name="l01673"></a>01673 {
<a name="l01674"></a>01674     wxFileDialog opendlg(<span class="keyword">this</span>, _(<span class="stringliteral">&quot;Choose a pattern file&quot;</span>), <a class="code" href="prefs_8cpp.html#adc6c83c9ee4250d0b1f2b2b9f33fa777">opensavedir</a>, wxEmptyString,
<a name="l01675"></a>01675                          _(<span class="stringliteral">&quot;Extended VTK files (*.vti;*.vtu)|*.vti;*.vtu&quot;</span>),
<a name="l01676"></a>01676                          wxFD_OPEN | wxFD_FILE_MUST_EXIST);
<a name="l01677"></a>01677 <span class="preprocessor">    #ifdef __WXGTK__</span>
<a name="l01678"></a>01678 <span class="preprocessor"></span>        <span class="comment">// opensavedir is ignored above (bug in wxGTK 2.8.x???)</span>
<a name="l01679"></a>01679         opendlg.SetDirectory(<a class="code" href="prefs_8cpp.html#adc6c83c9ee4250d0b1f2b2b9f33fa777">opensavedir</a>);
<a name="l01680"></a>01680 <span class="preprocessor">    #endif</span>
<a name="l01681"></a>01681 <span class="preprocessor"></span>    <span class="keywordflow">if</span>(opendlg.ShowModal() == wxID_OK) {
<a name="l01682"></a>01682         wxFileName fullpath( opendlg.GetPath() );
<a name="l01683"></a>01683         <a class="code" href="prefs_8cpp.html#adc6c83c9ee4250d0b1f2b2b9f33fa777">opensavedir</a> = fullpath.GetPath();
<a name="l01684"></a>01684         OpenFile( opendlg.GetPath() );
<a name="l01685"></a>01685     }
<a name="l01686"></a>01686 }
<a name="l01687"></a>01687 
<a name="l01688"></a>01688 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l01689"></a>01689 
<a name="l01690"></a><a class="code" href="classMyFrame.html#a436d29334a575795c92361ba33bf06c3">01690</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#a436d29334a575795c92361ba33bf06c3">MyFrame::OpenFile</a>(<span class="keyword">const</span> wxString&amp; path, <span class="keywordtype">bool</span> remember)
<a name="l01691"></a>01691 {
<a name="l01692"></a>01692     <span class="keywordflow">if</span> (<a class="code" href="wxutils_8cpp.html#a76758ad632040bc87bae5d58aa9358de">IsHTMLFile</a>(path)) {
<a name="l01693"></a>01693         <span class="comment">// show HTML file in help pane</span>
<a name="l01694"></a>01694         this-&gt;help_panel-&gt;ShowHelp(path);
<a name="l01695"></a>01695     
<a name="l01696"></a>01696         wxAuiPaneInfo &amp;pane = this-&gt;aui_mgr.GetPane(<a class="code" href="frame_8cpp.html#adb2d02d23949d250b57d1b3e00210c70">PaneName</a>(<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994aa793fe9cd53e4212456e78a881d61e73">ID::HelpPane</a>));
<a name="l01697"></a>01697         <span class="keywordflow">if</span>(pane.IsOk() &amp;&amp; !pane.IsShown()) {
<a name="l01698"></a>01698             pane.Show();
<a name="l01699"></a>01699             this-&gt;aui_mgr.Update();
<a name="l01700"></a>01700         }
<a name="l01701"></a>01701         
<a name="l01702"></a>01702         <span class="keywordflow">return</span>;
<a name="l01703"></a>01703     }
<a name="l01704"></a>01704     
<a name="l01705"></a>01705     <span class="keywordflow">if</span> (<a class="code" href="wxutils_8cpp.html#aa390352c0253eff8ca804e20566a4ce6">IsTextFile</a>(path)) {
<a name="l01706"></a>01706         <span class="comment">// open text file in user&#39;s preferred text editor</span>
<a name="l01707"></a>01707         EditFile(path);
<a name="l01708"></a>01708         <span class="keywordflow">return</span>;
<a name="l01709"></a>01709     }
<a name="l01710"></a>01710 
<a name="l01711"></a>01711     <span class="keywordflow">if</span>(!wxFileExists(path))
<a name="l01712"></a>01712     {
<a name="l01713"></a>01713         wxMessageBox(_(<span class="stringliteral">&quot;File doesn&#39;t exist: &quot;</span>)+path);
<a name="l01714"></a>01714         <span class="keywordflow">return</span>;
<a name="l01715"></a>01715     }
<a name="l01716"></a>01716 
<a name="l01717"></a>01717     <span class="keywordflow">if</span>(UserWantsToCancelWhenAskedIfWantsToSave()) <span class="keywordflow">return</span>;
<a name="l01718"></a>01718 
<a name="l01719"></a>01719     <span class="keywordflow">if</span>(remember) AddRecentPattern(path);
<a name="l01720"></a>01720     
<a name="l01721"></a>01721     wxBeginBusyCursor();
<a name="l01722"></a>01722 
<a name="l01723"></a>01723     <span class="comment">// load pattern file</span>
<a name="l01724"></a>01724     <span class="keywordtype">bool</span> warn_to_update = <span class="keyword">false</span>;
<a name="l01725"></a>01725     <a class="code" href="classAbstractRD.html" title="Abstract base class for all reaction-diffusion systems.">AbstractRD</a> *target_system = NULL;
<a name="l01726"></a>01726     <span class="keywordflow">try</span>
<a name="l01727"></a>01727     {
<a name="l01728"></a>01728         <span class="comment">// get the VTK data type from the file</span>
<a name="l01729"></a>01729         vtkSmartPointer&lt;vtkXMLGenericDataObjectReader&gt; generic_reader = vtkSmartPointer&lt;vtkXMLGenericDataObjectReader&gt;::New();
<a name="l01730"></a>01730         <span class="keywordtype">bool</span> parallel;
<a name="l01731"></a>01731         <span class="keywordtype">int</span> data_type = generic_reader-&gt;ReadOutputType(path.mb_str(),parallel);
<a name="l01732"></a>01732 
<a name="l01733"></a>01733         <span class="keywordflow">if</span>( data_type == VTK_IMAGE_DATA )
<a name="l01734"></a>01734         {
<a name="l01735"></a>01735             vtkSmartPointer&lt;RD_XMLImageReader&gt; reader = vtkSmartPointer&lt;RD_XMLImageReader&gt;::New();
<a name="l01736"></a>01736             reader-&gt;SetFileName(path.mb_str());
<a name="l01737"></a>01737             reader-&gt;Update();
<a name="l01738"></a>01738             vtkImageData *image = reader-&gt;GetOutput();
<a name="l01739"></a>01739 
<a name="l01740"></a>01740             <span class="keywordtype">string</span> type = reader-&gt;GetType();
<a name="l01741"></a>01741             <span class="keywordtype">string</span> name = reader-&gt;GetName();
<a name="l01742"></a>01742 
<a name="l01743"></a>01743             <a class="code" href="classImageRD.html" title="Base class for image-based systems.">ImageRD</a>* image_system;
<a name="l01744"></a>01744             <span class="keywordflow">if</span>(type==<span class="stringliteral">&quot;inbuilt&quot;</span>)
<a name="l01745"></a>01745             {
<a name="l01746"></a>01746                 <span class="keywordflow">if</span>(name==<span class="stringliteral">&quot;Gray-Scott&quot;</span>)
<a name="l01747"></a>01747                     image_system = <span class="keyword">new</span> <a class="code" href="classGrayScottImageRD.html" title="An inbuilt implementation: n-dimensional Gray-Scott.">GrayScottImageRD</a>();
<a name="l01748"></a>01748                 <span class="keywordflow">else</span> 
<a name="l01749"></a>01749                     <span class="keywordflow">throw</span> runtime_error(<span class="stringliteral">&quot;Unsupported inbuilt implementation: &quot;</span>+name);
<a name="l01750"></a>01750             }
<a name="l01751"></a>01751             <span class="keywordflow">else</span> <span class="keywordflow">if</span>(type==<span class="stringliteral">&quot;formula&quot;</span>)
<a name="l01752"></a>01752             {
<a name="l01753"></a>01753                 <span class="keywordflow">if</span>(!this-&gt;is_opencl_available) 
<a name="l01754"></a>01754                     <span class="keywordflow">throw</span> runtime_error(this-&gt;opencl_not_available_message);
<a name="l01755"></a>01755                 image_system = <span class="keyword">new</span> <a class="code" href="classFormulaOpenCLImageRD.html" title="An RD system that uses an OpenCL formula snippet.">FormulaOpenCLImageRD</a>(<a class="code" href="prefs_8cpp.html#a0de6a378ca700dd877cab59c65ba2f7b">opencl_platform</a>,<a class="code" href="prefs_8cpp.html#a11d0cbab21425e351638f4bf2cc72874">opencl_device</a>);
<a name="l01756"></a>01756             }
<a name="l01757"></a>01757             <span class="keywordflow">else</span> <span class="keywordflow">if</span>(type==<span class="stringliteral">&quot;kernel&quot;</span>)
<a name="l01758"></a>01758             {
<a name="l01759"></a>01759                 <span class="keywordflow">if</span>(!this-&gt;is_opencl_available) 
<a name="l01760"></a>01760                     <span class="keywordflow">throw</span> runtime_error(this-&gt;opencl_not_available_message);
<a name="l01761"></a>01761                 image_system = <span class="keyword">new</span> <a class="code" href="classFullKernelOpenCLImageRD.html" title="An RD system that uses an OpenCL program.">FullKernelOpenCLImageRD</a>(<a class="code" href="prefs_8cpp.html#a0de6a378ca700dd877cab59c65ba2f7b">opencl_platform</a>,<a class="code" href="prefs_8cpp.html#a11d0cbab21425e351638f4bf2cc72874">opencl_device</a>);
<a name="l01762"></a>01762             }
<a name="l01763"></a>01763             <span class="keywordflow">else</span> <span class="keywordflow">throw</span> runtime_error(<span class="stringliteral">&quot;Unsupported rule type: &quot;</span>+type);
<a name="l01764"></a>01764             image_system-&gt;<a class="code" href="classAbstractRD.html#a4b3c5316c168951a9d8990ec9832839d" title="Load this pattern from an RD element.">InitializeFromXML</a>(reader-&gt;GetRDElement(),warn_to_update);
<a name="l01765"></a>01765 
<a name="l01766"></a>01766             <span class="comment">// render settings</span>
<a name="l01767"></a>01767             this-&gt;InitializeDefaultRenderSettings();
<a name="l01768"></a>01768             vtkSmartPointer&lt;vtkXMLDataElement&gt; xml_render_settings = reader-&gt;GetRDElement()-&gt;FindNestedElementWithName(<span class="stringliteral">&quot;render_settings&quot;</span>);
<a name="l01769"></a>01769             <span class="keywordflow">if</span>(xml_render_settings) <span class="comment">// optional</span>
<a name="l01770"></a>01770                 this-&gt;render_settings.OverwriteFromXML(xml_render_settings);
<a name="l01771"></a>01771 
<a name="l01772"></a>01772             <span class="keywordtype">int</span> dim[3];
<a name="l01773"></a>01773             image-&gt;GetDimensions(dim);
<a name="l01774"></a>01774             <span class="keywordtype">int</span> nc = image-&gt;GetNumberOfScalarComponents() * image-&gt;GetPointData()-&gt;GetNumberOfArrays();
<a name="l01775"></a>01775             image_system-&gt;<a class="code" href="classImageRD.html#a73be8ca9a7b6659fc2f085f08b3375ca">SetDimensions</a>(dim[0],dim[1],dim[2]);
<a name="l01776"></a>01776             image_system-&gt;<a class="code" href="classImageRD.html#af933532d2ba634c8887bd31f3b8f95f1">SetNumberOfChemicals</a>(nc);
<a name="l01777"></a>01777             <span class="keywordflow">if</span>(reader-&gt;ShouldGenerateInitialPatternWhenLoading())
<a name="l01778"></a>01778                 image_system-&gt;<a class="code" href="classImageRD.html#ad1315e99af6900fbb7fd620e4827fda3">GenerateInitialPattern</a>();
<a name="l01779"></a>01779             <span class="keywordflow">else</span>
<a name="l01780"></a>01780                 image_system-&gt;<a class="code" href="classImageRD.html#a7f4d538f7c74d6f6ec6e70c4cc4236f4">CopyFromImage</a>(image);
<a name="l01781"></a>01781             target_system = image_system;
<a name="l01782"></a>01782         }
<a name="l01783"></a>01783         <span class="keywordflow">else</span> <span class="keywordflow">if</span>( data_type == VTK_UNSTRUCTURED_GRID )
<a name="l01784"></a>01784         {
<a name="l01785"></a>01785             vtkSmartPointer&lt;RD_XMLUnstructuredGridReader&gt; reader = vtkSmartPointer&lt;RD_XMLUnstructuredGridReader&gt;::New();
<a name="l01786"></a>01786             reader-&gt;SetFileName(path.mb_str());
<a name="l01787"></a>01787             reader-&gt;Update();
<a name="l01788"></a>01788             vtkUnstructuredGrid *ugrid = reader-&gt;GetOutput();
<a name="l01789"></a>01789 
<a name="l01790"></a>01790             <span class="keywordtype">string</span> type = reader-&gt;GetType();
<a name="l01791"></a>01791             <span class="keywordtype">string</span> name = reader-&gt;GetName();
<a name="l01792"></a>01792 
<a name="l01793"></a>01793             <a class="code" href="classMeshRD.html" title="Base class for mesh-based systems.">MeshRD</a>* mesh_system;
<a name="l01794"></a>01794             <span class="keywordflow">if</span>(type==<span class="stringliteral">&quot;inbuilt&quot;</span>)
<a name="l01795"></a>01795             {
<a name="l01796"></a>01796                 <span class="keywordflow">if</span>(name==<span class="stringliteral">&quot;Gray-Scott&quot;</span>)
<a name="l01797"></a>01797                     mesh_system = <span class="keyword">new</span> <a class="code" href="classGrayScottMeshRD.html" title="A non-OpenCL mesh implementation, just as an example.">GrayScottMeshRD</a>();
<a name="l01798"></a>01798                 <span class="keywordflow">else</span> 
<a name="l01799"></a>01799                     <span class="keywordflow">throw</span> runtime_error(<span class="stringliteral">&quot;Unsupported inbuilt implementation: &quot;</span>+name);
<a name="l01800"></a>01800             }
<a name="l01801"></a>01801             <span class="keywordflow">else</span> <span class="keywordflow">if</span>(type==<span class="stringliteral">&quot;formula&quot;</span>)
<a name="l01802"></a>01802             {
<a name="l01803"></a>01803                 <span class="keywordflow">if</span>(!this-&gt;is_opencl_available) 
<a name="l01804"></a>01804                     <span class="keywordflow">throw</span> runtime_error(this-&gt;opencl_not_available_message);
<a name="l01805"></a>01805                 mesh_system = <span class="keyword">new</span> <a class="code" href="classFormulaOpenCLMeshRD.html" title="An RD system that uses an OpenCL formula snippet.">FormulaOpenCLMeshRD</a>(<a class="code" href="prefs_8cpp.html#a0de6a378ca700dd877cab59c65ba2f7b">opencl_platform</a>,<a class="code" href="prefs_8cpp.html#a11d0cbab21425e351638f4bf2cc72874">opencl_device</a>);
<a name="l01806"></a>01806             }
<a name="l01807"></a>01807             <span class="keywordflow">else</span> <span class="keywordflow">if</span>(type==<span class="stringliteral">&quot;kernel&quot;</span>)
<a name="l01808"></a>01808             {
<a name="l01809"></a>01809                 <span class="keywordflow">if</span>(!this-&gt;is_opencl_available) 
<a name="l01810"></a>01810                     <span class="keywordflow">throw</span> runtime_error(this-&gt;opencl_not_available_message);
<a name="l01811"></a>01811                 mesh_system = <span class="keyword">new</span> <a class="code" href="classFullKernelOpenCLMeshRD.html" title="An RD system that uses an OpenCL program.">FullKernelOpenCLMeshRD</a>(<a class="code" href="prefs_8cpp.html#a0de6a378ca700dd877cab59c65ba2f7b">opencl_platform</a>,<a class="code" href="prefs_8cpp.html#a11d0cbab21425e351638f4bf2cc72874">opencl_device</a>);
<a name="l01812"></a>01812             }
<a name="l01813"></a>01813             <span class="keywordflow">else</span> <span class="keywordflow">throw</span> runtime_error(<span class="stringliteral">&quot;Unsupported rule type: &quot;</span>+type);
<a name="l01814"></a>01814 
<a name="l01815"></a>01815             mesh_system-&gt;<a class="code" href="classAbstractRD.html#a4b3c5316c168951a9d8990ec9832839d" title="Load this pattern from an RD element.">InitializeFromXML</a>(reader-&gt;GetRDElement(),warn_to_update);
<a name="l01816"></a>01816             mesh_system-&gt;<a class="code" href="classMeshRD.html#a86710329396780b3bf7a6f92e975cdb5">CopyFromMesh</a>(ugrid);
<a name="l01817"></a>01817             <span class="comment">// render settings</span>
<a name="l01818"></a>01818             this-&gt;InitializeDefaultRenderSettings();
<a name="l01819"></a>01819             vtkSmartPointer&lt;vtkXMLDataElement&gt; xml_render_settings = reader-&gt;GetRDElement()-&gt;FindNestedElementWithName(<span class="stringliteral">&quot;render_settings&quot;</span>);
<a name="l01820"></a>01820             <span class="keywordflow">if</span>(xml_render_settings) <span class="comment">// optional</span>
<a name="l01821"></a>01821                 this-&gt;render_settings.OverwriteFromXML(xml_render_settings);
<a name="l01822"></a>01822 
<a name="l01823"></a>01823             <span class="keywordflow">if</span>(reader-&gt;ShouldGenerateInitialPatternWhenLoading())
<a name="l01824"></a>01824                 mesh_system-&gt;<a class="code" href="classMeshRD.html#aea439a0c84c616efb787cce88a64e51c">GenerateInitialPattern</a>();
<a name="l01825"></a>01825 
<a name="l01826"></a>01826             target_system = mesh_system;
<a name="l01827"></a>01827         }
<a name="l01828"></a>01828         <span class="keywordflow">else</span>
<a name="l01829"></a>01829         {
<a name="l01830"></a>01830             ostringstream oss;
<a name="l01831"></a>01831             oss &lt;&lt; <span class="stringliteral">&quot;Unsupported data type: &quot;</span> &lt;&lt; data_type;
<a name="l01832"></a>01832             <span class="keywordflow">throw</span> runtime_error(oss.str());
<a name="l01833"></a>01833         }
<a name="l01834"></a>01834         target_system-&gt;<a class="code" href="classAbstractRD.html#a1ac0701d5f1d0ce7a65ce08f19d4d6e7">SetFilename</a>(<span class="keywordtype">string</span>(path.mb_str())); <span class="comment">// TODO: display filetitle only (user option?)</span>
<a name="l01835"></a>01835         target_system-&gt;<a class="code" href="classAbstractRD.html#a6bcf10c119c33cde1604bdc33a19a8e9">SetModified</a>(<span class="keyword">false</span>);
<a name="l01836"></a>01836         this-&gt;SetCurrentRDSystem(target_system);
<a name="l01837"></a>01837     }
<a name="l01838"></a>01838     <span class="keywordflow">catch</span>(<span class="keyword">const</span> exception&amp; e)
<a name="l01839"></a>01839     {
<a name="l01840"></a>01840         wxEndBusyCursor();
<a name="l01841"></a>01841         wxString message = warn_to_update ? _(<span class="stringliteral">&quot;This file is from a more recent version of Ready. You should download a newer version.\n\n&quot;</span>) : _(<span class="stringliteral">&quot;&quot;</span>);
<a name="l01842"></a>01842         message += _(<span class="stringliteral">&quot;Failed to open file. Error:\n\n&quot;</span>);
<a name="l01843"></a>01843         message += wxString(e.what(),wxConvUTF8);
<a name="l01844"></a>01844         <a class="code" href="classMonospaceMessageBox.html" title="Displays a block of text in a monospace font.">MonospaceMessageBox</a>(message,_(<span class="stringliteral">&quot;Error reading file&quot;</span>),wxART_ERROR);
<a name="l01845"></a>01845         <span class="keyword">delete</span> target_system;
<a name="l01846"></a>01846         <span class="keywordflow">return</span>;
<a name="l01847"></a>01847     }
<a name="l01848"></a>01848     <span class="keywordflow">catch</span>(...)
<a name="l01849"></a>01849     {
<a name="l01850"></a>01850         wxEndBusyCursor();
<a name="l01851"></a>01851         wxString message = warn_to_update ? _(<span class="stringliteral">&quot;This file is from a more recent version of Ready. You should download a newer version.\n\n&quot;</span>) : _(<span class="stringliteral">&quot;&quot;</span>);
<a name="l01852"></a>01852         message += _(<span class="stringliteral">&quot;Failed to open file.&quot;</span>);
<a name="l01853"></a>01853         <a class="code" href="classMonospaceMessageBox.html" title="Displays a block of text in a monospace font.">MonospaceMessageBox</a>(message,_(<span class="stringliteral">&quot;Error reading file&quot;</span>),wxART_ERROR);
<a name="l01854"></a>01854         <span class="keyword">delete</span> target_system;
<a name="l01855"></a>01855         <span class="keywordflow">return</span>;
<a name="l01856"></a>01856     }
<a name="l01857"></a>01857     wxEndBusyCursor();
<a name="l01858"></a>01858     <span class="keywordflow">if</span>(warn_to_update)
<a name="l01859"></a>01859     {
<a name="l01860"></a>01860         wxMessageBox(<span class="stringliteral">&quot;This file is from a more recent version of Ready. For best results you should download a newer version.&quot;</span>);
<a name="l01861"></a>01861         <span class="comment">// TODO: allow user to stop this message from appearing every time</span>
<a name="l01862"></a>01862     }
<a name="l01863"></a>01863     this-&gt;system-&gt;SetFilename(<span class="keywordtype">string</span>(path.mb_str()));
<a name="l01864"></a>01864 }
<a name="l01865"></a>01865 
<a name="l01866"></a>01866 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l01867"></a>01867 
<a name="l01868"></a><a class="code" href="classMyFrame.html#a6dd004ebccc7302c5ed7b25eba433746">01868</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#a6dd004ebccc7302c5ed7b25eba433746">MyFrame::OnOpenRecent</a>(wxCommandEvent&amp; event)
<a name="l01869"></a>01869 {
<a name="l01870"></a>01870     <span class="keywordtype">int</span> <span class="keywordtype">id</span> = <span class="keyword">event</span>.GetId();
<a name="l01871"></a>01871     <span class="keywordflow">if</span> (<span class="keywordtype">id</span> == <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a62c752cf096291b16dd60eaa26527904">ID::ClearMissingPatterns</a>) {
<a name="l01872"></a>01872         <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a62c752cf096291b16dd60eaa26527904">ClearMissingPatterns</a>();
<a name="l01873"></a>01873     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<span class="keywordtype">id</span> == <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a706737e76be11ecaa9546057bf8216c3">ID::ClearAllPatterns</a>) {
<a name="l01874"></a>01874         <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a706737e76be11ecaa9546057bf8216c3">ClearAllPatterns</a>();
<a name="l01875"></a>01875     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( <span class="keywordtype">id</span> &gt; <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a7cbbd0c9c34ab62384ebaaea64700a6e">ID::OpenRecent</a> &amp;&amp; <span class="keywordtype">id</span> &lt;= <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a7cbbd0c9c34ab62384ebaaea64700a6e">ID::OpenRecent</a> + <a class="code" href="prefs_8cpp.html#a17a3671114d042df36485b7cf3a80840">numpatterns</a> ) {
<a name="l01876"></a>01876         OpenRecentPattern(<span class="keywordtype">id</span>);
<a name="l01877"></a>01877     } <span class="keywordflow">else</span> {
<a name="l01878"></a>01878         <span class="keyword">event</span>.Skip();
<a name="l01879"></a>01879     }
<a name="l01880"></a>01880 }
<a name="l01881"></a>01881 
<a name="l01882"></a>01882 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l01883"></a>01883 
<a name="l01884"></a><a class="code" href="classMyFrame.html#a73641e373264629dc3cc639222847135">01884</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#a73641e373264629dc3cc639222847135">MyFrame::AddRecentPattern</a>(<span class="keyword">const</span> wxString&amp; inpath)
<a name="l01885"></a>01885 {
<a name="l01886"></a>01886     <span class="keywordflow">if</span> (inpath.IsEmpty()) <span class="keywordflow">return</span>;
<a name="l01887"></a>01887     wxString path = inpath;
<a name="l01888"></a>01888     <span class="keywordflow">if</span> (path.StartsWith(<a class="code" href="prefs_8cpp.html#aa3af5b468230e51f15091c9f1410b2c4">readydir</a>)) {
<a name="l01889"></a>01889         <span class="comment">// remove readydir from start of path</span>
<a name="l01890"></a>01890         path.erase(0, <a class="code" href="prefs_8cpp.html#aa3af5b468230e51f15091c9f1410b2c4">readydir</a>.length());
<a name="l01891"></a>01891     }
<a name="l01892"></a>01892 
<a name="l01893"></a>01893     <span class="comment">// duplicate any ampersands so they appear in menu</span>
<a name="l01894"></a>01894     path.Replace(wxT(<span class="stringliteral">&quot;&amp;&quot;</span>), wxT(<span class="stringliteral">&quot;&amp;&amp;&quot;</span>));
<a name="l01895"></a>01895 
<a name="l01896"></a>01896     <span class="comment">// put given path at start of patternSubMenu</span>
<a name="l01897"></a>01897 <span class="preprocessor">    #ifdef __WXGTK__</span>
<a name="l01898"></a>01898 <span class="preprocessor"></span>        <span class="comment">// avoid wxGTK bug in FindItem if path contains underscores</span>
<a name="l01899"></a>01899         <span class="keywordtype">int</span> <span class="keywordtype">id</span> = wxNOT_FOUND;
<a name="l01900"></a>01900         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="prefs_8cpp.html#a17a3671114d042df36485b7cf3a80840">numpatterns</a>; i++) {
<a name="l01901"></a>01901             wxMenuItem* item = <a class="code" href="prefs_8cpp.html#ae5246b1632294beb0e04a2942722d304">patternSubMenu</a>-&gt;FindItemByPosition(i);
<a name="l01902"></a>01902             wxString temp = item-&gt;GetText();
<a name="l01903"></a>01903             temp.Replace(wxT(<span class="stringliteral">&quot;__&quot;</span>), wxT(<span class="stringliteral">&quot;_&quot;</span>));
<a name="l01904"></a>01904             temp.Replace(wxT(<span class="stringliteral">&quot;&amp;&quot;</span>), wxT(<span class="stringliteral">&quot;&amp;&amp;&quot;</span>));
<a name="l01905"></a>01905             <span class="keywordflow">if</span> (temp == path) {
<a name="l01906"></a>01906                 <span class="keywordtype">id</span> = <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a7cbbd0c9c34ab62384ebaaea64700a6e">ID::OpenRecent</a> + 1 + i;
<a name="l01907"></a>01907                 <span class="keywordflow">break</span>;
<a name="l01908"></a>01908             }
<a name="l01909"></a>01909         }
<a name="l01910"></a>01910 <span class="preprocessor">    #else</span>
<a name="l01911"></a>01911 <span class="preprocessor"></span>        <span class="keywordtype">int</span> <span class="keywordtype">id</span> = <a class="code" href="prefs_8cpp.html#ae5246b1632294beb0e04a2942722d304">patternSubMenu</a>-&gt;FindItem(path);
<a name="l01912"></a>01912 <span class="preprocessor">    #endif</span>
<a name="l01913"></a>01913 <span class="preprocessor"></span>    <span class="keywordflow">if</span> ( <span class="keywordtype">id</span> == wxNOT_FOUND ) {
<a name="l01914"></a>01914         <span class="keywordflow">if</span> ( numpatterns &lt; <a class="code" href="prefs_8cpp.html#af74247065dccdcbc74c5e1b8dc09e01c">maxpatterns</a> ) {
<a name="l01915"></a>01915             <span class="comment">// add new path</span>
<a name="l01916"></a>01916             numpatterns++;
<a name="l01917"></a>01917             <span class="keywordtype">id</span> = <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a7cbbd0c9c34ab62384ebaaea64700a6e">ID::OpenRecent</a> + <a class="code" href="prefs_8cpp.html#a17a3671114d042df36485b7cf3a80840">numpatterns</a>;
<a name="l01918"></a>01918             <a class="code" href="prefs_8cpp.html#ae5246b1632294beb0e04a2942722d304">patternSubMenu</a>-&gt;Insert(numpatterns - 1, <span class="keywordtype">id</span>, path);
<a name="l01919"></a>01919         } <span class="keywordflow">else</span> {
<a name="l01920"></a>01920             <span class="comment">// replace last item with new path</span>
<a name="l01921"></a>01921             wxMenuItem* item = <a class="code" href="prefs_8cpp.html#ae5246b1632294beb0e04a2942722d304">patternSubMenu</a>-&gt;FindItemByPosition(<a class="code" href="prefs_8cpp.html#af74247065dccdcbc74c5e1b8dc09e01c">maxpatterns</a> - 1);
<a name="l01922"></a>01922             item-&gt;SetText(path);
<a name="l01923"></a>01923             <span class="keywordtype">id</span> = <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a7cbbd0c9c34ab62384ebaaea64700a6e">ID::OpenRecent</a> + <a class="code" href="prefs_8cpp.html#af74247065dccdcbc74c5e1b8dc09e01c">maxpatterns</a>;
<a name="l01924"></a>01924         }
<a name="l01925"></a>01925     }
<a name="l01926"></a>01926     
<a name="l01927"></a>01927     <span class="comment">// path exists in patternSubMenu</span>
<a name="l01928"></a>01928     <span class="keywordflow">if</span> ( <span class="keywordtype">id</span> &gt; <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a7cbbd0c9c34ab62384ebaaea64700a6e">ID::OpenRecent</a> + 1 ) {
<a name="l01929"></a>01929         <span class="comment">// move path to start of menu</span>
<a name="l01930"></a>01930         wxMenuItem* item;
<a name="l01931"></a>01931         <span class="keywordflow">while</span> ( <span class="keywordtype">id</span> &gt; <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a7cbbd0c9c34ab62384ebaaea64700a6e">ID::OpenRecent</a> + 1 ) {
<a name="l01932"></a>01932             wxMenuItem* previtem = <a class="code" href="prefs_8cpp.html#ae5246b1632294beb0e04a2942722d304">patternSubMenu</a>-&gt;FindItem(<span class="keywordtype">id</span> - 1);
<a name="l01933"></a>01933             wxString prevpath = previtem-&gt;GetText();
<a name="l01934"></a>01934 <span class="preprocessor">            #ifdef __WXGTK__</span>
<a name="l01935"></a>01935 <span class="preprocessor"></span>                <span class="comment">// remove duplicate underscores</span>
<a name="l01936"></a>01936                 prevpath.Replace(wxT(<span class="stringliteral">&quot;__&quot;</span>), wxT(<span class="stringliteral">&quot;_&quot;</span>));
<a name="l01937"></a>01937                 prevpath.Replace(wxT(<span class="stringliteral">&quot;&amp;&quot;</span>), wxT(<span class="stringliteral">&quot;&amp;&amp;&quot;</span>));
<a name="l01938"></a>01938 <span class="preprocessor">            #endif</span>
<a name="l01939"></a>01939 <span class="preprocessor"></span>            item = <a class="code" href="prefs_8cpp.html#ae5246b1632294beb0e04a2942722d304">patternSubMenu</a>-&gt;FindItem(<span class="keywordtype">id</span>);
<a name="l01940"></a>01940             item-&gt;SetText(prevpath);
<a name="l01941"></a>01941             <span class="keywordtype">id</span>--;
<a name="l01942"></a>01942         }
<a name="l01943"></a>01943         item = <a class="code" href="prefs_8cpp.html#ae5246b1632294beb0e04a2942722d304">patternSubMenu</a>-&gt;FindItem(<span class="keywordtype">id</span>);
<a name="l01944"></a>01944         item-&gt;SetText(path);
<a name="l01945"></a>01945     }
<a name="l01946"></a>01946     
<a name="l01947"></a>01947     wxMenuBar* mbar = GetMenuBar();
<a name="l01948"></a>01948     <span class="keywordflow">if</span> (mbar) mbar-&gt;Enable(<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a7cbbd0c9c34ab62384ebaaea64700a6e">ID::OpenRecent</a>, numpatterns &gt; 0);
<a name="l01949"></a>01949 }
<a name="l01950"></a>01950 
<a name="l01951"></a>01951 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l01952"></a>01952 
<a name="l01953"></a><a class="code" href="classMyFrame.html#aad11d3b14d33f240778eacb7862b18f7">01953</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#aad11d3b14d33f240778eacb7862b18f7">MyFrame::OpenRecentPattern</a>(<span class="keywordtype">int</span> <span class="keywordtype">id</span>)
<a name="l01954"></a>01954 {
<a name="l01955"></a>01955     wxMenuItem* item = <a class="code" href="prefs_8cpp.html#ae5246b1632294beb0e04a2942722d304">patternSubMenu</a>-&gt;FindItem(<span class="keywordtype">id</span>);
<a name="l01956"></a>01956     <span class="keywordflow">if</span> (item) {
<a name="l01957"></a>01957         wxString path = item-&gt;GetText();
<a name="l01958"></a>01958 <span class="preprocessor">        #ifdef __WXGTK__</span>
<a name="l01959"></a>01959 <span class="preprocessor"></span>            <span class="comment">// remove duplicate underscores</span>
<a name="l01960"></a>01960             path.Replace(wxT(<span class="stringliteral">&quot;__&quot;</span>), wxT(<span class="stringliteral">&quot;_&quot;</span>));
<a name="l01961"></a>01961 <span class="preprocessor">        #endif</span>
<a name="l01962"></a>01962 <span class="preprocessor"></span>        <span class="comment">// remove duplicate ampersands</span>
<a name="l01963"></a>01963         path.Replace(wxT(<span class="stringliteral">&quot;&amp;&amp;&quot;</span>), wxT(<span class="stringliteral">&quot;&amp;&quot;</span>));
<a name="l01964"></a>01964 
<a name="l01965"></a>01965         <span class="comment">// if path isn&#39;t absolute then prepend Ready directory</span>
<a name="l01966"></a>01966         wxFileName fname(path);
<a name="l01967"></a>01967         <span class="keywordflow">if</span> (!fname.IsAbsolute()) path = <a class="code" href="prefs_8cpp.html#aa3af5b468230e51f15091c9f1410b2c4">readydir</a> + path;
<a name="l01968"></a>01968 
<a name="l01969"></a>01969         OpenFile(path);
<a name="l01970"></a>01970     }
<a name="l01971"></a>01971 }
<a name="l01972"></a>01972 
<a name="l01973"></a>01973 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l01974"></a>01974 
<a name="l01975"></a><a class="code" href="classMyFrame.html#a6e65158f18a4be192fbc284d15c4315c">01975</a> <span class="keywordtype">void</span> <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a62c752cf096291b16dd60eaa26527904">MyFrame::ClearMissingPatterns</a>()
<a name="l01976"></a>01976 {
<a name="l01977"></a>01977     <span class="keywordtype">int</span> pos = 0;
<a name="l01978"></a>01978     <span class="keywordflow">while</span> (pos &lt; <a class="code" href="prefs_8cpp.html#a17a3671114d042df36485b7cf3a80840">numpatterns</a>) {
<a name="l01979"></a>01979         wxMenuItem* item = <a class="code" href="prefs_8cpp.html#ae5246b1632294beb0e04a2942722d304">patternSubMenu</a>-&gt;FindItemByPosition(pos);
<a name="l01980"></a>01980         wxString path = item-&gt;GetText();
<a name="l01981"></a>01981 <span class="preprocessor">        #ifdef __WXGTK__</span>
<a name="l01982"></a>01982 <span class="preprocessor"></span>            <span class="comment">// remove duplicate underscores</span>
<a name="l01983"></a>01983             path.Replace(wxT(<span class="stringliteral">&quot;__&quot;</span>), wxT(<span class="stringliteral">&quot;_&quot;</span>));
<a name="l01984"></a>01984 <span class="preprocessor">        #endif</span>
<a name="l01985"></a>01985 <span class="preprocessor"></span>        <span class="comment">// remove duplicate ampersands</span>
<a name="l01986"></a>01986         path.Replace(wxT(<span class="stringliteral">&quot;&amp;&amp;&quot;</span>), wxT(<span class="stringliteral">&quot;&amp;&quot;</span>));
<a name="l01987"></a>01987 
<a name="l01988"></a>01988         <span class="comment">// if path isn&#39;t absolute then prepend Ready directory</span>
<a name="l01989"></a>01989         wxFileName fname(path);
<a name="l01990"></a>01990         <span class="keywordflow">if</span> (!fname.IsAbsolute()) path = <a class="code" href="prefs_8cpp.html#aa3af5b468230e51f15091c9f1410b2c4">readydir</a> + path;
<a name="l01991"></a>01991 
<a name="l01992"></a>01992         <span class="keywordflow">if</span> (wxFileExists(path)) {
<a name="l01993"></a>01993             <span class="comment">// keep this item</span>
<a name="l01994"></a>01994             pos++;
<a name="l01995"></a>01995         } <span class="keywordflow">else</span> {
<a name="l01996"></a>01996             <span class="comment">// remove this item by shifting up later items</span>
<a name="l01997"></a>01997             <span class="keywordtype">int</span> nextpos = pos + 1;
<a name="l01998"></a>01998             <span class="keywordflow">while</span> (nextpos &lt; <a class="code" href="prefs_8cpp.html#a17a3671114d042df36485b7cf3a80840">numpatterns</a>) {
<a name="l01999"></a>01999                 wxMenuItem* nextitem = <a class="code" href="prefs_8cpp.html#ae5246b1632294beb0e04a2942722d304">patternSubMenu</a>-&gt;FindItemByPosition(nextpos);
<a name="l02000"></a>02000 <span class="preprocessor">                #ifdef __WXGTK__</span>
<a name="l02001"></a>02001 <span class="preprocessor"></span>                    <span class="comment">// avoid wxGTK bug if item contains underscore</span>
<a name="l02002"></a>02002                     wxString temp = nextitem-&gt;GetText();
<a name="l02003"></a>02003                     temp.Replace(wxT(<span class="stringliteral">&quot;__&quot;</span>), wxT(<span class="stringliteral">&quot;_&quot;</span>));
<a name="l02004"></a>02004                     temp.Replace(wxT(<span class="stringliteral">&quot;&amp;&quot;</span>), wxT(<span class="stringliteral">&quot;&amp;&amp;&quot;</span>));
<a name="l02005"></a>02005                     item-&gt;SetText( temp );
<a name="l02006"></a>02006 <span class="preprocessor">                #else</span>
<a name="l02007"></a>02007 <span class="preprocessor"></span>                    item-&gt;SetText( nextitem-&gt;GetText() );
<a name="l02008"></a>02008 <span class="preprocessor">                #endif</span>
<a name="l02009"></a>02009 <span class="preprocessor"></span>                item = nextitem;
<a name="l02010"></a>02010                 nextpos++;
<a name="l02011"></a>02011             }
<a name="l02012"></a>02012             <span class="comment">// delete last item</span>
<a name="l02013"></a>02013             <a class="code" href="prefs_8cpp.html#ae5246b1632294beb0e04a2942722d304">patternSubMenu</a>-&gt;Delete(item);
<a name="l02014"></a>02014             <a class="code" href="prefs_8cpp.html#a17a3671114d042df36485b7cf3a80840">numpatterns</a>--;
<a name="l02015"></a>02015         }
<a name="l02016"></a>02016     }
<a name="l02017"></a>02017     wxMenuBar* mbar = GetMenuBar();
<a name="l02018"></a>02018     <span class="keywordflow">if</span> (mbar) mbar-&gt;Enable(<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a7cbbd0c9c34ab62384ebaaea64700a6e">ID::OpenRecent</a>, <a class="code" href="prefs_8cpp.html#a17a3671114d042df36485b7cf3a80840">numpatterns</a> &gt; 0);
<a name="l02019"></a>02019 }
<a name="l02020"></a>02020 
<a name="l02021"></a>02021 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l02022"></a>02022 
<a name="l02023"></a><a class="code" href="classMyFrame.html#a1e7f4fab4dab3f3b8d6d28bc43755eea">02023</a> <span class="keywordtype">void</span> <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a706737e76be11ecaa9546057bf8216c3">MyFrame::ClearAllPatterns</a>()
<a name="l02024"></a>02024 {
<a name="l02025"></a>02025     <span class="keywordflow">while</span> (<a class="code" href="prefs_8cpp.html#a17a3671114d042df36485b7cf3a80840">numpatterns</a> &gt; 0) {
<a name="l02026"></a>02026         <a class="code" href="prefs_8cpp.html#ae5246b1632294beb0e04a2942722d304">patternSubMenu</a>-&gt;Delete( <a class="code" href="prefs_8cpp.html#ae5246b1632294beb0e04a2942722d304">patternSubMenu</a>-&gt;FindItemByPosition(0) );
<a name="l02027"></a>02027         <a class="code" href="prefs_8cpp.html#a17a3671114d042df36485b7cf3a80840">numpatterns</a>--;
<a name="l02028"></a>02028     }
<a name="l02029"></a>02029     wxMenuBar* mbar = GetMenuBar();
<a name="l02030"></a>02030     <span class="keywordflow">if</span> (mbar) mbar-&gt;Enable(<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a7cbbd0c9c34ab62384ebaaea64700a6e">ID::OpenRecent</a>, <span class="keyword">false</span>);
<a name="l02031"></a>02031 }
<a name="l02032"></a>02032 
<a name="l02033"></a>02033 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l02034"></a>02034 
<a name="l02035"></a><a class="code" href="classMyFrame.html#a5c14754eb42c4f049273237e2da8bb1e">02035</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#a5c14754eb42c4f049273237e2da8bb1e">MyFrame::EditFile</a>(<span class="keyword">const</span> wxString&amp; path)
<a name="l02036"></a>02036 {
<a name="l02037"></a>02037     <span class="comment">// prompt user if text editor hasn&#39;t been set yet</span>
<a name="l02038"></a>02038     <span class="keywordflow">if</span> (<a class="code" href="prefs_8cpp.html#a3a8c57e4e1beb747c341e067dc8869bf">texteditor</a>.IsEmpty()) {
<a name="l02039"></a>02039         <a class="code" href="prefs_8cpp.html#a02ca260200a3047b1cd1f87c4b8d8eda">ChooseTextEditor</a>(<span class="keyword">this</span>, <a class="code" href="prefs_8cpp.html#a3a8c57e4e1beb747c341e067dc8869bf">texteditor</a>);
<a name="l02040"></a>02040         <span class="keywordflow">if</span> (<a class="code" href="prefs_8cpp.html#a3a8c57e4e1beb747c341e067dc8869bf">texteditor</a>.IsEmpty()) <span class="keywordflow">return</span>;
<a name="l02041"></a>02041     }
<a name="l02042"></a>02042     
<a name="l02043"></a>02043     <span class="comment">// execute a command to open given file in user&#39;s preferred text editor</span>
<a name="l02044"></a>02044     wxString cmd = wxString::Format(wxT(<span class="stringliteral">&quot;\&quot;%s\&quot; \&quot;%s\&quot;&quot;</span>), <a class="code" href="prefs_8cpp.html#a3a8c57e4e1beb747c341e067dc8869bf">texteditor</a>.c_str(), path.c_str());
<a name="l02045"></a>02045     <span class="keywordtype">long</span> result = wxExecute(cmd, wxEXEC_ASYNC);
<a name="l02046"></a>02046     
<a name="l02047"></a>02047 <span class="preprocessor">#if defined(__WXMSW__)</span>
<a name="l02048"></a>02048 <span class="preprocessor"></span>    <span class="comment">// on Windows, wxExecute returns 0 if cmd fails</span>
<a name="l02049"></a>02049     <span class="keywordflow">if</span> (result == 0)
<a name="l02050"></a>02050 <span class="preprocessor">#elif defined(__WXMAC__)</span>
<a name="l02051"></a>02051 <span class="preprocessor"></span>    <span class="comment">// on Mac, wxExecute returns -1 if cmd succeeds (bug, or wx docs are wrong)</span>
<a name="l02052"></a>02052     <span class="keywordflow">if</span> (result != -1)
<a name="l02053"></a>02053 <span class="preprocessor">#elif defined(__WXGTK__)</span>
<a name="l02054"></a>02054 <span class="preprocessor"></span>    <span class="comment">// on Linux, wxExecute always returns a +ve number (pid?) if cmd fails OR succeeds (sheesh!)</span>
<a name="l02055"></a>02055     <span class="comment">// but if it fails an error message appears in shell window</span>
<a name="l02056"></a>02056     <span class="keywordflow">if</span> (result &lt;= 0)
<a name="l02057"></a>02057 <span class="preprocessor">#endif</span>
<a name="l02058"></a>02058 <span class="preprocessor"></span>    {
<a name="l02059"></a>02059         wxString msg = _(<span class="stringliteral">&quot;Failed to open file in your preferred text editor.\n&quot;</span>);
<a name="l02060"></a>02060         msg += _(<span class="stringliteral">&quot;Try choosing a different editor in Preferences &gt; File.&quot;</span>);
<a name="l02061"></a>02061         <a class="code" href="wxutils_8cpp.html#ad496c0028843186f55032174260d2732">Warning</a>(msg);
<a name="l02062"></a>02062     }
<a name="l02063"></a>02063 }
<a name="l02064"></a>02064 
<a name="l02065"></a>02065 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l02066"></a>02066 
<a name="l02067"></a><a class="code" href="classMyFrame.html#a47f01b7eaaec08a2b57cbbab61c11327">02067</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#a47f01b7eaaec08a2b57cbbab61c11327">MyFrame::OnChangeActiveChemical</a>(wxCommandEvent&amp; event)
<a name="l02068"></a>02068 {
<a name="l02069"></a>02069     wxArrayString choices;
<a name="l02070"></a>02070     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;this-&gt;system-&gt;GetNumberOfChemicals();i++)
<a name="l02071"></a>02071         choices.Add(<a class="code" href="utils_8cpp.html#afd49013680a14bc8e1bfb0c79b80972f" title="a, b, c, ... z, aa, ab, ...">GetChemicalName</a>(i));
<a name="l02072"></a>02072     wxSingleChoiceDialog dlg(<span class="keyword">this</span>,_(<span class="stringliteral">&quot;Select the chemical to render:&quot;</span>),_(<span class="stringliteral">&quot;Select active chemical&quot;</span>),
<a name="l02073"></a>02073         choices);
<a name="l02074"></a>02074     dlg.SetSelection(<a class="code" href="utils_8cpp.html#a68e90099fe736c151fdf42384c533550">IndexFromChemicalName</a>(this-&gt;render_settings.GetProperty(<span class="stringliteral">&quot;active_chemical&quot;</span>).GetChemical()));
<a name="l02075"></a>02075     <span class="keywordflow">if</span>(dlg.ShowModal()!=wxID_OK) <span class="keywordflow">return</span>;
<a name="l02076"></a>02076     this-&gt;render_settings.GetProperty(<span class="stringliteral">&quot;active_chemical&quot;</span>).SetChemical(<a class="code" href="utils_8cpp.html#afd49013680a14bc8e1bfb0c79b80972f" title="a, b, c, ... z, aa, ab, ...">GetChemicalName</a>(dlg.GetSelection()));
<a name="l02077"></a>02077     <a class="code" href="vtk__pipeline_8cpp.html#a83eef6bea304823921ff32ce0afb6d2b">InitializeVTKPipeline</a>(this-&gt;pVTKWindow,this-&gt;system,this-&gt;render_settings,<span class="keyword">false</span>);
<a name="l02078"></a>02078     this-&gt;UpdateWindows();
<a name="l02079"></a>02079 }
<a name="l02080"></a>02080 
<a name="l02081"></a>02081 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l02082"></a>02082 
<a name="l02083"></a><a class="code" href="classMyFrame.html#a72043bb79d2b6736db8ae9dd39148618">02083</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#a72043bb79d2b6736db8ae9dd39148618">MyFrame::SetRuleName</a>(<span class="keywordtype">string</span> s)
<a name="l02084"></a>02084 {
<a name="l02085"></a>02085     this-&gt;system-&gt;SetRuleName(s);
<a name="l02086"></a>02086     this-&gt;UpdateWindowTitle();
<a name="l02087"></a>02087     this-&gt;UpdateInfoPane();
<a name="l02088"></a>02088 }
<a name="l02089"></a>02089 
<a name="l02090"></a>02090 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l02091"></a>02091 
<a name="l02092"></a><a class="code" href="classMyFrame.html#a3d6adab2be01d722b1821f10f3778b03">02092</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#a3d6adab2be01d722b1821f10f3778b03">MyFrame::SetDescription</a>(<span class="keywordtype">string</span> s)
<a name="l02093"></a>02093 {
<a name="l02094"></a>02094     this-&gt;system-&gt;SetDescription(s);
<a name="l02095"></a>02095     this-&gt;UpdateWindowTitle();
<a name="l02096"></a>02096     this-&gt;UpdateInfoPane();
<a name="l02097"></a>02097 }
<a name="l02098"></a>02098 
<a name="l02099"></a>02099 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l02100"></a>02100 
<a name="l02101"></a><a class="code" href="classMyFrame.html#a3382130cdc508a84a93b1fba6ce60127">02101</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#a3382130cdc508a84a93b1fba6ce60127">MyFrame::SetParameter</a>(<span class="keywordtype">int</span> iParam,<span class="keywordtype">float</span> val)
<a name="l02102"></a>02102 {
<a name="l02103"></a>02103     this-&gt;system-&gt;SetParameterValue(iParam,val);
<a name="l02104"></a>02104     this-&gt;UpdateWindowTitle();
<a name="l02105"></a>02105     this-&gt;UpdateInfoPane();
<a name="l02106"></a>02106 }
<a name="l02107"></a>02107 
<a name="l02108"></a>02108 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l02109"></a>02109 
<a name="l02110"></a><a class="code" href="classMyFrame.html#a48ec1ef1e55ac5c0877fbf4602438973">02110</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#a48ec1ef1e55ac5c0877fbf4602438973">MyFrame::SetParameterName</a>(<span class="keywordtype">int</span> iParam,std::string s)
<a name="l02111"></a>02111 {
<a name="l02112"></a>02112     this-&gt;system-&gt;SetParameterName(iParam,s);
<a name="l02113"></a>02113     this-&gt;UpdateWindowTitle();
<a name="l02114"></a>02114     this-&gt;UpdateInfoPane();
<a name="l02115"></a>02115 }
<a name="l02116"></a>02116 
<a name="l02117"></a>02117 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l02118"></a>02118 
<a name="l02119"></a><a class="code" href="classMyFrame.html#a79cd0b2b572c454067b2013df4743c49">02119</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#a79cd0b2b572c454067b2013df4743c49">MyFrame::SetFormula</a>(std::string s)
<a name="l02120"></a>02120 {
<a name="l02121"></a>02121     this-&gt;system-&gt;SetFormula(s);
<a name="l02122"></a>02122     this-&gt;UpdateWindowTitle();
<a name="l02123"></a>02123     this-&gt;UpdateInfoPane();
<a name="l02124"></a>02124 }
<a name="l02125"></a>02125 
<a name="l02126"></a>02126 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l02127"></a>02127 
<a name="l02128"></a><a class="code" href="classMyFrame.html#a11452a5e7f9c703d8efd600937901617">02128</a> <span class="keywordtype">bool</span> <a class="code" href="classMyFrame.html#a11452a5e7f9c703d8efd600937901617">MyFrame::UserWantsToCancelWhenAskedIfWantsToSave</a>()
<a name="l02129"></a>02129 {
<a name="l02130"></a>02130     <span class="keywordflow">if</span>(this-&gt;system == NULL || !this-&gt;system-&gt;IsModified()) <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l02131"></a>02131     
<a name="l02132"></a>02132     <span class="keywordtype">int</span> ret = <a class="code" href="wxutils_8cpp.html#aba71c60bf2fbed7083e7f571655e41f7">SaveChanges</a>(_(<span class="stringliteral">&quot;Save the current system?&quot;</span>),_(<span class="stringliteral">&quot;If you don&#39;t save, your changes will be lost.&quot;</span>));
<a name="l02133"></a>02133     <span class="keywordflow">if</span>(ret==wxCANCEL) <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l02134"></a>02134     <span class="keywordflow">if</span>(ret==wxNO) <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l02135"></a>02135 
<a name="l02136"></a>02136     <span class="comment">// ret == wxYES</span>
<a name="l02137"></a>02137     wxString filename = SavePatternDialog();
<a name="l02138"></a>02138     <span class="keywordflow">if</span>(filename.empty()) <span class="keywordflow">return</span> <span class="keyword">true</span>; <span class="comment">// user cancelled</span>
<a name="l02139"></a>02139 
<a name="l02140"></a>02140     SaveFile(filename);
<a name="l02141"></a>02141     <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l02142"></a>02142 }
<a name="l02143"></a>02143 
<a name="l02144"></a>02144 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l02145"></a>02145 
<a name="l02146"></a><a class="code" href="classMyFrame.html#aca8e8d9ade335e41689ae7ccbbc8675a">02146</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#aca8e8d9ade335e41689ae7ccbbc8675a">MyFrame::OnClose</a>(wxCloseEvent&amp; event)
<a name="l02147"></a>02147 {
<a name="l02148"></a>02148     <span class="keywordflow">if</span>(event.CanVeto() &amp;&amp; this-&gt;UserWantsToCancelWhenAskedIfWantsToSave()) <span class="keywordflow">return</span>;
<a name="l02149"></a>02149     <span class="keyword">event</span>.Skip();
<a name="l02150"></a>02150 }
<a name="l02151"></a>02151 
<a name="l02152"></a>02152 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l02153"></a>02153 
<a name="l02154"></a><a class="code" href="classMyFrame.html#ad8e839562e6445a7c23a31b45985cdab">02154</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#ad8e839562e6445a7c23a31b45985cdab">MyFrame::ShowPrefsDialog</a>(<span class="keyword">const</span> wxString&amp; page)
<a name="l02155"></a>02155 {
<a name="l02156"></a>02156     <span class="keywordflow">if</span> (<a class="code" href="prefs_8cpp.html#a64b9ee51f62e15bc2969519122d85e25">ChangePrefs</a>(page)) {
<a name="l02157"></a>02157         <span class="comment">// user hit OK button so might as well save prefs now</span>
<a name="l02158"></a>02158         SaveSettings();
<a name="l02159"></a>02159     }
<a name="l02160"></a>02160     <span class="comment">// safer to update everything even if user hit Cancel</span>
<a name="l02161"></a>02161     this-&gt;UpdateWindows();
<a name="l02162"></a>02162 }
<a name="l02163"></a>02163 
<a name="l02164"></a>02164 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l02165"></a>02165 
<a name="l02166"></a><a class="code" href="classMyFrame.html#a7fcd634b78a7900d13e0d7ae2afbea6d">02166</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#a7fcd634b78a7900d13e0d7ae2afbea6d">MyFrame::OnPreferences</a>(wxCommandEvent&amp; event)
<a name="l02167"></a>02167 {
<a name="l02168"></a>02168     ShowPrefsDialog();
<a name="l02169"></a>02169 }
<a name="l02170"></a>02170 
<a name="l02171"></a>02171 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l02172"></a>02172 
<a name="l02173"></a><a class="code" href="classMyFrame.html#a196dff933096bec97dbae62aa9ce67c9">02173</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#a196dff933096bec97dbae62aa9ce67c9">MyFrame::EnableAllMenus</a>(<span class="keywordtype">bool</span> enable)
<a name="l02174"></a>02174 {
<a name="l02175"></a>02175     wxMenuBar* mbar = GetMenuBar();
<a name="l02176"></a>02176     <span class="keywordflow">if</span> (mbar) {
<a name="l02177"></a>02177         <span class="keywordtype">int</span> count = mbar-&gt;GetMenuCount();
<a name="l02178"></a>02178         <span class="keywordtype">int</span> i;
<a name="l02179"></a>02179         <span class="keywordflow">for</span> (i = 0; i &lt; count; i++) {
<a name="l02180"></a>02180             mbar-&gt;EnableTop(i, enable);
<a name="l02181"></a>02181         }
<a name="l02182"></a>02182 <span class="preprocessor">        #ifdef __WXOSX_COCOA__</span>
<a name="l02183"></a>02183 <span class="preprocessor"></span>            <span class="comment">// enable/disable items in app menu</span>
<a name="l02184"></a>02184             <span class="comment">// AKT TODO!!! they fail to disable due to wxOSX-Cocoa bug</span>
<a name="l02185"></a>02185             mbar-&gt;Enable(wxID_ABOUT, enable);
<a name="l02186"></a>02186             mbar-&gt;Enable(wxID_PREFERENCES, enable);
<a name="l02187"></a>02187             mbar-&gt;Enable(wxID_EXIT, enable);
<a name="l02188"></a>02188 <span class="preprocessor">        #endif</span>
<a name="l02189"></a>02189 <span class="preprocessor"></span>    }
<a name="l02190"></a>02190 }
<a name="l02191"></a>02191 
<a name="l02192"></a>02192 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l02193"></a>02193 
<a name="l02194"></a><a class="code" href="classMyFrame.html#ab1b7872607e17b76d86f104c94518ec6">02194</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#ab1b7872607e17b76d86f104c94518ec6">MyFrame::OnActivate</a>(wxActivateEvent&amp; event)
<a name="l02195"></a>02195 {
<a name="l02196"></a>02196     <span class="comment">// we need to disable all menu items when frame becomes inactive</span>
<a name="l02197"></a>02197     <span class="comment">// (eg. due to a modal dialog appearing) so that keys bound to menu items</span>
<a name="l02198"></a>02198     <span class="comment">// get passed to wxTextCtrls</span>
<a name="l02199"></a>02199     EnableAllMenus(event.GetActive());
<a name="l02200"></a>02200     <span class="keyword">event</span>.Skip();
<a name="l02201"></a>02201 }
<a name="l02202"></a>02202 
<a name="l02203"></a>02203 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l02204"></a>02204 
<a name="l02205"></a><a class="code" href="classMyFrame.html#a2fb74621355633ddff14d83943003550">02205</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#a2fb74621355633ddff14d83943003550">MyFrame::UpdateMenuAccelerators</a>()
<a name="l02206"></a>02206 {
<a name="l02207"></a>02207     <span class="comment">// keyboard shortcuts have changed, so update all menu item accelerators</span>
<a name="l02208"></a>02208     wxMenuBar* mbar = GetMenuBar();
<a name="l02209"></a>02209     <span class="keywordflow">if</span> (mbar) {
<a name="l02210"></a>02210         <span class="comment">// AKT TODO!!! wxOSX-Cocoa bug: these app menu items aren&#39;t updated</span>
<a name="l02211"></a>02211         <span class="comment">// (but user isn&#39;t likely to change them so not critical)</span>
<a name="l02212"></a>02212         <a class="code" href="prefs_8cpp.html#a80ab9b805f2f3378a3e053969dddbb2c">SetAccelerator</a>(mbar, wxID_ABOUT,                    <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a6c41bc6a32c0c5bb09a732a21cfccf4f">DO_ABOUT</a>);
<a name="l02213"></a>02213         <a class="code" href="prefs_8cpp.html#a80ab9b805f2f3378a3e053969dddbb2c">SetAccelerator</a>(mbar, wxID_PREFERENCES,              <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a9df6720475a3f3e52740a0250774dee2">DO_PREFS</a>);
<a name="l02214"></a>02214         <a class="code" href="prefs_8cpp.html#a80ab9b805f2f3378a3e053969dddbb2c">SetAccelerator</a>(mbar, wxID_EXIT,                     <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a0d23c152db0c24154c6a13303a6151a4">DO_QUIT</a>);
<a name="l02215"></a>02215         
<a name="l02216"></a>02216         <a class="code" href="prefs_8cpp.html#a80ab9b805f2f3378a3e053969dddbb2c">SetAccelerator</a>(mbar, wxID_NEW,                      <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a0a8b90d6d06556d673ffab3fe7bd765a">DO_NEWPATT</a>);
<a name="l02217"></a>02217         <a class="code" href="prefs_8cpp.html#a80ab9b805f2f3378a3e053969dddbb2c">SetAccelerator</a>(mbar, wxID_OPEN,                     <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a13b814442bb726fc27e2e46d75f68903">DO_OPENPATT</a>);
<a name="l02218"></a>02218         <a class="code" href="prefs_8cpp.html#a80ab9b805f2f3378a3e053969dddbb2c">SetAccelerator</a>(mbar, <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994ae7bda90ebbf43016198827042d4096a6">ID::ReloadFromDisk</a>,            <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62ae20cb524276f390aad2a8e31a85da68b">DO_RELOAD</a>);
<a name="l02219"></a>02219         <a class="code" href="prefs_8cpp.html#a80ab9b805f2f3378a3e053969dddbb2c">SetAccelerator</a>(mbar, <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a175531e6c07358f49a087d247ad79c2c">ID::ImportMesh</a>,                <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a1f4076bb401751fd60b827874e30b09c">DO_IMPORTMESH</a>);
<a name="l02220"></a>02220         <a class="code" href="prefs_8cpp.html#a80ab9b805f2f3378a3e053969dddbb2c">SetAccelerator</a>(mbar, <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a5a8bede146a5ee0a5972b95d7398f52b">ID::ExportMesh</a>,                <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a3b71061f14e65228175c258013cbec1c">DO_EXPORTMESH</a>);
<a name="l02221"></a>02221         <a class="code" href="prefs_8cpp.html#a80ab9b805f2f3378a3e053969dddbb2c">SetAccelerator</a>(mbar, <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994ad82007f1e3c968f6c48cafeee5703960">ID::ExportImage</a>,               <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62ad485985a3e2b6d4f2e4385e9a989ff0c">DO_EXPORTIMAGE</a>);
<a name="l02222"></a>02222         <a class="code" href="prefs_8cpp.html#a80ab9b805f2f3378a3e053969dddbb2c">SetAccelerator</a>(mbar, wxID_SAVE,                     <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62ac14c985dfcd45cba2f41c72260d29ffe">DO_SAVE</a>);
<a name="l02223"></a>02223         <a class="code" href="prefs_8cpp.html#a80ab9b805f2f3378a3e053969dddbb2c">SetAccelerator</a>(mbar, <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a67f4892e5c57cce8f949046681a353e9">ID::Screenshot</a>,                <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a8031583e5967eecb9ddf9d6a25962e5d">DO_SCREENSHOT</a>);
<a name="l02224"></a>02224         <a class="code" href="prefs_8cpp.html#a80ab9b805f2f3378a3e053969dddbb2c">SetAccelerator</a>(mbar, <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a7e41393e0cd6b5ee413a7d3669b3caf0">ID::StartRecording</a>,            <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a082e23992459dda1ce84300f90abe78f">DO_STARTRECORDING</a>);
<a name="l02225"></a>02225         <a class="code" href="prefs_8cpp.html#a80ab9b805f2f3378a3e053969dddbb2c">SetAccelerator</a>(mbar, <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994ad88b62c95bc0ef4d7d10305be547100d">ID::StopRecording</a>,             <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a897e611210825bbe786f7689733208c1">DO_STOPRECORDING</a>);
<a name="l02226"></a>02226         <a class="code" href="prefs_8cpp.html#a80ab9b805f2f3378a3e053969dddbb2c">SetAccelerator</a>(mbar, <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a96cb152725348747ab810e2f61fd95b8">ID::AddMyPatterns</a>,             <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a9b0e09a8a5af3eeda22366ae9a682b06">DO_ADDPATTS</a>);
<a name="l02227"></a>02227         
<a name="l02228"></a>02228         <a class="code" href="prefs_8cpp.html#a80ab9b805f2f3378a3e053969dddbb2c">SetAccelerator</a>(mbar, wxID_CUT,                      <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a86e6bb0ed1ed8e2b71aeee759d04f751">DO_CUT</a>);
<a name="l02229"></a>02229         <a class="code" href="prefs_8cpp.html#a80ab9b805f2f3378a3e053969dddbb2c">SetAccelerator</a>(mbar, wxID_COPY,                     <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a66ab504cb136ee10d90b5041b69b1072">DO_COPY</a>);
<a name="l02230"></a>02230         <a class="code" href="prefs_8cpp.html#a80ab9b805f2f3378a3e053969dddbb2c">SetAccelerator</a>(mbar, wxID_PASTE,                    <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a57db23febf9d70735b2d5429f9322921">DO_PASTE</a>);
<a name="l02231"></a>02231         <a class="code" href="prefs_8cpp.html#a80ab9b805f2f3378a3e053969dddbb2c">SetAccelerator</a>(mbar, wxID_CLEAR,                    <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62ad1502fb1fa8a6db8f0d5eab8c5ea1795">DO_CLEAR</a>);
<a name="l02232"></a>02232         <a class="code" href="prefs_8cpp.html#a80ab9b805f2f3378a3e053969dddbb2c">SetAccelerator</a>(mbar, wxID_SELECTALL,                <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a5e89d8bab01100c776f98476f132750c">DO_SELALL</a>);
<a name="l02233"></a>02233         
<a name="l02234"></a>02234         <a class="code" href="prefs_8cpp.html#a80ab9b805f2f3378a3e053969dddbb2c">SetAccelerator</a>(mbar, <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a414589df96055cbbf92f287fc135dcbf">ID::FullScreen</a>,                <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a14ccfd2e63a339d4172bda3ad550fff2">DO_FULLSCREEN</a>);
<a name="l02235"></a>02235         <a class="code" href="prefs_8cpp.html#a80ab9b805f2f3378a3e053969dddbb2c">SetAccelerator</a>(mbar, <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a427c0b326c042c60a407421b66c543fa">ID::FitPattern</a>,                <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a4b6a631192c5074db6357ebea2a4caf0">DO_FIT</a>);
<a name="l02236"></a>02236         <a class="code" href="prefs_8cpp.html#a80ab9b805f2f3378a3e053969dddbb2c">SetAccelerator</a>(mbar, <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994ac939d32eac9bad1c9c238c92526f6143">ID::Wireframe</a>,                 <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a069bd47d4f1f5762840246bb5a52bebf">DO_WIREFRAME</a>);
<a name="l02237"></a>02237         <a class="code" href="prefs_8cpp.html#a80ab9b805f2f3378a3e053969dddbb2c">SetAccelerator</a>(mbar, <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994acb63579b388e2e1b0fa5117d6bc55e08">ID::PatternsPane</a>,              <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a57a2af46aa8cd3deb36042aa2a05a4f0">DO_PATTERNS</a>);
<a name="l02238"></a>02238         <a class="code" href="prefs_8cpp.html#a80ab9b805f2f3378a3e053969dddbb2c">SetAccelerator</a>(mbar, <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a9a7b8f50f338bc1f33bbb46a265c66b2">ID::InfoPane</a>,                  <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a3b10246f0f8338327b892109a70eca29">DO_INFO</a>);
<a name="l02239"></a>02239         <a class="code" href="prefs_8cpp.html#a80ab9b805f2f3378a3e053969dddbb2c">SetAccelerator</a>(mbar, <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994aa793fe9cd53e4212456e78a881d61e73">ID::HelpPane</a>,                  <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a150b825efd182d9c95b587c9ef5516b9">DO_HELP</a>);
<a name="l02240"></a>02240         <a class="code" href="prefs_8cpp.html#a80ab9b805f2f3378a3e053969dddbb2c">SetAccelerator</a>(mbar, <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a970f2597ef339a100a5499c8bb8521c8">ID::RestoreDefaultPerspective</a>, <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62afb76022044b62bb892c1ee65ac4ef721">DO_RESTORE</a>);
<a name="l02241"></a>02241         <a class="code" href="prefs_8cpp.html#a80ab9b805f2f3378a3e053969dddbb2c">SetAccelerator</a>(mbar, <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a877fbb5ffc961960113e5daaa2cf81b2">ID::ChangeActiveChemical</a>,      <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a776300076489934b1008c8d05602a494">DO_CHEMICAL</a>);
<a name="l02242"></a>02242         
<a name="l02243"></a>02243         <a class="code" href="prefs_8cpp.html#a80ab9b805f2f3378a3e053969dddbb2c">SetAccelerator</a>(mbar, <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a29ce194c83647cde2066a129499a28b1">ID::Step1</a>,                     <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a5b6cbabe6909263c772ceb091fb2edcd">DO_STEP1</a>);
<a name="l02244"></a>02244         <a class="code" href="prefs_8cpp.html#a80ab9b805f2f3378a3e053969dddbb2c">SetAccelerator</a>(mbar, <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994aabc39ee10e4d33f32ba11dd7773ad781">ID::StepN</a>,                     <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62af6d9327fcfb8264f43b07cb94d66ec10">DO_STEPN</a>);
<a name="l02245"></a>02245         <a class="code" href="prefs_8cpp.html#a80ab9b805f2f3378a3e053969dddbb2c">SetAccelerator</a>(mbar, <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a7fa86a9ca58943a68ee72c2278d7091f">ID::RunStop</a>,                   <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62ad6773bc2d8b3a475b59775af5afc215c">DO_RUNSTOP</a>);
<a name="l02246"></a>02246         <a class="code" href="prefs_8cpp.html#a80ab9b805f2f3378a3e053969dddbb2c">SetAccelerator</a>(mbar, <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994ac6fcd8a484e837c655a4dfbbe689c12c">ID::Faster</a>,                    <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a389cee4c4147fecd61a4d134396e2e72">DO_FASTER</a>);
<a name="l02247"></a>02247         <a class="code" href="prefs_8cpp.html#a80ab9b805f2f3378a3e053969dddbb2c">SetAccelerator</a>(mbar, <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a9ec4f0f78fdccdd3937c37932871cb31">ID::Slower</a>,                    <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a53386a419f01d0b75372910dc9260c7e">DO_SLOWER</a>);
<a name="l02248"></a>02248         <a class="code" href="prefs_8cpp.html#a80ab9b805f2f3378a3e053969dddbb2c">SetAccelerator</a>(mbar, <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a34de4b7050e8e026745a5287938fd874">ID::ChangeRunningSpeed</a>,        <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62ae99153a35a4d051301adf666e9263afe">DO_CHANGESPEED</a>);
<a name="l02249"></a>02249         <a class="code" href="prefs_8cpp.html#a80ab9b805f2f3378a3e053969dddbb2c">SetAccelerator</a>(mbar, <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994ae64df26aa1aa17c056626418eeba266c">ID::Reset</a>,                     <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a4165bc81d865b678b2f9b7410eed6018">DO_RESET</a>);
<a name="l02250"></a>02250         <a class="code" href="prefs_8cpp.html#a80ab9b805f2f3378a3e053969dddbb2c">SetAccelerator</a>(mbar, <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a8b6dde37a380581b5c30d1d5f912f183">ID::GenerateInitialPattern</a>,    <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a4fe766d76d47511ceac02eff795a8b58">DO_GENPATT</a>);
<a name="l02251"></a>02251         <a class="code" href="prefs_8cpp.html#a80ab9b805f2f3378a3e053969dddbb2c">SetAccelerator</a>(mbar, <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a549e30966f04ac0c4348ea12a1d7282a">ID::Blank</a>,                     <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a00385d86c86e7885de37c86cf08587fc">DO_BLANK</a>);
<a name="l02252"></a>02252         <a class="code" href="prefs_8cpp.html#a80ab9b805f2f3378a3e053969dddbb2c">SetAccelerator</a>(mbar, <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a7755c932c23e416eff7e29e82276dc87">ID::AddParameter</a>,              <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62aa4d123ec804f00f2a2e6668d0c3770fe">DO_ADDPARAM</a>);
<a name="l02253"></a>02253         <a class="code" href="prefs_8cpp.html#a80ab9b805f2f3378a3e053969dddbb2c">SetAccelerator</a>(mbar, <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a9377f837fdf3eb370dd4d06d34dd1e29">ID::DeleteParameter</a>,           <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a2d72ebc020c77a64e833c939c6dabbd6">DO_DELPARAM</a>);
<a name="l02254"></a>02254         <a class="code" href="prefs_8cpp.html#a80ab9b805f2f3378a3e053969dddbb2c">SetAccelerator</a>(mbar, <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a9fa971bdea3dff48c7f2500cc9d0a693">ID::ViewFullKernel</a>,            <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a2f1156f3997ca07f6a87461122ee21d8">DO_VIEWKERNEL</a>);
<a name="l02255"></a>02255         <a class="code" href="prefs_8cpp.html#a80ab9b805f2f3378a3e053969dddbb2c">SetAccelerator</a>(mbar, <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a82d526382ae3e9f7b1ecf5274d3c265f">ID::SelectOpenCLDevice</a>,        <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62acb4c9b11dea3500cc66f3f402c084a2a">DO_DEVICE</a>);
<a name="l02256"></a>02256         <a class="code" href="prefs_8cpp.html#a80ab9b805f2f3378a3e053969dddbb2c">SetAccelerator</a>(mbar, <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a25785909b339d2424ba3e06092aea24d">ID::OpenCLDiagnostics</a>,         <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a47d344b75c0413566f55457e40d54914">DO_OPENCL</a>);
<a name="l02257"></a>02257     }
<a name="l02258"></a>02258 }
<a name="l02259"></a>02259 
<a name="l02260"></a>02260 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l02261"></a>02261 
<a name="l02262"></a><a class="code" href="classMyFrame.html#a47a959eefdac32d85b8d3fe6b675329a">02262</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#a47a959eefdac32d85b8d3fe6b675329a">MyFrame::ProcessKey</a>(<span class="keywordtype">int</span> key, <span class="keywordtype">int</span> modifiers)
<a name="l02263"></a>02263 {
<a name="l02264"></a>02264     <span class="keywordtype">int</span> cmdid = 0;
<a name="l02265"></a>02265     <a class="code" href="structaction__info.html">action_info</a> action = <a class="code" href="prefs_8cpp.html#a3c4b979a2ad1be1b0c006967843ee58d">FindAction</a>(key, modifiers);
<a name="l02266"></a>02266     
<a name="l02267"></a>02267     <span class="keywordflow">switch</span> (action.<a class="code" href="structaction__info.html#aa8aa631cd84cd7672b7870e1af6e6863">id</a>)
<a name="l02268"></a>02268     {
<a name="l02269"></a>02269         <span class="keywordflow">case</span> <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62aa3c06bc7e4d652a970cab72026c6fed1">DO_NOTHING</a>:        <span class="comment">// any unassigned key (including escape) turns off full screen mode</span>
<a name="l02270"></a>02270                                 <span class="keywordflow">if</span> (fullscreen) cmdid = <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a414589df96055cbbf92f287fc135dcbf">ID::FullScreen</a>; <span class="keywordflow">break</span>;
<a name="l02271"></a>02271         
<a name="l02272"></a>02272         <span class="keywordflow">case</span> <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a143bfdd54d27e620ee14307ec3cbd989">DO_OPENFILE</a>:       OpenFile(action.<a class="code" href="structaction__info.html#aa467bd3685a2427efa3f49cae6df2301">file</a>);
<a name="l02273"></a>02273                                 <span class="keywordflow">return</span>;
<a name="l02274"></a>02274         
<a name="l02275"></a>02275         <span class="comment">// File menu</span>
<a name="l02276"></a>02276         <span class="keywordflow">case</span> <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a0a8b90d6d06556d673ffab3fe7bd765a">DO_NEWPATT</a>:        cmdid = wxID_NEW; <span class="keywordflow">break</span>;
<a name="l02277"></a>02277         <span class="keywordflow">case</span> <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a13b814442bb726fc27e2e46d75f68903">DO_OPENPATT</a>:       cmdid = wxID_OPEN; <span class="keywordflow">break</span>;
<a name="l02278"></a>02278         <span class="keywordflow">case</span> <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62ae20cb524276f390aad2a8e31a85da68b">DO_RELOAD</a>:         cmdid = <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994ae7bda90ebbf43016198827042d4096a6">ID::ReloadFromDisk</a>; <span class="keywordflow">break</span>;
<a name="l02279"></a>02279         <span class="keywordflow">case</span> <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a1f4076bb401751fd60b827874e30b09c">DO_IMPORTMESH</a>:     cmdid = <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a175531e6c07358f49a087d247ad79c2c">ID::ImportMesh</a>; <span class="keywordflow">break</span>;
<a name="l02280"></a>02280         <span class="keywordflow">case</span> <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a3b71061f14e65228175c258013cbec1c">DO_EXPORTMESH</a>:     cmdid = <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a5a8bede146a5ee0a5972b95d7398f52b">ID::ExportMesh</a>; <span class="keywordflow">break</span>;
<a name="l02281"></a>02281         <span class="keywordflow">case</span> <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62ad485985a3e2b6d4f2e4385e9a989ff0c">DO_EXPORTIMAGE</a>:    cmdid = <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994ad82007f1e3c968f6c48cafeee5703960">ID::ExportImage</a>; <span class="keywordflow">break</span>;
<a name="l02282"></a>02282         <span class="keywordflow">case</span> <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62ac14c985dfcd45cba2f41c72260d29ffe">DO_SAVE</a>:           cmdid = wxID_SAVE; <span class="keywordflow">break</span>;
<a name="l02283"></a>02283         <span class="keywordflow">case</span> <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a8031583e5967eecb9ddf9d6a25962e5d">DO_SCREENSHOT</a>:     cmdid = <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a67f4892e5c57cce8f949046681a353e9">ID::Screenshot</a>; <span class="keywordflow">break</span>;
<a name="l02284"></a>02284         <span class="keywordflow">case</span> <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a082e23992459dda1ce84300f90abe78f">DO_STARTRECORDING</a>: cmdid = <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a7e41393e0cd6b5ee413a7d3669b3caf0">ID::StartRecording</a>; <span class="keywordflow">break</span>;
<a name="l02285"></a>02285         <span class="keywordflow">case</span> <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a897e611210825bbe786f7689733208c1">DO_STOPRECORDING</a>:  cmdid = <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994ad88b62c95bc0ef4d7d10305be547100d">ID::StopRecording</a>; <span class="keywordflow">break</span>;
<a name="l02286"></a>02286         <span class="keywordflow">case</span> <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a9b0e09a8a5af3eeda22366ae9a682b06">DO_ADDPATTS</a>:       cmdid = <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a96cb152725348747ab810e2f61fd95b8">ID::AddMyPatterns</a>; <span class="keywordflow">break</span>;
<a name="l02287"></a>02287         <span class="keywordflow">case</span> <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a9df6720475a3f3e52740a0250774dee2">DO_PREFS</a>:          cmdid = wxID_PREFERENCES; <span class="keywordflow">break</span>;
<a name="l02288"></a>02288         <span class="keywordflow">case</span> <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a0d23c152db0c24154c6a13303a6151a4">DO_QUIT</a>:           cmdid = wxID_EXIT; <span class="keywordflow">break</span>;
<a name="l02289"></a>02289         
<a name="l02290"></a>02290         <span class="comment">// Edit menu</span>
<a name="l02291"></a>02291         <span class="keywordflow">case</span> <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a86e6bb0ed1ed8e2b71aeee759d04f751">DO_CUT</a>:            cmdid = wxID_CUT; <span class="keywordflow">break</span>;
<a name="l02292"></a>02292         <span class="keywordflow">case</span> <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a66ab504cb136ee10d90b5041b69b1072">DO_COPY</a>:           cmdid = wxID_COPY; <span class="keywordflow">break</span>;
<a name="l02293"></a>02293         <span class="keywordflow">case</span> <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a57db23febf9d70735b2d5429f9322921">DO_PASTE</a>:          cmdid = wxID_PASTE; <span class="keywordflow">break</span>;
<a name="l02294"></a>02294         <span class="keywordflow">case</span> <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62ad1502fb1fa8a6db8f0d5eab8c5ea1795">DO_CLEAR</a>:          cmdid = wxID_CLEAR; <span class="keywordflow">break</span>;
<a name="l02295"></a>02295         <span class="keywordflow">case</span> <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a5e89d8bab01100c776f98476f132750c">DO_SELALL</a>:         cmdid = wxID_SELECTALL; <span class="keywordflow">break</span>;
<a name="l02296"></a>02296         
<a name="l02297"></a>02297         <span class="comment">// View menu</span>
<a name="l02298"></a>02298         <span class="keywordflow">case</span> <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a14ccfd2e63a339d4172bda3ad550fff2">DO_FULLSCREEN</a>:     cmdid = <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a414589df96055cbbf92f287fc135dcbf">ID::FullScreen</a>; <span class="keywordflow">break</span>;
<a name="l02299"></a>02299         <span class="keywordflow">case</span> <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a4b6a631192c5074db6357ebea2a4caf0">DO_FIT</a>:            cmdid = <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a427c0b326c042c60a407421b66c543fa">ID::FitPattern</a>; <span class="keywordflow">break</span>;
<a name="l02300"></a>02300         <span class="keywordflow">case</span> <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a069bd47d4f1f5762840246bb5a52bebf">DO_WIREFRAME</a>:      cmdid = <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994ac939d32eac9bad1c9c238c92526f6143">ID::Wireframe</a>; <span class="keywordflow">break</span>;
<a name="l02301"></a>02301         <span class="keywordflow">case</span> <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a57a2af46aa8cd3deb36042aa2a05a4f0">DO_PATTERNS</a>:       cmdid = <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994acb63579b388e2e1b0fa5117d6bc55e08">ID::PatternsPane</a>; <span class="keywordflow">break</span>;
<a name="l02302"></a>02302         <span class="keywordflow">case</span> <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a3b10246f0f8338327b892109a70eca29">DO_INFO</a>:           cmdid = <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a9a7b8f50f338bc1f33bbb46a265c66b2">ID::InfoPane</a>; <span class="keywordflow">break</span>;
<a name="l02303"></a>02303         <span class="keywordflow">case</span> <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a150b825efd182d9c95b587c9ef5516b9">DO_HELP</a>:           cmdid = <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994aa793fe9cd53e4212456e78a881d61e73">ID::HelpPane</a>; <span class="keywordflow">break</span>;
<a name="l02304"></a>02304         <span class="keywordflow">case</span> <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62afb76022044b62bb892c1ee65ac4ef721">DO_RESTORE</a>:        cmdid = <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a970f2597ef339a100a5499c8bb8521c8">ID::RestoreDefaultPerspective</a>; <span class="keywordflow">break</span>;
<a name="l02305"></a>02305         <span class="keywordflow">case</span> <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a776300076489934b1008c8d05602a494">DO_CHEMICAL</a>:       cmdid = <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a877fbb5ffc961960113e5daaa2cf81b2">ID::ChangeActiveChemical</a>; <span class="keywordflow">break</span>;
<a name="l02306"></a>02306         
<a name="l02307"></a>02307         <span class="comment">// Action menu</span>
<a name="l02308"></a>02308         <span class="keywordflow">case</span> <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a5b6cbabe6909263c772ceb091fb2edcd">DO_STEP1</a>:          cmdid = <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a29ce194c83647cde2066a129499a28b1">ID::Step1</a>; <span class="keywordflow">break</span>;
<a name="l02309"></a>02309         <span class="keywordflow">case</span> <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62af6d9327fcfb8264f43b07cb94d66ec10">DO_STEPN</a>:          cmdid = <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994aabc39ee10e4d33f32ba11dd7773ad781">ID::StepN</a>; <span class="keywordflow">break</span>;
<a name="l02310"></a>02310         <span class="keywordflow">case</span> <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62ad6773bc2d8b3a475b59775af5afc215c">DO_RUNSTOP</a>:        cmdid = <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a7fa86a9ca58943a68ee72c2278d7091f">ID::RunStop</a>; <span class="keywordflow">break</span>;
<a name="l02311"></a>02311         <span class="keywordflow">case</span> <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a389cee4c4147fecd61a4d134396e2e72">DO_FASTER</a>:         cmdid = <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994ac6fcd8a484e837c655a4dfbbe689c12c">ID::Faster</a>; <span class="keywordflow">break</span>;
<a name="l02312"></a>02312         <span class="keywordflow">case</span> <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a53386a419f01d0b75372910dc9260c7e">DO_SLOWER</a>:         cmdid = <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a9ec4f0f78fdccdd3937c37932871cb31">ID::Slower</a>; <span class="keywordflow">break</span>;
<a name="l02313"></a>02313         <span class="keywordflow">case</span> <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62ae99153a35a4d051301adf666e9263afe">DO_CHANGESPEED</a>:    cmdid = <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a34de4b7050e8e026745a5287938fd874">ID::ChangeRunningSpeed</a>; <span class="keywordflow">break</span>;
<a name="l02314"></a>02314         <span class="keywordflow">case</span> <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a4165bc81d865b678b2f9b7410eed6018">DO_RESET</a>:          cmdid = <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994ae64df26aa1aa17c056626418eeba266c">ID::Reset</a>; <span class="keywordflow">break</span>;
<a name="l02315"></a>02315         <span class="keywordflow">case</span> <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a4fe766d76d47511ceac02eff795a8b58">DO_GENPATT</a>:        cmdid = <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a8b6dde37a380581b5c30d1d5f912f183">ID::GenerateInitialPattern</a>; <span class="keywordflow">break</span>;
<a name="l02316"></a>02316         <span class="keywordflow">case</span> <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a00385d86c86e7885de37c86cf08587fc">DO_BLANK</a>:          cmdid = <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a549e30966f04ac0c4348ea12a1d7282a">ID::Blank</a>; <span class="keywordflow">break</span>;
<a name="l02317"></a>02317         <span class="keywordflow">case</span> <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62aa4d123ec804f00f2a2e6668d0c3770fe">DO_ADDPARAM</a>:       cmdid = <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a7755c932c23e416eff7e29e82276dc87">ID::AddParameter</a>; <span class="keywordflow">break</span>;
<a name="l02318"></a>02318         <span class="keywordflow">case</span> <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a2d72ebc020c77a64e833c939c6dabbd6">DO_DELPARAM</a>:       cmdid = <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a9377f837fdf3eb370dd4d06d34dd1e29">ID::DeleteParameter</a>; <span class="keywordflow">break</span>;
<a name="l02319"></a>02319         <span class="keywordflow">case</span> <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a2f1156f3997ca07f6a87461122ee21d8">DO_VIEWKERNEL</a>:     cmdid = <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a9fa971bdea3dff48c7f2500cc9d0a693">ID::ViewFullKernel</a>; <span class="keywordflow">break</span>;
<a name="l02320"></a>02320         <span class="keywordflow">case</span> <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62acb4c9b11dea3500cc66f3f402c084a2a">DO_DEVICE</a>:         cmdid = <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a82d526382ae3e9f7b1ecf5274d3c265f">ID::SelectOpenCLDevice</a>; <span class="keywordflow">break</span>;
<a name="l02321"></a>02321         <span class="keywordflow">case</span> <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a47d344b75c0413566f55457e40d54914">DO_OPENCL</a>:         cmdid = <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a25785909b339d2424ba3e06092aea24d">ID::OpenCLDiagnostics</a>; <span class="keywordflow">break</span>;
<a name="l02322"></a>02322         
<a name="l02323"></a>02323         <span class="comment">// Help menu</span>
<a name="l02324"></a>02324         <span class="keywordflow">case</span> <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a6c41bc6a32c0c5bb09a732a21cfccf4f">DO_ABOUT</a>:          cmdid = wxID_ABOUT; <span class="keywordflow">break</span>;
<a name="l02325"></a>02325         
<a name="l02326"></a>02326         <span class="keywordflow">default</span>:                <a class="code" href="wxutils_8cpp.html#ad496c0028843186f55032174260d2732">Warning</a>(_(<span class="stringliteral">&quot;Bug detected in ProcessKey!&quot;</span>));
<a name="l02327"></a>02327     }
<a name="l02328"></a>02328    
<a name="l02329"></a>02329     <span class="keywordflow">if</span> (cmdid != 0) {
<a name="l02330"></a>02330         wxCommandEvent cmdevent(wxEVT_COMMAND_MENU_SELECTED, cmdid);
<a name="l02331"></a>02331         cmdevent.SetEventObject(<span class="keyword">this</span>);
<a name="l02332"></a>02332         this-&gt;GetEventHandler()-&gt;ProcessEvent(cmdevent);
<a name="l02333"></a>02333     }
<a name="l02334"></a>02334 }
<a name="l02335"></a>02335 
<a name="l02336"></a>02336 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l02337"></a>02337 
<a name="l02338"></a><a class="code" href="classMyFrame.html#ac0457b9e23e582141215c35e5d42d97c">02338</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#ac0457b9e23e582141215c35e5d42d97c">MyFrame::OnKeyDown</a>(wxKeyEvent&amp; event)
<a name="l02339"></a>02339 {
<a name="l02340"></a>02340 <span class="preprocessor">    #ifdef __WXMAC__</span>
<a name="l02341"></a>02341 <span class="preprocessor"></span>        <span class="comment">// close any open tool tip window (fixes wxMac bug?)</span>
<a name="l02342"></a>02342         wxToolTip::RemoveToolTips();
<a name="l02343"></a>02343 <span class="preprocessor">    #endif</span>
<a name="l02344"></a>02344 <span class="preprocessor"></span>
<a name="l02345"></a>02345     realkey = <span class="keyword">event</span>.GetKeyCode();
<a name="l02346"></a>02346     <span class="keywordtype">int</span> mods = <span class="keyword">event</span>.GetModifiers();
<a name="l02347"></a>02347 
<a name="l02348"></a>02348     <span class="comment">// WARNING: logic must match that in KeyComboCtrl::OnKeyDown in prefs.cpp</span>
<a name="l02349"></a>02349     <span class="keywordflow">if</span> (mods == wxMOD_NONE || realkey == WXK_ESCAPE || realkey &gt; 127) {
<a name="l02350"></a>02350         <span class="comment">// tell OnChar handler to ignore realkey</span>
<a name="l02351"></a>02351         realkey = 0;
<a name="l02352"></a>02352     }
<a name="l02353"></a>02353 
<a name="l02354"></a>02354 <span class="preprocessor">    #ifdef __WXOSX__</span>
<a name="l02355"></a>02355 <span class="preprocessor"></span>        <span class="comment">// pass ctrl/cmd-key combos directly to OnChar</span>
<a name="l02356"></a>02356         <span class="keywordflow">if</span> (realkey &gt; 0 &amp;&amp; ((mods &amp; wxMOD_CONTROL) || (mods &amp; wxMOD_CMD))) {
<a name="l02357"></a>02357             this-&gt;OnChar(event);
<a name="l02358"></a>02358             <span class="keywordflow">return</span>;
<a name="l02359"></a>02359         }
<a name="l02360"></a>02360 <span class="preprocessor">    #endif</span>
<a name="l02361"></a>02361 <span class="preprocessor"></span>    
<a name="l02362"></a>02362 <span class="preprocessor">    #ifdef __WXMSW__</span>
<a name="l02363"></a>02363 <span class="preprocessor"></span>        <span class="comment">// on Windows, OnChar is NOT called for some ctrl-key combos like</span>
<a name="l02364"></a>02364         <span class="comment">// ctrl-0..9 or ctrl-alt-key, so we call OnChar ourselves</span>
<a name="l02365"></a>02365         <span class="keywordflow">if</span> (realkey &gt; 0 &amp;&amp; (mods &amp; wxMOD_CONTROL)) {
<a name="l02366"></a>02366             this-&gt;OnChar(event);
<a name="l02367"></a>02367             <span class="keywordflow">return</span>;
<a name="l02368"></a>02368         }
<a name="l02369"></a>02369 <span class="preprocessor">    #endif</span>
<a name="l02370"></a>02370 <span class="preprocessor"></span>
<a name="l02371"></a>02371 <span class="preprocessor">    #ifdef __WXGTK__</span>
<a name="l02372"></a>02372 <span class="preprocessor"></span>        <span class="keywordflow">if</span> (realkey == <span class="charliteral">&#39; &#39;</span> &amp;&amp; mods == wxMOD_SHIFT) {
<a name="l02373"></a>02373             <span class="comment">// fix wxGTK bug (curiously, the bug isn&#39;t seen in the prefs dialog);</span>
<a name="l02374"></a>02374             <span class="comment">// OnChar won&#39;t see the shift modifier, so set realkey to a special</span>
<a name="l02375"></a>02375             <span class="comment">// value to tell OnChar that shift-space was pressed</span>
<a name="l02376"></a>02376             realkey = -666;
<a name="l02377"></a>02377         }
<a name="l02378"></a>02378 <span class="preprocessor">    #endif</span>
<a name="l02379"></a>02379 <span class="preprocessor"></span>
<a name="l02380"></a>02380     <span class="keyword">event</span>.Skip();
<a name="l02381"></a>02381 }
<a name="l02382"></a>02382 
<a name="l02383"></a>02383 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l02384"></a>02384 
<a name="l02385"></a><a class="code" href="classMyFrame.html#a7d2dd27713dc21ead65462aeca0d0d75">02385</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#a7d2dd27713dc21ead65462aeca0d0d75">MyFrame::OnChar</a>(wxKeyEvent&amp; event)
<a name="l02386"></a>02386 {
<a name="l02387"></a>02387     <span class="keywordtype">int</span> key = <span class="keyword">event</span>.GetKeyCode();
<a name="l02388"></a>02388     <span class="keywordtype">int</span> mods = <span class="keyword">event</span>.GetModifiers();
<a name="l02389"></a>02389 
<a name="l02390"></a>02390     <span class="comment">// WARNING: logic here must match that in KeyComboCtrl::OnChar in prefs.cpp</span>
<a name="l02391"></a>02391     <span class="keywordflow">if</span> (realkey &gt; 0 &amp;&amp; mods != wxMOD_NONE) {
<a name="l02392"></a>02392 <span class="preprocessor">        #ifdef __WXGTK__</span>
<a name="l02393"></a>02393 <span class="preprocessor"></span>            <span class="comment">// sigh... wxGTK returns inconsistent results for shift-comma combos</span>
<a name="l02394"></a>02394             <span class="comment">// so we assume that &#39;&lt;&#39; is produced by pressing shift-comma</span>
<a name="l02395"></a>02395             <span class="comment">// (which might only be true for US keyboards)</span>
<a name="l02396"></a>02396             <span class="keywordflow">if</span> (key == <span class="charliteral">&#39;&lt;&#39;</span> &amp;&amp; (mods &amp; wxMOD_SHIFT)) realkey = <span class="charliteral">&#39;,&#39;</span>;
<a name="l02397"></a>02397 <span class="preprocessor">        #endif</span>
<a name="l02398"></a>02398 <span class="preprocessor"></span><span class="preprocessor">        #ifdef __WXMSW__</span>
<a name="l02399"></a>02399 <span class="preprocessor"></span>            <span class="comment">// sigh... wxMSW returns inconsistent results for some shift-key combos</span>
<a name="l02400"></a>02400             <span class="comment">// so again we assume we&#39;re using a US keyboard</span>
<a name="l02401"></a>02401             <span class="keywordflow">if</span> (key == <span class="charliteral">&#39;~&#39;</span> &amp;&amp; (mods &amp; wxMOD_SHIFT)) realkey = <span class="charliteral">&#39;`&#39;</span>;
<a name="l02402"></a>02402             <span class="keywordflow">if</span> (key == <span class="charliteral">&#39;+&#39;</span> &amp;&amp; (mods &amp; wxMOD_SHIFT)) realkey = <span class="charliteral">&#39;=&#39;</span>;
<a name="l02403"></a>02403 <span class="preprocessor">        #endif</span>
<a name="l02404"></a>02404 <span class="preprocessor"></span>        <span class="keywordflow">if</span> (mods == wxMOD_SHIFT &amp;&amp; key != realkey) {
<a name="l02405"></a>02405             <span class="comment">// use translated key code but remove shift key;</span>
<a name="l02406"></a>02406             <span class="comment">// eg. we want shift-&#39;/&#39; to be seen as &#39;?&#39;</span>
<a name="l02407"></a>02407             mods = wxMOD_NONE;
<a name="l02408"></a>02408         } <span class="keywordflow">else</span> {
<a name="l02409"></a>02409             <span class="comment">// use key code seen by OnKeyDown</span>
<a name="l02410"></a>02410             key = realkey;
<a name="l02411"></a>02411             <span class="keywordflow">if</span> (key &gt;= <span class="charliteral">&#39;A&#39;</span> &amp;&amp; key &lt;= <span class="charliteral">&#39;Z&#39;</span>) key += 32;  <span class="comment">// convert A..Z to a..z</span>
<a name="l02412"></a>02412         }
<a name="l02413"></a>02413     }
<a name="l02414"></a>02414     
<a name="l02415"></a>02415 <span class="preprocessor">    #ifdef __WXGTK__</span>
<a name="l02416"></a>02416 <span class="preprocessor"></span>        <span class="keywordflow">if</span> (realkey == -666) {
<a name="l02417"></a>02417             <span class="comment">// OnKeyDown saw that shift-space was pressed but for some reason</span>
<a name="l02418"></a>02418             <span class="comment">// OnChar doesn&#39;t see the modifier (ie. mods is wxMOD_NONE)</span>
<a name="l02419"></a>02419             key = <span class="charliteral">&#39; &#39;</span>;
<a name="l02420"></a>02420             mods = wxMOD_SHIFT;
<a name="l02421"></a>02421         }
<a name="l02422"></a>02422 <span class="preprocessor">    #endif</span>
<a name="l02423"></a>02423 <span class="preprocessor"></span>    
<a name="l02424"></a>02424     <span class="keywordflow">if</span> (this-&gt;pVTKWindow-&gt;HasFocus()) {
<a name="l02425"></a>02425         ProcessKey(key, mods);
<a name="l02426"></a>02426         <span class="comment">// don&#39;t call default handler (wxVTKRenderWindowInteractor::OnChar)</span>
<a name="l02427"></a>02427         <span class="keywordflow">return</span>;
<a name="l02428"></a>02428     }
<a name="l02429"></a>02429     
<a name="l02430"></a>02430     <span class="keywordflow">if</span> (this-&gt;patterns_panel-&gt;TreeHasFocus()) {
<a name="l02431"></a>02431         <span class="comment">// process keyboard shortcut for patterns panel</span>
<a name="l02432"></a>02432         <span class="keywordflow">if</span> (this-&gt;patterns_panel-&gt;DoKey(key, mods)) <span class="keywordflow">return</span>;
<a name="l02433"></a>02433         <span class="comment">// else call default handler</span>
<a name="l02434"></a>02434         <span class="keyword">event</span>.Skip();
<a name="l02435"></a>02435         <span class="keywordflow">return</span>;
<a name="l02436"></a>02436     }
<a name="l02437"></a>02437     
<a name="l02438"></a>02438     <span class="keywordflow">if</span> (this-&gt;info_panel-&gt;HtmlHasFocus()) {
<a name="l02439"></a>02439         <span class="comment">// process keyboard shortcut for info panel</span>
<a name="l02440"></a>02440         <span class="keywordflow">if</span> (this-&gt;info_panel-&gt;DoKey(key, mods)) <span class="keywordflow">return</span>;
<a name="l02441"></a>02441         <span class="comment">// else call default handler</span>
<a name="l02442"></a>02442         <span class="keyword">event</span>.Skip();
<a name="l02443"></a>02443         <span class="keywordflow">return</span>;
<a name="l02444"></a>02444     }
<a name="l02445"></a>02445     
<a name="l02446"></a>02446     <span class="keywordflow">if</span> (this-&gt;help_panel-&gt;HtmlHasFocus()) {
<a name="l02447"></a>02447         <span class="comment">// process keyboard shortcut for help panel</span>
<a name="l02448"></a>02448         <span class="keywordflow">if</span> (this-&gt;help_panel-&gt;DoKey(key, mods)) <span class="keywordflow">return</span>;
<a name="l02449"></a>02449         <span class="comment">// else call default handler</span>
<a name="l02450"></a>02450         <span class="keyword">event</span>.Skip();
<a name="l02451"></a>02451         <span class="keywordflow">return</span>;
<a name="l02452"></a>02452     }
<a name="l02453"></a>02453 }
<a name="l02454"></a>02454 
<a name="l02455"></a>02455 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l02456"></a>02456 
<a name="l02457"></a><a class="code" href="classMyFrame.html#af2953ecf41133df7b664eeade71aa6a0">02457</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#af2953ecf41133df7b664eeade71aa6a0">MyFrame::InitializeDefaultRenderSettings</a>()
<a name="l02458"></a>02458 {
<a name="l02459"></a>02459     this-&gt;render_settings.DeleteAllProperties();
<a name="l02460"></a>02460     this-&gt;render_settings.AddProperty(<a class="code" href="classProperty.html" title="A Property has a type, a name and a value.">Property</a>(<span class="stringliteral">&quot;surface_color&quot;</span>,<span class="stringliteral">&quot;color&quot;</span>,1.0f,1.0f,1.0f)); <span class="comment">// RGB [0,1]</span>
<a name="l02461"></a>02461     this-&gt;render_settings.AddProperty(<a class="code" href="classProperty.html" title="A Property has a type, a name and a value.">Property</a>(<span class="stringliteral">&quot;color_low&quot;</span>,<span class="stringliteral">&quot;color&quot;</span>,0.0f,0.0f,1.0f));
<a name="l02462"></a>02462     this-&gt;render_settings.AddProperty(<a class="code" href="classProperty.html" title="A Property has a type, a name and a value.">Property</a>(<span class="stringliteral">&quot;color_high&quot;</span>,<span class="stringliteral">&quot;color&quot;</span>,1.0f,0.0f,0.0f));
<a name="l02463"></a>02463     this-&gt;render_settings.AddProperty(<a class="code" href="classProperty.html" title="A Property has a type, a name and a value.">Property</a>(<span class="stringliteral">&quot;show_color_scale&quot;</span>,<span class="keyword">true</span>));
<a name="l02464"></a>02464     this-&gt;render_settings.AddProperty(<a class="code" href="classProperty.html" title="A Property has a type, a name and a value.">Property</a>(<span class="stringliteral">&quot;show_multiple_chemicals&quot;</span>,<span class="keyword">true</span>));
<a name="l02465"></a>02465     this-&gt;render_settings.AddProperty(<a class="code" href="classProperty.html" title="A Property has a type, a name and a value.">Property</a>(<span class="stringliteral">&quot;active_chemical&quot;</span>,<span class="stringliteral">&quot;chemical&quot;</span>,<span class="stringliteral">&quot;a&quot;</span>));
<a name="l02466"></a>02466     this-&gt;render_settings.AddProperty(<a class="code" href="classProperty.html" title="A Property has a type, a name and a value.">Property</a>(<span class="stringliteral">&quot;low&quot;</span>,0.0f));
<a name="l02467"></a>02467     this-&gt;render_settings.AddProperty(<a class="code" href="classProperty.html" title="A Property has a type, a name and a value.">Property</a>(<span class="stringliteral">&quot;high&quot;</span>,1.0f));
<a name="l02468"></a>02468     this-&gt;render_settings.AddProperty(<a class="code" href="classProperty.html" title="A Property has a type, a name and a value.">Property</a>(<span class="stringliteral">&quot;vertical_scale_1D&quot;</span>,30.0f));
<a name="l02469"></a>02469     this-&gt;render_settings.AddProperty(<a class="code" href="classProperty.html" title="A Property has a type, a name and a value.">Property</a>(<span class="stringliteral">&quot;vertical_scale_2D&quot;</span>,15.0f));
<a name="l02470"></a>02470     this-&gt;render_settings.AddProperty(<a class="code" href="classProperty.html" title="A Property has a type, a name and a value.">Property</a>(<span class="stringliteral">&quot;contour_level&quot;</span>,0.25f));
<a name="l02471"></a>02471     this-&gt;render_settings.AddProperty(<a class="code" href="classProperty.html" title="A Property has a type, a name and a value.">Property</a>(<span class="stringliteral">&quot;use_wireframe&quot;</span>,<span class="keyword">false</span>));
<a name="l02472"></a>02472     this-&gt;render_settings.AddProperty(<a class="code" href="classProperty.html" title="A Property has a type, a name and a value.">Property</a>(<span class="stringliteral">&quot;show_cell_edges&quot;</span>,<span class="keyword">false</span>));
<a name="l02473"></a>02473     this-&gt;render_settings.AddProperty(<a class="code" href="classProperty.html" title="A Property has a type, a name and a value.">Property</a>(<span class="stringliteral">&quot;show_bounding_box&quot;</span>,<span class="keyword">true</span>));
<a name="l02474"></a>02474     this-&gt;render_settings.AddProperty(<a class="code" href="classProperty.html" title="A Property has a type, a name and a value.">Property</a>(<span class="stringliteral">&quot;slice_3D&quot;</span>,<span class="keyword">true</span>));
<a name="l02475"></a>02475     this-&gt;render_settings.AddProperty(<a class="code" href="classProperty.html" title="A Property has a type, a name and a value.">Property</a>(<span class="stringliteral">&quot;slice_3D_axis&quot;</span>,<span class="stringliteral">&quot;axis&quot;</span>,<span class="stringliteral">&quot;z&quot;</span>));
<a name="l02476"></a>02476     this-&gt;render_settings.AddProperty(<a class="code" href="classProperty.html" title="A Property has a type, a name and a value.">Property</a>(<span class="stringliteral">&quot;slice_3D_position&quot;</span>,0.5f)); <span class="comment">// [0,1]</span>
<a name="l02477"></a>02477     this-&gt;render_settings.AddProperty(<a class="code" href="classProperty.html" title="A Property has a type, a name and a value.">Property</a>(<span class="stringliteral">&quot;show_displacement_mapped_surface&quot;</span>,<span class="keyword">true</span>));
<a name="l02478"></a>02478     this-&gt;render_settings.AddProperty(<a class="code" href="classProperty.html" title="A Property has a type, a name and a value.">Property</a>(<span class="stringliteral">&quot;color_displacement_mapped_surface&quot;</span>,<span class="keyword">true</span>));
<a name="l02479"></a>02479     this-&gt;render_settings.AddProperty(<a class="code" href="classProperty.html" title="A Property has a type, a name and a value.">Property</a>(<span class="stringliteral">&quot;use_image_interpolation&quot;</span>,<span class="keyword">true</span>));
<a name="l02480"></a>02480     this-&gt;render_settings.AddProperty(<a class="code" href="classProperty.html" title="A Property has a type, a name and a value.">Property</a>(<span class="stringliteral">&quot;timesteps_per_render&quot;</span>,100));
<a name="l02481"></a>02481     <span class="comment">// TODO: allow user to change defaults</span>
<a name="l02482"></a>02482 }
<a name="l02483"></a>02483 
<a name="l02484"></a>02484 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l02485"></a>02485 
<a name="l02486"></a><a class="code" href="classMyFrame.html#ac0763c86a2a0d69253d95c6ea976236a">02486</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#ac0763c86a2a0d69253d95c6ea976236a">MyFrame::SetNumberOfChemicals</a>(<span class="keywordtype">int</span> n)
<a name="l02487"></a>02487 {
<a name="l02488"></a>02488     <span class="keywordtype">bool</span> had_error = <span class="keyword">true</span>;
<a name="l02489"></a>02489     <span class="keywordflow">try</span> 
<a name="l02490"></a>02490     {
<a name="l02491"></a>02491         this-&gt;system-&gt;SetNumberOfChemicals(n);
<a name="l02492"></a>02492         had_error = <span class="keyword">false</span>;
<a name="l02493"></a>02493     }
<a name="l02494"></a>02494     <span class="keywordflow">catch</span>(<span class="keyword">const</span> exception&amp; e)
<a name="l02495"></a>02495     {
<a name="l02496"></a>02496         <a class="code" href="classMonospaceMessageBox.html" title="Displays a block of text in a monospace font.">MonospaceMessageBox</a>(_(<span class="stringliteral">&quot;Changing the number of chemicals caused an error:\n\n&quot;</span>)+wxString(e.what(),wxConvUTF8),_(<span class="stringliteral">&quot;Error&quot;</span>),wxART_ERROR);
<a name="l02497"></a>02497     }
<a name="l02498"></a>02498     <span class="keywordflow">catch</span>(...)
<a name="l02499"></a>02499     {
<a name="l02500"></a>02500         wxMessageBox(_(<span class="stringliteral">&quot;Changing the number of chemicals caused an unknown error&quot;</span>));
<a name="l02501"></a>02501     }
<a name="l02502"></a>02502     <span class="keywordflow">if</span>(!had_error) <span class="comment">// don&#39;t want to plague the user with error messages, one will do for now</span>
<a name="l02503"></a>02503     {
<a name="l02504"></a>02504         <span class="keywordflow">try</span>
<a name="l02505"></a>02505         {
<a name="l02506"></a>02506             this-&gt;system-&gt;GenerateInitialPattern();
<a name="l02507"></a>02507         }
<a name="l02508"></a>02508         <span class="keywordflow">catch</span>(<span class="keyword">const</span> exception&amp; e)
<a name="l02509"></a>02509         {
<a name="l02510"></a>02510             <a class="code" href="classMonospaceMessageBox.html" title="Displays a block of text in a monospace font.">MonospaceMessageBox</a>(_(<span class="stringliteral">&quot;Generating an initial pattern caused an error:\n\n&quot;</span>)+wxString(e.what(),wxConvUTF8),_(<span class="stringliteral">&quot;Error&quot;</span>),wxART_ERROR);
<a name="l02511"></a>02511         }
<a name="l02512"></a>02512         <span class="keywordflow">catch</span>(...)
<a name="l02513"></a>02513         {
<a name="l02514"></a>02514             wxMessageBox(_(<span class="stringliteral">&quot;Generating an initial pattern caused an unknown error&quot;</span>));
<a name="l02515"></a>02515         }
<a name="l02516"></a>02516     }
<a name="l02517"></a>02517     <span class="comment">// (we allow the user to proceed because they might now want to change other things to match)</span>
<a name="l02518"></a>02518     <a class="code" href="vtk__pipeline_8cpp.html#a83eef6bea304823921ff32ce0afb6d2b">InitializeVTKPipeline</a>(this-&gt;pVTKWindow,this-&gt;system,this-&gt;render_settings,<span class="keyword">false</span>);
<a name="l02519"></a>02519     this-&gt;UpdateWindows();
<a name="l02520"></a>02520 }
<a name="l02521"></a>02521 
<a name="l02522"></a>02522 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l02523"></a>02523 
<a name="l02524"></a><a class="code" href="classMyFrame.html#a9e049de0f8adb21c025c4c6984d8297c">02524</a> <span class="keywordtype">bool</span> <a class="code" href="classMyFrame.html#a9e049de0f8adb21c025c4c6984d8297c">MyFrame::SetDimensions</a>(<span class="keywordtype">int</span> x,<span class="keywordtype">int</span> y,<span class="keywordtype">int</span> z)
<a name="l02525"></a>02525 {
<a name="l02526"></a>02526     <span class="keywordflow">try</span> 
<a name="l02527"></a>02527     {
<a name="l02528"></a>02528         <span class="keywordflow">if</span>(x&lt;1 || y&lt;1 || z&lt;1) <span class="keywordflow">throw</span> runtime_error(<span class="stringliteral">&quot;Dimensions must be at least 1&quot;</span>);
<a name="l02529"></a>02529         <span class="comment">// rearrange the dimensions (for visualization we need the z to be 1 for 2D images, and both y and z to be 1 for 1D images)</span>
<a name="l02530"></a>02530         <span class="keywordflow">if</span>( (x==1 &amp;&amp; (y&gt;1 || z&gt;1)) || (y==1 &amp;&amp; z&gt;1) )
<a name="l02531"></a>02531         {
<a name="l02532"></a>02532             <span class="keywordtype">float</span> d[3]={x,y,z};
<a name="l02533"></a>02533             sort(d,d+3);
<a name="l02534"></a>02534             <span class="keywordflow">if</span>(d[2]!=x || d[1]!=y || d[0]!=z) {
<a name="l02535"></a>02535                 x=d[2]; y=d[1]; z=d[0];
<a name="l02536"></a>02536                 wxString msg = _(<span class="stringliteral">&quot;We&#39;ve rearranged the order of the dimensions for visualization. New dimensions: &quot;</span>);
<a name="l02537"></a>02537                 msg &lt;&lt; x &lt;&lt; _T(<span class="stringliteral">&quot; x &quot;</span>) &lt;&lt; y &lt;&lt; _T(<span class="stringliteral">&quot; x &quot;</span>) &lt;&lt; z;
<a name="l02538"></a>02538                 wxMessageBox(msg);
<a name="l02539"></a>02539             }
<a name="l02540"></a>02540         }
<a name="l02541"></a>02541         <span class="comment">// attempt the size change</span>
<a name="l02542"></a>02542         this-&gt;system-&gt;SetDimensions(x,y,z);
<a name="l02543"></a>02543     }
<a name="l02544"></a>02544     <span class="keywordflow">catch</span>(<span class="keyword">const</span> exception&amp; e)
<a name="l02545"></a>02545     {
<a name="l02546"></a>02546         <a class="code" href="classMonospaceMessageBox.html" title="Displays a block of text in a monospace font.">MonospaceMessageBox</a>(_(<span class="stringliteral">&quot;Dimensions not permitted:\n\n&quot;</span>)+wxString(e.what(),wxConvUTF8),_(<span class="stringliteral">&quot;Error&quot;</span>),wxART_ERROR);
<a name="l02547"></a>02547         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l02548"></a>02548     }
<a name="l02549"></a>02549     <span class="keywordflow">catch</span>(...)
<a name="l02550"></a>02550     {
<a name="l02551"></a>02551         wxMessageBox(_(<span class="stringliteral">&quot;Dimensions not permitted&quot;</span>));
<a name="l02552"></a>02552         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l02553"></a>02553     }
<a name="l02554"></a>02554     this-&gt;system-&gt;GenerateInitialPattern();
<a name="l02555"></a>02555     <a class="code" href="vtk__pipeline_8cpp.html#a83eef6bea304823921ff32ce0afb6d2b">InitializeVTKPipeline</a>(this-&gt;pVTKWindow,this-&gt;system,this-&gt;render_settings,<span class="keyword">true</span>);
<a name="l02556"></a>02556     this-&gt;UpdateWindows();
<a name="l02557"></a>02557     <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l02558"></a>02558 }
<a name="l02559"></a>02559 
<a name="l02560"></a>02560 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l02561"></a>02561 
<a name="l02562"></a><a class="code" href="classMyFrame.html#af360d8e3100aef9da843c91a8b8ed48f">02562</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#af360d8e3100aef9da843c91a8b8ed48f">MyFrame::SetBlockSize</a>(<span class="keywordtype">int</span> x,<span class="keywordtype">int</span> y,<span class="keywordtype">int</span> z)
<a name="l02563"></a>02563 {
<a name="l02564"></a>02564     this-&gt;system-&gt;SetBlockSizeX(x);
<a name="l02565"></a>02565     this-&gt;system-&gt;SetBlockSizeY(y);
<a name="l02566"></a>02566     this-&gt;system-&gt;SetBlockSizeZ(z);
<a name="l02567"></a>02567     this-&gt;system-&gt;GenerateInitialPattern();
<a name="l02568"></a>02568     <a class="code" href="vtk__pipeline_8cpp.html#a83eef6bea304823921ff32ce0afb6d2b">InitializeVTKPipeline</a>(this-&gt;pVTKWindow,this-&gt;system,this-&gt;render_settings,<span class="keyword">false</span>);
<a name="l02569"></a>02569     this-&gt;UpdateWindows();
<a name="l02570"></a>02570 }
<a name="l02571"></a>02571 
<a name="l02572"></a>02572 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l02573"></a>02573 
<a name="l02574"></a><a class="code" href="classMyFrame.html#a07925f9cb2db10ebe3cbf17ba1f69651">02574</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#a07925f9cb2db10ebe3cbf17ba1f69651">MyFrame::RenderSettingsChanged</a>()
<a name="l02575"></a>02575 {
<a name="l02576"></a>02576     <span class="comment">// first do some range checking (not done in InfoPanel::ChangeRenderSetting)</span>
<a name="l02577"></a>02577     <a class="code" href="classProperty.html" title="A Property has a type, a name and a value.">Property</a>&amp; prop = this-&gt;render_settings.GetProperty(<span class="stringliteral">&quot;timesteps_per_render&quot;</span>);
<a name="l02578"></a>02578     <span class="keywordflow">if</span> (prop.<a class="code" href="classProperty.html#a72ad7dd41b2d14973cd1788ce3a00c7a">GetInt</a>() &lt; 1) prop.<a class="code" href="classProperty.html#a071003388823285ab1079c3caac957a1">SetInt</a>(1);
<a name="l02579"></a>02579     <span class="keywordflow">if</span> (prop.<a class="code" href="classProperty.html#a72ad7dd41b2d14973cd1788ce3a00c7a">GetInt</a>() &gt; MAX_TIMESTEPS_PER_RENDER) prop.<a class="code" href="classProperty.html#a071003388823285ab1079c3caac957a1">SetInt</a>(MAX_TIMESTEPS_PER_RENDER);
<a name="l02580"></a>02580     
<a name="l02581"></a>02581     <a class="code" href="vtk__pipeline_8cpp.html#a83eef6bea304823921ff32ce0afb6d2b">InitializeVTKPipeline</a>(this-&gt;pVTKWindow,this-&gt;system,this-&gt;render_settings,<span class="keyword">false</span>);
<a name="l02582"></a>02582     this-&gt;UpdateWindows();
<a name="l02583"></a>02583 }
<a name="l02584"></a>02584 
<a name="l02585"></a>02585 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l02586"></a>02586 
<a name="l02587"></a><a class="code" href="classMyFrame.html#abc6a78e56dda70d98b6fd1a1fa43c26e">02587</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#abc6a78e56dda70d98b6fd1a1fa43c26e">MyFrame::OnAddParameter</a>(wxCommandEvent&amp; event)
<a name="l02588"></a>02588 {
<a name="l02589"></a>02589     <a class="code" href="classStringDialog.html" title="A modal dialog for getting a string.">StringDialog</a> dlg(<span class="keyword">this</span>,_(<span class="stringliteral">&quot;Add a parameter&quot;</span>),_(<span class="stringliteral">&quot;Name:&quot;</span>),wxEmptyString,wxDefaultPosition,wxDefaultSize);
<a name="l02590"></a>02590     <span class="keywordflow">if</span>(dlg.ShowModal()!=wxID_OK) <span class="keywordflow">return</span>;
<a name="l02591"></a>02591     this-&gt;GetCurrentRDSystem()-&gt;AddParameter(<span class="keywordtype">string</span>(dlg.<a class="code" href="classStringDialog.html#ac671f4fbd9f65279231f59b65bb32675">GetValue</a>().mb_str()),0.0f);
<a name="l02592"></a>02592     this-&gt;UpdateWindows();
<a name="l02593"></a>02593 }
<a name="l02594"></a>02594 
<a name="l02595"></a>02595 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l02596"></a>02596 
<a name="l02597"></a><a class="code" href="classMyFrame.html#a9dc9cf8ffb512e5f1db6a4c877811437">02597</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#a9dc9cf8ffb512e5f1db6a4c877811437">MyFrame::OnDeleteParameter</a>(wxCommandEvent&amp; event)
<a name="l02598"></a>02598 {
<a name="l02599"></a>02599     wxArrayString as;
<a name="l02600"></a>02600     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;this-&gt;GetCurrentRDSystem()-&gt;GetNumberOfParameters();i++)
<a name="l02601"></a>02601         as.Add(wxString(this-&gt;GetCurrentRDSystem()-&gt;GetParameterName(i).c_str(),wxConvUTF8));
<a name="l02602"></a>02602     wxSingleChoiceDialog dlg(<span class="keyword">this</span>,_(<span class="stringliteral">&quot;Select a parameter to delete:&quot;</span>),_(<span class="stringliteral">&quot;Delete a parameter&quot;</span>),as);
<a name="l02603"></a>02603     <span class="keywordflow">if</span>(dlg.ShowModal()!=wxID_OK) <span class="keywordflow">return</span>;
<a name="l02604"></a>02604     this-&gt;GetCurrentRDSystem()-&gt;DeleteParameter(dlg.GetSelection());
<a name="l02605"></a>02605     this-&gt;UpdateWindows();
<a name="l02606"></a>02606 }
<a name="l02607"></a>02607 
<a name="l02608"></a>02608 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l02609"></a>02609 
<a name="l02610"></a><a class="code" href="classMyFrame.html#a7773545349511c08a616604aebbdf346">02610</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#a7773545349511c08a616604aebbdf346">MyFrame::OnUpdateAddParameter</a>(wxUpdateUIEvent&amp; event)
<a name="l02611"></a>02611 {
<a name="l02612"></a>02612     <span class="keyword">event</span>.Enable(this-&gt;GetCurrentRDSystem()-&gt;HasEditableFormula());
<a name="l02613"></a>02613 }
<a name="l02614"></a>02614 
<a name="l02615"></a>02615 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l02616"></a>02616 
<a name="l02617"></a><a class="code" href="classMyFrame.html#a453b0bf90da968bad87c570d04004642">02617</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#a453b0bf90da968bad87c570d04004642">MyFrame::OnUpdateDeleteParameter</a>(wxUpdateUIEvent&amp; event)
<a name="l02618"></a>02618 {
<a name="l02619"></a>02619     <span class="keyword">event</span>.Enable(this-&gt;GetCurrentRDSystem()-&gt;HasEditableFormula() &amp;&amp;
<a name="l02620"></a>02620                  this-&gt;GetCurrentRDSystem()-&gt;GetNumberOfParameters() &gt; 0);
<a name="l02621"></a>02621 }
<a name="l02622"></a>02622 
<a name="l02623"></a>02623 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l02624"></a>02624 
<a name="l02625"></a><a class="code" href="classMyFrame.html#ab1fd5daf722d8dffba0efa6e197b42d2">02625</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#ab1fd5daf722d8dffba0efa6e197b42d2">MyFrame::OnRunFaster</a>(wxCommandEvent&amp; event)
<a name="l02626"></a>02626 {
<a name="l02627"></a>02627     <a class="code" href="classProperty.html" title="A Property has a type, a name and a value.">Property</a>&amp; prop = this-&gt;render_settings.GetProperty(<span class="stringliteral">&quot;timesteps_per_render&quot;</span>);
<a name="l02628"></a>02628     prop.<a class="code" href="classProperty.html#a071003388823285ab1079c3caac957a1">SetInt</a>(prop.<a class="code" href="classProperty.html#a72ad7dd41b2d14973cd1788ce3a00c7a">GetInt</a>() * 2);
<a name="l02629"></a>02629     <span class="comment">// check for overflow, or if beyond limit used in OnChangeRunningSpeed</span>
<a name="l02630"></a>02630     <span class="keywordflow">if</span> (prop.<a class="code" href="classProperty.html#a72ad7dd41b2d14973cd1788ce3a00c7a">GetInt</a>() &lt;= 0 || prop.<a class="code" href="classProperty.html#a72ad7dd41b2d14973cd1788ce3a00c7a">GetInt</a>() &gt; MAX_TIMESTEPS_PER_RENDER) prop.<a class="code" href="classProperty.html#a071003388823285ab1079c3caac957a1">SetInt</a>(MAX_TIMESTEPS_PER_RENDER);
<a name="l02631"></a>02631     this-&gt;UpdateInfoPane();
<a name="l02632"></a>02632 }
<a name="l02633"></a>02633 
<a name="l02634"></a>02634 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l02635"></a>02635 
<a name="l02636"></a><a class="code" href="classMyFrame.html#af47dad61a390a708bc444bdbd449eb05">02636</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#af47dad61a390a708bc444bdbd449eb05">MyFrame::OnRunSlower</a>(wxCommandEvent&amp; event)
<a name="l02637"></a>02637 {
<a name="l02638"></a>02638     <a class="code" href="classProperty.html" title="A Property has a type, a name and a value.">Property</a>&amp; prop = this-&gt;render_settings.GetProperty(<span class="stringliteral">&quot;timesteps_per_render&quot;</span>);
<a name="l02639"></a>02639     prop.<a class="code" href="classProperty.html#a071003388823285ab1079c3caac957a1">SetInt</a>(prop.<a class="code" href="classProperty.html#a72ad7dd41b2d14973cd1788ce3a00c7a">GetInt</a>() / 2);
<a name="l02640"></a>02640     <span class="comment">// don&#39;t let timesteps_per_render get to 0 otherwise OnRunFaster can&#39;t double it</span>
<a name="l02641"></a>02641     <span class="keywordflow">if</span> (prop.<a class="code" href="classProperty.html#a72ad7dd41b2d14973cd1788ce3a00c7a">GetInt</a>() &lt; 1) prop.<a class="code" href="classProperty.html#a071003388823285ab1079c3caac957a1">SetInt</a>(1);
<a name="l02642"></a>02642     this-&gt;UpdateInfoPane();
<a name="l02643"></a>02643 }
<a name="l02644"></a>02644 
<a name="l02645"></a>02645 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l02646"></a>02646 
<a name="l02647"></a><a class="code" href="classMyFrame.html#ad068a0c7ad7f3d094ad15bdabc730c11">02647</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#ad068a0c7ad7f3d094ad15bdabc730c11">MyFrame::OnChangeRunningSpeed</a>(wxCommandEvent&amp; event)
<a name="l02648"></a>02648 {
<a name="l02649"></a>02649     <a class="code" href="classIntegerDialog.html" title="A modal dialog for getting an integer.">IntegerDialog</a> dlg(<span class="keyword">this</span>, _(<span class="stringliteral">&quot;Running speed&quot;</span>), _(<span class="stringliteral">&quot;New value (timesteps per render):&quot;</span>),
<a name="l02650"></a>02650                       this-&gt;render_settings.GetProperty(<span class="stringliteral">&quot;timesteps_per_render&quot;</span>).GetInt(),
<a name="l02651"></a>02651                       1, MAX_TIMESTEPS_PER_RENDER, wxDefaultPosition, wxDefaultSize);
<a name="l02652"></a>02652     <span class="keywordflow">if</span>(dlg.ShowModal()!=wxID_OK) <span class="keywordflow">return</span>;
<a name="l02653"></a>02653     this-&gt;render_settings.GetProperty(<span class="stringliteral">&quot;timesteps_per_render&quot;</span>).SetInt(dlg.GetValue());
<a name="l02654"></a>02654     this-&gt;UpdateInfoPane();
<a name="l02655"></a>02655 }
<a name="l02656"></a>02656 
<a name="l02657"></a>02657 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l02658"></a>02658 
<a name="l02659"></a><a class="code" href="classMyFrame.html#af033176052c30566f52a90c97386b7f0">02659</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#af033176052c30566f52a90c97386b7f0">MyFrame::OnImportMesh</a>(wxCommandEvent&amp; event)
<a name="l02660"></a>02660 {
<a name="l02661"></a>02661     <span class="comment">// possible uses:</span>
<a name="l02662"></a>02662     <span class="comment">// 1. as MeshRD (to run RD on surface, or internally between 3d cells)</span>
<a name="l02663"></a>02663     <span class="comment">//    - will need to ask user for other pattern to duplicate formula etc. from, or whether to define this later</span>
<a name="l02664"></a>02664     <span class="comment">// 2. as representation of a binary image for ImageRD (e.g. import a 3D logo, then run tip-splitting from that seed)</span>
<a name="l02665"></a>02665     <span class="comment">//    - will need to ask for an existing pattern to load the image into, and whether to clear that image first</span>
<a name="l02666"></a>02666     <span class="comment">//    - will need to ask which chemical(s) to affect, and at what level (overlays engine)</span>
<a name="l02667"></a>02667 
<a name="l02668"></a>02668     wxString mesh_filename = wxFileSelector(_(<span class="stringliteral">&quot;Import a mesh:&quot;</span>),wxEmptyString,wxEmptyString,wxEmptyString,
<a name="l02669"></a>02669         _(<span class="stringliteral">&quot;Supported mesh formats (*.obj;*.vtu;*.vtp)|*.obj;*.vtu;*.vtp&quot;</span>),wxFD_OPEN);
<a name="l02670"></a>02670     <span class="keywordflow">if</span>(mesh_filename.empty()) <span class="keywordflow">return</span>; <span class="comment">// user cancelled</span>
<a name="l02671"></a>02671 
<a name="l02672"></a>02672     <span class="comment">/*</span>
<a name="l02673"></a>02673 <span class="comment">    wxArrayString choices;</span>
<a name="l02674"></a>02674 <span class="comment">    choices.Add(_(&quot;Run a pattern on the surface of this mesh&quot;));</span>
<a name="l02675"></a>02675 <span class="comment">    choices.Add(_(&quot;Paint this pattern into a 3D volume image&quot;));</span>
<a name="l02676"></a>02676 <span class="comment">    int ret = wxGetSingleChoiceIndex(_(&quot;What would you like to do with the mesh?&quot;),_(&quot;Select one of these options:&quot;),choices);</span>
<a name="l02677"></a>02677 <span class="comment">    if(ret==-1) return; // user cancelled</span>
<a name="l02678"></a>02678 <span class="comment"></span>
<a name="l02679"></a>02679 <span class="comment">    if(ret!=0) { wxMessageBox(_(&quot;Not yet implemented.&quot;)); return; } // TODO</span>
<a name="l02680"></a>02680 <span class="comment">    */</span>
<a name="l02681"></a>02681 
<a name="l02682"></a>02682     <span class="comment">// for now we give the mesh an inbuilt rule (Gray-Scott) but this should be different</span>
<a name="l02683"></a>02683 
<a name="l02684"></a>02684         <a class="code" href="classMeshRD.html" title="Base class for mesh-based systems.">MeshRD</a> *mesh_sys;
<a name="l02685"></a>02685     <span class="keywordflow">if</span>(mesh_filename.EndsWith(_T(<span class="stringliteral">&quot;vtp&quot;</span>)))
<a name="l02686"></a>02686     {
<a name="l02687"></a>02687         <span class="keywordflow">if</span>(UserWantsToCancelWhenAskedIfWantsToSave()) <span class="keywordflow">return</span>;
<a name="l02688"></a>02688 
<a name="l02689"></a>02689         wxBusyCursor busy;
<a name="l02690"></a>02690 
<a name="l02691"></a>02691         this-&gt;InitializeDefaultRenderSettings();
<a name="l02692"></a>02692         this-&gt;render_settings.GetProperty(<span class="stringliteral">&quot;slice_3D&quot;</span>).SetBool(<span class="keyword">false</span>);
<a name="l02693"></a>02693         this-&gt;render_settings.GetProperty(<span class="stringliteral">&quot;active_chemical&quot;</span>).SetChemical(<span class="stringliteral">&quot;b&quot;</span>);
<a name="l02694"></a>02694 
<a name="l02695"></a>02695         vtkSmartPointer&lt;vtkXMLPolyDataReader&gt; vtp_reader = vtkSmartPointer&lt;vtkXMLPolyDataReader&gt;::New();
<a name="l02696"></a>02696         vtp_reader-&gt;SetFileName(mesh_filename.mb_str());
<a name="l02697"></a>02697         vtp_reader-&gt;Update();
<a name="l02698"></a>02698         <span class="keywordflow">if</span>(this-&gt;is_opencl_available)
<a name="l02699"></a>02699                         mesh_sys = <span class="keyword">new</span> <a class="code" href="classFormulaOpenCLMeshRD.html" title="An RD system that uses an OpenCL formula snippet.">FormulaOpenCLMeshRD</a>(<a class="code" href="prefs_8cpp.html#a0de6a378ca700dd877cab59c65ba2f7b">opencl_platform</a>,<a class="code" href="prefs_8cpp.html#a11d0cbab21425e351638f4bf2cc72874">opencl_device</a>);
<a name="l02700"></a>02700                 <span class="keywordflow">else</span>
<a name="l02701"></a>02701                         mesh_sys = <span class="keyword">new</span> <a class="code" href="classGrayScottMeshRD.html" title="A non-OpenCL mesh implementation, just as an example.">GrayScottMeshRD</a>();
<a name="l02702"></a>02702         vtkSmartPointer&lt;vtkUnstructuredGrid&gt; ug = vtkSmartPointer&lt;vtkUnstructuredGrid&gt;::New();
<a name="l02703"></a>02703         ug-&gt;SetPoints(vtp_reader-&gt;GetOutput()-&gt;GetPoints());
<a name="l02704"></a>02704         ug-&gt;SetCells(VTK_POLYGON,vtp_reader-&gt;GetOutput()-&gt;GetPolys());
<a name="l02705"></a>02705         mesh_sys-&gt;<a class="code" href="classMeshRD.html#a86710329396780b3bf7a6f92e975cdb5">CopyFromMesh</a>(ug);
<a name="l02706"></a>02706     }
<a name="l02707"></a>02707     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(mesh_filename.EndsWith(_T(<span class="stringliteral">&quot;vtu&quot;</span>)))
<a name="l02708"></a>02708     {
<a name="l02709"></a>02709         <span class="keywordflow">if</span>(UserWantsToCancelWhenAskedIfWantsToSave()) <span class="keywordflow">return</span>;
<a name="l02710"></a>02710 
<a name="l02711"></a>02711         wxBusyCursor busy;
<a name="l02712"></a>02712 
<a name="l02713"></a>02713         this-&gt;InitializeDefaultRenderSettings();
<a name="l02714"></a>02714         this-&gt;render_settings.GetProperty(<span class="stringliteral">&quot;slice_3D&quot;</span>).SetBool(<span class="keyword">false</span>);
<a name="l02715"></a>02715         this-&gt;render_settings.GetProperty(<span class="stringliteral">&quot;active_chemical&quot;</span>).SetChemical(<span class="stringliteral">&quot;b&quot;</span>);
<a name="l02716"></a>02716 
<a name="l02717"></a>02717         vtkSmartPointer&lt;vtkXMLUnstructuredGridReader&gt; vtu_reader = vtkSmartPointer&lt;vtkXMLUnstructuredGridReader&gt;::New();
<a name="l02718"></a>02718         vtu_reader-&gt;SetFileName(mesh_filename.mb_str());
<a name="l02719"></a>02719         vtu_reader-&gt;Update();
<a name="l02720"></a>02720         <span class="keywordflow">if</span>(this-&gt;is_opencl_available)
<a name="l02721"></a>02721                         mesh_sys = <span class="keyword">new</span> <a class="code" href="classFormulaOpenCLMeshRD.html" title="An RD system that uses an OpenCL formula snippet.">FormulaOpenCLMeshRD</a>(<a class="code" href="prefs_8cpp.html#a0de6a378ca700dd877cab59c65ba2f7b">opencl_platform</a>,<a class="code" href="prefs_8cpp.html#a11d0cbab21425e351638f4bf2cc72874">opencl_device</a>);
<a name="l02722"></a>02722                 <span class="keywordflow">else</span>
<a name="l02723"></a>02723                         mesh_sys = <span class="keyword">new</span> <a class="code" href="classGrayScottMeshRD.html" title="A non-OpenCL mesh implementation, just as an example.">GrayScottMeshRD</a>();
<a name="l02724"></a>02724         mesh_sys-&gt;<a class="code" href="classMeshRD.html#a86710329396780b3bf7a6f92e975cdb5">CopyFromMesh</a>(vtu_reader-&gt;GetOutput());
<a name="l02725"></a>02725     }
<a name="l02726"></a>02726     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(mesh_filename.EndsWith(_T(<span class="stringliteral">&quot;obj&quot;</span>)))
<a name="l02727"></a>02727     {
<a name="l02728"></a>02728         <span class="keywordflow">if</span>(UserWantsToCancelWhenAskedIfWantsToSave()) <span class="keywordflow">return</span>;
<a name="l02729"></a>02729     
<a name="l02730"></a>02730         wxBusyCursor busy;
<a name="l02731"></a>02731 
<a name="l02732"></a>02732         this-&gt;InitializeDefaultRenderSettings();
<a name="l02733"></a>02733         this-&gt;render_settings.GetProperty(<span class="stringliteral">&quot;slice_3D&quot;</span>).SetBool(<span class="keyword">false</span>);
<a name="l02734"></a>02734         this-&gt;render_settings.GetProperty(<span class="stringliteral">&quot;active_chemical&quot;</span>).SetChemical(<span class="stringliteral">&quot;b&quot;</span>);
<a name="l02735"></a>02735 
<a name="l02736"></a>02736         vtkSmartPointer&lt;vtkOBJReader&gt; obj_reader = vtkSmartPointer&lt;vtkOBJReader&gt;::New();
<a name="l02737"></a>02737         obj_reader-&gt;SetFileName(mesh_filename.mb_str());
<a name="l02738"></a>02738         obj_reader-&gt;Update();
<a name="l02739"></a>02739         <span class="keywordflow">if</span>(this-&gt;is_opencl_available)
<a name="l02740"></a>02740                         mesh_sys = <span class="keyword">new</span> <a class="code" href="classFormulaOpenCLMeshRD.html" title="An RD system that uses an OpenCL formula snippet.">FormulaOpenCLMeshRD</a>(<a class="code" href="prefs_8cpp.html#a0de6a378ca700dd877cab59c65ba2f7b">opencl_platform</a>,<a class="code" href="prefs_8cpp.html#a11d0cbab21425e351638f4bf2cc72874">opencl_device</a>);
<a name="l02741"></a>02741                 <span class="keywordflow">else</span>
<a name="l02742"></a>02742                         mesh_sys = <span class="keyword">new</span> <a class="code" href="classGrayScottMeshRD.html" title="A non-OpenCL mesh implementation, just as an example.">GrayScottMeshRD</a>();
<a name="l02743"></a>02743         vtkSmartPointer&lt;vtkUnstructuredGrid&gt; ug = vtkSmartPointer&lt;vtkUnstructuredGrid&gt;::New();
<a name="l02744"></a>02744         ug-&gt;SetPoints(obj_reader-&gt;GetOutput()-&gt;GetPoints());
<a name="l02745"></a>02745         ug-&gt;SetCells(VTK_POLYGON,obj_reader-&gt;GetOutput()-&gt;GetPolys());
<a name="l02746"></a>02746         mesh_sys-&gt;<a class="code" href="classMeshRD.html#a86710329396780b3bf7a6f92e975cdb5">CopyFromMesh</a>(ug);
<a name="l02747"></a>02747     }
<a name="l02748"></a>02748     <span class="keywordflow">else</span>
<a name="l02749"></a>02749     {
<a name="l02750"></a>02750         wxMessageBox(_(<span class="stringliteral">&quot;Unsupported file type&quot;</span>)); 
<a name="l02751"></a>02751         <span class="keywordflow">return</span>; 
<a name="l02752"></a>02752     }
<a name="l02753"></a>02753 
<a name="l02754"></a>02754         mesh_sys-&gt;<a class="code" href="classMeshRD.html#a777f0b9e9f19d1b40e45f38430b6c6fb">SetNumberOfChemicals</a>(2);
<a name="l02755"></a>02755         mesh_sys-&gt;<a class="code" href="classAbstractRD.html#a3da00130c9bded5c65b891307486cecc" title="Create a generator suitable for Gray-Scott, so that new patterns can start working immediately...">CreateDefaultInitialPatternGenerator</a>();
<a name="l02756"></a>02756         mesh_sys-&gt;<a class="code" href="classMeshRD.html#aea439a0c84c616efb787cce88a64e51c">GenerateInitialPattern</a>();
<a name="l02757"></a>02757         this-&gt;SetCurrentRDSystem(mesh_sys);
<a name="l02758"></a>02758 }
<a name="l02759"></a>02759 
<a name="l02760"></a>02760 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l02761"></a>02761 
<a name="l02762"></a><a class="code" href="classMyFrame.html#a67767cce9137c1282861153b74452339">02762</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#a67767cce9137c1282861153b74452339">MyFrame::OnExportMesh</a>(wxCommandEvent&amp; event)
<a name="l02763"></a>02763 {
<a name="l02764"></a>02764     <span class="comment">// possible uses: (context dependent)</span>
<a name="l02765"></a>02765     <span class="comment">// 1. output MeshRD surface (although can already use Paraview to convert VTU to OBJ etc.)</span>
<a name="l02766"></a>02766     <span class="comment">// 2. output ImageRD 3d-image contour for active chemical</span>
<a name="l02767"></a>02767     <span class="comment">// 3. output ImageRD 2d-image displacement-mapped surface for active chemical</span>
<a name="l02768"></a>02768 
<a name="l02769"></a>02769     wxString mesh_filename = wxFileSelector(_(<span class="stringliteral">&quot;Export a mesh:&quot;</span>),wxEmptyString,wxEmptyString,wxEmptyString,
<a name="l02770"></a>02770         _(<span class="stringliteral">&quot;Supported mesh formats (*.obj;*.vtp)|*.obj;*.vtp&quot;</span>),wxFD_SAVE|wxFD_OVERWRITE_PROMPT);
<a name="l02771"></a>02771     <span class="keywordflow">if</span>(mesh_filename.empty()) <span class="keywordflow">return</span>; <span class="comment">// user cancelled</span>
<a name="l02772"></a>02772 
<a name="l02773"></a>02773     vtkSmartPointer&lt;vtkPolyData&gt; pd = vtkSmartPointer&lt;vtkPolyData&gt;::New();
<a name="l02774"></a>02774     this-&gt;system-&gt;GetAsMesh(pd,this-&gt;render_settings);
<a name="l02775"></a>02775 
<a name="l02776"></a>02776     <span class="keywordflow">if</span>(mesh_filename.EndsWith(_T(<span class="stringliteral">&quot;obj&quot;</span>)))
<a name="l02777"></a>02777     {
<a name="l02778"></a>02778         wxBusyCursor busy;
<a name="l02779"></a>02779         ofstream out(mesh_filename.mb_str());
<a name="l02780"></a>02780         out &lt;&lt; <span class="stringliteral">&quot;# Output from Ready - http://code.google.com/p/reaction-diffusion\n&quot;</span>;
<a name="l02781"></a>02781         pd-&gt;BuildCells();
<a name="l02782"></a>02782         <span class="keywordflow">for</span>(vtkIdType iPt=0;iPt&lt;pd-&gt;GetNumberOfPoints();iPt++)
<a name="l02783"></a>02783             out &lt;&lt; <span class="stringliteral">&quot;v &quot;</span> &lt;&lt; pd-&gt;GetPoint(iPt)[0] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; pd-&gt;GetPoint(iPt)[1] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; pd-&gt;GetPoint(iPt)[2] &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;
<a name="l02784"></a>02784         <span class="keywordflow">if</span>(pd-&gt;GetPointData()-&gt;GetNormals())
<a name="l02785"></a>02785         {
<a name="l02786"></a>02786             <span class="keywordflow">for</span>(vtkIdType iPt=0;iPt&lt;pd-&gt;GetNumberOfPoints();iPt++)
<a name="l02787"></a>02787                 out &lt;&lt; <span class="stringliteral">&quot;vn &quot;</span> &lt;&lt; pd-&gt;GetPointData()-&gt;GetNormals()-&gt;GetTuple3(iPt)[0] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> 
<a name="l02788"></a>02788                     &lt;&lt; pd-&gt;GetPointData()-&gt;GetNormals()-&gt;GetTuple3(iPt)[1] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> 
<a name="l02789"></a>02789                     &lt;&lt; pd-&gt;GetPointData()-&gt;GetNormals()-&gt;GetTuple3(iPt)[2] &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;
<a name="l02790"></a>02790         }
<a name="l02791"></a>02791         vtkIdType npts,*pts;
<a name="l02792"></a>02792         <span class="keywordflow">for</span>(vtkIdType iCell=0;iCell&lt;pd-&gt;GetPolys()-&gt;GetNumberOfCells();iCell++)
<a name="l02793"></a>02793         {
<a name="l02794"></a>02794             pd-&gt;GetCellPoints(iCell,npts,pts);
<a name="l02795"></a>02795             out &lt;&lt; <span class="stringliteral">&quot;f&quot;</span>;
<a name="l02796"></a>02796             <span class="keywordflow">if</span>(pd-&gt;GetPointData()-&gt;GetNormals())
<a name="l02797"></a>02797             {
<a name="l02798"></a>02798                 <span class="keywordflow">for</span>(vtkIdType iPt=0;iPt&lt;npts;iPt++)
<a name="l02799"></a>02799                     out &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; pts[iPt]+1 &lt;&lt; <span class="stringliteral">&quot;//&quot;</span> &lt;&lt; pts[iPt]+1; <span class="comment">// (OBJ indices are 1-based)</span>
<a name="l02800"></a>02800             }
<a name="l02801"></a>02801             <span class="keywordflow">else</span>
<a name="l02802"></a>02802             {
<a name="l02803"></a>02803                 <span class="keywordflow">for</span>(vtkIdType iPt=0;iPt&lt;npts;iPt++)
<a name="l02804"></a>02804                     out &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; pts[iPt]+1; <span class="comment">// (OBJ indices are 1-based)</span>
<a name="l02805"></a>02805             }
<a name="l02806"></a>02806             out &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;
<a name="l02807"></a>02807         }
<a name="l02808"></a>02808     }
<a name="l02809"></a>02809     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(mesh_filename.EndsWith(_T(<span class="stringliteral">&quot;vtp&quot;</span>)))
<a name="l02810"></a>02810     {
<a name="l02811"></a>02811         wxBusyCursor busy;
<a name="l02812"></a>02812         vtkSmartPointer&lt;vtkXMLPolyDataWriter&gt; writer = vtkSmartPointer&lt;vtkXMLPolyDataWriter&gt;::New();
<a name="l02813"></a>02813         writer-&gt;SetFileName(mesh_filename.mb_str());
<a name="l02814"></a>02814         writer-&gt;SetInput(pd);
<a name="l02815"></a>02815         writer-&gt;Write();
<a name="l02816"></a>02816     }
<a name="l02817"></a>02817     <span class="keywordflow">else</span>
<a name="l02818"></a>02818     {
<a name="l02819"></a>02819         wxMessageBox(_(<span class="stringliteral">&quot;Unsupported file type&quot;</span>)); 
<a name="l02820"></a>02820         <span class="keywordflow">return</span>; 
<a name="l02821"></a>02821     }
<a name="l02822"></a>02822 }
<a name="l02823"></a>02823 
<a name="l02824"></a>02824 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l02825"></a>02825 
<a name="l02826"></a><a class="code" href="classMyFrame.html#a8ea505e7020bdb7a997d29f61113be0a">02826</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#a8ea505e7020bdb7a997d29f61113be0a">MyFrame::OnReloadFromDisk</a>(wxCommandEvent &amp;event)
<a name="l02827"></a>02827 {
<a name="l02828"></a>02828     this-&gt;OpenFile(this-&gt;system-&gt;GetFilename());
<a name="l02829"></a>02829 }
<a name="l02830"></a>02830 
<a name="l02831"></a>02831 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l02832"></a>02832 
<a name="l02833"></a><a class="code" href="classMyFrame.html#a36877802eece02057bf5774eecc2f81e">02833</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#a36877802eece02057bf5774eecc2f81e">MyFrame::OnExportImage</a>(wxCommandEvent &amp;event)
<a name="l02834"></a>02834 {
<a name="l02835"></a>02835     <span class="comment">// find an unused filename</span>
<a name="l02836"></a>02836     <span class="keyword">const</span> wxString default_filename_root = _(<span class="stringliteral">&quot;Ready_image_&quot;</span>);
<a name="l02837"></a>02837     <span class="keyword">const</span> wxString default_filename_ext = _T(<span class="stringliteral">&quot;png&quot;</span>);
<a name="l02838"></a>02838     <span class="keywordtype">int</span> unused_value = 0;
<a name="l02839"></a>02839     wxString filename;
<a name="l02840"></a>02840     wxString extension,folder;
<a name="l02841"></a>02841     folder = <a class="code" href="prefs_8cpp.html#aecf1f655ef78e68e956e57878e7ea48d">screenshotdir</a>;
<a name="l02842"></a>02842     <span class="keywordflow">do</span> {
<a name="l02843"></a>02843         filename = default_filename_root;
<a name="l02844"></a>02844         filename &lt;&lt; wxString::Format(_(<span class="stringliteral">&quot;%04d.&quot;</span>),unused_value) &lt;&lt; default_filename_ext;
<a name="l02845"></a>02845         unused_value++;
<a name="l02846"></a>02846     } <span class="keywordflow">while</span>(::wxFileExists(folder+_T(<span class="stringliteral">&quot;/&quot;</span>)+filename));
<a name="l02847"></a>02847 
<a name="l02848"></a>02848     <span class="comment">// ask the user for confirmation</span>
<a name="l02849"></a>02849     <span class="keywordtype">bool</span> accepted = <span class="keyword">true</span>;
<a name="l02850"></a>02850     <span class="keywordflow">do</span> {
<a name="l02851"></a>02851         filename = wxFileSelector(_(<span class="stringliteral">&quot;Specify the image filename&quot;</span>),folder,filename,default_filename_ext,
<a name="l02852"></a>02852             _(<span class="stringliteral">&quot;PNG files (*.png)|*.png|JPG files (*.jpg)|*.jpg&quot;</span>),
<a name="l02853"></a>02853             wxFD_SAVE|wxFD_OVERWRITE_PROMPT);
<a name="l02854"></a>02854         <span class="keywordflow">if</span>(filename.empty()) <span class="keywordflow">return</span>; <span class="comment">// user cancelled</span>
<a name="l02855"></a>02855         <span class="comment">// validate</span>
<a name="l02856"></a>02856         wxFileName::SplitPath(filename,&amp;folder,NULL,&amp;extension);
<a name="l02857"></a>02857         <span class="keywordflow">if</span>(extension!=_T(<span class="stringliteral">&quot;png&quot;</span>) &amp;&amp; extension!=_T(<span class="stringliteral">&quot;jpg&quot;</span>))
<a name="l02858"></a>02858         {
<a name="l02859"></a>02859             wxMessageBox(_(<span class="stringliteral">&quot;Unsupported format&quot;</span>));
<a name="l02860"></a>02860             accepted = <span class="keyword">false</span>;
<a name="l02861"></a>02861         }
<a name="l02862"></a>02862     } <span class="keywordflow">while</span>(!accepted);
<a name="l02863"></a>02863 
<a name="l02864"></a>02864     <a class="code" href="prefs_8cpp.html#aecf1f655ef78e68e956e57878e7ea48d">screenshotdir</a> = folder;
<a name="l02865"></a>02865 
<a name="l02866"></a>02866     vtkSmartPointer&lt;vtkImageWriter&gt; writer;
<a name="l02867"></a>02867     <span class="keywordflow">if</span>(extension==_T(<span class="stringliteral">&quot;png&quot;</span>)) writer = vtkSmartPointer&lt;vtkPNGWriter&gt;::New();
<a name="l02868"></a>02868     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(extension==_T(<span class="stringliteral">&quot;jpg&quot;</span>)) writer = vtkSmartPointer&lt;vtkJPEGWriter&gt;::New();
<a name="l02869"></a>02869     writer-&gt;SetFileName(filename.mb_str());
<a name="l02870"></a>02870     vtkSmartPointer&lt;vtkImageData&gt; image = vtkSmartPointer&lt;vtkImageData&gt;::New();
<a name="l02871"></a>02871     system-&gt;GetAs2DImage(image,this-&gt;render_settings);
<a name="l02872"></a>02872     writer-&gt;SetInput(image);
<a name="l02873"></a>02873     writer-&gt;Write();
<a name="l02874"></a>02874 
<a name="l02875"></a>02875     <span class="comment">// TODO: merge with OnSaveScreenshot</span>
<a name="l02876"></a>02876 }
<a name="l02877"></a>02877 
<a name="l02878"></a>02878 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l02879"></a>02879 
<a name="l02880"></a><a class="code" href="classMyFrame.html#ab85937d2dd40e771a900c367dda30085">02880</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#ab85937d2dd40e771a900c367dda30085">MyFrame::RecordFrame</a>()
<a name="l02881"></a>02881 {
<a name="l02882"></a>02882     ostringstream oss; 
<a name="l02883"></a>02883     oss &lt;&lt; this-&gt;recording_prefix &lt;&lt; setfill(<span class="charliteral">&#39;0&#39;</span>) &lt;&lt; setw(6) &lt;&lt; this-&gt;iRecordingFrame &lt;&lt; this-&gt;recording_extension;
<a name="l02884"></a>02884     vtkSmartPointer&lt;vtkImageWriter&gt; writer;
<a name="l02885"></a>02885     <span class="keywordflow">if</span>(this-&gt;recording_extension==_T(<span class="stringliteral">&quot;.png&quot;</span>)) writer = vtkSmartPointer&lt;vtkPNGWriter&gt;::New();
<a name="l02886"></a>02886     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(this-&gt;recording_extension==_T(<span class="stringliteral">&quot;.jpg&quot;</span>)) writer = vtkSmartPointer&lt;vtkJPEGWriter&gt;::New();
<a name="l02887"></a>02887     <span class="keywordflow">if</span>(this-&gt;record_data_image) <span class="comment">// take the 2D data (2D system or 2D slice)</span>
<a name="l02888"></a>02888     {
<a name="l02889"></a>02889         vtkSmartPointer&lt;vtkImageData&gt; image = vtkSmartPointer&lt;vtkImageData&gt;::New();
<a name="l02890"></a>02890         this-&gt;system-&gt;GetAs2DImage(image,this-&gt;render_settings);
<a name="l02891"></a>02891         writer-&gt;SetInput(image);
<a name="l02892"></a>02892     }
<a name="l02893"></a>02893     <span class="keywordflow">else</span> <span class="comment">// take a screenshot of the current view</span>
<a name="l02894"></a>02894     {
<a name="l02895"></a>02895         vtkSmartPointer&lt;vtkWindowToImageFilter&gt; screenshot = vtkSmartPointer&lt;vtkWindowToImageFilter&gt;::New();
<a name="l02896"></a>02896         screenshot-&gt;SetInput(this-&gt;pVTKWindow-&gt;GetRenderWindow());
<a name="l02897"></a>02897         writer-&gt;SetInputConnection(screenshot-&gt;GetOutputPort());
<a name="l02898"></a>02898     }
<a name="l02899"></a>02899     writer-&gt;SetFileName(oss.str().c_str());
<a name="l02900"></a>02900     writer-&gt;Write();
<a name="l02901"></a>02901     this-&gt;iRecordingFrame++;
<a name="l02902"></a>02902 }
<a name="l02903"></a>02903 
<a name="l02904"></a>02904 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l02905"></a>02905 
<a name="l02906"></a><a class="code" href="classMyFrame.html#a29a86cbaf1242cbbc8853a532c631480">02906</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#a29a86cbaf1242cbbc8853a532c631480">MyFrame::OnStartRecording</a>(wxCommandEvent &amp;event)
<a name="l02907"></a>02907 {
<a name="l02908"></a>02908     <span class="keywordtype">bool</span> default_to_2D_data = (this-&gt;system-&gt;GetArenaDimensionality()==2);
<a name="l02909"></a>02909 
<a name="l02910"></a>02910     <a class="code" href="classRecordingDialog.html" title="Options for recording the frames of a simulation as images to disk.">RecordingDialog</a> dlg(<span class="keyword">this</span>,default_to_2D_data);
<a name="l02911"></a>02911     <span class="keywordflow">if</span>(dlg.ShowModal()!=wxID_OK) <span class="keywordflow">return</span>;
<a name="l02912"></a>02912     this-&gt;recording_prefix = dlg.<a class="code" href="classRecordingDialog.html#a5bc47a8b3ad70f9999ed86b153d9b08b">recording_prefix</a>;
<a name="l02913"></a>02913     this-&gt;recording_extension = dlg.<a class="code" href="classRecordingDialog.html#a8577bc91b2ff2c3d62574b73c2e1cc61">recording_extension</a>;
<a name="l02914"></a>02914     this-&gt;record_data_image = dlg.<a class="code" href="classRecordingDialog.html#a381652ac15b4b54cc9c668ef16f67db6">record_data_image</a>;
<a name="l02915"></a>02915     this-&gt;iRecordingFrame = 0;
<a name="l02916"></a>02916     this-&gt;is_recording = <span class="keyword">true</span>;
<a name="l02917"></a>02917 }
<a name="l02918"></a>02918 
<a name="l02919"></a>02919 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l02920"></a>02920 
<a name="l02921"></a><a class="code" href="classMyFrame.html#a6fd41e5d2c29122469bec56d2e4a13cd">02921</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#a6fd41e5d2c29122469bec56d2e4a13cd">MyFrame::OnUpdateStartRecording</a>(wxUpdateUIEvent &amp;event)
<a name="l02922"></a>02922 {
<a name="l02923"></a>02923     <span class="keyword">event</span>.Enable(!this-&gt;is_recording);
<a name="l02924"></a>02924 }
<a name="l02925"></a>02925 
<a name="l02926"></a>02926 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l02927"></a>02927 
<a name="l02928"></a><a class="code" href="classMyFrame.html#a3490771b8abfdcba16a1122e83d720c7">02928</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#a3490771b8abfdcba16a1122e83d720c7">MyFrame::OnStopRecording</a>(wxCommandEvent &amp;event)
<a name="l02929"></a>02929 {
<a name="l02930"></a>02930     this-&gt;is_recording = <span class="keyword">false</span>;
<a name="l02931"></a>02931 }
<a name="l02932"></a>02932 
<a name="l02933"></a>02933 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l02934"></a>02934 
<a name="l02935"></a><a class="code" href="classMyFrame.html#aa7324fd8ad78e980bf6583446bc701d0">02935</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#aa7324fd8ad78e980bf6583446bc701d0">MyFrame::OnUpdateStopRecording</a>(wxUpdateUIEvent &amp;event)
<a name="l02936"></a>02936 {
<a name="l02937"></a>02937     <span class="keyword">event</span>.Enable(this-&gt;is_recording);
<a name="l02938"></a>02938 }
<a name="l02939"></a>02939 
<a name="l02940"></a>02940 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l02941"></a>02941 
<a name="l02942"></a><a class="code" href="classMyFrame.html#abef84c8c644f10f07dbab504bbc4cec3">02942</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#abef84c8c644f10f07dbab504bbc4cec3">MyFrame::OnBlank</a>(wxCommandEvent&amp; event)
<a name="l02943"></a>02943 {
<a name="l02944"></a>02944     this-&gt;system-&gt;BlankImage();
<a name="l02945"></a>02945     this-&gt;is_running = <span class="keyword">false</span>;
<a name="l02946"></a>02946     this-&gt;UpdateWindows();
<a name="l02947"></a>02947 }
<a name="l02948"></a>02948 
<a name="l02949"></a>02949 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l02950"></a>02950 
<a name="l02951"></a><a class="code" href="classMyFrame.html#a3f7b366f3bfc1ed8dbf4509729d222c5">02951</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#a3f7b366f3bfc1ed8dbf4509729d222c5">MyFrame::OnViewFullKernel</a>(wxCommandEvent&amp; event)
<a name="l02952"></a>02952 {
<a name="l02953"></a>02953     <a class="code" href="classMonospaceMessageBox.html" title="Displays a block of text in a monospace font.">MonospaceMessageBox</a>(wxString(this-&gt;system-&gt;GetKernel().c_str(),wxConvUTF8),
<a name="l02954"></a>02954         _(<span class="stringliteral">&quot;The full OpenCL kernel for this formula rule:&quot;</span>),wxART_INFORMATION);
<a name="l02955"></a>02955 }
<a name="l02956"></a>02956 
<a name="l02957"></a>02957 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l02958"></a>02958 
<a name="l02959"></a><a class="code" href="classMyFrame.html#a2358f0157edc9791ff6a3803c93e56b3">02959</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#a2358f0157edc9791ff6a3803c93e56b3">MyFrame::OnUpdateViewFullKernel</a>(wxUpdateUIEvent&amp; event)
<a name="l02960"></a>02960 {
<a name="l02961"></a>02961     <span class="keyword">event</span>.Enable(this-&gt;system-&gt;GetRuleType()==<span class="stringliteral">&quot;formula&quot;</span>);
<a name="l02962"></a>02962 }
<a name="l02963"></a>02963 
<a name="l02964"></a>02964 <span class="comment">// ---------------------------------------------------------------------</span>
</pre></div></div><!-- contents -->


<hr class="footer"/><address class="footer"><small>
Generated on Thu Jun 14 2012 12:19:58 for Ready by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.0
</small></address>

</body>
</html>
