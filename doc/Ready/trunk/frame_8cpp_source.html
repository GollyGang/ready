<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>Ready: gui/frame.cpp Source File</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />

<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  <td id="projectlogo"><img alt="Logo" src="logo.png"/></td>
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">Ready
   &#160;<span id="projectnumber">0.3</span>
   </div>
   <div id="projectbrief">A cross-platform implementation of various reaction-diffusion systems.</div>
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.8.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="dir_11bc0974ce736ce9a6fadebbeb7a8314.html">gui</a>      </li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<div class="title">frame.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="frame_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/*  Copyright 2011, 2012 The Ready Bunch</span>
<a name="l00002"></a>00002 <span class="comment"></span>
<a name="l00003"></a>00003 <span class="comment">    This file is part of Ready.</span>
<a name="l00004"></a>00004 <span class="comment"></span>
<a name="l00005"></a>00005 <span class="comment">    Ready is free software: you can redistribute it and/or modify</span>
<a name="l00006"></a>00006 <span class="comment">    it under the terms of the GNU General Public License as published by</span>
<a name="l00007"></a>00007 <span class="comment">    the Free Software Foundation, either version 3 of the License, or</span>
<a name="l00008"></a>00008 <span class="comment">    (at your option) any later version.</span>
<a name="l00009"></a>00009 <span class="comment"></span>
<a name="l00010"></a>00010 <span class="comment">    Ready is distributed in the hope that it will be useful,</span>
<a name="l00011"></a>00011 <span class="comment">    but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<a name="l00012"></a>00012 <span class="comment">    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the</span>
<a name="l00013"></a>00013 <span class="comment">    GNU General Public License for more details.</span>
<a name="l00014"></a>00014 <span class="comment"></span>
<a name="l00015"></a>00015 <span class="comment">    You should have received a copy of the GNU General Public License</span>
<a name="l00016"></a>00016 <span class="comment">    along with Ready. If not, see &lt;http://www.gnu.org/licenses/&gt;.         */</span>
<a name="l00017"></a>00017 
<a name="l00018"></a>00018 <span class="comment">// local:</span>
<a name="l00019"></a>00019 <span class="preprocessor">#include &quot;<a class="code" href="frame_8hpp.html">frame.hpp</a>&quot;</span>
<a name="l00020"></a>00020 <span class="preprocessor">#include &quot;<a class="code" href="app_8hpp.html">app.hpp</a>&quot;</span>              <span class="comment">// for wxGetApp</span>
<a name="l00021"></a>00021 <span class="preprocessor">#include &quot;<a class="code" href="wxutils_8hpp.html">wxutils.hpp</a>&quot;</span>
<a name="l00022"></a>00022 <span class="preprocessor">#include &quot;<a class="code" href="prefs_8hpp.html">prefs.hpp</a>&quot;</span>            <span class="comment">// for GetPrefs, SavePrefs, etc</span>
<a name="l00023"></a>00023 <span class="preprocessor">#include &quot;<a class="code" href="PatternsPanel_8hpp.html">PatternsPanel.hpp</a>&quot;</span>
<a name="l00024"></a>00024 <span class="preprocessor">#include &quot;<a class="code" href="InfoPanel_8hpp.html">InfoPanel.hpp</a>&quot;</span>
<a name="l00025"></a>00025 <span class="preprocessor">#include &quot;<a class="code" href="HelpPanel_8hpp.html">HelpPanel.hpp</a>&quot;</span>
<a name="l00026"></a>00026 <span class="preprocessor">#include &quot;<a class="code" href="IDs_8hpp.html">IDs.hpp</a>&quot;</span>
<a name="l00027"></a>00027 <span class="preprocessor">#include &quot;<a class="code" href="vtk__pipeline_8hpp.html">vtk_pipeline.hpp</a>&quot;</span>
<a name="l00028"></a>00028 <span class="preprocessor">#include &quot;<a class="code" href="dialogs_8hpp.html">dialogs.hpp</a>&quot;</span>
<a name="l00029"></a>00029 
<a name="l00030"></a>00030 <span class="comment">// readybase:</span>
<a name="l00031"></a>00031 <span class="preprocessor">#include &quot;<a class="code" href="utils_8hpp.html">utils.hpp</a>&quot;</span>
<a name="l00032"></a>00032 <span class="preprocessor">#include &quot;<a class="code" href="GrayScottImageRD_8hpp.html">GrayScottImageRD.hpp</a>&quot;</span>
<a name="l00033"></a>00033 <span class="preprocessor">#include &quot;<a class="code" href="OpenCL__utils_8hpp.html">OpenCL_utils.hpp</a>&quot;</span>
<a name="l00034"></a>00034 <span class="preprocessor">#include &quot;<a class="code" href="IO__XML_8hpp.html">IO_XML.hpp</a>&quot;</span>
<a name="l00035"></a>00035 <span class="preprocessor">#include &quot;<a class="code" href="HeatEquationMeshRD_8hpp.html">HeatEquationMeshRD.hpp</a>&quot;</span>
<a name="l00036"></a>00036 <span class="preprocessor">#include &quot;<a class="code" href="FormulaOpenCLImageRD_8hpp.html">FormulaOpenCLImageRD.hpp</a>&quot;</span>
<a name="l00037"></a>00037 <span class="preprocessor">#include &quot;<a class="code" href="FullKernelOpenCLImageRD_8hpp.html">FullKernelOpenCLImageRD.hpp</a>&quot;</span>
<a name="l00038"></a>00038 <span class="keyword">using namespace </span>OpenCL_utils;
<a name="l00039"></a>00039 
<a name="l00040"></a>00040 <span class="comment">// local resources:</span>
<a name="l00041"></a>00041 <span class="preprocessor">#include &quot;appicon16.xpm&quot;</span>
<a name="l00042"></a>00042 
<a name="l00043"></a>00043 <span class="comment">// wxWidgets:</span>
<a name="l00044"></a>00044 <span class="preprocessor">#include &lt;wx/config.h&gt;</span>
<a name="l00045"></a>00045 <span class="preprocessor">#include &lt;wx/aboutdlg.h&gt;</span>
<a name="l00046"></a>00046 <span class="preprocessor">#include &lt;wx/filename.h&gt;</span>
<a name="l00047"></a>00047 <span class="preprocessor">#include &lt;wx/font.h&gt;</span>
<a name="l00048"></a>00048 <span class="preprocessor">#include &lt;wx/dir.h&gt;</span>
<a name="l00049"></a>00049 <span class="preprocessor">#include &lt;wx/dnd.h&gt;</span>             <span class="comment">// for wxFileDropTarget</span>
<a name="l00050"></a>00050 <span class="preprocessor">#include &lt;wx/artprov.h&gt;</span>
<a name="l00051"></a>00051 <span class="preprocessor">#if wxUSE_TOOLTIPS</span>
<a name="l00052"></a>00052 <span class="preprocessor"></span><span class="preprocessor">   #include &quot;wx/tooltip.h&quot;</span>      <span class="comment">// for wxToolTip</span>
<a name="l00053"></a>00053 <span class="preprocessor">#endif</span>
<a name="l00054"></a>00054 <span class="preprocessor"></span><span class="preprocessor">#include &lt;wx/choicdlg.h&gt;</span>
<a name="l00055"></a>00055 
<a name="l00056"></a>00056 <span class="comment">// wxVTK: (local copy)</span>
<a name="l00057"></a>00057 <span class="preprocessor">#include &quot;<a class="code" href="wxVTKRenderWindowInteractor_8h.html">wxVTKRenderWindowInteractor.h</a>&quot;</span>
<a name="l00058"></a>00058 
<a name="l00059"></a>00059 <span class="comment">// STL:</span>
<a name="l00060"></a>00060 <span class="preprocessor">#include &lt;fstream&gt;</span>
<a name="l00061"></a>00061 <span class="preprocessor">#include &lt;string&gt;</span>
<a name="l00062"></a>00062 <span class="preprocessor">#include &lt;stdexcept&gt;</span>
<a name="l00063"></a>00063 <span class="preprocessor">#include &lt;algorithm&gt;</span>
<a name="l00064"></a>00064 <span class="keyword">using namespace </span>std;
<a name="l00065"></a>00065 
<a name="l00066"></a>00066 <span class="comment">// VTK:</span>
<a name="l00067"></a>00067 <span class="preprocessor">#include &lt;vtkWindowToImageFilter.h&gt;</span>
<a name="l00068"></a>00068 <span class="preprocessor">#include &lt;vtkPNGWriter.h&gt;</span>
<a name="l00069"></a>00069 <span class="preprocessor">#include &lt;vtkJPEGWriter.h&gt;</span>
<a name="l00070"></a>00070 <span class="preprocessor">#include &lt;vtkSmartPointer.h&gt;</span>
<a name="l00071"></a>00071 <span class="preprocessor">#include &lt;vtkXMLPolyDataReader.h&gt;</span>
<a name="l00072"></a>00072 <span class="preprocessor">#include &lt;vtkUnstructuredGrid.h&gt;</span>
<a name="l00073"></a>00073 <span class="preprocessor">#include &lt;vtkPolyData.h&gt;</span>
<a name="l00074"></a>00074 <span class="preprocessor">#include &lt;vtkOBJReader.h&gt;</span>
<a name="l00075"></a>00075 <span class="preprocessor">#include &lt;vtkCellArray.h&gt;</span>
<a name="l00076"></a>00076 <span class="preprocessor">#include &lt;vtkXMLPolyDataWriter.h&gt;</span>
<a name="l00077"></a>00077 <span class="preprocessor">#include &lt;vtkTriangleFilter.h&gt;</span>
<a name="l00078"></a>00078 <span class="preprocessor">#include &lt;vtkPointData.h&gt;</span>
<a name="l00079"></a>00079 <span class="preprocessor">#include &lt;vtkRendererCollection.h&gt;</span>
<a name="l00080"></a>00080 <span class="preprocessor">#include &lt;vtkXMLGenericDataObjectReader.h&gt;</span>
<a name="l00081"></a>00081 
<a name="l00082"></a>00082 <span class="preprocessor">#ifdef __WXMAC__</span>
<a name="l00083"></a>00083 <span class="preprocessor"></span><span class="preprocessor">    #include &lt;Carbon/Carbon.h&gt;</span>  <span class="comment">// for GetCurrentProcess, etc</span>
<a name="l00084"></a>00084 <span class="preprocessor">#endif</span>
<a name="l00085"></a>00085 <span class="preprocessor"></span>
<a name="l00086"></a>00086 <span class="preprocessor">#if wxCHECK_VERSION(2,9,0)</span>
<a name="l00087"></a>00087 <span class="preprocessor"></span>    <span class="comment">// some wxMenuItem method names have changed in wx 2.9</span>
<a name="l00088"></a>00088 <span class="preprocessor">    #define GetText GetItemLabel</span>
<a name="l00089"></a>00089 <span class="preprocessor"></span><span class="preprocessor">    #define SetText SetItemLabel</span>
<a name="l00090"></a>00090 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l00091"></a>00091 <span class="preprocessor"></span>
<a name="l00092"></a>00092 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l00093"></a>00093 
<a name="l00094"></a><a class="code" href="frame_8cpp.html#adb2d02d23949d250b57d1b3e00210c70">00094</a> wxString <a class="code" href="frame_8cpp.html#adb2d02d23949d250b57d1b3e00210c70">PaneName</a>(<span class="keywordtype">int</span> <span class="keywordtype">id</span>)
<a name="l00095"></a>00095 {
<a name="l00096"></a>00096     <span class="keywordflow">return</span> wxString::Format(_T(<span class="stringliteral">&quot;%d&quot;</span>),<span class="keywordtype">id</span>);
<a name="l00097"></a>00097 }
<a name="l00098"></a>00098 
<a name="l00099"></a>00099 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l00100"></a>00100 
<a name="l00101"></a>00101 BEGIN_EVENT_TABLE(<a class="code" href="classMyFrame.html" title="The wxFrame-derived top-level window for the Ready GUI.">MyFrame</a>, wxFrame)
<a name="l00102"></a>00102     EVT_ACTIVATE(<a class="code" href="classMyFrame.html" title="The wxFrame-derived top-level window for the Ready GUI.">MyFrame</a>::OnActivate)
<a name="l00103"></a>00103     EVT_IDLE(<a class="code" href="classMyFrame.html" title="The wxFrame-derived top-level window for the Ready GUI.">MyFrame</a>::OnIdle)
<a name="l00104"></a>00104     EVT_SIZE(<a class="code" href="classMyFrame.html" title="The wxFrame-derived top-level window for the Ready GUI.">MyFrame</a>::OnSize)
<a name="l00105"></a>00105     EVT_CLOSE(<a class="code" href="classMyFrame.html" title="The wxFrame-derived top-level window for the Ready GUI.">MyFrame</a>::OnClose)
<a name="l00106"></a>00106     <span class="comment">// file menu</span>
<a name="l00107"></a>00107     EVT_MENU(wxID_NEW, <a class="code" href="classMyFrame.html" title="The wxFrame-derived top-level window for the Ready GUI.">MyFrame</a>::OnNewPattern)
<a name="l00108"></a>00108     EVT_MENU(wxID_OPEN, <a class="code" href="classMyFrame.html" title="The wxFrame-derived top-level window for the Ready GUI.">MyFrame</a>::OnOpenPattern)
<a name="l00109"></a>00109     EVT_MENU(wxID_SAVE, <a class="code" href="classMyFrame.html" title="The wxFrame-derived top-level window for the Ready GUI.">MyFrame</a>::OnSavePattern)
<a name="l00110"></a>00110     EVT_MENU(ID::<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a175531e6c07358f49a087d247ad79c2c">ImportMesh</a>, <a class="code" href="classMyFrame.html" title="The wxFrame-derived top-level window for the Ready GUI.">MyFrame</a>::OnImportMesh)
<a name="l00111"></a>00111     EVT_MENU(ID::<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a5a8bede146a5ee0a5972b95d7398f52b">ExportMesh</a>, <a class="code" href="classMyFrame.html" title="The wxFrame-derived top-level window for the Ready GUI.">MyFrame</a>::OnExportMesh)
<a name="l00112"></a>00112     EVT_MENU(ID::<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a67f4892e5c57cce8f949046681a353e9">Screenshot</a>, <a class="code" href="classMyFrame.html" title="The wxFrame-derived top-level window for the Ready GUI.">MyFrame</a>::OnScreenshot)
<a name="l00113"></a>00113     EVT_MENU(ID::<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a96cb152725348747ab810e2f61fd95b8">AddMyPatterns</a>, <a class="code" href="classMyFrame.html" title="The wxFrame-derived top-level window for the Ready GUI.">MyFrame</a>::OnAddMyPatterns)
<a name="l00114"></a>00114     EVT_MENU(wxID_PREFERENCES, <a class="code" href="classMyFrame.html" title="The wxFrame-derived top-level window for the Ready GUI.">MyFrame</a>::OnPreferences)
<a name="l00115"></a>00115     EVT_MENU(wxID_EXIT, <a class="code" href="classMyFrame.html" title="The wxFrame-derived top-level window for the Ready GUI.">MyFrame</a>::OnQuit)
<a name="l00116"></a>00116     <span class="comment">// edit menu</span>
<a name="l00117"></a>00117     EVT_MENU(wxID_CUT, <a class="code" href="classMyFrame.html" title="The wxFrame-derived top-level window for the Ready GUI.">MyFrame</a>::OnCut)
<a name="l00118"></a>00118     EVT_MENU(wxID_COPY, <a class="code" href="classMyFrame.html" title="The wxFrame-derived top-level window for the Ready GUI.">MyFrame</a>::OnCopy)
<a name="l00119"></a>00119     EVT_MENU(wxID_PASTE, <a class="code" href="classMyFrame.html" title="The wxFrame-derived top-level window for the Ready GUI.">MyFrame</a>::OnPaste)
<a name="l00120"></a>00120     EVT_UPDATE_UI(wxID_PASTE, <a class="code" href="classMyFrame.html" title="The wxFrame-derived top-level window for the Ready GUI.">MyFrame</a>::OnUpdatePaste)
<a name="l00121"></a>00121     EVT_MENU(wxID_CLEAR, <a class="code" href="classMyFrame.html" title="The wxFrame-derived top-level window for the Ready GUI.">MyFrame</a>::OnClear)
<a name="l00122"></a>00122     EVT_MENU(wxID_SELECTALL, <a class="code" href="classMyFrame.html" title="The wxFrame-derived top-level window for the Ready GUI.">MyFrame</a>::OnSelectAll)
<a name="l00123"></a>00123     <span class="comment">// view menu</span>
<a name="l00124"></a>00124     EVT_MENU(ID::<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a414589df96055cbbf92f287fc135dcbf">FullScreen</a>, <a class="code" href="classMyFrame.html" title="The wxFrame-derived top-level window for the Ready GUI.">MyFrame</a>::OnFullScreen)
<a name="l00125"></a>00125     EVT_MENU(ID::<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a427c0b326c042c60a407421b66c543fa">FitPattern</a>, <a class="code" href="classMyFrame.html" title="The wxFrame-derived top-level window for the Ready GUI.">MyFrame</a>::OnFitPattern)
<a name="l00126"></a>00126     EVT_MENU(ID::<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994ac939d32eac9bad1c9c238c92526f6143">Wireframe</a>, <a class="code" href="classMyFrame.html" title="The wxFrame-derived top-level window for the Ready GUI.">MyFrame</a>::OnWireframe)
<a name="l00127"></a>00127     EVT_UPDATE_UI(ID::Wireframe, <a class="code" href="classMyFrame.html" title="The wxFrame-derived top-level window for the Ready GUI.">MyFrame</a>::OnUpdateWireframe)
<a name="l00128"></a>00128     EVT_MENU(ID::<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994acb63579b388e2e1b0fa5117d6bc55e08">PatternsPane</a>, <a class="code" href="classMyFrame.html" title="The wxFrame-derived top-level window for the Ready GUI.">MyFrame</a>::OnToggleViewPane)
<a name="l00129"></a>00129     EVT_UPDATE_UI(ID::PatternsPane, <a class="code" href="classMyFrame.html" title="The wxFrame-derived top-level window for the Ready GUI.">MyFrame</a>::OnUpdateViewPane)
<a name="l00130"></a>00130     EVT_MENU(ID::<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a9a7b8f50f338bc1f33bbb46a265c66b2">InfoPane</a>, <a class="code" href="classMyFrame.html" title="The wxFrame-derived top-level window for the Ready GUI.">MyFrame</a>::OnToggleViewPane)
<a name="l00131"></a>00131     EVT_UPDATE_UI(ID::InfoPane, <a class="code" href="classMyFrame.html" title="The wxFrame-derived top-level window for the Ready GUI.">MyFrame</a>::OnUpdateViewPane)
<a name="l00132"></a>00132     EVT_MENU(ID::<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994aa793fe9cd53e4212456e78a881d61e73">HelpPane</a>, <a class="code" href="classMyFrame.html" title="The wxFrame-derived top-level window for the Ready GUI.">MyFrame</a>::OnToggleViewPane)
<a name="l00133"></a>00133     EVT_UPDATE_UI(ID::HelpPane, <a class="code" href="classMyFrame.html" title="The wxFrame-derived top-level window for the Ready GUI.">MyFrame</a>::OnUpdateViewPane)
<a name="l00134"></a>00134     EVT_MENU(ID::<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a970f2597ef339a100a5499c8bb8521c8">RestoreDefaultPerspective</a>, <a class="code" href="classMyFrame.html" title="The wxFrame-derived top-level window for the Ready GUI.">MyFrame</a>::OnRestoreDefaultPerspective)
<a name="l00135"></a>00135     EVT_MENU(ID::<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a877fbb5ffc961960113e5daaa2cf81b2">ChangeActiveChemical</a>, <a class="code" href="classMyFrame.html" title="The wxFrame-derived top-level window for the Ready GUI.">MyFrame</a>::OnChangeActiveChemical)
<a name="l00136"></a>00136     <span class="comment">// action menu</span>
<a name="l00137"></a>00137     EVT_MENU(ID::<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a29ce194c83647cde2066a129499a28b1">Step1</a>, <a class="code" href="classMyFrame.html" title="The wxFrame-derived top-level window for the Ready GUI.">MyFrame</a>::OnStep)
<a name="l00138"></a>00138     EVT_MENU(ID::<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994aabc39ee10e4d33f32ba11dd7773ad781">StepN</a>, <a class="code" href="classMyFrame.html" title="The wxFrame-derived top-level window for the Ready GUI.">MyFrame</a>::OnStep)
<a name="l00139"></a>00139     EVT_UPDATE_UI(ID::Step1, <a class="code" href="classMyFrame.html" title="The wxFrame-derived top-level window for the Ready GUI.">MyFrame</a>::OnUpdateStep)
<a name="l00140"></a>00140     EVT_UPDATE_UI(ID::StepN, <a class="code" href="classMyFrame.html" title="The wxFrame-derived top-level window for the Ready GUI.">MyFrame</a>::OnUpdateStep)
<a name="l00141"></a>00141     EVT_MENU(ID::<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a7fa86a9ca58943a68ee72c2278d7091f">RunStop</a>, <a class="code" href="classMyFrame.html" title="The wxFrame-derived top-level window for the Ready GUI.">MyFrame</a>::OnRunStop)
<a name="l00142"></a>00142     EVT_UPDATE_UI(ID::RunStop, <a class="code" href="classMyFrame.html" title="The wxFrame-derived top-level window for the Ready GUI.">MyFrame</a>::OnUpdateRunStop)
<a name="l00143"></a>00143     EVT_MENU(ID::<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994ae64df26aa1aa17c056626418eeba266c">Reset</a>, <a class="code" href="classMyFrame.html" title="The wxFrame-derived top-level window for the Ready GUI.">MyFrame</a>::OnReset)
<a name="l00144"></a>00144     EVT_UPDATE_UI(ID::Reset, <a class="code" href="classMyFrame.html" title="The wxFrame-derived top-level window for the Ready GUI.">MyFrame</a>::OnUpdateReset)
<a name="l00145"></a>00145     EVT_MENU(ID::<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994ac6fcd8a484e837c655a4dfbbe689c12c">Faster</a>, <a class="code" href="classMyFrame.html" title="The wxFrame-derived top-level window for the Ready GUI.">MyFrame</a>::OnRunFaster)
<a name="l00146"></a>00146     EVT_MENU(ID::<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a9ec4f0f78fdccdd3937c37932871cb31">Slower</a>, <a class="code" href="classMyFrame.html" title="The wxFrame-derived top-level window for the Ready GUI.">MyFrame</a>::OnRunSlower)
<a name="l00147"></a>00147     EVT_MENU(ID::<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a34de4b7050e8e026745a5287938fd874">ChangeRunningSpeed</a>, <a class="code" href="classMyFrame.html" title="The wxFrame-derived top-level window for the Ready GUI.">MyFrame</a>::OnChangeRunningSpeed)
<a name="l00148"></a>00148     EVT_MENU(ID::<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a8b6dde37a380581b5c30d1d5f912f183">GenerateInitialPattern</a>, <a class="code" href="classMyFrame.html" title="The wxFrame-derived top-level window for the Ready GUI.">MyFrame</a>::OnGenerateInitialPattern)
<a name="l00149"></a>00149     EVT_MENU(ID::<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a7755c932c23e416eff7e29e82276dc87">AddParameter</a>,<a class="code" href="classMyFrame.html" title="The wxFrame-derived top-level window for the Ready GUI.">MyFrame</a>::OnAddParameter)
<a name="l00150"></a>00150     EVT_UPDATE_UI(ID::AddParameter, <a class="code" href="classMyFrame.html" title="The wxFrame-derived top-level window for the Ready GUI.">MyFrame</a>::OnUpdateAddParameter)
<a name="l00151"></a>00151     EVT_MENU(ID::<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a9377f837fdf3eb370dd4d06d34dd1e29">DeleteParameter</a>,<a class="code" href="classMyFrame.html" title="The wxFrame-derived top-level window for the Ready GUI.">MyFrame</a>::OnDeleteParameter)
<a name="l00152"></a>00152     EVT_UPDATE_UI(ID::DeleteParameter, <a class="code" href="classMyFrame.html" title="The wxFrame-derived top-level window for the Ready GUI.">MyFrame</a>::OnUpdateDeleteParameter)
<a name="l00153"></a>00153     EVT_MENU(ID::<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a82d526382ae3e9f7b1ecf5274d3c265f">SelectOpenCLDevice</a>, <a class="code" href="classMyFrame.html" title="The wxFrame-derived top-level window for the Ready GUI.">MyFrame</a>::OnSelectOpenCLDevice)
<a name="l00154"></a>00154     EVT_MENU(ID::<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a25785909b339d2424ba3e06092aea24d">OpenCLDiagnostics</a>, <a class="code" href="classMyFrame.html" title="The wxFrame-derived top-level window for the Ready GUI.">MyFrame</a>::OnOpenCLDiagnostics)
<a name="l00155"></a>00155     <span class="comment">// help menu</span>
<a name="l00156"></a>00156     EVT_MENU(wxID_HELP, <a class="code" href="classMyFrame.html" title="The wxFrame-derived top-level window for the Ready GUI.">MyFrame</a>::OnHelp)
<a name="l00157"></a>00157     EVT_MENU(ID::<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994ae4da177bc93aa9c32cd1c4c7e5df05f7">HelpQuick</a>, <a class="code" href="classMyFrame.html" title="The wxFrame-derived top-level window for the Ready GUI.">MyFrame</a>::OnHelp)
<a name="l00158"></a>00158     EVT_MENU(ID::<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a2e16df9987ffe628f9c3379f468762b4">HelpTips</a>, <a class="code" href="classMyFrame.html" title="The wxFrame-derived top-level window for the Ready GUI.">MyFrame</a>::OnHelp)
<a name="l00159"></a>00159     EVT_MENU(ID::<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a19e87388929f7a4f3d961de8105c5f6d">HelpKeyboard</a>, <a class="code" href="classMyFrame.html" title="The wxFrame-derived top-level window for the Ready GUI.">MyFrame</a>::OnHelp)
<a name="l00160"></a>00160     EVT_MENU(ID::<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a4c430f7f8809a8418a14a2641b48719a">HelpMouse</a>, <a class="code" href="classMyFrame.html" title="The wxFrame-derived top-level window for the Ready GUI.">MyFrame</a>::OnHelp)
<a name="l00161"></a>00161     EVT_MENU(ID::<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a34623182ac086372c85925d0939f666b">HelpFile</a>, <a class="code" href="classMyFrame.html" title="The wxFrame-derived top-level window for the Ready GUI.">MyFrame</a>::OnHelp)
<a name="l00162"></a>00162     EVT_MENU(ID::<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994ab5e85cc7435ed3454f3f5b980ed96e3d">HelpEdit</a>, <a class="code" href="classMyFrame.html" title="The wxFrame-derived top-level window for the Ready GUI.">MyFrame</a>::OnHelp)
<a name="l00163"></a>00163     EVT_MENU(ID::<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994aa6e5d26454218360dd70852ca324bec2">HelpView</a>, <a class="code" href="classMyFrame.html" title="The wxFrame-derived top-level window for the Ready GUI.">MyFrame</a>::OnHelp)
<a name="l00164"></a>00164     EVT_MENU(ID::<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a11c4f11523bb33079a18947830fa827e">HelpAction</a>, <a class="code" href="classMyFrame.html" title="The wxFrame-derived top-level window for the Ready GUI.">MyFrame</a>::OnHelp)
<a name="l00165"></a>00165     EVT_MENU(ID::<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a34a6d520118d6a6012bd9e8f0f9a1560">HelpHelp</a>, <a class="code" href="classMyFrame.html" title="The wxFrame-derived top-level window for the Ready GUI.">MyFrame</a>::OnHelp)
<a name="l00166"></a>00166     EVT_MENU(ID::<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a05b3c81109c55177ad668803cb8c6e1a">HelpFormats</a>, <a class="code" href="classMyFrame.html" title="The wxFrame-derived top-level window for the Ready GUI.">MyFrame</a>::OnHelp)
<a name="l00167"></a>00167     EVT_MENU(ID::<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a99d9508355ab71324cf773c2b607a41f">HelpProblems</a>, <a class="code" href="classMyFrame.html" title="The wxFrame-derived top-level window for the Ready GUI.">MyFrame</a>::OnHelp)
<a name="l00168"></a>00168     EVT_MENU(ID::<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a9f852fa906fbd919f0dd378129029422">HelpChanges</a>, <a class="code" href="classMyFrame.html" title="The wxFrame-derived top-level window for the Ready GUI.">MyFrame</a>::OnHelp)
<a name="l00169"></a>00169     EVT_MENU(ID::<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a5aea20957851faa34cfbf82d59895b56">HelpCredits</a>, <a class="code" href="classMyFrame.html" title="The wxFrame-derived top-level window for the Ready GUI.">MyFrame</a>::OnHelp)
<a name="l00170"></a>00170     EVT_MENU(wxID_ABOUT, <a class="code" href="classMyFrame.html" title="The wxFrame-derived top-level window for the Ready GUI.">MyFrame</a>::OnAbout)
<a name="l00171"></a>00171     <span class="comment">// items in Open Recent submenu must be handled last</span>
<a name="l00172"></a>00172     EVT_MENU(wxID_ANY, <a class="code" href="classMyFrame.html" title="The wxFrame-derived top-level window for the Ready GUI.">MyFrame</a>::OnOpenRecent)
<a name="l00173"></a>00173 END_EVENT_TABLE()
<a name="l00174"></a>00174 
<a name="l00175"></a>00175 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l00176"></a>00176 
<a name="l00177"></a>00177 <span class="comment">// frame constructor</span>
<a name="l00178"></a><a class="code" href="classMyFrame.html#af13d7bffe3d6844c2331085f423764a4">00178</a> <a class="code" href="classMyFrame.html" title="The wxFrame-derived top-level window for the Ready GUI.">MyFrame</a>::<a class="code" href="classMyFrame.html" title="The wxFrame-derived top-level window for the Ready GUI.">MyFrame</a>(const wxString&amp; title)
<a name="l00179"></a>00179        : wxFrame(NULL, wxID_ANY, title),
<a name="l00180"></a>00180        pVTKWindow(NULL),system(NULL),
<a name="l00181"></a>00181        is_running(false),
<a name="l00182"></a>00182        frames_per_second(0.0),
<a name="l00183"></a>00183        million_cell_generations_per_second(0.0),
<a name="l00184"></a>00184        fullscreen(false),
<a name="l00185"></a>00185        render_settings(&quot;render_settings&quot;)
<a name="l00186"></a>00186 {
<a name="l00187"></a>00187     this-&gt;SetIcon(wxICON(appicon16));
<a name="l00188"></a>00188 <span class="preprocessor">    #ifdef __WXGTK__</span>
<a name="l00189"></a>00189 <span class="preprocessor"></span>        <span class="comment">// advanced docking hints cause problems on xfce (and probably others)</span>
<a name="l00190"></a>00190         this-&gt;aui_mgr.SetFlags( wxAUI_MGR_ALLOW_FLOATING | wxAUI_MGR_RECTANGLE_HINT );
<a name="l00191"></a>00191 <span class="preprocessor">    #endif</span>
<a name="l00192"></a>00192 <span class="preprocessor"></span><span class="preprocessor">    #ifdef __WXMAC__</span>
<a name="l00193"></a>00193 <span class="preprocessor"></span>        this-&gt;aui_mgr.SetFlags( wxAUI_MGR_ALLOW_FLOATING | wxAUI_MGR_TRANSPARENT_HINT | wxAUI_MGR_ALLOW_ACTIVE_PANE );
<a name="l00194"></a>00194 <span class="preprocessor">    #endif</span>
<a name="l00195"></a>00195 <span class="preprocessor"></span>    this-&gt;aui_mgr.SetManagedWindow(<span class="keyword">this</span>);
<a name="l00196"></a>00196     
<a name="l00197"></a>00197     <a class="code" href="prefs_8cpp.html#a3b2a68cd85602c7c83ebb305f79d2617">GetPrefs</a>();     <span class="comment">// must be called before InitializeMenus</span>
<a name="l00198"></a>00198 
<a name="l00199"></a>00199     this-&gt;InitializeMenus();
<a name="l00200"></a>00200     this-&gt;InitializeToolbars();
<a name="l00201"></a>00201 
<a name="l00202"></a>00202     CreateStatusBar(1);
<a name="l00203"></a>00203     SetStatusText(_(<span class="stringliteral">&quot;Ready&quot;</span>));
<a name="l00204"></a>00204 
<a name="l00205"></a>00205     this-&gt;InitializePatternsPane();
<a name="l00206"></a>00206     this-&gt;InitializeInfoPane();
<a name="l00207"></a>00207     this-&gt;InitializeHelpPane();
<a name="l00208"></a>00208     this-&gt;InitializeRenderPane();
<a name="l00209"></a>00209 
<a name="l00210"></a>00210     this-&gt;default_perspective = this-&gt;aui_mgr.SavePerspective();
<a name="l00211"></a>00211     this-&gt;LoadSettings();
<a name="l00212"></a>00212     this-&gt;aui_mgr.Update();
<a name="l00213"></a>00213 
<a name="l00214"></a>00214     <span class="comment">// enable/disable tool tips</span>
<a name="l00215"></a>00215 <span class="preprocessor">    #if wxUSE_TOOLTIPS</span>
<a name="l00216"></a>00216 <span class="preprocessor"></span>        <span class="comment">// AKT TODO!!! fix bug: can&#39;t disable tooltips in Mac app (bug is in wxOSX-Cocoa)</span>
<a name="l00217"></a>00217         wxToolTip::Enable(<a class="code" href="prefs_8cpp.html#af831ab3ffe0ee800c61d7a73b2873ce3">showtips</a>);
<a name="l00218"></a>00218 <span class="preprocessor">    #endif</span>
<a name="l00219"></a>00219 <span class="preprocessor"></span>
<a name="l00220"></a>00220     <span class="comment">// initialize an RD system to get us started</span>
<a name="l00221"></a>00221 <span class="preprocessor">    #ifdef __WXMSW__</span>
<a name="l00222"></a>00222 <span class="preprocessor"></span>        <span class="comment">// use back slashes on Windows</span>
<a name="l00223"></a>00223         <span class="keyword">const</span> wxString initfile = _T(<span class="stringliteral">&quot;Patterns\\CPU-only\\grayscott_3D.vti&quot;</span>);
<a name="l00224"></a>00224 <span class="preprocessor">    #else</span>
<a name="l00225"></a>00225 <span class="preprocessor"></span>        <span class="comment">// use forward slashes on Mac/Linux</span>
<a name="l00226"></a>00226         <span class="keyword">const</span> wxString initfile = _T(<span class="stringliteral">&quot;Patterns/CPU-only/grayscott_3D.vti&quot;</span>);
<a name="l00227"></a>00227 <span class="preprocessor">    #endif</span>
<a name="l00228"></a>00228 <span class="preprocessor"></span>    <span class="keywordflow">if</span> (wxFileExists(initfile)) {
<a name="l00229"></a>00229         this-&gt;OpenFile(initfile);
<a name="l00230"></a>00230     } <span class="keywordflow">else</span> {
<a name="l00231"></a>00231         <span class="comment">// create new pattern</span>
<a name="l00232"></a>00232         wxCommandEvent cmdevent(wxID_NEW);
<a name="l00233"></a>00233         OnNewPattern(cmdevent);
<a name="l00234"></a>00234     }
<a name="l00235"></a>00235 }
<a name="l00236"></a>00236 
<a name="l00237"></a>00237 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l00238"></a>00238 
<a name="l00239"></a><a class="code" href="classMyFrame.html#a8c4a61f9dd46a80206b1d9af7b2052ee">00239</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#a8c4a61f9dd46a80206b1d9af7b2052ee">MyFrame::InitializeMenus</a>()
<a name="l00240"></a>00240 {
<a name="l00241"></a>00241     wxMenuBar *menuBar = <span class="keyword">new</span> wxMenuBar();
<a name="l00242"></a>00242     {   <span class="comment">// file menu:</span>
<a name="l00243"></a>00243         wxMenu *menu = <span class="keyword">new</span> wxMenu;
<a name="l00244"></a>00244         menu-&gt;Append(wxID_NEW, _(<span class="stringliteral">&quot;New Pattern&quot;</span>) + <a class="code" href="prefs_8cpp.html#ab9798965988e2083acef3da70016317f">GetAccelerator</a>(<a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a0a8b90d6d06556d673ffab3fe7bd765a">DO_NEWPATT</a>), _(<span class="stringliteral">&quot;Create a new pattern&quot;</span>));
<a name="l00245"></a>00245         menu-&gt;AppendSeparator();
<a name="l00246"></a>00246         menu-&gt;Append(wxID_OPEN, _(<span class="stringliteral">&quot;Open Pattern...&quot;</span>) + <a class="code" href="prefs_8cpp.html#ab9798965988e2083acef3da70016317f">GetAccelerator</a>(<a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a13b814442bb726fc27e2e46d75f68903">DO_OPENPATT</a>), _(<span class="stringliteral">&quot;Choose a pattern file to open&quot;</span>));
<a name="l00247"></a>00247         menu-&gt;Append(<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a7cbbd0c9c34ab62384ebaaea64700a6e">ID::OpenRecent</a>, _(<span class="stringliteral">&quot;Open Recent&quot;</span>), <a class="code" href="prefs_8cpp.html#ae5246b1632294beb0e04a2942722d304">patternSubMenu</a>);
<a name="l00248"></a>00248         menu-&gt;AppendSeparator();
<a name="l00249"></a>00249         menu-&gt;Append(<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a175531e6c07358f49a087d247ad79c2c">ID::ImportMesh</a>, _(<span class="stringliteral">&quot;Import Mesh...&quot;</span>) + <a class="code" href="prefs_8cpp.html#ab9798965988e2083acef3da70016317f">GetAccelerator</a>(<a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a1f4076bb401751fd60b827874e30b09c">DO_IMPORTMESH</a>), _(<span class="stringliteral">&quot;Import a mesh&quot;</span>));
<a name="l00250"></a>00250         menu-&gt;Append(<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a5a8bede146a5ee0a5972b95d7398f52b">ID::ExportMesh</a>, _(<span class="stringliteral">&quot;Export Mesh...&quot;</span>) + <a class="code" href="prefs_8cpp.html#ab9798965988e2083acef3da70016317f">GetAccelerator</a>(<a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a3b71061f14e65228175c258013cbec1c">DO_EXPORTMESH</a>), _(<span class="stringliteral">&quot;Export a mesh&quot;</span>));
<a name="l00251"></a>00251         menu-&gt;AppendSeparator();
<a name="l00252"></a>00252         menu-&gt;Append(wxID_SAVE, _(<span class="stringliteral">&quot;Save Pattern...&quot;</span>) + <a class="code" href="prefs_8cpp.html#ab9798965988e2083acef3da70016317f">GetAccelerator</a>(<a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62ac14c985dfcd45cba2f41c72260d29ffe">DO_SAVE</a>), _(<span class="stringliteral">&quot;Save the current pattern&quot;</span>));
<a name="l00253"></a>00253         menu-&gt;Append(<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a67f4892e5c57cce8f949046681a353e9">ID::Screenshot</a>, _(<span class="stringliteral">&quot;Save Screenshot...&quot;</span>) + <a class="code" href="prefs_8cpp.html#ab9798965988e2083acef3da70016317f">GetAccelerator</a>(<a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a8031583e5967eecb9ddf9d6a25962e5d">DO_SCREENSHOT</a>), _(<span class="stringliteral">&quot;Save a screenshot of the current view&quot;</span>));
<a name="l00254"></a>00254         menu-&gt;AppendSeparator();
<a name="l00255"></a>00255         menu-&gt;Append(<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a96cb152725348747ab810e2f61fd95b8">ID::AddMyPatterns</a>, _(<span class="stringliteral">&quot;Add My Patterns...&quot;</span>) + <a class="code" href="prefs_8cpp.html#ab9798965988e2083acef3da70016317f">GetAccelerator</a>(<a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a9b0e09a8a5af3eeda22366ae9a682b06">DO_ADDPATTS</a>), _(<span class="stringliteral">&quot;Add chosen folder to patterns pane&quot;</span>));
<a name="l00256"></a>00256 <span class="preprocessor">        #if !defined(__WXOSX_COCOA__)</span>
<a name="l00257"></a>00257 <span class="preprocessor"></span>            menu-&gt;AppendSeparator();
<a name="l00258"></a>00258 <span class="preprocessor">        #endif</span>
<a name="l00259"></a>00259 <span class="preprocessor"></span>        <span class="comment">// on the Mac the wxID_PREFERENCES item is moved to the app menu</span>
<a name="l00260"></a>00260         menu-&gt;Append(wxID_PREFERENCES, _(<span class="stringliteral">&quot;Preferences...&quot;</span>) + <a class="code" href="prefs_8cpp.html#ab9798965988e2083acef3da70016317f">GetAccelerator</a>(<a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a9df6720475a3f3e52740a0250774dee2">DO_PREFS</a>), _(<span class="stringliteral">&quot;Edit the preferences&quot;</span>));
<a name="l00261"></a>00261 <span class="preprocessor">        #if !defined(__WXOSX_COCOA__)</span>
<a name="l00262"></a>00262 <span class="preprocessor"></span>            menu-&gt;AppendSeparator();
<a name="l00263"></a>00263 <span class="preprocessor">        #endif</span>
<a name="l00264"></a>00264 <span class="preprocessor"></span>        <span class="comment">// on the Mac the wxID_EXIT item is moved to the app menu and the app name is appended to &quot;Quit &quot;</span>
<a name="l00265"></a>00265         menu-&gt;Append(wxID_EXIT, _(<span class="stringliteral">&quot;Quit&quot;</span>) + <a class="code" href="prefs_8cpp.html#ab9798965988e2083acef3da70016317f">GetAccelerator</a>(<a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a0d23c152db0c24154c6a13303a6151a4">DO_QUIT</a>));
<a name="l00266"></a>00266         menuBar-&gt;Append(menu, _(<span class="stringliteral">&quot;&amp;File&quot;</span>));
<a name="l00267"></a>00267     }
<a name="l00268"></a>00268     {   <span class="comment">// edit menu:</span>
<a name="l00269"></a>00269         wxMenu *menu = <span class="keyword">new</span> wxMenu;
<a name="l00270"></a>00270         menu-&gt;Append(wxID_CUT, _(<span class="stringliteral">&quot;Cut&quot;</span>) + <a class="code" href="prefs_8cpp.html#ab9798965988e2083acef3da70016317f">GetAccelerator</a>(<a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a86e6bb0ed1ed8e2b71aeee759d04f751">DO_CUT</a>), _(<span class="stringliteral">&quot;Cut the selection and save it to the clipboard&quot;</span>));
<a name="l00271"></a>00271         menu-&gt;Append(wxID_COPY, _(<span class="stringliteral">&quot;Copy&quot;</span>) + <a class="code" href="prefs_8cpp.html#ab9798965988e2083acef3da70016317f">GetAccelerator</a>(<a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a66ab504cb136ee10d90b5041b69b1072">DO_COPY</a>), _(<span class="stringliteral">&quot;Copy the selection to the clipboard&quot;</span>));
<a name="l00272"></a>00272         menu-&gt;Append(wxID_PASTE, _(<span class="stringliteral">&quot;Paste&quot;</span>) + <a class="code" href="prefs_8cpp.html#ab9798965988e2083acef3da70016317f">GetAccelerator</a>(<a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a57db23febf9d70735b2d5429f9322921">DO_PASTE</a>), _(<span class="stringliteral">&quot;Paste in the contents of the clipboard&quot;</span>));
<a name="l00273"></a>00273         menu-&gt;Append(wxID_CLEAR, _(<span class="stringliteral">&quot;Clear&quot;</span>) + <a class="code" href="prefs_8cpp.html#ab9798965988e2083acef3da70016317f">GetAccelerator</a>(<a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62ad1502fb1fa8a6db8f0d5eab8c5ea1795">DO_CLEAR</a>), _(<span class="stringliteral">&quot;Clear the selection&quot;</span>));
<a name="l00274"></a>00274         menu-&gt;AppendSeparator();
<a name="l00275"></a>00275         menu-&gt;Append(wxID_SELECTALL, _(<span class="stringliteral">&quot;Select All&quot;</span>) + <a class="code" href="prefs_8cpp.html#ab9798965988e2083acef3da70016317f">GetAccelerator</a>(<a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a5e89d8bab01100c776f98476f132750c">DO_SELALL</a>), _(<span class="stringliteral">&quot;Select everything&quot;</span>));
<a name="l00276"></a>00276         menuBar-&gt;Append(menu, _(<span class="stringliteral">&quot;&amp;Edit&quot;</span>));
<a name="l00277"></a>00277     }
<a name="l00278"></a>00278     {   <span class="comment">// view menu:</span>
<a name="l00279"></a>00279         wxMenu *menu = <span class="keyword">new</span> wxMenu;
<a name="l00280"></a>00280         menu-&gt;Append(<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a414589df96055cbbf92f287fc135dcbf">ID::FullScreen</a>, _(<span class="stringliteral">&quot;Full Screen&quot;</span>) + <a class="code" href="prefs_8cpp.html#ab9798965988e2083acef3da70016317f">GetAccelerator</a>(<a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a14ccfd2e63a339d4172bda3ad550fff2">DO_FULLSCREEN</a>), _(<span class="stringliteral">&quot;Toggle full screen mode&quot;</span>));
<a name="l00281"></a>00281         menu-&gt;Append(<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a427c0b326c042c60a407421b66c543fa">ID::FitPattern</a>, _(<span class="stringliteral">&quot;Fit Pattern&quot;</span>) + <a class="code" href="prefs_8cpp.html#ab9798965988e2083acef3da70016317f">GetAccelerator</a>(<a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a4b6a631192c5074db6357ebea2a4caf0">DO_FIT</a>), _(<span class="stringliteral">&quot;Restore view so all of pattern is visible&quot;</span>));
<a name="l00282"></a>00282         menu-&gt;AppendCheckItem(<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994ac939d32eac9bad1c9c238c92526f6143">ID::Wireframe</a>, _(<span class="stringliteral">&quot;Wireframe&quot;</span>) + <a class="code" href="prefs_8cpp.html#ab9798965988e2083acef3da70016317f">GetAccelerator</a>(<a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a069bd47d4f1f5762840246bb5a52bebf">DO_WIREFRAME</a>), _(<span class="stringliteral">&quot;Wireframe or surface view&quot;</span>));
<a name="l00283"></a>00283         menu-&gt;AppendSeparator();
<a name="l00284"></a>00284         menu-&gt;AppendCheckItem(<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994acb63579b388e2e1b0fa5117d6bc55e08">ID::PatternsPane</a>, _(<span class="stringliteral">&quot;&amp;Patterns Pane&quot;</span>) + <a class="code" href="prefs_8cpp.html#ab9798965988e2083acef3da70016317f">GetAccelerator</a>(<a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a57a2af46aa8cd3deb36042aa2a05a4f0">DO_PATTERNS</a>), _(<span class="stringliteral">&quot;View the patterns pane&quot;</span>));
<a name="l00285"></a>00285         menu-&gt;AppendCheckItem(<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a9a7b8f50f338bc1f33bbb46a265c66b2">ID::InfoPane</a>, _(<span class="stringliteral">&quot;&amp;Info Pane&quot;</span>) + <a class="code" href="prefs_8cpp.html#ab9798965988e2083acef3da70016317f">GetAccelerator</a>(<a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a3b10246f0f8338327b892109a70eca29">DO_INFO</a>), _(<span class="stringliteral">&quot;View the info pane&quot;</span>));
<a name="l00286"></a>00286         menu-&gt;AppendCheckItem(<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994aa793fe9cd53e4212456e78a881d61e73">ID::HelpPane</a>, _(<span class="stringliteral">&quot;&amp;Help Pane&quot;</span>) + <a class="code" href="prefs_8cpp.html#ab9798965988e2083acef3da70016317f">GetAccelerator</a>(<a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a150b825efd182d9c95b587c9ef5516b9">DO_HELP</a>), _(<span class="stringliteral">&quot;View the help pane&quot;</span>));
<a name="l00287"></a>00287         menu-&gt;AppendSeparator();
<a name="l00288"></a>00288         menu-&gt;Append(<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a970f2597ef339a100a5499c8bb8521c8">ID::RestoreDefaultPerspective</a>, _(<span class="stringliteral">&quot;&amp;Restore Default Layout&quot;</span>) + <a class="code" href="prefs_8cpp.html#ab9798965988e2083acef3da70016317f">GetAccelerator</a>(<a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62afb76022044b62bb892c1ee65ac4ef721">DO_RESTORE</a>), _(<span class="stringliteral">&quot;Put the windows back where they were&quot;</span>));
<a name="l00289"></a>00289         menu-&gt;AppendSeparator();
<a name="l00290"></a>00290         menu-&gt;Append(<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a877fbb5ffc961960113e5daaa2cf81b2">ID::ChangeActiveChemical</a>, _(<span class="stringliteral">&quot;&amp;Change Active Chemical...&quot;</span>) + <a class="code" href="prefs_8cpp.html#ab9798965988e2083acef3da70016317f">GetAccelerator</a>(<a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a776300076489934b1008c8d05602a494">DO_CHEMICAL</a>), _(<span class="stringliteral">&quot;Change which chemical is being visualized&quot;</span>));
<a name="l00291"></a>00291         menuBar-&gt;Append(menu, _(<span class="stringliteral">&quot;&amp;View&quot;</span>));
<a name="l00292"></a>00292     }
<a name="l00293"></a>00293     {   <span class="comment">// action menu:</span>
<a name="l00294"></a>00294         wxMenu *menu = <span class="keyword">new</span> wxMenu;
<a name="l00295"></a>00295         menu-&gt;Append(<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a29ce194c83647cde2066a129499a28b1">ID::Step1</a>, _(<span class="stringliteral">&quot;Step by 1&quot;</span>) + <a class="code" href="prefs_8cpp.html#ab9798965988e2083acef3da70016317f">GetAccelerator</a>(<a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a5b6cbabe6909263c772ceb091fb2edcd">DO_STEP1</a>), _(<span class="stringliteral">&quot;Advance the simulation by a single timestep&quot;</span>));
<a name="l00296"></a>00296         menu-&gt;Append(<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994aabc39ee10e4d33f32ba11dd7773ad781">ID::StepN</a>, _(<span class="stringliteral">&quot;Step by N&quot;</span>) + <a class="code" href="prefs_8cpp.html#ab9798965988e2083acef3da70016317f">GetAccelerator</a>(<a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62af6d9327fcfb8264f43b07cb94d66ec10">DO_STEPN</a>), _(<span class="stringliteral">&quot;Advance the simulation by timesteps per render&quot;</span>));
<a name="l00297"></a>00297         menu-&gt;Append(<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a7fa86a9ca58943a68ee72c2278d7091f">ID::RunStop</a>, _(<span class="stringliteral">&quot;Run&quot;</span>) + <a class="code" href="prefs_8cpp.html#ab9798965988e2083acef3da70016317f">GetAccelerator</a>(<a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62ad6773bc2d8b3a475b59775af5afc215c">DO_RUNSTOP</a>), _(<span class="stringliteral">&quot;Start running the simulation&quot;</span>));
<a name="l00298"></a>00298         menu-&gt;AppendSeparator();
<a name="l00299"></a>00299         menu-&gt;Append(<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994ae64df26aa1aa17c056626418eeba266c">ID::Reset</a>, _(<span class="stringliteral">&quot;Reset&quot;</span>) + <a class="code" href="prefs_8cpp.html#ab9798965988e2083acef3da70016317f">GetAccelerator</a>(<a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a4165bc81d865b678b2f9b7410eed6018">DO_RESET</a>), _(<span class="stringliteral">&quot;Go back to the starting pattern&quot;</span>));
<a name="l00300"></a>00300         menu-&gt;Append(<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a8b6dde37a380581b5c30d1d5f912f183">ID::GenerateInitialPattern</a>, _(<span class="stringliteral">&quot;Generate Initial &amp;Pattern&quot;</span>) + <a class="code" href="prefs_8cpp.html#ab9798965988e2083acef3da70016317f">GetAccelerator</a>(<a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a4fe766d76d47511ceac02eff795a8b58">DO_GENPATT</a>), _(<span class="stringliteral">&quot;Run the Initial Pattern Generator&quot;</span>));
<a name="l00301"></a>00301         menu-&gt;AppendSeparator();
<a name="l00302"></a>00302         menu-&gt;Append(<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994ac6fcd8a484e837c655a4dfbbe689c12c">ID::Faster</a>, _(<span class="stringliteral">&quot;Run Faster&quot;</span>) + <a class="code" href="prefs_8cpp.html#ab9798965988e2083acef3da70016317f">GetAccelerator</a>(<a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a389cee4c4147fecd61a4d134396e2e72">DO_FASTER</a>),_(<span class="stringliteral">&quot;Run with more timesteps between each render&quot;</span>));
<a name="l00303"></a>00303         menu-&gt;Append(<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a9ec4f0f78fdccdd3937c37932871cb31">ID::Slower</a>, _(<span class="stringliteral">&quot;Run Slower&quot;</span>) + <a class="code" href="prefs_8cpp.html#ab9798965988e2083acef3da70016317f">GetAccelerator</a>(<a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a53386a419f01d0b75372910dc9260c7e">DO_SLOWER</a>),_(<span class="stringliteral">&quot;Run with fewer timesteps between each render&quot;</span>));
<a name="l00304"></a>00304         menu-&gt;Append(<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a34de4b7050e8e026745a5287938fd874">ID::ChangeRunningSpeed</a>, _(<span class="stringliteral">&quot;Change Running Speed...&quot;</span>) + <a class="code" href="prefs_8cpp.html#ab9798965988e2083acef3da70016317f">GetAccelerator</a>(<a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62ae99153a35a4d051301adf666e9263afe">DO_CHANGESPEED</a>),_(<span class="stringliteral">&quot;Change the number of timesteps between each render&quot;</span>));
<a name="l00305"></a>00305         menu-&gt;AppendSeparator();
<a name="l00306"></a>00306         menu-&gt;Append(<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a7755c932c23e416eff7e29e82276dc87">ID::AddParameter</a>, _(<span class="stringliteral">&quot;&amp;Add Parameter...&quot;</span>) + <a class="code" href="prefs_8cpp.html#ab9798965988e2083acef3da70016317f">GetAccelerator</a>(<a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62aa4d123ec804f00f2a2e6668d0c3770fe">DO_ADDPARAM</a>),_(<span class="stringliteral">&quot;Add a new named parameter&quot;</span>));
<a name="l00307"></a>00307         menu-&gt;Append(<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a9377f837fdf3eb370dd4d06d34dd1e29">ID::DeleteParameter</a>, _(<span class="stringliteral">&quot;&amp;Delete Parameter...&quot;</span>) + <a class="code" href="prefs_8cpp.html#ab9798965988e2083acef3da70016317f">GetAccelerator</a>(<a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a2d72ebc020c77a64e833c939c6dabbd6">DO_DELPARAM</a>),_(<span class="stringliteral">&quot;Delete one of the parameters&quot;</span>));
<a name="l00308"></a>00308         menu-&gt;AppendSeparator();
<a name="l00309"></a>00309         menu-&gt;Append(<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a82d526382ae3e9f7b1ecf5274d3c265f">ID::SelectOpenCLDevice</a>, _(<span class="stringliteral">&quot;Select &amp;OpenCL Device...&quot;</span>) + <a class="code" href="prefs_8cpp.html#ab9798965988e2083acef3da70016317f">GetAccelerator</a>(<a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62acb4c9b11dea3500cc66f3f402c084a2a">DO_DEVICE</a>), _(<span class="stringliteral">&quot;Choose which OpenCL device to run on&quot;</span>));
<a name="l00310"></a>00310         menu-&gt;Append(<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a25785909b339d2424ba3e06092aea24d">ID::OpenCLDiagnostics</a>, _(<span class="stringliteral">&quot;Show Open&amp;CL Diagnostics...&quot;</span>) + <a class="code" href="prefs_8cpp.html#ab9798965988e2083acef3da70016317f">GetAccelerator</a>(<a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a47d344b75c0413566f55457e40d54914">DO_OPENCL</a>), _(<span class="stringliteral">&quot;Show the available OpenCL devices and their attributes&quot;</span>));
<a name="l00311"></a>00311         menuBar-&gt;Append(menu, _(<span class="stringliteral">&quot;&amp;Action&quot;</span>));
<a name="l00312"></a>00312     }
<a name="l00313"></a>00313     {   <span class="comment">// help menu:</span>
<a name="l00314"></a>00314         wxMenu *menu = <span class="keyword">new</span> wxMenu;
<a name="l00315"></a>00315         menu-&gt;Append(wxID_HELP,        _(<span class="stringliteral">&quot;Contents&quot;</span>));
<a name="l00316"></a>00316         menu-&gt;Append(<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994ae4da177bc93aa9c32cd1c4c7e5df05f7">ID::HelpQuick</a>,    _(<span class="stringliteral">&quot;Quick Start&quot;</span>));
<a name="l00317"></a>00317         menu-&gt;Append(<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a2e16df9987ffe628f9c3379f468762b4">ID::HelpTips</a>,     _(<span class="stringliteral">&quot;Hints and Tips&quot;</span>));
<a name="l00318"></a>00318         menu-&gt;Append(<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a19e87388929f7a4f3d961de8105c5f6d">ID::HelpKeyboard</a>, _(<span class="stringliteral">&quot;Keyboard Shortcuts&quot;</span>));
<a name="l00319"></a>00319         menu-&gt;Append(<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a4c430f7f8809a8418a14a2641b48719a">ID::HelpMouse</a>,    _(<span class="stringliteral">&quot;Mouse Shortcuts&quot;</span>));
<a name="l00320"></a>00320         menu-&gt;AppendSeparator();
<a name="l00321"></a>00321         menu-&gt;Append(<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a34623182ac086372c85925d0939f666b">ID::HelpFile</a>,     _(<span class="stringliteral">&quot;File Menu&quot;</span>));
<a name="l00322"></a>00322         menu-&gt;Append(<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994ab5e85cc7435ed3454f3f5b980ed96e3d">ID::HelpEdit</a>,     _(<span class="stringliteral">&quot;Edit Menu&quot;</span>));
<a name="l00323"></a>00323         menu-&gt;Append(<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994aa6e5d26454218360dd70852ca324bec2">ID::HelpView</a>,     _(<span class="stringliteral">&quot;View Menu&quot;</span>));
<a name="l00324"></a>00324         menu-&gt;Append(<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a11c4f11523bb33079a18947830fa827e">ID::HelpAction</a>,   _(<span class="stringliteral">&quot;Action Menu&quot;</span>));
<a name="l00325"></a>00325         menu-&gt;Append(<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a34a6d520118d6a6012bd9e8f0f9a1560">ID::HelpHelp</a>,     _(<span class="stringliteral">&quot;Help Menu&quot;</span>));
<a name="l00326"></a>00326         menu-&gt;AppendSeparator();
<a name="l00327"></a>00327         menu-&gt;Append(<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a05b3c81109c55177ad668803cb8c6e1a">ID::HelpFormats</a>,  _(<span class="stringliteral">&quot;File Formats&quot;</span>));
<a name="l00328"></a>00328         menu-&gt;Append(<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a99d9508355ab71324cf773c2b607a41f">ID::HelpProblems</a>, _(<span class="stringliteral">&quot;Known Problems&quot;</span>));
<a name="l00329"></a>00329         menu-&gt;Append(<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a9f852fa906fbd919f0dd378129029422">ID::HelpChanges</a>,  _(<span class="stringliteral">&quot;Changes&quot;</span>));
<a name="l00330"></a>00330         menu-&gt;Append(<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a5aea20957851faa34cfbf82d59895b56">ID::HelpCredits</a>,  _(<span class="stringliteral">&quot;Credits&quot;</span>));
<a name="l00331"></a>00331         menu-&gt;AppendSeparator();
<a name="l00332"></a>00332         menu-&gt;Append(wxID_ABOUT,       _(<span class="stringliteral">&quot;&amp;About Ready&quot;</span>) + <a class="code" href="prefs_8cpp.html#ab9798965988e2083acef3da70016317f">GetAccelerator</a>(<a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a6c41bc6a32c0c5bb09a732a21cfccf4f">DO_ABOUT</a>));
<a name="l00333"></a>00333         menuBar-&gt;Append(menu, _(<span class="stringliteral">&quot;&amp;Help&quot;</span>));
<a name="l00334"></a>00334     }
<a name="l00335"></a>00335     SetMenuBar(menuBar);
<a name="l00336"></a>00336 }
<a name="l00337"></a>00337 
<a name="l00338"></a>00338 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l00339"></a>00339 
<a name="l00340"></a>00340 <span class="preprocessor">#ifdef __WXMAC__</span>
<a name="l00341"></a>00341 <span class="preprocessor"></span>    <span class="comment">// smaller toolbar bitmaps look much nicer on Mac</span>
<a name="l00342"></a>00342 <span class="preprocessor">    #undef wxART_TOOLBAR</span>
<a name="l00343"></a>00343 <span class="preprocessor"></span><span class="preprocessor">    #define wxART_TOOLBAR wxART_BUTTON</span>
<a name="l00344"></a>00344 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l00345"></a>00345 <span class="preprocessor"></span>
<a name="l00346"></a><a class="code" href="classMyFrame.html#ad18dcc0ba063d7b92ac9bb99eb92bebf">00346</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#ad18dcc0ba063d7b92ac9bb99eb92bebf">MyFrame::InitializeToolbars</a>()
<a name="l00347"></a>00347 {
<a name="l00348"></a>00348     {   <span class="comment">// file menu items</span>
<a name="l00349"></a>00349         wxAuiToolBar *tb = <span class="keyword">new</span> wxAuiToolBar(<span class="keyword">this</span>,<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a5dac25d358c2adfb6c19008ebfa48ccf">ID::FileToolbar</a>);
<a name="l00350"></a>00350         tb-&gt;AddTool(wxID_NEW,wxEmptyString,wxArtProvider::GetBitmap(wxART_NEW,wxART_TOOLBAR),_(<span class="stringliteral">&quot;Create a new pattern&quot;</span>));
<a name="l00351"></a>00351         tb-&gt;AddTool(wxID_OPEN,wxEmptyString,wxArtProvider::GetBitmap(wxART_FILE_OPEN,wxART_TOOLBAR),_(<span class="stringliteral">&quot;Choose a pattern file to open&quot;</span>));
<a name="l00352"></a>00352         tb-&gt;AddTool(wxID_SAVE,wxEmptyString,wxArtProvider::GetBitmap(wxART_FILE_SAVE,wxART_TOOLBAR),_(<span class="stringliteral">&quot;Save the current pattern&quot;</span>));
<a name="l00353"></a>00353 <span class="preprocessor">        #ifdef __WXMAC__</span>
<a name="l00354"></a>00354 <span class="preprocessor"></span>            tb-&gt;SetToolBorderPadding(10);
<a name="l00355"></a>00355 <span class="preprocessor">        #endif</span>
<a name="l00356"></a>00356 <span class="preprocessor"></span>        this-&gt;aui_mgr.AddPane(tb,wxAuiPaneInfo().ToolbarPane().Top().Name(<a class="code" href="frame_8cpp.html#adb2d02d23949d250b57d1b3e00210c70">PaneName</a>(<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a5dac25d358c2adfb6c19008ebfa48ccf">ID::FileToolbar</a>))
<a name="l00357"></a>00357             .Position(0).Caption(_(<span class="stringliteral">&quot;File tools&quot;</span>)));
<a name="l00358"></a>00358     }
<a name="l00359"></a>00359     {   <span class="comment">// action menu items</span>
<a name="l00360"></a>00360         this-&gt;action_toolbar = <span class="keyword">new</span> wxAuiToolBar(<span class="keyword">this</span>,<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994ac5933a5c56a2cda5c854446f3256ff91">ID::ActionToolbar</a>);
<a name="l00361"></a>00361         this-&gt;action_toolbar-&gt;AddTool(<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a29ce194c83647cde2066a129499a28b1">ID::Step1</a>,wxEmptyString,wxArtProvider::GetBitmap(wxART_PLUS,wxART_TOOLBAR),
<a name="l00362"></a>00362             _(<span class="stringliteral">&quot;Step by 1&quot;</span>));
<a name="l00363"></a>00363         this-&gt;action_toolbar-&gt;AddTool(<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a7fa86a9ca58943a68ee72c2278d7091f">ID::RunStop</a>,wxEmptyString,wxArtProvider::GetBitmap(wxART_GO_FORWARD,wxART_TOOLBAR),
<a name="l00364"></a>00364             _(<span class="stringliteral">&quot;Start running the simulation&quot;</span>));
<a name="l00365"></a>00365         this-&gt;action_toolbar-&gt;AddTool(<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994ae64df26aa1aa17c056626418eeba266c">ID::Reset</a>,wxEmptyString,wxArtProvider::GetBitmap(wxART_GOTO_FIRST,wxART_TOOLBAR),
<a name="l00366"></a>00366             _(<span class="stringliteral">&quot;Go back to the starting pattern&quot;</span>));
<a name="l00367"></a>00367         this-&gt;action_toolbar-&gt;AddTool(<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a8b6dde37a380581b5c30d1d5f912f183">ID::GenerateInitialPattern</a>,wxEmptyString,wxArtProvider::GetBitmap(wxART_EXECUTABLE_FILE,wxART_TOOLBAR),
<a name="l00368"></a>00368             _(<span class="stringliteral">&quot;Run the Initial Pattern Generator&quot;</span>));
<a name="l00369"></a>00369 <span class="preprocessor">        #ifdef __WXMAC__</span>
<a name="l00370"></a>00370 <span class="preprocessor"></span>            this-&gt;action_toolbar-&gt;SetToolBorderPadding(10);
<a name="l00371"></a>00371 <span class="preprocessor">        #endif</span>
<a name="l00372"></a>00372 <span class="preprocessor"></span>        this-&gt;aui_mgr.AddPane(this-&gt;action_toolbar,wxAuiPaneInfo().ToolbarPane().Top()
<a name="l00373"></a>00373             .Name(<a class="code" href="frame_8cpp.html#adb2d02d23949d250b57d1b3e00210c70">PaneName</a>(<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994ac5933a5c56a2cda5c854446f3256ff91">ID::ActionToolbar</a>)).Position(1).Caption(_(<span class="stringliteral">&quot;Action tools&quot;</span>)));
<a name="l00374"></a>00374     }
<a name="l00375"></a>00375 }
<a name="l00376"></a>00376 
<a name="l00377"></a>00377 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l00378"></a>00378 
<a name="l00379"></a><a class="code" href="classMyFrame.html#aa3c6e7102c269c79b734517e5da97ed2">00379</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#aa3c6e7102c269c79b734517e5da97ed2">MyFrame::InitializePatternsPane</a>()
<a name="l00380"></a>00380 {
<a name="l00381"></a>00381     this-&gt;patterns_panel = <span class="keyword">new</span> <a class="code" href="classPatternsPanel.html">PatternsPanel</a>(<span class="keyword">this</span>,wxID_ANY);
<a name="l00382"></a>00382     this-&gt;aui_mgr.AddPane(this-&gt;patterns_panel,
<a name="l00383"></a>00383                   wxAuiPaneInfo()
<a name="l00384"></a>00384                   .Name(<a class="code" href="frame_8cpp.html#adb2d02d23949d250b57d1b3e00210c70">PaneName</a>(<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994acb63579b388e2e1b0fa5117d6bc55e08">ID::PatternsPane</a>))
<a name="l00385"></a>00385                   .Caption(_(<span class="stringliteral">&quot;Patterns Pane&quot;</span>))
<a name="l00386"></a>00386                   .Left()
<a name="l00387"></a>00387                   .BestSize(220,600)
<a name="l00388"></a>00388                   .Position(0)
<a name="l00389"></a>00389                   );
<a name="l00390"></a>00390 }
<a name="l00391"></a>00391 
<a name="l00392"></a>00392 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l00393"></a>00393 
<a name="l00394"></a><a class="code" href="classMyFrame.html#a843de9600d3363f8c49aeacca8fcefe9">00394</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#a843de9600d3363f8c49aeacca8fcefe9">MyFrame::InitializeInfoPane</a>()
<a name="l00395"></a>00395 {
<a name="l00396"></a>00396     this-&gt;info_panel = <span class="keyword">new</span> <a class="code" href="classInfoPanel.html">InfoPanel</a>(<span class="keyword">this</span>,wxID_ANY);
<a name="l00397"></a>00397     this-&gt;aui_mgr.AddPane(this-&gt;info_panel,
<a name="l00398"></a>00398                   wxAuiPaneInfo()
<a name="l00399"></a>00399                   .Name(<a class="code" href="frame_8cpp.html#adb2d02d23949d250b57d1b3e00210c70">PaneName</a>(<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a9a7b8f50f338bc1f33bbb46a265c66b2">ID::InfoPane</a>))
<a name="l00400"></a>00400                   .Caption(_(<span class="stringliteral">&quot;Info Pane&quot;</span>))
<a name="l00401"></a>00401                   .Right()
<a name="l00402"></a>00402                   .BestSize(500,300)
<a name="l00403"></a>00403                   .Position(0)
<a name="l00404"></a>00404                   );
<a name="l00405"></a>00405 }
<a name="l00406"></a>00406 
<a name="l00407"></a>00407 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l00408"></a>00408 
<a name="l00409"></a><a class="code" href="classMyFrame.html#a5e712e937780b265b60781518399df4e">00409</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#a5e712e937780b265b60781518399df4e">MyFrame::UpdateInfoPane</a>()
<a name="l00410"></a>00410 {
<a name="l00411"></a>00411     this-&gt;info_panel-&gt;Update(this-&gt;system);
<a name="l00412"></a>00412 }
<a name="l00413"></a>00413 
<a name="l00414"></a>00414 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l00415"></a>00415 
<a name="l00416"></a><a class="code" href="classMyFrame.html#a810d4a6ef18c288fc6c7bab3d8cbea14">00416</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#a810d4a6ef18c288fc6c7bab3d8cbea14">MyFrame::InitializeHelpPane</a>()
<a name="l00417"></a>00417 {
<a name="l00418"></a>00418     this-&gt;help_panel = <span class="keyword">new</span> <a class="code" href="classHelpPanel.html">HelpPanel</a>(<span class="keyword">this</span>,wxID_ANY);
<a name="l00419"></a>00419     this-&gt;aui_mgr.AddPane(this-&gt;help_panel,
<a name="l00420"></a>00420                   wxAuiPaneInfo()
<a name="l00421"></a>00421                   .Name(<a class="code" href="frame_8cpp.html#adb2d02d23949d250b57d1b3e00210c70">PaneName</a>(<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994aa793fe9cd53e4212456e78a881d61e73">ID::HelpPane</a>))
<a name="l00422"></a>00422                   .Caption(_(<span class="stringliteral">&quot;Help Pane&quot;</span>))
<a name="l00423"></a>00423                   .Right()
<a name="l00424"></a>00424                   .BestSize(500,300)
<a name="l00425"></a>00425                   .Position(1)
<a name="l00426"></a>00426                   );
<a name="l00427"></a>00427 }
<a name="l00428"></a>00428 
<a name="l00429"></a>00429 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l00430"></a>00430 
<a name="l00431"></a>00431 <span class="preprocessor">#if wxUSE_DRAG_AND_DROP</span>
<a name="l00432"></a>00432 <span class="preprocessor"></span>
<a name="l00433"></a>00433 <span class="comment">// derive a simple class for handling dropped files</span>
<a name="l00434"></a>00434 <span class="keyword">class </span>DnDFile : <span class="keyword">public</span> wxFileDropTarget
<a name="l00435"></a>00435 {
<a name="l00436"></a>00436 <span class="keyword">public</span>:
<a name="l00437"></a>00437     DnDFile() {}
<a name="l00438"></a>00438     <span class="keyword">virtual</span> <span class="keywordtype">bool</span> OnDropFiles(wxCoord x, wxCoord y, <span class="keyword">const</span> wxArrayString&amp; filenames);
<a name="l00439"></a>00439 };
<a name="l00440"></a>00440 
<a name="l00441"></a>00441 <span class="keywordtype">bool</span> DnDFile::OnDropFiles(wxCoord, wxCoord, <span class="keyword">const</span> wxArrayString&amp; filenames)
<a name="l00442"></a>00442 {
<a name="l00443"></a>00443     <a class="code" href="classMyFrame.html" title="The wxFrame-derived top-level window for the Ready GUI.">MyFrame</a>* frameptr = wxGetApp().currframe;
<a name="l00444"></a>00444 
<a name="l00445"></a>00445     <span class="comment">// bring app to front</span>
<a name="l00446"></a>00446 <span class="preprocessor">    #ifdef __WXMAC__</span>
<a name="l00447"></a>00447 <span class="preprocessor"></span>        ProcessSerialNumber process;
<a name="l00448"></a>00448         <span class="keywordflow">if</span> ( GetCurrentProcess(&amp;process) == noErr ) SetFrontProcess(&amp;process);
<a name="l00449"></a>00449 <span class="preprocessor">    #endif</span>
<a name="l00450"></a>00450 <span class="preprocessor"></span><span class="preprocessor">    #ifdef __WXMSW__</span>
<a name="l00451"></a>00451 <span class="preprocessor"></span>        SetForegroundWindow( (HWND)frameptr-&gt;GetHandle() );
<a name="l00452"></a>00452 <span class="preprocessor">    #endif</span>
<a name="l00453"></a>00453 <span class="preprocessor"></span>    frameptr-&gt;Raise();
<a name="l00454"></a>00454    
<a name="l00455"></a>00455     <span class="keywordtype">size_t</span> numfiles = filenames.GetCount();
<a name="l00456"></a>00456     <span class="keywordflow">for</span> ( <span class="keywordtype">size_t</span> n = 0; n &lt; numfiles; n++ ) {
<a name="l00457"></a>00457         frameptr-&gt;<a class="code" href="classMyFrame.html#a436d29334a575795c92361ba33bf06c3">OpenFile</a>(filenames[n]);
<a name="l00458"></a>00458     }
<a name="l00459"></a>00459     <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00460"></a>00460 }
<a name="l00461"></a>00461 
<a name="l00462"></a>00462 <span class="preprocessor">#endif // wxUSE_DRAG_AND_DROP</span>
<a name="l00463"></a>00463 <span class="preprocessor"></span>
<a name="l00464"></a>00464 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l00465"></a>00465 
<a name="l00466"></a><a class="code" href="classMyFrame.html#aadb4cf00bea27ef97342047b36ee6d1f">00466</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#aadb4cf00bea27ef97342047b36ee6d1f">MyFrame::InitializeRenderPane</a>()
<a name="l00467"></a>00467 {
<a name="l00468"></a>00468     <span class="comment">// for now the VTK window goes in the center pane (always visible) - we got problems when had in a floating pane</span>
<a name="l00469"></a>00469     vtkObject::GlobalWarningDisplayOff(); <span class="comment">// (can turn on for debugging)</span>
<a name="l00470"></a>00470     this-&gt;pVTKWindow = <span class="keyword">new</span> <a class="code" href="classwxVTKRenderWindowInteractor.html">wxVTKRenderWindowInteractor</a>(<span class="keyword">this</span>,wxID_ANY);
<a name="l00471"></a>00471     this-&gt;aui_mgr.AddPane(this-&gt;pVTKWindow,
<a name="l00472"></a>00472                   wxAuiPaneInfo()
<a name="l00473"></a>00473                   .Name(<a class="code" href="frame_8cpp.html#adb2d02d23949d250b57d1b3e00210c70">PaneName</a>(<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a67f9b0b6dcbe03c4ba95bd0755a05617">ID::CanvasPane</a>))
<a name="l00474"></a>00474                   <span class="comment">// AKT TODO!!! why don&#39;t we see caption??? (it would be nice to see when it has focus)</span>
<a name="l00475"></a>00475                   .Caption(_(<span class="stringliteral">&quot;Render Pane&quot;</span>)).CaptionVisible()
<a name="l00476"></a>00476                   .CenterPane()
<a name="l00477"></a>00477                   .BestSize(400,400)
<a name="l00478"></a>00478                   );
<a name="l00479"></a>00479 
<a name="l00480"></a>00480 <span class="preprocessor">    #if wxUSE_DRAG_AND_DROP</span>
<a name="l00481"></a>00481 <span class="preprocessor"></span>        <span class="comment">// let users drag-and-drop pattern files onto the render pane</span>
<a name="l00482"></a>00482         this-&gt;pVTKWindow-&gt;SetDropTarget(<span class="keyword">new</span> DnDFile());
<a name="l00483"></a>00483 <span class="preprocessor">    #endif</span>
<a name="l00484"></a>00484 <span class="preprocessor"></span>
<a name="l00485"></a>00485     <span class="comment">// install event handlers to detect keyboard shortcuts when render window has focus</span>
<a name="l00486"></a>00486     this-&gt;pVTKWindow-&gt;Connect(wxEVT_KEY_DOWN, wxKeyEventHandler(<a class="code" href="classMyFrame.html#ac0457b9e23e582141215c35e5d42d97c">MyFrame::OnKeyDown</a>), NULL, <span class="keyword">this</span>);
<a name="l00487"></a>00487     this-&gt;pVTKWindow-&gt;Connect(wxEVT_CHAR, wxKeyEventHandler(<a class="code" href="classMyFrame.html#a7d2dd27713dc21ead65462aeca0d0d75">MyFrame::OnChar</a>), NULL, <span class="keyword">this</span>);
<a name="l00488"></a>00488 }
<a name="l00489"></a>00489 
<a name="l00490"></a>00490 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l00491"></a>00491 
<a name="l00492"></a><a class="code" href="classMyFrame.html#a56af1181b6f87b92e35dcbbd450dd5f2">00492</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#a56af1181b6f87b92e35dcbbd450dd5f2">MyFrame::LoadSettings</a>()
<a name="l00493"></a>00493 {
<a name="l00494"></a>00494     <span class="comment">// use global info set by GetPrefs()</span>
<a name="l00495"></a>00495     this-&gt;SetPosition(wxPoint(<a class="code" href="prefs_8cpp.html#a26b11189d93fef33172f1a2a1d174188">mainx</a>,<a class="code" href="prefs_8cpp.html#a8b015efaa4cb16287077ac74b60ad67a">mainy</a>));
<a name="l00496"></a>00496     this-&gt;SetSize(<a class="code" href="prefs_8cpp.html#a7b08ad54bec54f213c5ed4c1d8749548">mainwd</a>,<a class="code" href="prefs_8cpp.html#afd8ee1110367c04cc21e2219607b7a7b">mainht</a>);
<a name="l00497"></a>00497     <span class="keywordflow">if</span> (<a class="code" href="prefs_8cpp.html#a9c5a9f65dc02b9e7ed8abef92565e5fa">auilayout</a>.length() &gt; 0) this-&gt;aui_mgr.LoadPerspective(<a class="code" href="prefs_8cpp.html#a9c5a9f65dc02b9e7ed8abef92565e5fa">auilayout</a>);
<a name="l00498"></a>00498 }
<a name="l00499"></a>00499 
<a name="l00500"></a>00500 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l00501"></a>00501 
<a name="l00502"></a><a class="code" href="classMyFrame.html#a41c4b3fdce4d573112daac75a9fda896">00502</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#a41c4b3fdce4d573112daac75a9fda896">MyFrame::SaveSettings</a>()
<a name="l00503"></a>00503 {
<a name="l00504"></a>00504     <span class="keywordflow">if</span> (fullscreen) {
<a name="l00505"></a>00505         <span class="comment">// use auilayout saved earlier in OnFullScreen</span>
<a name="l00506"></a>00506     } <span class="keywordflow">else</span> {
<a name="l00507"></a>00507         <a class="code" href="prefs_8cpp.html#a9c5a9f65dc02b9e7ed8abef92565e5fa">auilayout</a> = this-&gt;aui_mgr.SavePerspective();
<a name="l00508"></a>00508     }
<a name="l00509"></a>00509     <a class="code" href="prefs_8cpp.html#a36a6fcc2c220a813bd9f3057c8c8bfc1">SavePrefs</a>();
<a name="l00510"></a>00510 }
<a name="l00511"></a>00511 
<a name="l00512"></a>00512 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l00513"></a>00513 
<a name="l00514"></a><a class="code" href="classMyFrame.html#a711b2bda77494841f2e582982b80c356">00514</a> <a class="code" href="classMyFrame.html#a711b2bda77494841f2e582982b80c356">MyFrame::~MyFrame</a>()
<a name="l00515"></a>00515 {
<a name="l00516"></a>00516     this-&gt;SaveSettings(); <span class="comment">// save the current settings so it starts up the same next time</span>
<a name="l00517"></a>00517     this-&gt;aui_mgr.UnInit();
<a name="l00518"></a>00518     this-&gt;pVTKWindow-&gt;Delete();
<a name="l00519"></a>00519     <span class="keyword">delete</span> this-&gt;system;
<a name="l00520"></a>00520 }
<a name="l00521"></a>00521 
<a name="l00522"></a>00522 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l00523"></a>00523 
<a name="l00524"></a><a class="code" href="classMyFrame.html#a9e6c4824efad3aa9f4c3a3025a616e2d">00524</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#a9e6c4824efad3aa9f4c3a3025a616e2d">MyFrame::OnQuit</a>(wxCommandEvent&amp; WXUNUSED(event))
<a name="l00525"></a>00525 {
<a name="l00526"></a>00526     <span class="keywordflow">if</span>(UserWantsToCancelWhenAskedIfWantsToSave()) <span class="keywordflow">return</span>;
<a name="l00527"></a>00527     Close(<span class="keyword">true</span>);
<a name="l00528"></a>00528 }
<a name="l00529"></a>00529 
<a name="l00530"></a>00530 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l00531"></a>00531 
<a name="l00532"></a><a class="code" href="classMyFrame.html#ab470cba0c5d8d46980c602589d556ee5">00532</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#ab470cba0c5d8d46980c602589d556ee5">MyFrame::OnAbout</a>(wxCommandEvent&amp; WXUNUSED(event))
<a name="l00533"></a>00533 {
<a name="l00534"></a>00534     <a class="code" href="HelpPanel_8cpp.html#a69114324160abe189b7412b8a56308f9">ShowAboutBox</a>();
<a name="l00535"></a>00535 }
<a name="l00536"></a>00536 
<a name="l00537"></a>00537 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l00538"></a>00538 
<a name="l00539"></a><a class="code" href="classMyFrame.html#a96aaaff9d90a787f70587d5d9184f27b">00539</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#a96aaaff9d90a787f70587d5d9184f27b">MyFrame::OnCut</a>(wxCommandEvent&amp; event)
<a name="l00540"></a>00540 {
<a name="l00541"></a>00541     <span class="comment">// action depends on which pane has focus</span>
<a name="l00542"></a>00542     <span class="keywordflow">if</span> (this-&gt;info_panel-&gt;HtmlHasFocus()) <span class="keywordflow">return</span>;
<a name="l00543"></a>00543     <span class="keywordflow">if</span> (this-&gt;help_panel-&gt;HtmlHasFocus()) <span class="keywordflow">return</span>;
<a name="l00544"></a>00544     <span class="keyword">event</span>.Skip();
<a name="l00545"></a>00545 }
<a name="l00546"></a>00546 
<a name="l00547"></a>00547 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l00548"></a>00548 
<a name="l00549"></a><a class="code" href="classMyFrame.html#a5a67d598f37e13825032c15ce275e30d">00549</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#a5a67d598f37e13825032c15ce275e30d">MyFrame::OnCopy</a>(wxCommandEvent&amp; event)
<a name="l00550"></a>00550 {
<a name="l00551"></a>00551     <span class="comment">// action depends on which pane has focus</span>
<a name="l00552"></a>00552     <span class="keywordflow">if</span> (this-&gt;info_panel-&gt;HtmlHasFocus()) {
<a name="l00553"></a>00553         this-&gt;info_panel-&gt;CopySelection();
<a name="l00554"></a>00554         <span class="keywordflow">return</span>;
<a name="l00555"></a>00555     }
<a name="l00556"></a>00556     <span class="keywordflow">if</span> (this-&gt;help_panel-&gt;HtmlHasFocus()) {
<a name="l00557"></a>00557         this-&gt;help_panel-&gt;CopySelection();
<a name="l00558"></a>00558         <span class="keywordflow">return</span>;
<a name="l00559"></a>00559     }
<a name="l00560"></a>00560     <span class="keyword">event</span>.Skip();
<a name="l00561"></a>00561 }
<a name="l00562"></a>00562 
<a name="l00563"></a>00563 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l00564"></a>00564 
<a name="l00565"></a><a class="code" href="classMyFrame.html#a6b7eb93dc671ae87351d9555f5b0d0d5">00565</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#a6b7eb93dc671ae87351d9555f5b0d0d5">MyFrame::OnPaste</a>(wxCommandEvent&amp; event)
<a name="l00566"></a>00566 {
<a name="l00567"></a>00567     <span class="comment">// action depends on which pane has focus</span>
<a name="l00568"></a>00568     <span class="keywordflow">if</span> (this-&gt;info_panel-&gt;HtmlHasFocus()) <span class="keywordflow">return</span>;
<a name="l00569"></a>00569     <span class="keywordflow">if</span> (this-&gt;help_panel-&gt;HtmlHasFocus()) <span class="keywordflow">return</span>;
<a name="l00570"></a>00570     <span class="keyword">event</span>.Skip();
<a name="l00571"></a>00571 }
<a name="l00572"></a>00572 
<a name="l00573"></a>00573 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l00574"></a>00574 
<a name="l00575"></a><a class="code" href="classMyFrame.html#ac12aa086bdab2c68f62c9b52f819f88c">00575</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#ac12aa086bdab2c68f62c9b52f819f88c">MyFrame::OnUpdatePaste</a>(wxUpdateUIEvent&amp; event)
<a name="l00576"></a>00576 {
<a name="l00577"></a>00577     <span class="keyword">event</span>.Enable(<a class="code" href="wxutils_8cpp.html#a9207b602b6bd12d3c7283558f80e5dc8">ClipboardHasText</a>());
<a name="l00578"></a>00578 }
<a name="l00579"></a>00579 
<a name="l00580"></a>00580 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l00581"></a>00581 
<a name="l00582"></a><a class="code" href="classMyFrame.html#ae65e6947cf2f55d5a10391f69d1b0557">00582</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#ae65e6947cf2f55d5a10391f69d1b0557">MyFrame::OnClear</a>(wxCommandEvent&amp; event)
<a name="l00583"></a>00583 {
<a name="l00584"></a>00584     <span class="comment">// action depends on which pane has focus</span>
<a name="l00585"></a>00585     <span class="keywordflow">if</span> (this-&gt;info_panel-&gt;HtmlHasFocus()) <span class="keywordflow">return</span>;
<a name="l00586"></a>00586     <span class="keywordflow">if</span> (this-&gt;help_panel-&gt;HtmlHasFocus()) <span class="keywordflow">return</span>;
<a name="l00587"></a>00587     <span class="keyword">event</span>.Skip();
<a name="l00588"></a>00588 }
<a name="l00589"></a>00589 
<a name="l00590"></a>00590 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l00591"></a>00591 
<a name="l00592"></a><a class="code" href="classMyFrame.html#a23a6bc0797a79648a27a18c5ecb6bb7d">00592</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#a23a6bc0797a79648a27a18c5ecb6bb7d">MyFrame::OnSelectAll</a>(wxCommandEvent&amp; event)
<a name="l00593"></a>00593 {
<a name="l00594"></a>00594     <span class="comment">// action depends on which pane has focus</span>
<a name="l00595"></a>00595     <span class="keywordflow">if</span> (this-&gt;info_panel-&gt;HtmlHasFocus()) {
<a name="l00596"></a>00596         this-&gt;info_panel-&gt;SelectAllText();
<a name="l00597"></a>00597         <span class="keywordflow">return</span>;
<a name="l00598"></a>00598     }
<a name="l00599"></a>00599     <span class="keywordflow">if</span> (this-&gt;help_panel-&gt;HtmlHasFocus()) {
<a name="l00600"></a>00600         this-&gt;help_panel-&gt;SelectAllText();
<a name="l00601"></a>00601         <span class="keywordflow">return</span>;
<a name="l00602"></a>00602     }
<a name="l00603"></a>00603     <span class="keyword">event</span>.Skip();
<a name="l00604"></a>00604 }
<a name="l00605"></a>00605 
<a name="l00606"></a>00606 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l00607"></a>00607 
<a name="l00608"></a><a class="code" href="classMyFrame.html#aedf9dc8c2a723fd8de16d90596500b50">00608</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#aedf9dc8c2a723fd8de16d90596500b50">MyFrame::OnFullScreen</a>(wxCommandEvent&amp; event)
<a name="l00609"></a>00609 {
<a name="l00610"></a>00610     <span class="keyword">static</span> <span class="keywordtype">bool</span> restorestatus;  <span class="comment">// restore the status bar?</span>
<a name="l00611"></a>00611     
<a name="l00612"></a>00612     wxStatusBar* statusbar = GetStatusBar();
<a name="l00613"></a>00613     
<a name="l00614"></a>00614     <span class="keywordflow">if</span> (!fullscreen) {
<a name="l00615"></a>00615         <span class="comment">// save current location and size for use in SavePrefs</span>
<a name="l00616"></a>00616         wxRect r = GetRect();
<a name="l00617"></a>00617         <a class="code" href="prefs_8cpp.html#a26b11189d93fef33172f1a2a1d174188">mainx</a> = r.x;
<a name="l00618"></a>00618         <a class="code" href="prefs_8cpp.html#a8b015efaa4cb16287077ac74b60ad67a">mainy</a> = r.y;
<a name="l00619"></a>00619         <a class="code" href="prefs_8cpp.html#a7b08ad54bec54f213c5ed4c1d8749548">mainwd</a> = r.width;
<a name="l00620"></a>00620         <a class="code" href="prefs_8cpp.html#afd8ee1110367c04cc21e2219607b7a7b">mainht</a> = r.height;
<a name="l00621"></a>00621         <span class="comment">// also save current perspective</span>
<a name="l00622"></a>00622         <a class="code" href="prefs_8cpp.html#a9c5a9f65dc02b9e7ed8abef92565e5fa">auilayout</a> = this-&gt;aui_mgr.SavePerspective();
<a name="l00623"></a>00623     } <span class="keywordflow">else</span> {
<a name="l00624"></a>00624         <span class="comment">// restore status bar before calling ShowFullScreen (so we see status text in Mac app)</span>
<a name="l00625"></a>00625         <span class="keywordflow">if</span> (restorestatus) statusbar-&gt;Show();
<a name="l00626"></a>00626     }
<a name="l00627"></a>00627 
<a name="l00628"></a>00628     fullscreen = !fullscreen;
<a name="l00629"></a>00629     ShowFullScreen(fullscreen, wxFULLSCREEN_NOMENUBAR | wxFULLSCREEN_NOBORDER | wxFULLSCREEN_NOCAPTION);
<a name="l00630"></a>00630 
<a name="l00631"></a>00631     <span class="keywordflow">if</span> (fullscreen) {
<a name="l00632"></a>00632         <span class="comment">// hide the status bar</span>
<a name="l00633"></a>00633         restorestatus = statusbar &amp;&amp; statusbar-&gt;IsShown();
<a name="l00634"></a>00634         <span class="keywordflow">if</span> (restorestatus) statusbar-&gt;Hide();
<a name="l00635"></a>00635 
<a name="l00636"></a>00636         <span class="comment">// hide all currently shown panes</span>
<a name="l00637"></a>00637         wxAuiPaneInfo &amp;pattpane = this-&gt;aui_mgr.GetPane(<a class="code" href="frame_8cpp.html#adb2d02d23949d250b57d1b3e00210c70">PaneName</a>(<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994acb63579b388e2e1b0fa5117d6bc55e08">ID::PatternsPane</a>));
<a name="l00638"></a>00638         wxAuiPaneInfo &amp;infopane = this-&gt;aui_mgr.GetPane(<a class="code" href="frame_8cpp.html#adb2d02d23949d250b57d1b3e00210c70">PaneName</a>(<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a9a7b8f50f338bc1f33bbb46a265c66b2">ID::InfoPane</a>));
<a name="l00639"></a>00639         wxAuiPaneInfo &amp;helppane = this-&gt;aui_mgr.GetPane(<a class="code" href="frame_8cpp.html#adb2d02d23949d250b57d1b3e00210c70">PaneName</a>(<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994aa793fe9cd53e4212456e78a881d61e73">ID::HelpPane</a>));
<a name="l00640"></a>00640         wxAuiPaneInfo &amp;filepane = this-&gt;aui_mgr.GetPane(<a class="code" href="frame_8cpp.html#adb2d02d23949d250b57d1b3e00210c70">PaneName</a>(<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a5dac25d358c2adfb6c19008ebfa48ccf">ID::FileToolbar</a>));
<a name="l00641"></a>00641         wxAuiPaneInfo &amp;actionpane = this-&gt;aui_mgr.GetPane(<a class="code" href="frame_8cpp.html#adb2d02d23949d250b57d1b3e00210c70">PaneName</a>(<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994ac5933a5c56a2cda5c854446f3256ff91">ID::ActionToolbar</a>));
<a name="l00642"></a>00642         
<a name="l00643"></a>00643         <span class="keywordflow">if</span> (pattpane.IsOk() &amp;&amp; pattpane.IsShown()) pattpane.Show(<span class="keyword">false</span>);
<a name="l00644"></a>00644         <span class="keywordflow">if</span> (infopane.IsOk() &amp;&amp; infopane.IsShown()) infopane.Show(<span class="keyword">false</span>);
<a name="l00645"></a>00645         <span class="keywordflow">if</span> (helppane.IsOk() &amp;&amp; helppane.IsShown()) helppane.Show(<span class="keyword">false</span>);
<a name="l00646"></a>00646         <span class="keywordflow">if</span> (filepane.IsOk() &amp;&amp; filepane.IsShown()) filepane.Show(<span class="keyword">false</span>);
<a name="l00647"></a>00647         <span class="keywordflow">if</span> (actionpane.IsOk() &amp;&amp; actionpane.IsShown()) actionpane.Show(<span class="keyword">false</span>);
<a name="l00648"></a>00648         
<a name="l00649"></a>00649         <span class="comment">// ensure the render window sees keyboard shortcuts</span>
<a name="l00650"></a>00650         this-&gt;pVTKWindow-&gt;SetFocus();
<a name="l00651"></a>00651 
<a name="l00652"></a>00652     } <span class="keywordflow">else</span> {
<a name="l00653"></a>00653         <span class="comment">// restore saved perspective</span>
<a name="l00654"></a>00654         this-&gt;aui_mgr.LoadPerspective(<a class="code" href="prefs_8cpp.html#a9c5a9f65dc02b9e7ed8abef92565e5fa">auilayout</a>);
<a name="l00655"></a>00655     }
<a name="l00656"></a>00656     
<a name="l00657"></a>00657     this-&gt;aui_mgr.Update();
<a name="l00658"></a>00658 }
<a name="l00659"></a>00659 
<a name="l00660"></a>00660 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l00661"></a>00661 
<a name="l00662"></a><a class="code" href="classMyFrame.html#afa6b1e7abbc33e4c1a487e796f2f183b">00662</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#afa6b1e7abbc33e4c1a487e796f2f183b">MyFrame::OnFitPattern</a>(wxCommandEvent&amp; event)
<a name="l00663"></a>00663 {
<a name="l00664"></a>00664     <span class="comment">// reset the active camera in all the renderers in this render window</span>
<a name="l00665"></a>00665     vtkRenderWindow* renWin = this-&gt;pVTKWindow-&gt;GetRenderWindow();
<a name="l00666"></a>00666     renWin-&gt;GetRenderers()-&gt;InitTraversal();
<a name="l00667"></a>00667     vtkRenderer *ren;
<a name="l00668"></a>00668     <span class="keywordflow">while</span>(ren = renWin-&gt;GetRenderers()-&gt;GetNextItem())
<a name="l00669"></a>00669         ren-&gt;ResetCamera();
<a name="l00670"></a>00670     this-&gt;Refresh(<span class="keyword">false</span>);
<a name="l00671"></a>00671 }
<a name="l00672"></a>00672 
<a name="l00673"></a>00673 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l00674"></a>00674 
<a name="l00675"></a><a class="code" href="classMyFrame.html#a79715a0026a2ba48bffc82408d5486eb">00675</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#a79715a0026a2ba48bffc82408d5486eb">MyFrame::OnWireframe</a>(wxCommandEvent&amp; event)
<a name="l00676"></a>00676 {
<a name="l00677"></a>00677     <span class="keywordtype">bool</span> wireframe = this-&gt;render_settings.GetProperty(<span class="stringliteral">&quot;use_wireframe&quot;</span>).GetBool();
<a name="l00678"></a>00678     wireframe = !wireframe;
<a name="l00679"></a>00679     this-&gt;render_settings.GetProperty(<span class="stringliteral">&quot;use_wireframe&quot;</span>).SetBool(wireframe);
<a name="l00680"></a>00680     <a class="code" href="vtk__pipeline_8cpp.html#a83eef6bea304823921ff32ce0afb6d2b">InitializeVTKPipeline</a>(this-&gt;pVTKWindow,this-&gt;system,this-&gt;render_settings,<span class="keyword">false</span>);
<a name="l00681"></a>00681     this-&gt;UpdateInfoPane();
<a name="l00682"></a>00682     this-&gt;Refresh(<span class="keyword">false</span>);
<a name="l00683"></a>00683 }
<a name="l00684"></a>00684 
<a name="l00685"></a>00685 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l00686"></a>00686 
<a name="l00687"></a><a class="code" href="classMyFrame.html#a43362d67fa9bc3454691762cb1e55b54">00687</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#a43362d67fa9bc3454691762cb1e55b54">MyFrame::OnUpdateWireframe</a>(wxUpdateUIEvent&amp; event)
<a name="l00688"></a>00688 {
<a name="l00689"></a>00689     <span class="keyword">event</span>.Check(this-&gt;render_settings.GetProperty(<span class="stringliteral">&quot;use_wireframe&quot;</span>).GetBool());
<a name="l00690"></a>00690 }
<a name="l00691"></a>00691 
<a name="l00692"></a>00692 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l00693"></a>00693 
<a name="l00694"></a><a class="code" href="classMyFrame.html#afde773529f2d2d6b619683c3349b8808">00694</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#afde773529f2d2d6b619683c3349b8808">MyFrame::OnToggleViewPane</a>(wxCommandEvent&amp; event)
<a name="l00695"></a>00695 {
<a name="l00696"></a>00696     wxAuiPaneInfo &amp;pane = this-&gt;aui_mgr.GetPane(<a class="code" href="frame_8cpp.html#adb2d02d23949d250b57d1b3e00210c70">PaneName</a>(event.GetId()));
<a name="l00697"></a>00697     <span class="keywordflow">if</span>(!pane.IsOk()) <span class="keywordflow">return</span>;
<a name="l00698"></a>00698     pane.Show(!pane.IsShown());
<a name="l00699"></a>00699     this-&gt;aui_mgr.Update();
<a name="l00700"></a>00700 }
<a name="l00701"></a>00701 
<a name="l00702"></a>00702 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l00703"></a>00703 
<a name="l00704"></a><a class="code" href="classMyFrame.html#ae6b2e6360847eafb8e030e1c1c0174ad">00704</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#ae6b2e6360847eafb8e030e1c1c0174ad">MyFrame::OnUpdateViewPane</a>(wxUpdateUIEvent&amp; event)
<a name="l00705"></a>00705 {
<a name="l00706"></a>00706     wxAuiPaneInfo &amp;pane = this-&gt;aui_mgr.GetPane(<a class="code" href="frame_8cpp.html#adb2d02d23949d250b57d1b3e00210c70">PaneName</a>(event.GetId()));
<a name="l00707"></a>00707     <span class="keywordflow">if</span>(!pane.IsOk()) <span class="keywordflow">return</span>;
<a name="l00708"></a>00708     <span class="keyword">event</span>.Check(pane.IsShown());
<a name="l00709"></a>00709 }
<a name="l00710"></a>00710 
<a name="l00711"></a>00711 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l00712"></a>00712 
<a name="l00713"></a><a class="code" href="classMyFrame.html#a97767bd1acede9a4755cda62741a6cf6">00713</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#a97767bd1acede9a4755cda62741a6cf6">MyFrame::OnOpenCLDiagnostics</a>(wxCommandEvent&amp; event)
<a name="l00714"></a>00714 {
<a name="l00715"></a>00715     <span class="comment">// TODO: merge this with SelectOpenCLDevice?</span>
<a name="l00716"></a>00716     wxString txt;
<a name="l00717"></a>00717     {
<a name="l00718"></a>00718         wxBusyCursor busy;
<a name="l00719"></a>00719         txt = wxString(<a class="code" href="namespaceOpenCL__utils.html#af6a3ee46b7c1f42b9f5a18d9de6b5f10" title="Returns a full report on the available OpenCL devices.">GetOpenCLDiagnostics</a>().c_str(),wxConvUTF8);
<a name="l00720"></a>00720     }
<a name="l00721"></a>00721     <a class="code" href="classMonospaceMessageBox.html">MonospaceMessageBox</a>(txt,_(<span class="stringliteral">&quot;OpenCL diagnostics&quot;</span>),wxART_INFORMATION);
<a name="l00722"></a>00722 }
<a name="l00723"></a>00723 
<a name="l00724"></a>00724 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l00725"></a>00725 
<a name="l00726"></a><a class="code" href="classMyFrame.html#ade1ee7abd7620c01deeafaee1c75a79d">00726</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#ade1ee7abd7620c01deeafaee1c75a79d">MyFrame::OnSize</a>(wxSizeEvent&amp; event)
<a name="l00727"></a>00727 {
<a name="l00728"></a>00728 <span class="preprocessor">#ifdef __WXMSW__</span>
<a name="l00729"></a>00729 <span class="preprocessor"></span>    <span class="keywordflow">if</span>(this-&gt;pVTKWindow) {
<a name="l00730"></a>00730         <span class="comment">// save current location and size for use in SavePrefs if app</span>
<a name="l00731"></a>00731         <span class="comment">// is closed when window is minimized</span>
<a name="l00732"></a>00732         wxRect r = GetRect();
<a name="l00733"></a>00733         <a class="code" href="prefs_8cpp.html#a26b11189d93fef33172f1a2a1d174188">mainx</a> = r.x;
<a name="l00734"></a>00734         <a class="code" href="prefs_8cpp.html#a8b015efaa4cb16287077ac74b60ad67a">mainy</a> = r.y;
<a name="l00735"></a>00735         <a class="code" href="prefs_8cpp.html#a7b08ad54bec54f213c5ed4c1d8749548">mainwd</a> = r.width;
<a name="l00736"></a>00736         <a class="code" href="prefs_8cpp.html#afd8ee1110367c04cc21e2219607b7a7b">mainht</a> = r.height;
<a name="l00737"></a>00737     }
<a name="l00738"></a>00738 <span class="preprocessor">#endif</span>
<a name="l00739"></a>00739 <span class="preprocessor"></span>
<a name="l00740"></a>00740     <span class="comment">// trigger a redraw</span>
<a name="l00741"></a>00741     <span class="keywordflow">if</span>(this-&gt;pVTKWindow) this-&gt;pVTKWindow-&gt;Refresh(<span class="keyword">false</span>);
<a name="l00742"></a>00742     
<a name="l00743"></a>00743     <span class="comment">// need this to move and resize status bar in Mac app</span>
<a name="l00744"></a>00744     <span class="keyword">event</span>.Skip();
<a name="l00745"></a>00745 }
<a name="l00746"></a>00746 
<a name="l00747"></a>00747 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l00748"></a>00748 
<a name="l00749"></a><a class="code" href="classMyFrame.html#aa4f7b2abb9bcde53ea6ee6235179888d">00749</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#aa4f7b2abb9bcde53ea6ee6235179888d">MyFrame::OnScreenshot</a>(wxCommandEvent&amp; event)
<a name="l00750"></a>00750 {
<a name="l00751"></a>00751     <span class="comment">// find an unused filename</span>
<a name="l00752"></a>00752     <span class="keyword">const</span> wxString default_filename_root = _(<span class="stringliteral">&quot;Ready_screenshot_&quot;</span>);
<a name="l00753"></a>00753     <span class="keyword">const</span> wxString default_filename_ext = _T(<span class="stringliteral">&quot;png&quot;</span>);
<a name="l00754"></a>00754     <span class="keywordtype">int</span> unused_value = 0;
<a name="l00755"></a>00755     wxString filename;
<a name="l00756"></a>00756     wxString extension,folder;
<a name="l00757"></a>00757     folder = <a class="code" href="prefs_8cpp.html#aecf1f655ef78e68e956e57878e7ea48d">screenshotdir</a>;
<a name="l00758"></a>00758     <span class="keywordflow">do</span> {
<a name="l00759"></a>00759         filename = default_filename_root;
<a name="l00760"></a>00760         filename &lt;&lt; wxString::Format(_(<span class="stringliteral">&quot;%04d.&quot;</span>),unused_value) &lt;&lt; default_filename_ext;
<a name="l00761"></a>00761         unused_value++;
<a name="l00762"></a>00762     } <span class="keywordflow">while</span>(::wxFileExists(folder+_T(<span class="stringliteral">&quot;/&quot;</span>)+filename));
<a name="l00763"></a>00763 
<a name="l00764"></a>00764     <span class="comment">// ask the user for confirmation</span>
<a name="l00765"></a>00765     <span class="keywordtype">bool</span> accepted = <span class="keyword">true</span>;
<a name="l00766"></a>00766     <span class="keywordflow">do</span> {
<a name="l00767"></a>00767         filename = wxFileSelector(_(<span class="stringliteral">&quot;Specify the screenshot filename&quot;</span>),folder,filename,default_filename_ext,
<a name="l00768"></a>00768             _(<span class="stringliteral">&quot;PNG files (*.png)|*.png|JPG files (*.jpg)|*.jpg&quot;</span>),
<a name="l00769"></a>00769             wxFD_SAVE|wxFD_OVERWRITE_PROMPT);
<a name="l00770"></a>00770         <span class="keywordflow">if</span>(filename.empty()) <span class="keywordflow">return</span>; <span class="comment">// user cancelled</span>
<a name="l00771"></a>00771         <span class="comment">// validate</span>
<a name="l00772"></a>00772         wxFileName::SplitPath(filename,&amp;folder,NULL,&amp;extension);
<a name="l00773"></a>00773         <span class="keywordflow">if</span>(extension!=_T(<span class="stringliteral">&quot;png&quot;</span>) &amp;&amp; extension!=_T(<span class="stringliteral">&quot;jpg&quot;</span>))
<a name="l00774"></a>00774         {
<a name="l00775"></a>00775             wxMessageBox(_(<span class="stringliteral">&quot;Unsupported format&quot;</span>));
<a name="l00776"></a>00776             accepted = <span class="keyword">false</span>;
<a name="l00777"></a>00777         }
<a name="l00778"></a>00778     } <span class="keywordflow">while</span>(!accepted);
<a name="l00779"></a>00779 
<a name="l00780"></a>00780     <a class="code" href="prefs_8cpp.html#aecf1f655ef78e68e956e57878e7ea48d">screenshotdir</a> = folder;
<a name="l00781"></a>00781 
<a name="l00782"></a>00782     vtkSmartPointer&lt;vtkWindowToImageFilter&gt; screenshot = vtkSmartPointer&lt;vtkWindowToImageFilter&gt;::New();
<a name="l00783"></a>00783     screenshot-&gt;SetInput(this-&gt;pVTKWindow-&gt;GetRenderWindow());
<a name="l00784"></a>00784 
<a name="l00785"></a>00785     vtkSmartPointer&lt;vtkImageWriter&gt; writer;
<a name="l00786"></a>00786     <span class="keywordflow">if</span>(extension==_T(<span class="stringliteral">&quot;png&quot;</span>)) writer = vtkSmartPointer&lt;vtkPNGWriter&gt;::New();
<a name="l00787"></a>00787     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(extension==_T(<span class="stringliteral">&quot;jpg&quot;</span>)) writer = vtkSmartPointer&lt;vtkJPEGWriter&gt;::New();
<a name="l00788"></a>00788     writer-&gt;SetFileName(filename.mb_str());
<a name="l00789"></a>00789     writer-&gt;SetInputConnection(screenshot-&gt;GetOutputPort());
<a name="l00790"></a>00790     writer-&gt;Write();
<a name="l00791"></a>00791 }
<a name="l00792"></a>00792 
<a name="l00793"></a>00793 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l00794"></a>00794 
<a name="l00795"></a><a class="code" href="classMyFrame.html#a189588e62a253e87d392a42ad9da4be6">00795</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#a189588e62a253e87d392a42ad9da4be6">MyFrame::OnAddMyPatterns</a>(wxCommandEvent&amp; event)
<a name="l00796"></a>00796 {
<a name="l00797"></a>00797     <span class="comment">// first make sure the patterns pane is visible</span>
<a name="l00798"></a>00798     wxAuiPaneInfo &amp;pane = this-&gt;aui_mgr.GetPane(<a class="code" href="frame_8cpp.html#adb2d02d23949d250b57d1b3e00210c70">PaneName</a>(<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994acb63579b388e2e1b0fa5117d6bc55e08">ID::PatternsPane</a>));
<a name="l00799"></a>00799     <span class="keywordflow">if</span>(pane.IsOk() &amp;&amp; !pane.IsShown()) {
<a name="l00800"></a>00800         pane.Show();
<a name="l00801"></a>00801         this-&gt;aui_mgr.Update();
<a name="l00802"></a>00802     }
<a name="l00803"></a>00803 
<a name="l00804"></a>00804     wxDirDialog dirdlg(<span class="keyword">this</span>, _(<span class="stringliteral">&quot;Choose your pattern folder&quot;</span>), <a class="code" href="prefs_8cpp.html#a91188f84b92fb18a365b824f1d78c07f">userdir</a>, wxDD_NEW_DIR_BUTTON);
<a name="l00805"></a>00805     <span class="keywordflow">if</span> (dirdlg.ShowModal() == wxID_OK) {
<a name="l00806"></a>00806         <a class="code" href="prefs_8cpp.html#a91188f84b92fb18a365b824f1d78c07f">userdir</a> = dirdlg.GetPath();
<a name="l00807"></a>00807         this-&gt;patterns_panel-&gt;BuildTree();
<a name="l00808"></a>00808     }
<a name="l00809"></a>00809 }
<a name="l00810"></a>00810 
<a name="l00811"></a>00811 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l00812"></a>00812 
<a name="l00813"></a><a class="code" href="classMyFrame.html#a086401ec370582814bad574a1b077cfa">00813</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#a086401ec370582814bad574a1b077cfa">MyFrame::SetCurrentRDSystem</a>(<a class="code" href="classAbstractRD.html" title="Abstract base class for all reaction-diffusion systems.">AbstractRD</a>* sys)
<a name="l00814"></a>00814 {
<a name="l00815"></a>00815     <span class="keyword">delete</span> this-&gt;system;
<a name="l00816"></a>00816     this-&gt;system = sys;
<a name="l00817"></a>00817     <span class="keywordtype">int</span> iChem = <a class="code" href="utils_8cpp.html#a68e90099fe736c151fdf42384c533550">IndexFromChemicalName</a>(this-&gt;render_settings.GetProperty(<span class="stringliteral">&quot;active_chemical&quot;</span>).GetChemical());
<a name="l00818"></a>00818     iChem = min(iChem,this-&gt;system-&gt;GetNumberOfChemicals()-1); <span class="comment">// ensure is in valid range</span>
<a name="l00819"></a>00819     this-&gt;render_settings.GetProperty(<span class="stringliteral">&quot;active_chemical&quot;</span>).SetChemical(<a class="code" href="utils_8cpp.html#afd49013680a14bc8e1bfb0c79b80972f" title="a, b, c, ... z, aa, ab, ...">GetChemicalName</a>(iChem));
<a name="l00820"></a>00820     <a class="code" href="vtk__pipeline_8cpp.html#a83eef6bea304823921ff32ce0afb6d2b">InitializeVTKPipeline</a>(this-&gt;pVTKWindow,this-&gt;system,this-&gt;render_settings,<span class="keyword">true</span>);
<a name="l00821"></a>00821     this-&gt;is_running = <span class="keyword">false</span>;
<a name="l00822"></a>00822     this-&gt;info_panel-&gt;ResetPosition();
<a name="l00823"></a>00823     this-&gt;UpdateWindows();
<a name="l00824"></a>00824 }
<a name="l00825"></a>00825 
<a name="l00826"></a>00826 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l00827"></a>00827 
<a name="l00828"></a><a class="code" href="classMyFrame.html#a74e7806af7f4ab7204f6b7e3b27fe6d9">00828</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#a74e7806af7f4ab7204f6b7e3b27fe6d9">MyFrame::UpdateWindowTitle</a>()
<a name="l00829"></a>00829 {
<a name="l00830"></a>00830     wxString name = this-&gt;system-&gt;GetFilename();
<a name="l00831"></a>00831     <span class="keywordflow">if</span> (name.IsEmpty()) {
<a name="l00832"></a>00832         <span class="comment">// this should probably never happen</span>
<a name="l00833"></a>00833         name = _(<span class="stringliteral">&quot;unknown&quot;</span>);
<a name="l00834"></a>00834     } <span class="keywordflow">else</span> {
<a name="l00835"></a>00835         <span class="comment">// just show file&#39;s name, not full path</span>
<a name="l00836"></a>00836         name = name.AfterLast(wxFILE_SEP_PATH);
<a name="l00837"></a>00837     }
<a name="l00838"></a>00838     
<a name="l00839"></a>00839     <span class="keywordflow">if</span> (this-&gt;system-&gt;IsModified()) {
<a name="l00840"></a>00840         <span class="comment">// prepend asterisk to indicate the current system has been modified</span>
<a name="l00841"></a>00841         <span class="comment">// (this is consistent with Golly and other Win/Linux apps)</span>
<a name="l00842"></a>00842         name = _T(<span class="stringliteral">&quot;*&quot;</span>) + name;
<a name="l00843"></a>00843     }
<a name="l00844"></a>00844     
<a name="l00845"></a>00845 <span class="preprocessor">    #ifdef __WXMAC__</span>
<a name="l00846"></a>00846 <span class="preprocessor"></span>        <span class="comment">// Mac apps don&#39;t show app name in window title</span>
<a name="l00847"></a>00847         this-&gt;SetTitle(name);
<a name="l00848"></a>00848 <span class="preprocessor">    #else</span>
<a name="l00849"></a>00849 <span class="preprocessor"></span>        <span class="comment">// Win/Linux apps usually append the app name to the file name</span>
<a name="l00850"></a>00850         this-&gt;SetTitle(name + _T(<span class="stringliteral">&quot; - Ready&quot;</span>));
<a name="l00851"></a>00851 <span class="preprocessor">    #endif</span>
<a name="l00852"></a>00852 <span class="preprocessor"></span>}
<a name="l00853"></a>00853 
<a name="l00854"></a>00854 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l00855"></a>00855 
<a name="l00856"></a><a class="code" href="classMyFrame.html#af51a2749c9de332c8af5fdb0e8cf7166">00856</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#af51a2749c9de332c8af5fdb0e8cf7166">MyFrame::UpdateWindows</a>()
<a name="l00857"></a>00857 {
<a name="l00858"></a>00858     this-&gt;SetStatusBarText();
<a name="l00859"></a>00859     this-&gt;UpdateInfoPane();
<a name="l00860"></a>00860     this-&gt;UpdateWindowTitle();
<a name="l00861"></a>00861     this-&gt;UpdateToolbars();
<a name="l00862"></a>00862     this-&gt;Refresh(<span class="keyword">false</span>);
<a name="l00863"></a>00863 }
<a name="l00864"></a>00864 
<a name="l00865"></a>00865 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l00866"></a>00866 
<a name="l00867"></a><a class="code" href="classMyFrame.html#a6ef220dbc111e7954d43a079c7a0ef31">00867</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#a6ef220dbc111e7954d43a079c7a0ef31">MyFrame::OnStep</a>(wxCommandEvent&amp; event)
<a name="l00868"></a>00868 {
<a name="l00869"></a>00869     <span class="keywordflow">if</span> (this-&gt;is_running)
<a name="l00870"></a>00870         <span class="keywordflow">return</span>;
<a name="l00871"></a>00871     
<a name="l00872"></a>00872     <span class="keywordflow">if</span> (this-&gt;system-&gt;GetTimestepsTaken() == 0)
<a name="l00873"></a>00873     {
<a name="l00874"></a>00874         this-&gt;system-&gt;SaveStartingPattern();
<a name="l00875"></a>00875     
<a name="l00876"></a>00876         <span class="comment">// reset the initial number of steps used by system-&gt;Update in OnIdle</span>
<a name="l00877"></a>00877         num_steps = 50;
<a name="l00878"></a>00878         <span class="comment">// 50 is half the initial timesteps_per_render value used in most</span>
<a name="l00879"></a>00879         <span class="comment">// pattern files, but really we could choose any small number &gt; 0</span>
<a name="l00880"></a>00880     }
<a name="l00881"></a>00881 
<a name="l00882"></a>00882     <span class="keywordflow">try</span>
<a name="l00883"></a>00883     {
<a name="l00884"></a>00884         <span class="keywordflow">if</span> (event.GetId() == <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a29ce194c83647cde2066a129499a28b1">ID::Step1</a>) {
<a name="l00885"></a>00885             this-&gt;system-&gt;Update(1);
<a name="l00886"></a>00886         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (event.GetId() == <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994aabc39ee10e4d33f32ba11dd7773ad781">ID::StepN</a>) {
<a name="l00887"></a>00887             <span class="comment">// timesteps_per_render might be huge, so don&#39;t do this:</span>
<a name="l00888"></a>00888             <span class="comment">// this-&gt;system-&gt;Update(this-&gt;render_settings.GetProperty(&quot;timesteps_per_render&quot;).GetInt());</span>
<a name="l00889"></a>00889             <span class="comment">// instead we let OnIdle do the stepping, but stop at next render</span>
<a name="l00890"></a>00890             this-&gt;is_running = <span class="keyword">true</span>;
<a name="l00891"></a>00891             steps_since_last_render = 0;
<a name="l00892"></a>00892             accumulated_time = 0.0;
<a name="l00893"></a>00893             do_one_render = <span class="keyword">true</span>;
<a name="l00894"></a>00894         }
<a name="l00895"></a>00895     }
<a name="l00896"></a>00896     <span class="keywordflow">catch</span>(<span class="keyword">const</span> exception&amp; e)
<a name="l00897"></a>00897     {
<a name="l00898"></a>00898         <a class="code" href="classMonospaceMessageBox.html">MonospaceMessageBox</a>(_(<span class="stringliteral">&quot;An error occurred when running the simulation:\n\n&quot;</span>)+wxString(e.what(),wxConvUTF8),_(<span class="stringliteral">&quot;Error&quot;</span>),wxART_ERROR);
<a name="l00899"></a>00899     }
<a name="l00900"></a>00900     <span class="keywordflow">catch</span>(...)
<a name="l00901"></a>00901     {
<a name="l00902"></a>00902         wxMessageBox(_(<span class="stringliteral">&quot;An unknown error occurred when running the simulation&quot;</span>));
<a name="l00903"></a>00903     }
<a name="l00904"></a>00904     
<a name="l00905"></a>00905     this-&gt;SetStatusBarText();
<a name="l00906"></a>00906     Refresh(<span class="keyword">false</span>);
<a name="l00907"></a>00907 }
<a name="l00908"></a>00908 
<a name="l00909"></a>00909 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l00910"></a>00910 
<a name="l00911"></a><a class="code" href="classMyFrame.html#a6ddede5bb58b853a17e7635a17e2612b">00911</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#a6ddede5bb58b853a17e7635a17e2612b">MyFrame::OnUpdateStep</a>(wxUpdateUIEvent&amp; event)
<a name="l00912"></a>00912 {
<a name="l00913"></a>00913     <span class="comment">// Step1 or StepN</span>
<a name="l00914"></a>00914     <span class="keyword">event</span>.Enable(!this-&gt;is_running);
<a name="l00915"></a>00915 }
<a name="l00916"></a>00916 
<a name="l00917"></a>00917 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l00918"></a>00918 
<a name="l00919"></a><a class="code" href="classMyFrame.html#a876746aaf753afa88cc773b27ec92004">00919</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#a876746aaf753afa88cc773b27ec92004">MyFrame::OnRunStop</a>(wxCommandEvent&amp; event)
<a name="l00920"></a>00920 {
<a name="l00921"></a>00921     <span class="keywordflow">if</span> (this-&gt;is_running) {
<a name="l00922"></a>00922         this-&gt;is_running = <span class="keyword">false</span>;
<a name="l00923"></a>00923         this-&gt;SetStatusBarText();
<a name="l00924"></a>00924     } <span class="keywordflow">else</span> {
<a name="l00925"></a>00925         this-&gt;is_running = <span class="keyword">true</span>;
<a name="l00926"></a>00926     }
<a name="l00927"></a>00927     this-&gt;UpdateToolbars();
<a name="l00928"></a>00928     Refresh(<span class="keyword">false</span>);
<a name="l00929"></a>00929     
<a name="l00930"></a>00930     <span class="keywordflow">if</span> (this-&gt;is_running) {
<a name="l00931"></a>00931         <span class="keywordflow">if</span> (this-&gt;system-&gt;GetTimestepsTaken() == 0)
<a name="l00932"></a>00932         {
<a name="l00933"></a>00933             this-&gt;system-&gt;SaveStartingPattern();
<a name="l00934"></a>00934     
<a name="l00935"></a>00935             <span class="comment">// reset the initial number of steps used by system-&gt;Update in OnIdle</span>
<a name="l00936"></a>00936             num_steps = 50;
<a name="l00937"></a>00937             <span class="comment">// 50 is half the initial timesteps_per_render value used in most</span>
<a name="l00938"></a>00938             <span class="comment">// pattern files, but really we could choose any small number &gt; 0</span>
<a name="l00939"></a>00939         }
<a name="l00940"></a>00940         steps_since_last_render = 0;
<a name="l00941"></a>00941         accumulated_time = 0.0;
<a name="l00942"></a>00942         do_one_render = <span class="keyword">false</span>;
<a name="l00943"></a>00943     }
<a name="l00944"></a>00944 }
<a name="l00945"></a>00945 
<a name="l00946"></a>00946 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l00947"></a>00947 
<a name="l00948"></a><a class="code" href="classMyFrame.html#ad413507c0c9ddd8aedebfbb2bc86b8f8">00948</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#ad413507c0c9ddd8aedebfbb2bc86b8f8">MyFrame::OnUpdateRunStop</a>(wxUpdateUIEvent&amp; event)
<a name="l00949"></a>00949 {
<a name="l00950"></a>00950     wxMenuBar* mbar = GetMenuBar();
<a name="l00951"></a>00951     <span class="keywordflow">if</span> (mbar) {
<a name="l00952"></a>00952         <span class="keywordflow">if</span> (this-&gt;is_running) {
<a name="l00953"></a>00953             mbar-&gt;SetLabel(<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a7fa86a9ca58943a68ee72c2278d7091f">ID::RunStop</a>, _(<span class="stringliteral">&quot;Stop&quot;</span>) + <a class="code" href="prefs_8cpp.html#ab9798965988e2083acef3da70016317f">GetAccelerator</a>(<a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62ad6773bc2d8b3a475b59775af5afc215c">DO_RUNSTOP</a>));
<a name="l00954"></a>00954             mbar-&gt;SetHelpString(<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a7fa86a9ca58943a68ee72c2278d7091f">ID::RunStop</a>,_(<span class="stringliteral">&quot;Stop running the simulation&quot;</span>));
<a name="l00955"></a>00955         } <span class="keywordflow">else</span> {
<a name="l00956"></a>00956             mbar-&gt;SetLabel(<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a7fa86a9ca58943a68ee72c2278d7091f">ID::RunStop</a>, _(<span class="stringliteral">&quot;Run&quot;</span>) + <a class="code" href="prefs_8cpp.html#ab9798965988e2083acef3da70016317f">GetAccelerator</a>(<a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62ad6773bc2d8b3a475b59775af5afc215c">DO_RUNSTOP</a>));
<a name="l00957"></a>00957             mbar-&gt;SetHelpString(<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a7fa86a9ca58943a68ee72c2278d7091f">ID::RunStop</a>,_(<span class="stringliteral">&quot;Start running the simulation&quot;</span>));
<a name="l00958"></a>00958         }
<a name="l00959"></a>00959     }
<a name="l00960"></a>00960 }
<a name="l00961"></a>00961 
<a name="l00962"></a>00962 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l00963"></a>00963 
<a name="l00964"></a><a class="code" href="classMyFrame.html#ac2f496c3047e2e16f892a8eedecdc945">00964</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#ac2f496c3047e2e16f892a8eedecdc945">MyFrame::UpdateToolbars</a>()
<a name="l00965"></a>00965 {
<a name="l00966"></a>00966     this-&gt;action_toolbar-&gt;FindTool(<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a7fa86a9ca58943a68ee72c2278d7091f">ID::RunStop</a>)-&gt;SetBitmap( 
<a name="l00967"></a>00967         this-&gt;is_running ? wxArtProvider::GetBitmap(wxART_CROSS_MARK,wxART_TOOLBAR)
<a name="l00968"></a>00968                          : wxArtProvider::GetBitmap(wxART_GO_FORWARD,wxART_TOOLBAR) );
<a name="l00969"></a>00969     
<a name="l00970"></a>00970     this-&gt;action_toolbar-&gt;FindTool(<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a7fa86a9ca58943a68ee72c2278d7091f">ID::RunStop</a>)-&gt;SetShortHelp( 
<a name="l00971"></a>00971         this-&gt;is_running ? _(<span class="stringliteral">&quot;Stop running the simulation&quot;</span>)
<a name="l00972"></a>00972                          : _(<span class="stringliteral">&quot;Start running the simulation&quot;</span>) );
<a name="l00973"></a>00973 }
<a name="l00974"></a>00974 
<a name="l00975"></a>00975 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l00976"></a>00976 
<a name="l00977"></a><a class="code" href="classMyFrame.html#ae2229e75383faa860ed7fa15f5069a5f">00977</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#ae2229e75383faa860ed7fa15f5069a5f">MyFrame::OnReset</a>(wxCommandEvent&amp; event)
<a name="l00978"></a>00978 {
<a name="l00979"></a>00979     <span class="keywordflow">if</span>(this-&gt;system-&gt;GetTimestepsTaken() &gt; 0) 
<a name="l00980"></a>00980     {
<a name="l00981"></a>00981         <span class="comment">// restore pattern and other info saved by SaveStartingPattern() which</span>
<a name="l00982"></a>00982         <span class="comment">// was called in OnStep/OnRunStop when GetTimestepsTaken() was 0</span>
<a name="l00983"></a>00983         this-&gt;system-&gt;RestoreStartingPattern();
<a name="l00984"></a>00984         this-&gt;is_running = <span class="keyword">false</span>;
<a name="l00985"></a>00985         this-&gt;UpdateWindows();
<a name="l00986"></a>00986     }
<a name="l00987"></a>00987 }
<a name="l00988"></a>00988 
<a name="l00989"></a>00989 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l00990"></a>00990 
<a name="l00991"></a><a class="code" href="classMyFrame.html#a3e48390dfa340659c39155d9f7a0285c">00991</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#a3e48390dfa340659c39155d9f7a0285c">MyFrame::OnUpdateReset</a>(wxUpdateUIEvent&amp; event)
<a name="l00992"></a>00992 {
<a name="l00993"></a>00993     <span class="keyword">event</span>.Enable(this-&gt;system-&gt;GetTimestepsTaken() &gt; 0);
<a name="l00994"></a>00994 }
<a name="l00995"></a>00995 
<a name="l00996"></a>00996 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l00997"></a>00997 
<a name="l00998"></a><a class="code" href="classMyFrame.html#a8f3b6893451e61b3b547ca20772cb982">00998</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#a8f3b6893451e61b3b547ca20772cb982">MyFrame::CheckFocus</a>()
<a name="l00999"></a>00999 {
<a name="l01000"></a>01000     <span class="comment">// ensure one of our panes has the focus so keyboard shortcuts always work</span>
<a name="l01001"></a>01001     <span class="keywordflow">if</span> ( this-&gt;pVTKWindow-&gt;HasFocus() ||
<a name="l01002"></a>01002          this-&gt;patterns_panel-&gt;TreeHasFocus() ||
<a name="l01003"></a>01003          this-&gt;info_panel-&gt;HtmlHasFocus() ||
<a name="l01004"></a>01004          this-&gt;help_panel-&gt;HtmlHasFocus() ) {
<a name="l01005"></a>01005         <span class="comment">// good, no need to change focus</span>
<a name="l01006"></a>01006     } <span class="keywordflow">else</span> {
<a name="l01007"></a>01007         <span class="comment">// best to restore focus to render window</span>
<a name="l01008"></a>01008         this-&gt;pVTKWindow-&gt;SetFocus();
<a name="l01009"></a>01009     }
<a name="l01010"></a>01010 }
<a name="l01011"></a>01011 
<a name="l01012"></a>01012 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l01013"></a>01013 
<a name="l01014"></a><a class="code" href="classMyFrame.html#a58d9c1d5b2197bfac0be4a55ccc3efa7">01014</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#a58d9c1d5b2197bfac0be4a55ccc3efa7">MyFrame::OnIdle</a>(wxIdleEvent&amp; event)
<a name="l01015"></a>01015 {
<a name="l01016"></a>01016 <span class="preprocessor">    #ifdef __WXMAC__</span>
<a name="l01017"></a>01017 <span class="preprocessor"></span>        <span class="comment">// do NOT do this in the Win app (buttons in Info/Help pane won&#39;t work)</span>
<a name="l01018"></a>01018         <span class="keywordflow">if</span> (this-&gt;IsActive()) this-&gt;CheckFocus();
<a name="l01019"></a>01019 <span class="preprocessor">    #endif</span>
<a name="l01020"></a>01020 <span class="preprocessor"></span>    
<a name="l01021"></a>01021     <span class="comment">// we drive our simulation loop via idle events</span>
<a name="l01022"></a>01022     <span class="keywordflow">if</span> (this-&gt;is_running)
<a name="l01023"></a>01023     {
<a name="l01024"></a>01024         <span class="comment">// ensure num_steps &lt;= timesteps_per_render</span>
<a name="l01025"></a>01025         <span class="keywordtype">int</span> timesteps_per_render = this-&gt;render_settings.GetProperty(<span class="stringliteral">&quot;timesteps_per_render&quot;</span>).GetInt();
<a name="l01026"></a>01026         <span class="keywordflow">if</span> (num_steps &gt; timesteps_per_render) num_steps = timesteps_per_render;
<a name="l01027"></a>01027 
<a name="l01028"></a>01028         <span class="comment">// use temp_steps for the actual system-&gt;Update call because it might be &lt; num_steps</span>
<a name="l01029"></a>01029         <span class="keywordtype">int</span> temp_steps = num_steps;
<a name="l01030"></a>01030         <span class="keywordflow">if</span> (steps_since_last_render + temp_steps &gt; timesteps_per_render) {
<a name="l01031"></a>01031             <span class="comment">// do final steps of this rendering phase</span>
<a name="l01032"></a>01032             temp_steps = timesteps_per_render - steps_since_last_render;
<a name="l01033"></a>01033         }
<a name="l01034"></a>01034         
<a name="l01035"></a>01035         <span class="keywordtype">double</span> time_before = <a class="code" href="utils_8cpp.html#a1287a1eb9d39297d5f181e01acc9de18">get_time_in_seconds</a>();
<a name="l01036"></a>01036         
<a name="l01037"></a>01037         <span class="keywordflow">try</span> 
<a name="l01038"></a>01038         {
<a name="l01039"></a>01039             this-&gt;system-&gt;Update(temp_steps);
<a name="l01040"></a>01040         }
<a name="l01041"></a>01041         <span class="keywordflow">catch</span>(<span class="keyword">const</span> exception&amp; e)
<a name="l01042"></a>01042         {
<a name="l01043"></a>01043             this-&gt;is_running = <span class="keyword">false</span>;
<a name="l01044"></a>01044             this-&gt;SetStatusBarText();
<a name="l01045"></a>01045             this-&gt;UpdateToolbars();
<a name="l01046"></a>01046             <a class="code" href="classMonospaceMessageBox.html">MonospaceMessageBox</a>(_(<span class="stringliteral">&quot;An error occurred when running the simulation:\n\n&quot;</span>)+wxString(e.what(),wxConvUTF8),_(<span class="stringliteral">&quot;Error&quot;</span>),wxART_ERROR);
<a name="l01047"></a>01047         }
<a name="l01048"></a>01048         <span class="keywordflow">catch</span>(...)
<a name="l01049"></a>01049         {
<a name="l01050"></a>01050             this-&gt;is_running = <span class="keyword">false</span>;
<a name="l01051"></a>01051             this-&gt;SetStatusBarText();
<a name="l01052"></a>01052             this-&gt;UpdateToolbars();
<a name="l01053"></a>01053             wxMessageBox(_(<span class="stringliteral">&quot;An unknown error occurred when running the simulation&quot;</span>));
<a name="l01054"></a>01054         }
<a name="l01055"></a>01055         
<a name="l01056"></a>01056         <span class="keywordtype">double</span> time_diff = <a class="code" href="utils_8cpp.html#a1287a1eb9d39297d5f181e01acc9de18">get_time_in_seconds</a>() - time_before;
<a name="l01057"></a>01057         
<a name="l01058"></a>01058         <span class="comment">// note that we don&#39;t change num_steps if temp_steps &lt; num_steps</span>
<a name="l01059"></a>01059         <span class="keywordflow">if</span> (num_steps == temp_steps) {
<a name="l01060"></a>01060             <span class="comment">// if the above system-&gt;Update was quick then we&#39;ll use more steps in the next call,</span>
<a name="l01061"></a>01061             <span class="comment">// otherwise we&#39;ll use less steps so that the app remains responsive</span>
<a name="l01062"></a>01062             <span class="keywordflow">if</span> (time_diff &lt; 0.1) {
<a name="l01063"></a>01063                 num_steps *= 2;
<a name="l01064"></a>01064                 <span class="keywordflow">if</span> (num_steps &gt; timesteps_per_render) num_steps = timesteps_per_render;
<a name="l01065"></a>01065             } <span class="keywordflow">else</span> {
<a name="l01066"></a>01066                 num_steps /= 2;
<a name="l01067"></a>01067                 <span class="keywordflow">if</span> (num_steps &lt; 1) num_steps = 1;
<a name="l01068"></a>01068             }
<a name="l01069"></a>01069         }
<a name="l01070"></a>01070         
<a name="l01071"></a>01071         accumulated_time += time_diff;
<a name="l01072"></a>01072         steps_since_last_render += temp_steps;
<a name="l01073"></a>01073         
<a name="l01074"></a>01074         <span class="keywordflow">if</span> (steps_since_last_render &gt;= timesteps_per_render) {
<a name="l01075"></a>01075             <span class="comment">// it&#39;s time to render what we&#39;ve computed so far</span>
<a name="l01076"></a>01076             <span class="keywordtype">int</span> n_cells = this-&gt;system-&gt;GetNumberOfCells();
<a name="l01077"></a>01077             <span class="keywordflow">if</span> (accumulated_time == 0.0)
<a name="l01078"></a>01078                 accumulated_time = 0.000001;  <span class="comment">// unlikely, but play safe</span>
<a name="l01079"></a>01079             this-&gt;frames_per_second = steps_since_last_render / accumulated_time;
<a name="l01080"></a>01080             this-&gt;million_cell_generations_per_second = this-&gt;frames_per_second * n_cells / 1e6;
<a name="l01081"></a>01081        
<a name="l01082"></a>01082             this-&gt;pVTKWindow-&gt;Refresh(<span class="keyword">false</span>);
<a name="l01083"></a>01083             this-&gt;SetStatusBarText();
<a name="l01084"></a>01084             
<a name="l01085"></a>01085             <span class="keywordflow">if</span> (do_one_render) {
<a name="l01086"></a>01086                 <span class="comment">// user selected Step by N so stop now</span>
<a name="l01087"></a>01087                 this-&gt;is_running = <span class="keyword">false</span>;
<a name="l01088"></a>01088                 this-&gt;SetStatusBarText();
<a name="l01089"></a>01089                 this-&gt;UpdateToolbars();
<a name="l01090"></a>01090             } <span class="keywordflow">else</span> {
<a name="l01091"></a>01091                 <span class="comment">// keep simulating</span>
<a name="l01092"></a>01092                 steps_since_last_render = 0;
<a name="l01093"></a>01093                 accumulated_time = 0.0;
<a name="l01094"></a>01094             }
<a name="l01095"></a>01095         }
<a name="l01096"></a>01096         
<a name="l01097"></a>01097         <span class="keyword">event</span>.RequestMore(); <span class="comment">// trigger another idle event</span>
<a name="l01098"></a>01098     }
<a name="l01099"></a>01099     
<a name="l01100"></a>01100     <span class="keyword">event</span>.Skip();
<a name="l01101"></a>01101 }
<a name="l01102"></a>01102 
<a name="l01103"></a>01103 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l01104"></a>01104 
<a name="l01105"></a><a class="code" href="classMyFrame.html#a096a2bc6cbb76046bc4e3a15c1ee7183">01105</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#a096a2bc6cbb76046bc4e3a15c1ee7183">MyFrame::SetStatusBarText</a>()
<a name="l01106"></a>01106 {
<a name="l01107"></a>01107     wxString txt;
<a name="l01108"></a>01108     <span class="keywordflow">if</span>(this-&gt;is_running) txt &lt;&lt; _(<span class="stringliteral">&quot;Running.&quot;</span>);
<a name="l01109"></a>01109     <span class="keywordflow">else</span> txt &lt;&lt; _(<span class="stringliteral">&quot;Stopped.&quot;</span>);
<a name="l01110"></a>01110     txt &lt;&lt; _(<span class="stringliteral">&quot; Timesteps: &quot;</span>) &lt;&lt; this-&gt;system-&gt;GetTimestepsTaken();
<a name="l01111"></a>01111     txt &lt;&lt; _T(<span class="stringliteral">&quot;   (&quot;</span>) &lt;&lt; wxString::Format(_T(<span class="stringliteral">&quot;%.0f&quot;</span>),this-&gt;frames_per_second)
<a name="l01112"></a>01112         &lt;&lt; _(<span class="stringliteral">&quot; computed frames per second, &quot;</span>)
<a name="l01113"></a>01113         &lt;&lt; wxString::Format(_T(<span class="stringliteral">&quot;%.0f&quot;</span>),this-&gt;million_cell_generations_per_second)
<a name="l01114"></a>01114         &lt;&lt; _T(<span class="stringliteral">&quot; mcgs)&quot;</span>);
<a name="l01115"></a>01115     <span class="comment">/* DEBUG</span>
<a name="l01116"></a>01116 <span class="comment">    txt &lt;&lt; wxString::Format(_T(&quot;  num_steps=%d&quot;), num_steps)</span>
<a name="l01117"></a>01117 <span class="comment">        &lt;&lt; wxString::Format(_T(&quot;  tpr=%d&quot;), this-&gt;render_settings.GetProperty(&quot;timesteps_per_render&quot;).GetInt());</span>
<a name="l01118"></a>01118 <span class="comment">    */</span>
<a name="l01119"></a>01119     SetStatusText(txt);
<a name="l01120"></a>01120 }
<a name="l01121"></a>01121 
<a name="l01122"></a>01122 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l01123"></a>01123 
<a name="l01124"></a><a class="code" href="classMyFrame.html#a56f2c479de5f3c59ffb2bc1e2cb78bc7">01124</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#a56f2c479de5f3c59ffb2bc1e2cb78bc7">MyFrame::OnRestoreDefaultPerspective</a>(wxCommandEvent&amp; event)
<a name="l01125"></a>01125 {
<a name="l01126"></a>01126     this-&gt;aui_mgr.LoadPerspective(this-&gt;default_perspective);
<a name="l01127"></a>01127 }
<a name="l01128"></a>01128 
<a name="l01129"></a>01129 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l01130"></a>01130 
<a name="l01131"></a><a class="code" href="classMyFrame.html#aafe47efa230f33628ceae2aebe3394cc">01131</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#aafe47efa230f33628ceae2aebe3394cc">MyFrame::OnGenerateInitialPattern</a>(wxCommandEvent&amp; event)
<a name="l01132"></a>01132 {
<a name="l01133"></a>01133     <span class="keywordflow">try</span>
<a name="l01134"></a>01134     {
<a name="l01135"></a>01135         this-&gt;system-&gt;GenerateInitialPattern();
<a name="l01136"></a>01136     }
<a name="l01137"></a>01137     <span class="keywordflow">catch</span>(<span class="keyword">const</span> exception&amp; e)
<a name="l01138"></a>01138     {
<a name="l01139"></a>01139         <a class="code" href="classMonospaceMessageBox.html">MonospaceMessageBox</a>(_(<span class="stringliteral">&quot;Generating an initial pattern caused an error:\n\n&quot;</span>)+wxString(e.what(),wxConvUTF8),_(<span class="stringliteral">&quot;Error&quot;</span>),wxART_ERROR);
<a name="l01140"></a>01140     }
<a name="l01141"></a>01141     <span class="keywordflow">catch</span>(...)
<a name="l01142"></a>01142     {
<a name="l01143"></a>01143         wxMessageBox(_(<span class="stringliteral">&quot;Generating an initial pattern caused an unknown error&quot;</span>));
<a name="l01144"></a>01144     }
<a name="l01145"></a>01145     <span class="comment">// (we allow the user to proceed because they might now want to change other things to match)</span>
<a name="l01146"></a>01146 
<a name="l01147"></a>01147     this-&gt;is_running = <span class="keyword">false</span>;
<a name="l01148"></a>01148     this-&gt;UpdateWindows();
<a name="l01149"></a>01149 }
<a name="l01150"></a>01150 
<a name="l01151"></a>01151 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l01152"></a>01152 
<a name="l01153"></a><a class="code" href="classMyFrame.html#afa0f14ee2bdd4f9fb69d66315e056384">01153</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#afa0f14ee2bdd4f9fb69d66315e056384">MyFrame::OnSelectOpenCLDevice</a>(wxCommandEvent&amp; event)
<a name="l01154"></a>01154 {
<a name="l01155"></a>01155     <span class="comment">// TODO: merge this with GetOpenCL diagnostics?</span>
<a name="l01156"></a>01156     wxArrayString choices;
<a name="l01157"></a>01157     <span class="keywordtype">int</span> iOldSelection;
<a name="l01158"></a>01158     <span class="keywordtype">int</span> np;
<a name="l01159"></a>01159     <span class="keywordflow">try</span> 
<a name="l01160"></a>01160     {
<a name="l01161"></a>01161         np = <a class="code" href="namespaceOpenCL__utils.html#a17e5ec4397c2d70c8430f17ec53d83d5" title="Returns the number of OpenCL platforms (from vendors) that are available.">GetNumberOfPlatforms</a>();
<a name="l01162"></a>01162     }
<a name="l01163"></a>01163     <span class="keywordflow">catch</span>(<span class="keyword">const</span> exception&amp; e)
<a name="l01164"></a>01164     {
<a name="l01165"></a>01165         wxMessageBox(_(<span class="stringliteral">&quot;OpenCL not available: &quot;</span>)+
<a name="l01166"></a>01166             wxString(e.what(),wxConvUTF8));
<a name="l01167"></a>01167         <span class="keywordflow">return</span>;
<a name="l01168"></a>01168     }
<a name="l01169"></a>01169     <span class="keywordflow">catch</span>(...)
<a name="l01170"></a>01170     {
<a name="l01171"></a>01171         wxMessageBox(_(<span class="stringliteral">&quot;OpenCL not available&quot;</span>));
<a name="l01172"></a>01172         <span class="keywordflow">return</span>;
<a name="l01173"></a>01173     }
<a name="l01174"></a>01174     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> ip=0;ip&lt;np;ip++)
<a name="l01175"></a>01175     {
<a name="l01176"></a>01176         <span class="keywordtype">int</span> nd = <a class="code" href="namespaceOpenCL__utils.html#ae182ffd5ff716e80e9d19dd3b2409daf" title="Returns the number of OpenCL devices available on this platform.">GetNumberOfDevices</a>(ip);
<a name="l01177"></a>01177         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> <span class="keywordtype">id</span>=0;<span class="keywordtype">id</span>&lt;nd;<span class="keywordtype">id</span>++)
<a name="l01178"></a>01178         {
<a name="l01179"></a>01179             <span class="keywordflow">if</span>(ip==<a class="code" href="prefs_8cpp.html#a0de6a378ca700dd877cab59c65ba2f7b">opencl_platform</a> &amp;&amp; <span class="keywordtype">id</span>==<a class="code" href="prefs_8cpp.html#a11d0cbab21425e351638f4bf2cc72874">opencl_device</a>)
<a name="l01180"></a>01180                 iOldSelection = (int)choices.size();
<a name="l01181"></a>01181             wxString s(<a class="code" href="namespaceOpenCL__utils.html#a8d16f21d70ff47eeeefa7f8b3f3e897c" title="Returns a description of this platform.">GetPlatformDescription</a>(ip).c_str(),wxConvUTF8);
<a name="l01182"></a>01182             s &lt;&lt; _T(<span class="stringliteral">&quot; : &quot;</span>) &lt;&lt; wxString(<a class="code" href="namespaceOpenCL__utils.html#a7ad04228a76befc69c19c55b15aca091" title="Returns a description of this device.">GetDeviceDescription</a>(ip,<span class="keywordtype">id</span>).c_str(),wxConvUTF8);
<a name="l01183"></a>01183             choices.Add(s);
<a name="l01184"></a>01184         }
<a name="l01185"></a>01185     }
<a name="l01186"></a>01186     wxSingleChoiceDialog dlg(<span class="keyword">this</span>,_(<span class="stringliteral">&quot;Select the OpenCL device to use:&quot;</span>),_(<span class="stringliteral">&quot;Select OpenCL device&quot;</span>),
<a name="l01187"></a>01187         choices);
<a name="l01188"></a>01188     dlg.SetSelection(iOldSelection);
<a name="l01189"></a>01189     <span class="keywordflow">if</span>(dlg.ShowModal()!=wxID_OK) <span class="keywordflow">return</span>;
<a name="l01190"></a>01190     <span class="keywordtype">int</span> iNewSelection = dlg.GetSelection();
<a name="l01191"></a>01191     <span class="keywordflow">if</span>(iNewSelection != iOldSelection)
<a name="l01192"></a>01192         wxMessageBox(_(<span class="stringliteral">&quot;The selected device will be used the next time an OpenCL pattern is loaded.&quot;</span>));
<a name="l01193"></a>01193     <span class="keywordtype">int</span> dc = 0;
<a name="l01194"></a>01194     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> ip=0;ip&lt;np;ip++)
<a name="l01195"></a>01195     {
<a name="l01196"></a>01196         <span class="keywordtype">int</span> nd = <a class="code" href="namespaceOpenCL__utils.html#ae182ffd5ff716e80e9d19dd3b2409daf" title="Returns the number of OpenCL devices available on this platform.">GetNumberOfDevices</a>(ip);
<a name="l01197"></a>01197         <span class="keywordflow">if</span>(iNewSelection &lt; nd)
<a name="l01198"></a>01198         {
<a name="l01199"></a>01199             <a class="code" href="prefs_8cpp.html#a0de6a378ca700dd877cab59c65ba2f7b">opencl_platform</a> = ip;
<a name="l01200"></a>01200             <a class="code" href="prefs_8cpp.html#a11d0cbab21425e351638f4bf2cc72874">opencl_device</a> = iNewSelection;
<a name="l01201"></a>01201             <span class="keywordflow">break</span>;
<a name="l01202"></a>01202         }
<a name="l01203"></a>01203         iNewSelection -= nd;
<a name="l01204"></a>01204     }
<a name="l01205"></a>01205     <span class="comment">// TODO: hot-change the current RD system</span>
<a name="l01206"></a>01206 }
<a name="l01207"></a>01207 
<a name="l01208"></a>01208 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l01209"></a>01209 
<a name="l01210"></a><a class="code" href="classMyFrame.html#a63b23742f9322a0ae726aa2a29eae96d">01210</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#a63b23742f9322a0ae726aa2a29eae96d">MyFrame::OnHelp</a>(wxCommandEvent&amp; event)
<a name="l01211"></a>01211 {
<a name="l01212"></a>01212     <span class="keywordtype">int</span> <span class="keywordtype">id</span> = <span class="keyword">event</span>.GetId();
<a name="l01213"></a>01213     <span class="keywordflow">switch</span> (<span class="keywordtype">id</span>)
<a name="l01214"></a>01214     {
<a name="l01215"></a>01215         <span class="keywordflow">case</span> wxID_HELP:         this-&gt;help_panel-&gt;ShowHelp(_(<span class="stringliteral">&quot;Help/index.html&quot;</span>)); <span class="keywordflow">break</span>;
<a name="l01216"></a>01216         <span class="keywordflow">case</span> <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994ae4da177bc93aa9c32cd1c4c7e5df05f7">ID::HelpQuick</a>:     this-&gt;help_panel-&gt;ShowHelp(_(<span class="stringliteral">&quot;Help/quickstart.html&quot;</span>)); <span class="keywordflow">break</span>;
<a name="l01217"></a>01217         <span class="keywordflow">case</span> <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a2e16df9987ffe628f9c3379f468762b4">ID::HelpTips</a>:      this-&gt;help_panel-&gt;ShowHelp(_(<span class="stringliteral">&quot;Help/tips.html&quot;</span>)); <span class="keywordflow">break</span>;
<a name="l01218"></a>01218         <span class="keywordflow">case</span> <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a19e87388929f7a4f3d961de8105c5f6d">ID::HelpKeyboard</a>:  this-&gt;help_panel-&gt;ShowHelp(<a class="code" href="HelpPanel_8hpp.html#a9db5413b8fd829de0db28738ccfdea90">SHOW_KEYBOARD_SHORTCUTS</a>); <span class="keywordflow">break</span>;
<a name="l01219"></a>01219         <span class="keywordflow">case</span> <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a4c430f7f8809a8418a14a2641b48719a">ID::HelpMouse</a>:     this-&gt;help_panel-&gt;ShowHelp(_(<span class="stringliteral">&quot;Help/mouse.html&quot;</span>)); <span class="keywordflow">break</span>;
<a name="l01220"></a>01220         <span class="keywordflow">case</span> <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a34623182ac086372c85925d0939f666b">ID::HelpFile</a>:      this-&gt;help_panel-&gt;ShowHelp(_(<span class="stringliteral">&quot;Help/file.html&quot;</span>)); <span class="keywordflow">break</span>;
<a name="l01221"></a>01221         <span class="keywordflow">case</span> <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994ab5e85cc7435ed3454f3f5b980ed96e3d">ID::HelpEdit</a>:      this-&gt;help_panel-&gt;ShowHelp(_(<span class="stringliteral">&quot;Help/edit.html&quot;</span>)); <span class="keywordflow">break</span>;
<a name="l01222"></a>01222         <span class="keywordflow">case</span> <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994aa6e5d26454218360dd70852ca324bec2">ID::HelpView</a>:      this-&gt;help_panel-&gt;ShowHelp(_(<span class="stringliteral">&quot;Help/view.html&quot;</span>)); <span class="keywordflow">break</span>;
<a name="l01223"></a>01223         <span class="keywordflow">case</span> <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a11c4f11523bb33079a18947830fa827e">ID::HelpAction</a>:    this-&gt;help_panel-&gt;ShowHelp(_(<span class="stringliteral">&quot;Help/action.html&quot;</span>)); <span class="keywordflow">break</span>;
<a name="l01224"></a>01224         <span class="keywordflow">case</span> <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a34a6d520118d6a6012bd9e8f0f9a1560">ID::HelpHelp</a>:      this-&gt;help_panel-&gt;ShowHelp(_(<span class="stringliteral">&quot;Help/help.html&quot;</span>)); <span class="keywordflow">break</span>;
<a name="l01225"></a>01225         <span class="keywordflow">case</span> <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a05b3c81109c55177ad668803cb8c6e1a">ID::HelpFormats</a>:   this-&gt;help_panel-&gt;ShowHelp(_(<span class="stringliteral">&quot;Help/formats.html&quot;</span>)); <span class="keywordflow">break</span>;
<a name="l01226"></a>01226         <span class="keywordflow">case</span> <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a99d9508355ab71324cf773c2b607a41f">ID::HelpProblems</a>:  this-&gt;help_panel-&gt;ShowHelp(_(<span class="stringliteral">&quot;Help/problems.html&quot;</span>)); <span class="keywordflow">break</span>;
<a name="l01227"></a>01227         <span class="keywordflow">case</span> <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a9f852fa906fbd919f0dd378129029422">ID::HelpChanges</a>:   this-&gt;help_panel-&gt;ShowHelp(_(<span class="stringliteral">&quot;Help/changes.html&quot;</span>)); <span class="keywordflow">break</span>;
<a name="l01228"></a>01228         <span class="keywordflow">case</span> <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a5aea20957851faa34cfbf82d59895b56">ID::HelpCredits</a>:   this-&gt;help_panel-&gt;ShowHelp(_(<span class="stringliteral">&quot;Help/credits.html&quot;</span>)); <span class="keywordflow">break</span>;
<a name="l01229"></a>01229         <span class="keywordflow">default</span>:
<a name="l01230"></a>01230             wxMessageBox(_(<span class="stringliteral">&quot;Bug: Unexpected ID in OnHelp!&quot;</span>));
<a name="l01231"></a>01231             <span class="keywordflow">return</span>;
<a name="l01232"></a>01232     }
<a name="l01233"></a>01233     
<a name="l01234"></a>01234     wxAuiPaneInfo &amp;pane = this-&gt;aui_mgr.GetPane(<a class="code" href="frame_8cpp.html#adb2d02d23949d250b57d1b3e00210c70">PaneName</a>(<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994aa793fe9cd53e4212456e78a881d61e73">ID::HelpPane</a>));
<a name="l01235"></a>01235     <span class="keywordflow">if</span>(pane.IsOk() &amp;&amp; !pane.IsShown()) {
<a name="l01236"></a>01236         pane.Show();
<a name="l01237"></a>01237         this-&gt;aui_mgr.Update();
<a name="l01238"></a>01238     }
<a name="l01239"></a>01239 }
<a name="l01240"></a>01240 
<a name="l01241"></a>01241 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l01242"></a>01242 
<a name="l01243"></a><a class="code" href="classMyFrame.html#a68e2ef8eac733779aff5b7028dc8c6be">01243</a> wxString <a class="code" href="classMyFrame.html#a68e2ef8eac733779aff5b7028dc8c6be">MyFrame::SavePatternDialog</a>()
<a name="l01244"></a>01244 {
<a name="l01245"></a>01245     wxString filename = wxEmptyString;
<a name="l01246"></a>01246     wxString currname = this-&gt;system-&gt;GetFilename();
<a name="l01247"></a>01247     currname = currname.AfterLast(wxFILE_SEP_PATH);
<a name="l01248"></a>01248 
<a name="l01249"></a>01249     wxString extension(this-&gt;system-&gt;GetFileExtension().c_str(),wxConvUTF8);
<a name="l01250"></a>01250     wxString extension_description = _(<span class="stringliteral">&quot;Extended VTK files (*.&quot;</span>)+extension +_T(<span class="stringliteral">&quot;)|*.&quot;</span>)+extension;
<a name="l01251"></a>01251     
<a name="l01252"></a>01252     wxFileDialog savedlg(<span class="keyword">this</span>, _(<span class="stringliteral">&quot;Specify the pattern filename&quot;</span>), <a class="code" href="prefs_8cpp.html#adc6c83c9ee4250d0b1f2b2b9f33fa777">opensavedir</a>, currname,
<a name="l01253"></a>01253                          extension_description,
<a name="l01254"></a>01254                          wxFD_SAVE | wxFD_OVERWRITE_PROMPT);
<a name="l01255"></a>01255 <span class="preprocessor">    #ifdef __WXGTK__</span>
<a name="l01256"></a>01256 <span class="preprocessor"></span>        <span class="comment">// opensavedir is ignored above (bug in wxGTK 2.8.0???)</span>
<a name="l01257"></a>01257         savedlg.SetDirectory(<a class="code" href="prefs_8cpp.html#adc6c83c9ee4250d0b1f2b2b9f33fa777">opensavedir</a>);
<a name="l01258"></a>01258 <span class="preprocessor">    #endif</span>
<a name="l01259"></a>01259 <span class="preprocessor"></span>    <span class="keywordflow">if</span>(savedlg.ShowModal() == wxID_OK) {
<a name="l01260"></a>01260         wxFileName fullpath( savedlg.GetPath() );
<a name="l01261"></a>01261         <a class="code" href="prefs_8cpp.html#adc6c83c9ee4250d0b1f2b2b9f33fa777">opensavedir</a> = fullpath.GetPath();
<a name="l01262"></a>01262         filename = savedlg.GetPath();
<a name="l01263"></a>01263     }
<a name="l01264"></a>01264     
<a name="l01265"></a>01265     <span class="keywordflow">return</span> filename;
<a name="l01266"></a>01266 }
<a name="l01267"></a>01267 
<a name="l01268"></a>01268 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l01269"></a>01269 
<a name="l01270"></a><a class="code" href="classMyFrame.html#a06843eec325e9393b35b542944cb31b9">01270</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#a06843eec325e9393b35b542944cb31b9">MyFrame::OnSavePattern</a>(wxCommandEvent&amp; event)
<a name="l01271"></a>01271 {
<a name="l01272"></a>01272     wxString filename = SavePatternDialog();
<a name="l01273"></a>01273     <span class="keywordflow">if</span>(!filename.empty()) SaveFile(filename);
<a name="l01274"></a>01274 }
<a name="l01275"></a>01275 
<a name="l01276"></a>01276 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l01277"></a>01277 
<a name="l01278"></a><a class="code" href="classMyFrame.html#a610f889b7182018a80c927d4ea93897d">01278</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#a610f889b7182018a80c927d4ea93897d">MyFrame::SaveFile</a>(<span class="keyword">const</span> wxString&amp; path)
<a name="l01279"></a>01279 {
<a name="l01280"></a>01280     wxBusyCursor busy;
<a name="l01281"></a>01281 
<a name="l01282"></a>01282     this-&gt;system-&gt;SaveFile(path.mb_str(),this-&gt;render_settings);
<a name="l01283"></a>01283 
<a name="l01284"></a>01284     AddRecentPattern(path);
<a name="l01285"></a>01285     this-&gt;system-&gt;SetFilename(<span class="keywordtype">string</span>(path.mb_str()));
<a name="l01286"></a>01286     this-&gt;system-&gt;SetModified(<span class="keyword">false</span>);
<a name="l01287"></a>01287     this-&gt;UpdateWindowTitle();
<a name="l01288"></a>01288 }
<a name="l01289"></a>01289 
<a name="l01290"></a>01290 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l01291"></a>01291 
<a name="l01292"></a><a class="code" href="classMyFrame.html#af1bae8e07814a9375a27844eb1b65b09">01292</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#af1bae8e07814a9375a27844eb1b65b09">MyFrame::OnNewPattern</a>(wxCommandEvent&amp; event)
<a name="l01293"></a>01293 {
<a name="l01294"></a>01294     this-&gt;InitializeDefaultRenderSettings();
<a name="l01295"></a>01295     <span class="keywordflow">if</span>(this-&gt;system == NULL) {
<a name="l01296"></a>01296         <span class="comment">// initial call from MyFrame::MyFrame</span>
<a name="l01297"></a>01297         <a class="code" href="classGrayScottImageRD.html" title="An inbuilt implementation: n-dimensional Gray-Scott.">GrayScottImageRD</a> *s = <span class="keyword">new</span> <a class="code" href="classGrayScottImageRD.html" title="An inbuilt implementation: n-dimensional Gray-Scott.">GrayScottImageRD</a>();
<a name="l01298"></a>01298         s-&gt;<a class="code" href="classImageRD.html#a5bfabf85d8f8e8ea604fe982e32d1cd5">SetDimensionsAndNumberOfChemicals</a>(30,25,20,2);
<a name="l01299"></a>01299         s-&gt;<a class="code" href="classAbstractRD.html#a6bcf10c119c33cde1604bdc33a19a8e9">SetModified</a>(<span class="keyword">false</span>);
<a name="l01300"></a>01300         s-&gt;<a class="code" href="classAbstractRD.html#a1ac0701d5f1d0ce7a65ce08f19d4d6e7">SetFilename</a>(<span class="stringliteral">&quot;untitled&quot;</span>);
<a name="l01301"></a>01301         s-&gt;<a class="code" href="classImageRD.html#ad1315e99af6900fbb7fd620e4827fda3">GenerateInitialPattern</a>();
<a name="l01302"></a>01302         this-&gt;SetCurrentRDSystem(s);
<a name="l01303"></a>01303         <span class="keywordflow">return</span>;
<a name="l01304"></a>01304     }
<a name="l01305"></a>01305 
<a name="l01306"></a>01306     <span class="keywordflow">if</span>(UserWantsToCancelWhenAskedIfWantsToSave()) <span class="keywordflow">return</span>;
<a name="l01307"></a>01307 
<a name="l01308"></a>01308     this-&gt;system-&gt;BlankImage();
<a name="l01309"></a>01309 
<a name="l01310"></a>01310     this-&gt;is_running = <span class="keyword">false</span>;
<a name="l01311"></a>01311     this-&gt;system-&gt;SetFilename(<span class="stringliteral">&quot;untitled&quot;</span>);
<a name="l01312"></a>01312     this-&gt;system-&gt;SetModified(<span class="keyword">false</span>);
<a name="l01313"></a>01313     this-&gt;UpdateWindows();
<a name="l01314"></a>01314 }
<a name="l01315"></a>01315 
<a name="l01316"></a>01316 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l01317"></a>01317 
<a name="l01318"></a><a class="code" href="classMyFrame.html#a6f02cf3b0fc388971523943457c5cc36">01318</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#a6f02cf3b0fc388971523943457c5cc36">MyFrame::OnOpenPattern</a>(wxCommandEvent&amp; event)
<a name="l01319"></a>01319 {
<a name="l01320"></a>01320     wxFileDialog opendlg(<span class="keyword">this</span>, _(<span class="stringliteral">&quot;Choose a pattern file&quot;</span>), <a class="code" href="prefs_8cpp.html#adc6c83c9ee4250d0b1f2b2b9f33fa777">opensavedir</a>, wxEmptyString,
<a name="l01321"></a>01321                          _(<span class="stringliteral">&quot;Extended VTK files (*.vti;*.vtu)|*.vti;*.vtu&quot;</span>),
<a name="l01322"></a>01322                          wxFD_OPEN | wxFD_FILE_MUST_EXIST);
<a name="l01323"></a>01323 <span class="preprocessor">    #ifdef __WXGTK__</span>
<a name="l01324"></a>01324 <span class="preprocessor"></span>        <span class="comment">// opensavedir is ignored above (bug in wxGTK 2.8.x???)</span>
<a name="l01325"></a>01325         opendlg.SetDirectory(<a class="code" href="prefs_8cpp.html#adc6c83c9ee4250d0b1f2b2b9f33fa777">opensavedir</a>);
<a name="l01326"></a>01326 <span class="preprocessor">    #endif</span>
<a name="l01327"></a>01327 <span class="preprocessor"></span>    <span class="keywordflow">if</span>(opendlg.ShowModal() == wxID_OK) {
<a name="l01328"></a>01328         wxFileName fullpath( opendlg.GetPath() );
<a name="l01329"></a>01329         <a class="code" href="prefs_8cpp.html#adc6c83c9ee4250d0b1f2b2b9f33fa777">opensavedir</a> = fullpath.GetPath();
<a name="l01330"></a>01330         OpenFile( opendlg.GetPath() );
<a name="l01331"></a>01331     }
<a name="l01332"></a>01332 }
<a name="l01333"></a>01333 
<a name="l01334"></a>01334 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l01335"></a>01335 
<a name="l01336"></a><a class="code" href="classMyFrame.html#a436d29334a575795c92361ba33bf06c3">01336</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#a436d29334a575795c92361ba33bf06c3">MyFrame::OpenFile</a>(<span class="keyword">const</span> wxString&amp; path, <span class="keywordtype">bool</span> remember)
<a name="l01337"></a>01337 {
<a name="l01338"></a>01338     <span class="keywordflow">if</span> (<a class="code" href="wxutils_8cpp.html#a76758ad632040bc87bae5d58aa9358de">IsHTMLFile</a>(path)) {
<a name="l01339"></a>01339         <span class="comment">// show HTML file in help pane</span>
<a name="l01340"></a>01340         this-&gt;help_panel-&gt;ShowHelp(path);
<a name="l01341"></a>01341     
<a name="l01342"></a>01342         wxAuiPaneInfo &amp;pane = this-&gt;aui_mgr.GetPane(<a class="code" href="frame_8cpp.html#adb2d02d23949d250b57d1b3e00210c70">PaneName</a>(<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994aa793fe9cd53e4212456e78a881d61e73">ID::HelpPane</a>));
<a name="l01343"></a>01343         <span class="keywordflow">if</span>(pane.IsOk() &amp;&amp; !pane.IsShown()) {
<a name="l01344"></a>01344             pane.Show();
<a name="l01345"></a>01345             this-&gt;aui_mgr.Update();
<a name="l01346"></a>01346         }
<a name="l01347"></a>01347         
<a name="l01348"></a>01348         <span class="keywordflow">return</span>;
<a name="l01349"></a>01349     }
<a name="l01350"></a>01350     
<a name="l01351"></a>01351     <span class="keywordflow">if</span> (<a class="code" href="wxutils_8cpp.html#aa390352c0253eff8ca804e20566a4ce6">IsTextFile</a>(path)) {
<a name="l01352"></a>01352         <span class="comment">// open text file in user&#39;s preferred text editor</span>
<a name="l01353"></a>01353         EditFile(path);
<a name="l01354"></a>01354         <span class="keywordflow">return</span>;
<a name="l01355"></a>01355     }
<a name="l01356"></a>01356 
<a name="l01357"></a>01357     <span class="keywordflow">if</span>(!wxFileExists(path))
<a name="l01358"></a>01358     {
<a name="l01359"></a>01359         wxMessageBox(_(<span class="stringliteral">&quot;File doesn&#39;t exist: &quot;</span>)+path);
<a name="l01360"></a>01360         <span class="keywordflow">return</span>;
<a name="l01361"></a>01361     }
<a name="l01362"></a>01362 
<a name="l01363"></a>01363     <span class="keywordflow">if</span>(UserWantsToCancelWhenAskedIfWantsToSave()) <span class="keywordflow">return</span>;
<a name="l01364"></a>01364 
<a name="l01365"></a>01365     <span class="keywordflow">if</span>(remember) AddRecentPattern(path);
<a name="l01366"></a>01366     
<a name="l01367"></a>01367     wxBeginBusyCursor();
<a name="l01368"></a>01368 
<a name="l01369"></a>01369     <span class="comment">// load pattern file</span>
<a name="l01370"></a>01370     <span class="keywordtype">bool</span> warn_to_update = <span class="keyword">false</span>;
<a name="l01371"></a>01371     <a class="code" href="classAbstractRD.html" title="Abstract base class for all reaction-diffusion systems.">AbstractRD</a> *target_system = NULL;
<a name="l01372"></a>01372     <span class="keywordflow">try</span>
<a name="l01373"></a>01373     {
<a name="l01374"></a>01374         <span class="comment">// get the VTK data type from the file</span>
<a name="l01375"></a>01375         vtkSmartPointer&lt;vtkXMLGenericDataObjectReader&gt; generic_reader = vtkSmartPointer&lt;vtkXMLGenericDataObjectReader&gt;::New();
<a name="l01376"></a>01376         <span class="keywordtype">bool</span> parallel;
<a name="l01377"></a>01377         <span class="keywordtype">int</span> data_type = generic_reader-&gt;ReadOutputType(path.mb_str(),parallel);
<a name="l01378"></a>01378 
<a name="l01379"></a>01379         <span class="keywordflow">if</span>( data_type == VTK_IMAGE_DATA )
<a name="l01380"></a>01380         {
<a name="l01381"></a>01381             vtkSmartPointer&lt;RD_XMLImageReader&gt; reader = vtkSmartPointer&lt;RD_XMLImageReader&gt;::New();
<a name="l01382"></a>01382             reader-&gt;SetFileName(path.mb_str());
<a name="l01383"></a>01383             reader-&gt;Update();
<a name="l01384"></a>01384             vtkImageData *image = reader-&gt;GetOutput();
<a name="l01385"></a>01385 
<a name="l01386"></a>01386             <span class="keywordtype">string</span> type = reader-&gt;GetType();
<a name="l01387"></a>01387             <span class="keywordtype">string</span> name = reader-&gt;GetName();
<a name="l01388"></a>01388 
<a name="l01389"></a>01389             <a class="code" href="classImageRD.html" title="Base class for image-based systems.">ImageRD</a>* image_system;
<a name="l01390"></a>01390             <span class="keywordflow">if</span>(type==<span class="stringliteral">&quot;inbuilt&quot;</span>)
<a name="l01391"></a>01391             {
<a name="l01392"></a>01392                 <span class="keywordflow">if</span>(name==<span class="stringliteral">&quot;Gray-Scott&quot;</span>)
<a name="l01393"></a>01393                     image_system = <span class="keyword">new</span> <a class="code" href="classGrayScottImageRD.html" title="An inbuilt implementation: n-dimensional Gray-Scott.">GrayScottImageRD</a>();
<a name="l01394"></a>01394                 <span class="keywordflow">else</span> 
<a name="l01395"></a>01395                     <span class="keywordflow">throw</span> runtime_error(<span class="stringliteral">&quot;Unsupported inbuilt implementation: &quot;</span>+name);
<a name="l01396"></a>01396             }
<a name="l01397"></a>01397             <span class="keywordflow">else</span> <span class="keywordflow">if</span>(type==<span class="stringliteral">&quot;formula&quot;</span>)
<a name="l01398"></a>01398             {
<a name="l01399"></a>01399                 <span class="comment">// TODO: detect if opencl is available, abort if not</span>
<a name="l01400"></a>01400                 <a class="code" href="classFormulaOpenCLImageRD.html" title="An RD system that uses an OpenCL formula snippet.">FormulaOpenCLImageRD</a> *s = <span class="keyword">new</span> <a class="code" href="classFormulaOpenCLImageRD.html" title="An RD system that uses an OpenCL formula snippet.">FormulaOpenCLImageRD</a>();
<a name="l01401"></a>01401                 s-&gt;<a class="code" href="classOpenCL__MixIn.html#aaec65d3cb1d6bca590c377df36ad229a">SetPlatform</a>(<a class="code" href="prefs_8cpp.html#a0de6a378ca700dd877cab59c65ba2f7b">opencl_platform</a>);
<a name="l01402"></a>01402                 s-&gt;<a class="code" href="classOpenCL__MixIn.html#adb3a6ccfecf048fd02e1bbbf285ba8d0">SetDevice</a>(<a class="code" href="prefs_8cpp.html#a11d0cbab21425e351638f4bf2cc72874">opencl_device</a>);
<a name="l01403"></a>01403                 image_system = s;
<a name="l01404"></a>01404             }
<a name="l01405"></a>01405             <span class="keywordflow">else</span> <span class="keywordflow">if</span>(type==<span class="stringliteral">&quot;kernel&quot;</span>)
<a name="l01406"></a>01406             {
<a name="l01407"></a>01407                 <span class="comment">// TODO: detect if opencl is available, abort if not</span>
<a name="l01408"></a>01408                 <a class="code" href="classFullKernelOpenCLImageRD.html" title="An RD system that uses an OpenCL program.">FullKernelOpenCLImageRD</a> *s = <span class="keyword">new</span> <a class="code" href="classFullKernelOpenCLImageRD.html" title="An RD system that uses an OpenCL program.">FullKernelOpenCLImageRD</a>();
<a name="l01409"></a>01409                 s-&gt;<a class="code" href="classOpenCL__MixIn.html#aaec65d3cb1d6bca590c377df36ad229a">SetPlatform</a>(<a class="code" href="prefs_8cpp.html#a0de6a378ca700dd877cab59c65ba2f7b">opencl_platform</a>);
<a name="l01410"></a>01410                 s-&gt;<a class="code" href="classOpenCL__MixIn.html#adb3a6ccfecf048fd02e1bbbf285ba8d0">SetDevice</a>(<a class="code" href="prefs_8cpp.html#a11d0cbab21425e351638f4bf2cc72874">opencl_device</a>);
<a name="l01411"></a>01411                 image_system = s;
<a name="l01412"></a>01412             }
<a name="l01413"></a>01413             <span class="keywordflow">else</span> <span class="keywordflow">throw</span> runtime_error(<span class="stringliteral">&quot;Unsupported rule type: &quot;</span>+type);
<a name="l01414"></a>01414             image_system-&gt;<a class="code" href="classAbstractRD.html#a4b3c5316c168951a9d8990ec9832839d">InitializeFromXML</a>(reader-&gt;GetRDElement(),warn_to_update);
<a name="l01415"></a>01415 
<a name="l01416"></a>01416             <span class="comment">// render settings</span>
<a name="l01417"></a>01417             this-&gt;InitializeDefaultRenderSettings();
<a name="l01418"></a>01418             vtkSmartPointer&lt;vtkXMLDataElement&gt; xml_render_settings = reader-&gt;GetRDElement()-&gt;FindNestedElementWithName(<span class="stringliteral">&quot;render_settings&quot;</span>);
<a name="l01419"></a>01419             <span class="keywordflow">if</span>(xml_render_settings) <span class="comment">// optional</span>
<a name="l01420"></a>01420                 this-&gt;render_settings.OverwriteFromXML(xml_render_settings);
<a name="l01421"></a>01421 
<a name="l01422"></a>01422             <span class="keywordtype">int</span> dim[3];
<a name="l01423"></a>01423             image-&gt;GetDimensions(dim);
<a name="l01424"></a>01424             <span class="keywordtype">int</span> nc = image-&gt;GetNumberOfScalarComponents() * image-&gt;GetPointData()-&gt;GetNumberOfArrays();
<a name="l01425"></a>01425             image_system-&gt;<a class="code" href="classImageRD.html#a73be8ca9a7b6659fc2f085f08b3375ca">SetDimensions</a>(dim[0],dim[1],dim[2]);
<a name="l01426"></a>01426             image_system-&gt;<a class="code" href="classImageRD.html#af933532d2ba634c8887bd31f3b8f95f1">SetNumberOfChemicals</a>(nc);
<a name="l01427"></a>01427             <span class="keywordflow">if</span>(reader-&gt;ShouldGenerateInitialPatternWhenLoading())
<a name="l01428"></a>01428                 image_system-&gt;<a class="code" href="classImageRD.html#ad1315e99af6900fbb7fd620e4827fda3">GenerateInitialPattern</a>();
<a name="l01429"></a>01429             <span class="keywordflow">else</span>
<a name="l01430"></a>01430                 image_system-&gt;<a class="code" href="classImageRD.html#a7f4d538f7c74d6f6ec6e70c4cc4236f4">CopyFromImage</a>(image);
<a name="l01431"></a>01431             target_system = image_system;
<a name="l01432"></a>01432         }
<a name="l01433"></a>01433         <span class="keywordflow">else</span> <span class="keywordflow">if</span>( data_type == VTK_UNSTRUCTURED_GRID )
<a name="l01434"></a>01434         {
<a name="l01435"></a>01435             vtkSmartPointer&lt;RD_XMLUnstructuredGridReader&gt; reader = vtkSmartPointer&lt;RD_XMLUnstructuredGridReader&gt;::New();
<a name="l01436"></a>01436             reader-&gt;SetFileName(path.mb_str());
<a name="l01437"></a>01437             reader-&gt;Update();
<a name="l01438"></a>01438             vtkUnstructuredGrid *ugrid = reader-&gt;GetOutput();
<a name="l01439"></a>01439 
<a name="l01440"></a>01440             <span class="keywordtype">string</span> type = reader-&gt;GetType();
<a name="l01441"></a>01441             <span class="keywordtype">string</span> name = reader-&gt;GetName();
<a name="l01442"></a>01442 
<a name="l01443"></a>01443             <a class="code" href="classMeshRD.html" title="Base class for mesh-based systems.">MeshRD</a>* mesh_system;
<a name="l01444"></a>01444             <span class="keywordflow">if</span>(type==<span class="stringliteral">&quot;formula&quot;</span>)
<a name="l01445"></a>01445             {
<a name="l01446"></a>01446                 <span class="comment">// TODO</span>
<a name="l01447"></a>01447                 mesh_system = <span class="keyword">new</span> <a class="code" href="classHeatEquationMeshRD.html" title="A non-OpenCL mesh implementation, just as an example.">HeatEquationMeshRD</a>();
<a name="l01448"></a>01448             }
<a name="l01449"></a>01449             <span class="keywordflow">else</span> <span class="keywordflow">throw</span> runtime_error(<span class="stringliteral">&quot;Unsupported rule type: &quot;</span>+type);
<a name="l01450"></a>01450 
<a name="l01451"></a>01451             mesh_system-&gt;<a class="code" href="classMeshRD.html#a86710329396780b3bf7a6f92e975cdb5">CopyFromMesh</a>(ugrid);
<a name="l01452"></a>01452             mesh_system-&gt;<a class="code" href="classMeshRD.html#ae7df8e16cc290e4a8bce905a7627cb71">InitializeFromXML</a>(reader-&gt;GetRDElement(),warn_to_update);
<a name="l01453"></a>01453             <span class="comment">// render settings</span>
<a name="l01454"></a>01454             this-&gt;InitializeDefaultRenderSettings();
<a name="l01455"></a>01455             vtkSmartPointer&lt;vtkXMLDataElement&gt; xml_render_settings = reader-&gt;GetRDElement()-&gt;FindNestedElementWithName(<span class="stringliteral">&quot;render_settings&quot;</span>);
<a name="l01456"></a>01456             <span class="keywordflow">if</span>(xml_render_settings) <span class="comment">// optional</span>
<a name="l01457"></a>01457                 this-&gt;render_settings.OverwriteFromXML(xml_render_settings);
<a name="l01458"></a>01458 
<a name="l01459"></a>01459             <span class="keywordflow">if</span>(reader-&gt;ShouldGenerateInitialPatternWhenLoading())
<a name="l01460"></a>01460                 mesh_system-&gt;<a class="code" href="classMeshRD.html#aea439a0c84c616efb787cce88a64e51c">GenerateInitialPattern</a>();
<a name="l01461"></a>01461 
<a name="l01462"></a>01462             target_system = mesh_system;
<a name="l01463"></a>01463         }
<a name="l01464"></a>01464         <span class="keywordflow">else</span>
<a name="l01465"></a>01465         {
<a name="l01466"></a>01466             ostringstream oss;
<a name="l01467"></a>01467             oss &lt;&lt; <span class="stringliteral">&quot;Unsupported data type: &quot;</span> &lt;&lt; data_type;
<a name="l01468"></a>01468             <span class="keywordflow">throw</span> runtime_error(oss.str());
<a name="l01469"></a>01469         }
<a name="l01470"></a>01470         target_system-&gt;<a class="code" href="classAbstractRD.html#a1ac0701d5f1d0ce7a65ce08f19d4d6e7">SetFilename</a>(<span class="keywordtype">string</span>(path.mb_str())); <span class="comment">// TODO: display filetitle only (user option?)</span>
<a name="l01471"></a>01471         target_system-&gt;<a class="code" href="classAbstractRD.html#a6bcf10c119c33cde1604bdc33a19a8e9">SetModified</a>(<span class="keyword">false</span>);
<a name="l01472"></a>01472         this-&gt;SetCurrentRDSystem(target_system);
<a name="l01473"></a>01473     }
<a name="l01474"></a>01474     <span class="keywordflow">catch</span>(<span class="keyword">const</span> exception&amp; e)
<a name="l01475"></a>01475     {
<a name="l01476"></a>01476         wxEndBusyCursor();
<a name="l01477"></a>01477         wxString message = warn_to_update ? _(<span class="stringliteral">&quot;This file is from a more recent version of Ready. You should download a newer version.\n\n&quot;</span>) : _(<span class="stringliteral">&quot;&quot;</span>);
<a name="l01478"></a>01478         message += _(<span class="stringliteral">&quot;Failed to open file. Error:\n\n&quot;</span>);
<a name="l01479"></a>01479         message += wxString(e.what(),wxConvUTF8);
<a name="l01480"></a>01480         <a class="code" href="classMonospaceMessageBox.html">MonospaceMessageBox</a>(message,_(<span class="stringliteral">&quot;Error reading file&quot;</span>),wxART_ERROR);
<a name="l01481"></a>01481         <span class="keyword">delete</span> target_system;
<a name="l01482"></a>01482         <span class="keywordflow">return</span>;
<a name="l01483"></a>01483     }
<a name="l01484"></a>01484     <span class="keywordflow">catch</span>(...)
<a name="l01485"></a>01485     {
<a name="l01486"></a>01486         wxEndBusyCursor();
<a name="l01487"></a>01487         wxString message = warn_to_update ? _(<span class="stringliteral">&quot;This file is from a more recent version of Ready. You should download a newer version.\n\n&quot;</span>) : _(<span class="stringliteral">&quot;&quot;</span>);
<a name="l01488"></a>01488         message += _(<span class="stringliteral">&quot;Failed to open file.&quot;</span>);
<a name="l01489"></a>01489         <a class="code" href="classMonospaceMessageBox.html">MonospaceMessageBox</a>(message,_(<span class="stringliteral">&quot;Error reading file&quot;</span>),wxART_ERROR);
<a name="l01490"></a>01490         <span class="keyword">delete</span> target_system;
<a name="l01491"></a>01491         <span class="keywordflow">return</span>;
<a name="l01492"></a>01492     }
<a name="l01493"></a>01493     wxEndBusyCursor();
<a name="l01494"></a>01494     <span class="keywordflow">if</span>(warn_to_update)
<a name="l01495"></a>01495     {
<a name="l01496"></a>01496         wxMessageBox(<span class="stringliteral">&quot;This file is from a more recent version of Ready. For best results you should download a newer version.&quot;</span>);
<a name="l01497"></a>01497         <span class="comment">// TODO: allow user to stop this message from appearing every time</span>
<a name="l01498"></a>01498     }
<a name="l01499"></a>01499 }
<a name="l01500"></a>01500 
<a name="l01501"></a>01501 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l01502"></a>01502 
<a name="l01503"></a><a class="code" href="classMyFrame.html#a6dd004ebccc7302c5ed7b25eba433746">01503</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#a6dd004ebccc7302c5ed7b25eba433746">MyFrame::OnOpenRecent</a>(wxCommandEvent&amp; event)
<a name="l01504"></a>01504 {
<a name="l01505"></a>01505     <span class="keywordtype">int</span> <span class="keywordtype">id</span> = <span class="keyword">event</span>.GetId();
<a name="l01506"></a>01506     <span class="keywordflow">if</span> (<span class="keywordtype">id</span> == <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a62c752cf096291b16dd60eaa26527904">ID::ClearMissingPatterns</a>) {
<a name="l01507"></a>01507         <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a62c752cf096291b16dd60eaa26527904">ClearMissingPatterns</a>();
<a name="l01508"></a>01508     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<span class="keywordtype">id</span> == <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a706737e76be11ecaa9546057bf8216c3">ID::ClearAllPatterns</a>) {
<a name="l01509"></a>01509         <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a706737e76be11ecaa9546057bf8216c3">ClearAllPatterns</a>();
<a name="l01510"></a>01510     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( <span class="keywordtype">id</span> &gt; <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a7cbbd0c9c34ab62384ebaaea64700a6e">ID::OpenRecent</a> &amp;&amp; <span class="keywordtype">id</span> &lt;= <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a7cbbd0c9c34ab62384ebaaea64700a6e">ID::OpenRecent</a> + <a class="code" href="prefs_8cpp.html#a17a3671114d042df36485b7cf3a80840">numpatterns</a> ) {
<a name="l01511"></a>01511         OpenRecentPattern(<span class="keywordtype">id</span>);
<a name="l01512"></a>01512     } <span class="keywordflow">else</span> {
<a name="l01513"></a>01513         <span class="keyword">event</span>.Skip();
<a name="l01514"></a>01514     }
<a name="l01515"></a>01515 }
<a name="l01516"></a>01516 
<a name="l01517"></a>01517 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l01518"></a>01518 
<a name="l01519"></a><a class="code" href="classMyFrame.html#a73641e373264629dc3cc639222847135">01519</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#a73641e373264629dc3cc639222847135">MyFrame::AddRecentPattern</a>(<span class="keyword">const</span> wxString&amp; inpath)
<a name="l01520"></a>01520 {
<a name="l01521"></a>01521     <span class="keywordflow">if</span> (inpath.IsEmpty()) <span class="keywordflow">return</span>;
<a name="l01522"></a>01522     wxString path = inpath;
<a name="l01523"></a>01523     <span class="keywordflow">if</span> (path.StartsWith(<a class="code" href="prefs_8cpp.html#aa3af5b468230e51f15091c9f1410b2c4">readydir</a>)) {
<a name="l01524"></a>01524         <span class="comment">// remove readydir from start of path</span>
<a name="l01525"></a>01525         path.erase(0, <a class="code" href="prefs_8cpp.html#aa3af5b468230e51f15091c9f1410b2c4">readydir</a>.length());
<a name="l01526"></a>01526     }
<a name="l01527"></a>01527 
<a name="l01528"></a>01528     <span class="comment">// duplicate any ampersands so they appear in menu</span>
<a name="l01529"></a>01529     path.Replace(wxT(<span class="stringliteral">&quot;&amp;&quot;</span>), wxT(<span class="stringliteral">&quot;&amp;&amp;&quot;</span>));
<a name="l01530"></a>01530 
<a name="l01531"></a>01531     <span class="comment">// put given path at start of patternSubMenu</span>
<a name="l01532"></a>01532 <span class="preprocessor">    #ifdef __WXGTK__</span>
<a name="l01533"></a>01533 <span class="preprocessor"></span>        <span class="comment">// avoid wxGTK bug in FindItem if path contains underscores</span>
<a name="l01534"></a>01534         <span class="keywordtype">int</span> <span class="keywordtype">id</span> = wxNOT_FOUND;
<a name="l01535"></a>01535         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="prefs_8cpp.html#a17a3671114d042df36485b7cf3a80840">numpatterns</a>; i++) {
<a name="l01536"></a>01536             wxMenuItem* item = <a class="code" href="prefs_8cpp.html#ae5246b1632294beb0e04a2942722d304">patternSubMenu</a>-&gt;FindItemByPosition(i);
<a name="l01537"></a>01537             wxString temp = item-&gt;GetText();
<a name="l01538"></a>01538             temp.Replace(wxT(<span class="stringliteral">&quot;__&quot;</span>), wxT(<span class="stringliteral">&quot;_&quot;</span>));
<a name="l01539"></a>01539             temp.Replace(wxT(<span class="stringliteral">&quot;&amp;&quot;</span>), wxT(<span class="stringliteral">&quot;&amp;&amp;&quot;</span>));
<a name="l01540"></a>01540             <span class="keywordflow">if</span> (temp == path) {
<a name="l01541"></a>01541                 <span class="keywordtype">id</span> = <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a7cbbd0c9c34ab62384ebaaea64700a6e">ID::OpenRecent</a> + 1 + i;
<a name="l01542"></a>01542                 <span class="keywordflow">break</span>;
<a name="l01543"></a>01543             }
<a name="l01544"></a>01544         }
<a name="l01545"></a>01545 <span class="preprocessor">    #else</span>
<a name="l01546"></a>01546 <span class="preprocessor"></span>        <span class="keywordtype">int</span> <span class="keywordtype">id</span> = <a class="code" href="prefs_8cpp.html#ae5246b1632294beb0e04a2942722d304">patternSubMenu</a>-&gt;FindItem(path);
<a name="l01547"></a>01547 <span class="preprocessor">    #endif</span>
<a name="l01548"></a>01548 <span class="preprocessor"></span>    <span class="keywordflow">if</span> ( <span class="keywordtype">id</span> == wxNOT_FOUND ) {
<a name="l01549"></a>01549         <span class="keywordflow">if</span> ( numpatterns &lt; <a class="code" href="prefs_8cpp.html#af74247065dccdcbc74c5e1b8dc09e01c">maxpatterns</a> ) {
<a name="l01550"></a>01550             <span class="comment">// add new path</span>
<a name="l01551"></a>01551             numpatterns++;
<a name="l01552"></a>01552             <span class="keywordtype">id</span> = <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a7cbbd0c9c34ab62384ebaaea64700a6e">ID::OpenRecent</a> + <a class="code" href="prefs_8cpp.html#a17a3671114d042df36485b7cf3a80840">numpatterns</a>;
<a name="l01553"></a>01553             <a class="code" href="prefs_8cpp.html#ae5246b1632294beb0e04a2942722d304">patternSubMenu</a>-&gt;Insert(numpatterns - 1, <span class="keywordtype">id</span>, path);
<a name="l01554"></a>01554         } <span class="keywordflow">else</span> {
<a name="l01555"></a>01555             <span class="comment">// replace last item with new path</span>
<a name="l01556"></a>01556             wxMenuItem* item = <a class="code" href="prefs_8cpp.html#ae5246b1632294beb0e04a2942722d304">patternSubMenu</a>-&gt;FindItemByPosition(<a class="code" href="prefs_8cpp.html#af74247065dccdcbc74c5e1b8dc09e01c">maxpatterns</a> - 1);
<a name="l01557"></a>01557             item-&gt;SetText(path);
<a name="l01558"></a>01558             <span class="keywordtype">id</span> = <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a7cbbd0c9c34ab62384ebaaea64700a6e">ID::OpenRecent</a> + <a class="code" href="prefs_8cpp.html#af74247065dccdcbc74c5e1b8dc09e01c">maxpatterns</a>;
<a name="l01559"></a>01559         }
<a name="l01560"></a>01560     }
<a name="l01561"></a>01561     
<a name="l01562"></a>01562     <span class="comment">// path exists in patternSubMenu</span>
<a name="l01563"></a>01563     <span class="keywordflow">if</span> ( <span class="keywordtype">id</span> &gt; <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a7cbbd0c9c34ab62384ebaaea64700a6e">ID::OpenRecent</a> + 1 ) {
<a name="l01564"></a>01564         <span class="comment">// move path to start of menu</span>
<a name="l01565"></a>01565         wxMenuItem* item;
<a name="l01566"></a>01566         <span class="keywordflow">while</span> ( <span class="keywordtype">id</span> &gt; <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a7cbbd0c9c34ab62384ebaaea64700a6e">ID::OpenRecent</a> + 1 ) {
<a name="l01567"></a>01567             wxMenuItem* previtem = <a class="code" href="prefs_8cpp.html#ae5246b1632294beb0e04a2942722d304">patternSubMenu</a>-&gt;FindItem(<span class="keywordtype">id</span> - 1);
<a name="l01568"></a>01568             wxString prevpath = previtem-&gt;GetText();
<a name="l01569"></a>01569 <span class="preprocessor">            #ifdef __WXGTK__</span>
<a name="l01570"></a>01570 <span class="preprocessor"></span>                <span class="comment">// remove duplicate underscores</span>
<a name="l01571"></a>01571                 prevpath.Replace(wxT(<span class="stringliteral">&quot;__&quot;</span>), wxT(<span class="stringliteral">&quot;_&quot;</span>));
<a name="l01572"></a>01572                 prevpath.Replace(wxT(<span class="stringliteral">&quot;&amp;&quot;</span>), wxT(<span class="stringliteral">&quot;&amp;&amp;&quot;</span>));
<a name="l01573"></a>01573 <span class="preprocessor">            #endif</span>
<a name="l01574"></a>01574 <span class="preprocessor"></span>            item = <a class="code" href="prefs_8cpp.html#ae5246b1632294beb0e04a2942722d304">patternSubMenu</a>-&gt;FindItem(<span class="keywordtype">id</span>);
<a name="l01575"></a>01575             item-&gt;SetText(prevpath);
<a name="l01576"></a>01576             <span class="keywordtype">id</span>--;
<a name="l01577"></a>01577         }
<a name="l01578"></a>01578         item = <a class="code" href="prefs_8cpp.html#ae5246b1632294beb0e04a2942722d304">patternSubMenu</a>-&gt;FindItem(<span class="keywordtype">id</span>);
<a name="l01579"></a>01579         item-&gt;SetText(path);
<a name="l01580"></a>01580     }
<a name="l01581"></a>01581     
<a name="l01582"></a>01582     wxMenuBar* mbar = GetMenuBar();
<a name="l01583"></a>01583     <span class="keywordflow">if</span> (mbar) mbar-&gt;Enable(<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a7cbbd0c9c34ab62384ebaaea64700a6e">ID::OpenRecent</a>, numpatterns &gt; 0);
<a name="l01584"></a>01584 }
<a name="l01585"></a>01585 
<a name="l01586"></a>01586 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l01587"></a>01587 
<a name="l01588"></a><a class="code" href="classMyFrame.html#aad11d3b14d33f240778eacb7862b18f7">01588</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#aad11d3b14d33f240778eacb7862b18f7">MyFrame::OpenRecentPattern</a>(<span class="keywordtype">int</span> <span class="keywordtype">id</span>)
<a name="l01589"></a>01589 {
<a name="l01590"></a>01590     wxMenuItem* item = <a class="code" href="prefs_8cpp.html#ae5246b1632294beb0e04a2942722d304">patternSubMenu</a>-&gt;FindItem(<span class="keywordtype">id</span>);
<a name="l01591"></a>01591     <span class="keywordflow">if</span> (item) {
<a name="l01592"></a>01592         wxString path = item-&gt;GetText();
<a name="l01593"></a>01593 <span class="preprocessor">        #ifdef __WXGTK__</span>
<a name="l01594"></a>01594 <span class="preprocessor"></span>            <span class="comment">// remove duplicate underscores</span>
<a name="l01595"></a>01595             path.Replace(wxT(<span class="stringliteral">&quot;__&quot;</span>), wxT(<span class="stringliteral">&quot;_&quot;</span>));
<a name="l01596"></a>01596 <span class="preprocessor">        #endif</span>
<a name="l01597"></a>01597 <span class="preprocessor"></span>        <span class="comment">// remove duplicate ampersands</span>
<a name="l01598"></a>01598         path.Replace(wxT(<span class="stringliteral">&quot;&amp;&amp;&quot;</span>), wxT(<span class="stringliteral">&quot;&amp;&quot;</span>));
<a name="l01599"></a>01599 
<a name="l01600"></a>01600         <span class="comment">// if path isn&#39;t absolute then prepend Ready directory</span>
<a name="l01601"></a>01601         wxFileName fname(path);
<a name="l01602"></a>01602         <span class="keywordflow">if</span> (!fname.IsAbsolute()) path = <a class="code" href="prefs_8cpp.html#aa3af5b468230e51f15091c9f1410b2c4">readydir</a> + path;
<a name="l01603"></a>01603 
<a name="l01604"></a>01604         OpenFile(path);
<a name="l01605"></a>01605     }
<a name="l01606"></a>01606 }
<a name="l01607"></a>01607 
<a name="l01608"></a>01608 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l01609"></a>01609 
<a name="l01610"></a><a class="code" href="classMyFrame.html#a6e65158f18a4be192fbc284d15c4315c">01610</a> <span class="keywordtype">void</span> <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a62c752cf096291b16dd60eaa26527904">MyFrame::ClearMissingPatterns</a>()
<a name="l01611"></a>01611 {
<a name="l01612"></a>01612     <span class="keywordtype">int</span> pos = 0;
<a name="l01613"></a>01613     <span class="keywordflow">while</span> (pos &lt; <a class="code" href="prefs_8cpp.html#a17a3671114d042df36485b7cf3a80840">numpatterns</a>) {
<a name="l01614"></a>01614         wxMenuItem* item = <a class="code" href="prefs_8cpp.html#ae5246b1632294beb0e04a2942722d304">patternSubMenu</a>-&gt;FindItemByPosition(pos);
<a name="l01615"></a>01615         wxString path = item-&gt;GetText();
<a name="l01616"></a>01616 <span class="preprocessor">        #ifdef __WXGTK__</span>
<a name="l01617"></a>01617 <span class="preprocessor"></span>            <span class="comment">// remove duplicate underscores</span>
<a name="l01618"></a>01618             path.Replace(wxT(<span class="stringliteral">&quot;__&quot;</span>), wxT(<span class="stringliteral">&quot;_&quot;</span>));
<a name="l01619"></a>01619 <span class="preprocessor">        #endif</span>
<a name="l01620"></a>01620 <span class="preprocessor"></span>        <span class="comment">// remove duplicate ampersands</span>
<a name="l01621"></a>01621         path.Replace(wxT(<span class="stringliteral">&quot;&amp;&amp;&quot;</span>), wxT(<span class="stringliteral">&quot;&amp;&quot;</span>));
<a name="l01622"></a>01622 
<a name="l01623"></a>01623         <span class="comment">// if path isn&#39;t absolute then prepend Ready directory</span>
<a name="l01624"></a>01624         wxFileName fname(path);
<a name="l01625"></a>01625         <span class="keywordflow">if</span> (!fname.IsAbsolute()) path = <a class="code" href="prefs_8cpp.html#aa3af5b468230e51f15091c9f1410b2c4">readydir</a> + path;
<a name="l01626"></a>01626 
<a name="l01627"></a>01627         <span class="keywordflow">if</span> (wxFileExists(path)) {
<a name="l01628"></a>01628             <span class="comment">// keep this item</span>
<a name="l01629"></a>01629             pos++;
<a name="l01630"></a>01630         } <span class="keywordflow">else</span> {
<a name="l01631"></a>01631             <span class="comment">// remove this item by shifting up later items</span>
<a name="l01632"></a>01632             <span class="keywordtype">int</span> nextpos = pos + 1;
<a name="l01633"></a>01633             <span class="keywordflow">while</span> (nextpos &lt; <a class="code" href="prefs_8cpp.html#a17a3671114d042df36485b7cf3a80840">numpatterns</a>) {
<a name="l01634"></a>01634                 wxMenuItem* nextitem = <a class="code" href="prefs_8cpp.html#ae5246b1632294beb0e04a2942722d304">patternSubMenu</a>-&gt;FindItemByPosition(nextpos);
<a name="l01635"></a>01635 <span class="preprocessor">                #ifdef __WXGTK__</span>
<a name="l01636"></a>01636 <span class="preprocessor"></span>                    <span class="comment">// avoid wxGTK bug if item contains underscore</span>
<a name="l01637"></a>01637                     wxString temp = nextitem-&gt;GetText();
<a name="l01638"></a>01638                     temp.Replace(wxT(<span class="stringliteral">&quot;__&quot;</span>), wxT(<span class="stringliteral">&quot;_&quot;</span>));
<a name="l01639"></a>01639                     temp.Replace(wxT(<span class="stringliteral">&quot;&amp;&quot;</span>), wxT(<span class="stringliteral">&quot;&amp;&amp;&quot;</span>));
<a name="l01640"></a>01640                     item-&gt;SetText( temp );
<a name="l01641"></a>01641 <span class="preprocessor">                #else</span>
<a name="l01642"></a>01642 <span class="preprocessor"></span>                    item-&gt;SetText( nextitem-&gt;GetText() );
<a name="l01643"></a>01643 <span class="preprocessor">                #endif</span>
<a name="l01644"></a>01644 <span class="preprocessor"></span>                item = nextitem;
<a name="l01645"></a>01645                 nextpos++;
<a name="l01646"></a>01646             }
<a name="l01647"></a>01647             <span class="comment">// delete last item</span>
<a name="l01648"></a>01648             <a class="code" href="prefs_8cpp.html#ae5246b1632294beb0e04a2942722d304">patternSubMenu</a>-&gt;Delete(item);
<a name="l01649"></a>01649             <a class="code" href="prefs_8cpp.html#a17a3671114d042df36485b7cf3a80840">numpatterns</a>--;
<a name="l01650"></a>01650         }
<a name="l01651"></a>01651     }
<a name="l01652"></a>01652     wxMenuBar* mbar = GetMenuBar();
<a name="l01653"></a>01653     <span class="keywordflow">if</span> (mbar) mbar-&gt;Enable(<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a7cbbd0c9c34ab62384ebaaea64700a6e">ID::OpenRecent</a>, <a class="code" href="prefs_8cpp.html#a17a3671114d042df36485b7cf3a80840">numpatterns</a> &gt; 0);
<a name="l01654"></a>01654 }
<a name="l01655"></a>01655 
<a name="l01656"></a>01656 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l01657"></a>01657 
<a name="l01658"></a><a class="code" href="classMyFrame.html#a1e7f4fab4dab3f3b8d6d28bc43755eea">01658</a> <span class="keywordtype">void</span> <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a706737e76be11ecaa9546057bf8216c3">MyFrame::ClearAllPatterns</a>()
<a name="l01659"></a>01659 {
<a name="l01660"></a>01660     <span class="keywordflow">while</span> (<a class="code" href="prefs_8cpp.html#a17a3671114d042df36485b7cf3a80840">numpatterns</a> &gt; 0) {
<a name="l01661"></a>01661         <a class="code" href="prefs_8cpp.html#ae5246b1632294beb0e04a2942722d304">patternSubMenu</a>-&gt;Delete( <a class="code" href="prefs_8cpp.html#ae5246b1632294beb0e04a2942722d304">patternSubMenu</a>-&gt;FindItemByPosition(0) );
<a name="l01662"></a>01662         <a class="code" href="prefs_8cpp.html#a17a3671114d042df36485b7cf3a80840">numpatterns</a>--;
<a name="l01663"></a>01663     }
<a name="l01664"></a>01664     wxMenuBar* mbar = GetMenuBar();
<a name="l01665"></a>01665     <span class="keywordflow">if</span> (mbar) mbar-&gt;Enable(<a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a7cbbd0c9c34ab62384ebaaea64700a6e">ID::OpenRecent</a>, <span class="keyword">false</span>);
<a name="l01666"></a>01666 }
<a name="l01667"></a>01667 
<a name="l01668"></a>01668 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l01669"></a>01669 
<a name="l01670"></a><a class="code" href="classMyFrame.html#a5c14754eb42c4f049273237e2da8bb1e">01670</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#a5c14754eb42c4f049273237e2da8bb1e">MyFrame::EditFile</a>(<span class="keyword">const</span> wxString&amp; path)
<a name="l01671"></a>01671 {
<a name="l01672"></a>01672     <span class="comment">// prompt user if text editor hasn&#39;t been set yet</span>
<a name="l01673"></a>01673     <span class="keywordflow">if</span> (<a class="code" href="prefs_8cpp.html#a3a8c57e4e1beb747c341e067dc8869bf">texteditor</a>.IsEmpty()) {
<a name="l01674"></a>01674         <a class="code" href="prefs_8cpp.html#a02ca260200a3047b1cd1f87c4b8d8eda">ChooseTextEditor</a>(<span class="keyword">this</span>, <a class="code" href="prefs_8cpp.html#a3a8c57e4e1beb747c341e067dc8869bf">texteditor</a>);
<a name="l01675"></a>01675         <span class="keywordflow">if</span> (<a class="code" href="prefs_8cpp.html#a3a8c57e4e1beb747c341e067dc8869bf">texteditor</a>.IsEmpty()) <span class="keywordflow">return</span>;
<a name="l01676"></a>01676     }
<a name="l01677"></a>01677     
<a name="l01678"></a>01678     <span class="comment">// open given file in user&#39;s preferred text editor</span>
<a name="l01679"></a>01679     wxString cmd;
<a name="l01680"></a>01680 <span class="preprocessor">    #ifdef __WXMAC__</span>
<a name="l01681"></a>01681 <span class="preprocessor"></span>        cmd = wxString::Format(wxT(<span class="stringliteral">&quot;open -a \&quot;%s\&quot; \&quot;%s\&quot;&quot;</span>), <a class="code" href="prefs_8cpp.html#a3a8c57e4e1beb747c341e067dc8869bf">texteditor</a>.c_str(), path.c_str());
<a name="l01682"></a>01682 <span class="preprocessor">    #else</span>
<a name="l01683"></a>01683 <span class="preprocessor"></span>        <span class="comment">// Windows or Unix</span>
<a name="l01684"></a>01684         cmd = wxString::Format(wxT(<span class="stringliteral">&quot;\&quot;%s\&quot; \&quot;%s\&quot;&quot;</span>), <a class="code" href="prefs_8cpp.html#a3a8c57e4e1beb747c341e067dc8869bf">texteditor</a>.c_str(), path.c_str());
<a name="l01685"></a>01685 <span class="preprocessor">    #endif</span>
<a name="l01686"></a>01686 <span class="preprocessor"></span>    wxExecute(cmd, wxEXEC_ASYNC);
<a name="l01687"></a>01687 }
<a name="l01688"></a>01688 
<a name="l01689"></a>01689 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l01690"></a>01690 
<a name="l01691"></a><a class="code" href="classMyFrame.html#a47f01b7eaaec08a2b57cbbab61c11327">01691</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#a47f01b7eaaec08a2b57cbbab61c11327">MyFrame::OnChangeActiveChemical</a>(wxCommandEvent&amp; event)
<a name="l01692"></a>01692 {
<a name="l01693"></a>01693     wxArrayString choices;
<a name="l01694"></a>01694     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;this-&gt;system-&gt;GetNumberOfChemicals();i++)
<a name="l01695"></a>01695         choices.Add(<a class="code" href="utils_8cpp.html#afd49013680a14bc8e1bfb0c79b80972f" title="a, b, c, ... z, aa, ab, ...">GetChemicalName</a>(i));
<a name="l01696"></a>01696     wxSingleChoiceDialog dlg(<span class="keyword">this</span>,_(<span class="stringliteral">&quot;Select the chemical to render:&quot;</span>),_(<span class="stringliteral">&quot;Select active chemical&quot;</span>),
<a name="l01697"></a>01697         choices);
<a name="l01698"></a>01698     dlg.SetSelection(<a class="code" href="utils_8cpp.html#a68e90099fe736c151fdf42384c533550">IndexFromChemicalName</a>(this-&gt;render_settings.GetProperty(<span class="stringliteral">&quot;active_chemical&quot;</span>).GetChemical()));
<a name="l01699"></a>01699     <span class="keywordflow">if</span>(dlg.ShowModal()!=wxID_OK) <span class="keywordflow">return</span>;
<a name="l01700"></a>01700     this-&gt;render_settings.GetProperty(<span class="stringliteral">&quot;active_chemical&quot;</span>).SetChemical(<a class="code" href="utils_8cpp.html#afd49013680a14bc8e1bfb0c79b80972f" title="a, b, c, ... z, aa, ab, ...">GetChemicalName</a>(dlg.GetSelection()));
<a name="l01701"></a>01701     <a class="code" href="vtk__pipeline_8cpp.html#a83eef6bea304823921ff32ce0afb6d2b">InitializeVTKPipeline</a>(this-&gt;pVTKWindow,this-&gt;system,this-&gt;render_settings,<span class="keyword">false</span>);
<a name="l01702"></a>01702     this-&gt;UpdateWindows();
<a name="l01703"></a>01703 }
<a name="l01704"></a>01704 
<a name="l01705"></a>01705 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l01706"></a>01706 
<a name="l01707"></a><a class="code" href="classMyFrame.html#a72043bb79d2b6736db8ae9dd39148618">01707</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#a72043bb79d2b6736db8ae9dd39148618">MyFrame::SetRuleName</a>(<span class="keywordtype">string</span> s)
<a name="l01708"></a>01708 {
<a name="l01709"></a>01709     this-&gt;system-&gt;SetRuleName(s);
<a name="l01710"></a>01710     this-&gt;UpdateWindowTitle();
<a name="l01711"></a>01711     this-&gt;UpdateInfoPane();
<a name="l01712"></a>01712 }
<a name="l01713"></a>01713 
<a name="l01714"></a>01714 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l01715"></a>01715 
<a name="l01716"></a><a class="code" href="classMyFrame.html#a3d6adab2be01d722b1821f10f3778b03">01716</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#a3d6adab2be01d722b1821f10f3778b03">MyFrame::SetDescription</a>(<span class="keywordtype">string</span> s)
<a name="l01717"></a>01717 {
<a name="l01718"></a>01718     this-&gt;system-&gt;SetDescription(s);
<a name="l01719"></a>01719     this-&gt;UpdateWindowTitle();
<a name="l01720"></a>01720     this-&gt;UpdateInfoPane();
<a name="l01721"></a>01721 }
<a name="l01722"></a>01722 
<a name="l01723"></a>01723 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l01724"></a>01724 
<a name="l01725"></a><a class="code" href="classMyFrame.html#a3382130cdc508a84a93b1fba6ce60127">01725</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#a3382130cdc508a84a93b1fba6ce60127">MyFrame::SetParameter</a>(<span class="keywordtype">int</span> iParam,<span class="keywordtype">float</span> val)
<a name="l01726"></a>01726 {
<a name="l01727"></a>01727     this-&gt;system-&gt;SetParameterValue(iParam,val);
<a name="l01728"></a>01728     this-&gt;UpdateWindowTitle();
<a name="l01729"></a>01729     this-&gt;UpdateInfoPane();
<a name="l01730"></a>01730 }
<a name="l01731"></a>01731 
<a name="l01732"></a>01732 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l01733"></a>01733 
<a name="l01734"></a><a class="code" href="classMyFrame.html#a48ec1ef1e55ac5c0877fbf4602438973">01734</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#a48ec1ef1e55ac5c0877fbf4602438973">MyFrame::SetParameterName</a>(<span class="keywordtype">int</span> iParam,std::string s)
<a name="l01735"></a>01735 {
<a name="l01736"></a>01736     this-&gt;system-&gt;SetParameterName(iParam,s);
<a name="l01737"></a>01737     this-&gt;UpdateWindowTitle();
<a name="l01738"></a>01738     this-&gt;UpdateInfoPane();
<a name="l01739"></a>01739 }
<a name="l01740"></a>01740 
<a name="l01741"></a>01741 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l01742"></a>01742 
<a name="l01743"></a><a class="code" href="classMyFrame.html#a79cd0b2b572c454067b2013df4743c49">01743</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#a79cd0b2b572c454067b2013df4743c49">MyFrame::SetFormula</a>(std::string s)
<a name="l01744"></a>01744 {
<a name="l01745"></a>01745     this-&gt;system-&gt;SetFormula(s);
<a name="l01746"></a>01746     this-&gt;UpdateWindowTitle();
<a name="l01747"></a>01747     this-&gt;UpdateInfoPane();
<a name="l01748"></a>01748 }
<a name="l01749"></a>01749 
<a name="l01750"></a>01750 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l01751"></a>01751 
<a name="l01752"></a><a class="code" href="classMyFrame.html#a11452a5e7f9c703d8efd600937901617">01752</a> <span class="keywordtype">bool</span> <a class="code" href="classMyFrame.html#a11452a5e7f9c703d8efd600937901617">MyFrame::UserWantsToCancelWhenAskedIfWantsToSave</a>()
<a name="l01753"></a>01753 {
<a name="l01754"></a>01754     <span class="keywordflow">if</span>(this-&gt;system == NULL || !this-&gt;system-&gt;IsModified()) <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l01755"></a>01755     
<a name="l01756"></a>01756     <span class="keywordtype">int</span> ret = <a class="code" href="wxutils_8cpp.html#aba71c60bf2fbed7083e7f571655e41f7">SaveChanges</a>(_(<span class="stringliteral">&quot;Save the current system?&quot;</span>),_(<span class="stringliteral">&quot;If you don&#39;t save, your changes will be lost.&quot;</span>));
<a name="l01757"></a>01757     <span class="keywordflow">if</span>(ret==wxCANCEL) <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l01758"></a>01758     <span class="keywordflow">if</span>(ret==wxNO) <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l01759"></a>01759 
<a name="l01760"></a>01760     <span class="comment">// ret == wxYES</span>
<a name="l01761"></a>01761     wxString filename = SavePatternDialog();
<a name="l01762"></a>01762     <span class="keywordflow">if</span>(filename.empty()) <span class="keywordflow">return</span> <span class="keyword">true</span>; <span class="comment">// user cancelled</span>
<a name="l01763"></a>01763 
<a name="l01764"></a>01764     SaveFile(filename);
<a name="l01765"></a>01765     <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l01766"></a>01766 }
<a name="l01767"></a>01767 
<a name="l01768"></a>01768 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l01769"></a>01769 
<a name="l01770"></a><a class="code" href="classMyFrame.html#aca8e8d9ade335e41689ae7ccbbc8675a">01770</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#aca8e8d9ade335e41689ae7ccbbc8675a">MyFrame::OnClose</a>(wxCloseEvent&amp; event)
<a name="l01771"></a>01771 {
<a name="l01772"></a>01772     <span class="keywordflow">if</span>(event.CanVeto() &amp;&amp; this-&gt;UserWantsToCancelWhenAskedIfWantsToSave()) <span class="keywordflow">return</span>;
<a name="l01773"></a>01773     <span class="keyword">event</span>.Skip();
<a name="l01774"></a>01774 }
<a name="l01775"></a>01775 
<a name="l01776"></a>01776 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l01777"></a>01777 
<a name="l01778"></a><a class="code" href="classMyFrame.html#ad8e839562e6445a7c23a31b45985cdab">01778</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#ad8e839562e6445a7c23a31b45985cdab">MyFrame::ShowPrefsDialog</a>(<span class="keyword">const</span> wxString&amp; page)
<a name="l01779"></a>01779 {
<a name="l01780"></a>01780     <span class="keywordflow">if</span> (<a class="code" href="prefs_8cpp.html#a64b9ee51f62e15bc2969519122d85e25">ChangePrefs</a>(page)) {
<a name="l01781"></a>01781         <span class="comment">// user hit OK button so might as well save prefs now</span>
<a name="l01782"></a>01782         SaveSettings();
<a name="l01783"></a>01783     }
<a name="l01784"></a>01784     <span class="comment">// safer to update everything even if user hit Cancel</span>
<a name="l01785"></a>01785     this-&gt;UpdateWindows();
<a name="l01786"></a>01786 }
<a name="l01787"></a>01787 
<a name="l01788"></a>01788 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l01789"></a>01789 
<a name="l01790"></a><a class="code" href="classMyFrame.html#a7fcd634b78a7900d13e0d7ae2afbea6d">01790</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#a7fcd634b78a7900d13e0d7ae2afbea6d">MyFrame::OnPreferences</a>(wxCommandEvent&amp; event)
<a name="l01791"></a>01791 {
<a name="l01792"></a>01792     ShowPrefsDialog();
<a name="l01793"></a>01793 }
<a name="l01794"></a>01794 
<a name="l01795"></a>01795 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l01796"></a>01796 
<a name="l01797"></a><a class="code" href="classMyFrame.html#a196dff933096bec97dbae62aa9ce67c9">01797</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#a196dff933096bec97dbae62aa9ce67c9">MyFrame::EnableAllMenus</a>(<span class="keywordtype">bool</span> enable)
<a name="l01798"></a>01798 {
<a name="l01799"></a>01799     wxMenuBar* mbar = GetMenuBar();
<a name="l01800"></a>01800     <span class="keywordflow">if</span> (mbar) {
<a name="l01801"></a>01801         <span class="keywordtype">int</span> count = mbar-&gt;GetMenuCount();
<a name="l01802"></a>01802         <span class="keywordtype">int</span> i;
<a name="l01803"></a>01803         <span class="keywordflow">for</span> (i = 0; i &lt; count; i++) {
<a name="l01804"></a>01804             mbar-&gt;EnableTop(i, enable);
<a name="l01805"></a>01805         }
<a name="l01806"></a>01806 <span class="preprocessor">        #ifdef __WXOSX_COCOA__</span>
<a name="l01807"></a>01807 <span class="preprocessor"></span>            <span class="comment">// enable/disable items in app menu</span>
<a name="l01808"></a>01808             <span class="comment">// AKT TODO!!! they fail to disable due to wxOSX-Cocoa bug</span>
<a name="l01809"></a>01809             mbar-&gt;Enable(wxID_ABOUT, enable);
<a name="l01810"></a>01810             mbar-&gt;Enable(wxID_PREFERENCES, enable);
<a name="l01811"></a>01811             mbar-&gt;Enable(wxID_EXIT, enable);
<a name="l01812"></a>01812 <span class="preprocessor">        #endif</span>
<a name="l01813"></a>01813 <span class="preprocessor"></span>    }
<a name="l01814"></a>01814 }
<a name="l01815"></a>01815 
<a name="l01816"></a>01816 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l01817"></a>01817 
<a name="l01818"></a><a class="code" href="classMyFrame.html#ab1b7872607e17b76d86f104c94518ec6">01818</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#ab1b7872607e17b76d86f104c94518ec6">MyFrame::OnActivate</a>(wxActivateEvent&amp; event)
<a name="l01819"></a>01819 {
<a name="l01820"></a>01820     <span class="comment">// we need to disable all menu items when frame becomes inactive</span>
<a name="l01821"></a>01821     <span class="comment">// (eg. due to a modal dialog appearing) so that keys bound to menu items</span>
<a name="l01822"></a>01822     <span class="comment">// get passed to wxTextCtrls</span>
<a name="l01823"></a>01823     EnableAllMenus(event.GetActive());
<a name="l01824"></a>01824     <span class="keyword">event</span>.Skip();
<a name="l01825"></a>01825 }
<a name="l01826"></a>01826 
<a name="l01827"></a>01827 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l01828"></a>01828 
<a name="l01829"></a><a class="code" href="classMyFrame.html#a2fb74621355633ddff14d83943003550">01829</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#a2fb74621355633ddff14d83943003550">MyFrame::UpdateMenuAccelerators</a>()
<a name="l01830"></a>01830 {
<a name="l01831"></a>01831     <span class="comment">// keyboard shortcuts have changed, so update all menu item accelerators</span>
<a name="l01832"></a>01832     wxMenuBar* mbar = GetMenuBar();
<a name="l01833"></a>01833     <span class="keywordflow">if</span> (mbar) {
<a name="l01834"></a>01834         <span class="comment">// AKT TODO!!! wxOSX-Cocoa bug: these app menu items aren&#39;t updated</span>
<a name="l01835"></a>01835         <span class="comment">// (but user isn&#39;t likely to change them so not critical)</span>
<a name="l01836"></a>01836         <a class="code" href="prefs_8cpp.html#a80ab9b805f2f3378a3e053969dddbb2c">SetAccelerator</a>(mbar, wxID_ABOUT,                    <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a6c41bc6a32c0c5bb09a732a21cfccf4f">DO_ABOUT</a>);
<a name="l01837"></a>01837         <a class="code" href="prefs_8cpp.html#a80ab9b805f2f3378a3e053969dddbb2c">SetAccelerator</a>(mbar, wxID_PREFERENCES,              <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a9df6720475a3f3e52740a0250774dee2">DO_PREFS</a>);
<a name="l01838"></a>01838         <a class="code" href="prefs_8cpp.html#a80ab9b805f2f3378a3e053969dddbb2c">SetAccelerator</a>(mbar, wxID_EXIT,                     <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a0d23c152db0c24154c6a13303a6151a4">DO_QUIT</a>);
<a name="l01839"></a>01839         
<a name="l01840"></a>01840         <a class="code" href="prefs_8cpp.html#a80ab9b805f2f3378a3e053969dddbb2c">SetAccelerator</a>(mbar, wxID_NEW,                      <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a0a8b90d6d06556d673ffab3fe7bd765a">DO_NEWPATT</a>);
<a name="l01841"></a>01841         <a class="code" href="prefs_8cpp.html#a80ab9b805f2f3378a3e053969dddbb2c">SetAccelerator</a>(mbar, wxID_OPEN,                     <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a13b814442bb726fc27e2e46d75f68903">DO_OPENPATT</a>);
<a name="l01842"></a>01842         <a class="code" href="prefs_8cpp.html#a80ab9b805f2f3378a3e053969dddbb2c">SetAccelerator</a>(mbar, <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a175531e6c07358f49a087d247ad79c2c">ID::ImportMesh</a>,                <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a1f4076bb401751fd60b827874e30b09c">DO_IMPORTMESH</a>);
<a name="l01843"></a>01843         <a class="code" href="prefs_8cpp.html#a80ab9b805f2f3378a3e053969dddbb2c">SetAccelerator</a>(mbar, <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a5a8bede146a5ee0a5972b95d7398f52b">ID::ExportMesh</a>,                <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a3b71061f14e65228175c258013cbec1c">DO_EXPORTMESH</a>);
<a name="l01844"></a>01844         <a class="code" href="prefs_8cpp.html#a80ab9b805f2f3378a3e053969dddbb2c">SetAccelerator</a>(mbar, wxID_SAVE,                     <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62ac14c985dfcd45cba2f41c72260d29ffe">DO_SAVE</a>);
<a name="l01845"></a>01845         <a class="code" href="prefs_8cpp.html#a80ab9b805f2f3378a3e053969dddbb2c">SetAccelerator</a>(mbar, <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a67f4892e5c57cce8f949046681a353e9">ID::Screenshot</a>,                <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a8031583e5967eecb9ddf9d6a25962e5d">DO_SCREENSHOT</a>);
<a name="l01846"></a>01846         <a class="code" href="prefs_8cpp.html#a80ab9b805f2f3378a3e053969dddbb2c">SetAccelerator</a>(mbar, <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a96cb152725348747ab810e2f61fd95b8">ID::AddMyPatterns</a>,             <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a9b0e09a8a5af3eeda22366ae9a682b06">DO_ADDPATTS</a>);
<a name="l01847"></a>01847         
<a name="l01848"></a>01848         <a class="code" href="prefs_8cpp.html#a80ab9b805f2f3378a3e053969dddbb2c">SetAccelerator</a>(mbar, wxID_CUT,                      <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a86e6bb0ed1ed8e2b71aeee759d04f751">DO_CUT</a>);
<a name="l01849"></a>01849         <a class="code" href="prefs_8cpp.html#a80ab9b805f2f3378a3e053969dddbb2c">SetAccelerator</a>(mbar, wxID_COPY,                     <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a66ab504cb136ee10d90b5041b69b1072">DO_COPY</a>);
<a name="l01850"></a>01850         <a class="code" href="prefs_8cpp.html#a80ab9b805f2f3378a3e053969dddbb2c">SetAccelerator</a>(mbar, wxID_PASTE,                    <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a57db23febf9d70735b2d5429f9322921">DO_PASTE</a>);
<a name="l01851"></a>01851         <a class="code" href="prefs_8cpp.html#a80ab9b805f2f3378a3e053969dddbb2c">SetAccelerator</a>(mbar, wxID_CLEAR,                    <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62ad1502fb1fa8a6db8f0d5eab8c5ea1795">DO_CLEAR</a>);
<a name="l01852"></a>01852         <a class="code" href="prefs_8cpp.html#a80ab9b805f2f3378a3e053969dddbb2c">SetAccelerator</a>(mbar, wxID_SELECTALL,                <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a5e89d8bab01100c776f98476f132750c">DO_SELALL</a>);
<a name="l01853"></a>01853         
<a name="l01854"></a>01854         <a class="code" href="prefs_8cpp.html#a80ab9b805f2f3378a3e053969dddbb2c">SetAccelerator</a>(mbar, <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a414589df96055cbbf92f287fc135dcbf">ID::FullScreen</a>,                <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a14ccfd2e63a339d4172bda3ad550fff2">DO_FULLSCREEN</a>);
<a name="l01855"></a>01855         <a class="code" href="prefs_8cpp.html#a80ab9b805f2f3378a3e053969dddbb2c">SetAccelerator</a>(mbar, <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a427c0b326c042c60a407421b66c543fa">ID::FitPattern</a>,                <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a4b6a631192c5074db6357ebea2a4caf0">DO_FIT</a>);
<a name="l01856"></a>01856         <a class="code" href="prefs_8cpp.html#a80ab9b805f2f3378a3e053969dddbb2c">SetAccelerator</a>(mbar, <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994ac939d32eac9bad1c9c238c92526f6143">ID::Wireframe</a>,                 <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a069bd47d4f1f5762840246bb5a52bebf">DO_WIREFRAME</a>);
<a name="l01857"></a>01857         <a class="code" href="prefs_8cpp.html#a80ab9b805f2f3378a3e053969dddbb2c">SetAccelerator</a>(mbar, <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994acb63579b388e2e1b0fa5117d6bc55e08">ID::PatternsPane</a>,              <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a57a2af46aa8cd3deb36042aa2a05a4f0">DO_PATTERNS</a>);
<a name="l01858"></a>01858         <a class="code" href="prefs_8cpp.html#a80ab9b805f2f3378a3e053969dddbb2c">SetAccelerator</a>(mbar, <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a9a7b8f50f338bc1f33bbb46a265c66b2">ID::InfoPane</a>,                  <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a3b10246f0f8338327b892109a70eca29">DO_INFO</a>);
<a name="l01859"></a>01859         <a class="code" href="prefs_8cpp.html#a80ab9b805f2f3378a3e053969dddbb2c">SetAccelerator</a>(mbar, <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994aa793fe9cd53e4212456e78a881d61e73">ID::HelpPane</a>,                  <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a150b825efd182d9c95b587c9ef5516b9">DO_HELP</a>);
<a name="l01860"></a>01860         <a class="code" href="prefs_8cpp.html#a80ab9b805f2f3378a3e053969dddbb2c">SetAccelerator</a>(mbar, <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a970f2597ef339a100a5499c8bb8521c8">ID::RestoreDefaultPerspective</a>, <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62afb76022044b62bb892c1ee65ac4ef721">DO_RESTORE</a>);
<a name="l01861"></a>01861         <a class="code" href="prefs_8cpp.html#a80ab9b805f2f3378a3e053969dddbb2c">SetAccelerator</a>(mbar, <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a877fbb5ffc961960113e5daaa2cf81b2">ID::ChangeActiveChemical</a>,      <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a776300076489934b1008c8d05602a494">DO_CHEMICAL</a>);
<a name="l01862"></a>01862         
<a name="l01863"></a>01863         <a class="code" href="prefs_8cpp.html#a80ab9b805f2f3378a3e053969dddbb2c">SetAccelerator</a>(mbar, <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a29ce194c83647cde2066a129499a28b1">ID::Step1</a>,                     <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a5b6cbabe6909263c772ceb091fb2edcd">DO_STEP1</a>);
<a name="l01864"></a>01864         <a class="code" href="prefs_8cpp.html#a80ab9b805f2f3378a3e053969dddbb2c">SetAccelerator</a>(mbar, <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994aabc39ee10e4d33f32ba11dd7773ad781">ID::StepN</a>,                     <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62af6d9327fcfb8264f43b07cb94d66ec10">DO_STEPN</a>);
<a name="l01865"></a>01865         <a class="code" href="prefs_8cpp.html#a80ab9b805f2f3378a3e053969dddbb2c">SetAccelerator</a>(mbar, <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a7fa86a9ca58943a68ee72c2278d7091f">ID::RunStop</a>,                   <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62ad6773bc2d8b3a475b59775af5afc215c">DO_RUNSTOP</a>);
<a name="l01866"></a>01866         <a class="code" href="prefs_8cpp.html#a80ab9b805f2f3378a3e053969dddbb2c">SetAccelerator</a>(mbar, <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994ae64df26aa1aa17c056626418eeba266c">ID::Reset</a>,                     <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a4165bc81d865b678b2f9b7410eed6018">DO_RESET</a>);
<a name="l01867"></a>01867         <a class="code" href="prefs_8cpp.html#a80ab9b805f2f3378a3e053969dddbb2c">SetAccelerator</a>(mbar, <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a8b6dde37a380581b5c30d1d5f912f183">ID::GenerateInitialPattern</a>,    <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a4fe766d76d47511ceac02eff795a8b58">DO_GENPATT</a>);
<a name="l01868"></a>01868         <a class="code" href="prefs_8cpp.html#a80ab9b805f2f3378a3e053969dddbb2c">SetAccelerator</a>(mbar, <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994ac6fcd8a484e837c655a4dfbbe689c12c">ID::Faster</a>,                    <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a389cee4c4147fecd61a4d134396e2e72">DO_FASTER</a>);
<a name="l01869"></a>01869         <a class="code" href="prefs_8cpp.html#a80ab9b805f2f3378a3e053969dddbb2c">SetAccelerator</a>(mbar, <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a9ec4f0f78fdccdd3937c37932871cb31">ID::Slower</a>,                    <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a53386a419f01d0b75372910dc9260c7e">DO_SLOWER</a>);
<a name="l01870"></a>01870         <a class="code" href="prefs_8cpp.html#a80ab9b805f2f3378a3e053969dddbb2c">SetAccelerator</a>(mbar, <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a34de4b7050e8e026745a5287938fd874">ID::ChangeRunningSpeed</a>,        <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62ae99153a35a4d051301adf666e9263afe">DO_CHANGESPEED</a>);
<a name="l01871"></a>01871         <a class="code" href="prefs_8cpp.html#a80ab9b805f2f3378a3e053969dddbb2c">SetAccelerator</a>(mbar, <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a7755c932c23e416eff7e29e82276dc87">ID::AddParameter</a>,              <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62aa4d123ec804f00f2a2e6668d0c3770fe">DO_ADDPARAM</a>);
<a name="l01872"></a>01872         <a class="code" href="prefs_8cpp.html#a80ab9b805f2f3378a3e053969dddbb2c">SetAccelerator</a>(mbar, <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a9377f837fdf3eb370dd4d06d34dd1e29">ID::DeleteParameter</a>,           <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a2d72ebc020c77a64e833c939c6dabbd6">DO_DELPARAM</a>);
<a name="l01873"></a>01873         <a class="code" href="prefs_8cpp.html#a80ab9b805f2f3378a3e053969dddbb2c">SetAccelerator</a>(mbar, <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a82d526382ae3e9f7b1ecf5274d3c265f">ID::SelectOpenCLDevice</a>,        <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62acb4c9b11dea3500cc66f3f402c084a2a">DO_DEVICE</a>);
<a name="l01874"></a>01874         <a class="code" href="prefs_8cpp.html#a80ab9b805f2f3378a3e053969dddbb2c">SetAccelerator</a>(mbar, <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a25785909b339d2424ba3e06092aea24d">ID::OpenCLDiagnostics</a>,         <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a47d344b75c0413566f55457e40d54914">DO_OPENCL</a>);
<a name="l01875"></a>01875     }
<a name="l01876"></a>01876 }
<a name="l01877"></a>01877 
<a name="l01878"></a>01878 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l01879"></a>01879 
<a name="l01880"></a><a class="code" href="classMyFrame.html#a47a959eefdac32d85b8d3fe6b675329a">01880</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#a47a959eefdac32d85b8d3fe6b675329a">MyFrame::ProcessKey</a>(<span class="keywordtype">int</span> key, <span class="keywordtype">int</span> modifiers)
<a name="l01881"></a>01881 {
<a name="l01882"></a>01882     <span class="keywordtype">int</span> cmdid = 0;
<a name="l01883"></a>01883     <a class="code" href="structaction__info.html">action_info</a> action = <a class="code" href="prefs_8cpp.html#a3c4b979a2ad1be1b0c006967843ee58d">FindAction</a>(key, modifiers);
<a name="l01884"></a>01884     
<a name="l01885"></a>01885     <span class="keywordflow">switch</span> (action.<a class="code" href="structaction__info.html#aa8aa631cd84cd7672b7870e1af6e6863">id</a>)
<a name="l01886"></a>01886     {
<a name="l01887"></a>01887         <span class="keywordflow">case</span> <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62aa3c06bc7e4d652a970cab72026c6fed1">DO_NOTHING</a>:        <span class="comment">// any unassigned key (including escape) turns off full screen mode</span>
<a name="l01888"></a>01888                                 <span class="keywordflow">if</span> (fullscreen) cmdid = <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a414589df96055cbbf92f287fc135dcbf">ID::FullScreen</a>; <span class="keywordflow">break</span>;
<a name="l01889"></a>01889         
<a name="l01890"></a>01890         <span class="keywordflow">case</span> <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a143bfdd54d27e620ee14307ec3cbd989">DO_OPENFILE</a>:       OpenFile(action.<a class="code" href="structaction__info.html#aa467bd3685a2427efa3f49cae6df2301">file</a>);
<a name="l01891"></a>01891                                 <span class="keywordflow">return</span>;
<a name="l01892"></a>01892         
<a name="l01893"></a>01893         <span class="comment">// File menu</span>
<a name="l01894"></a>01894         <span class="keywordflow">case</span> <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a0a8b90d6d06556d673ffab3fe7bd765a">DO_NEWPATT</a>:        cmdid = wxID_NEW; <span class="keywordflow">break</span>;
<a name="l01895"></a>01895         <span class="keywordflow">case</span> <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a13b814442bb726fc27e2e46d75f68903">DO_OPENPATT</a>:       cmdid = wxID_OPEN; <span class="keywordflow">break</span>;
<a name="l01896"></a>01896         <span class="keywordflow">case</span> <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a1f4076bb401751fd60b827874e30b09c">DO_IMPORTMESH</a>:     cmdid = <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a175531e6c07358f49a087d247ad79c2c">ID::ImportMesh</a>; <span class="keywordflow">break</span>;
<a name="l01897"></a>01897         <span class="keywordflow">case</span> <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a3b71061f14e65228175c258013cbec1c">DO_EXPORTMESH</a>:     cmdid = <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a5a8bede146a5ee0a5972b95d7398f52b">ID::ExportMesh</a>; <span class="keywordflow">break</span>;
<a name="l01898"></a>01898         <span class="keywordflow">case</span> <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62ac14c985dfcd45cba2f41c72260d29ffe">DO_SAVE</a>:           cmdid = wxID_SAVE; <span class="keywordflow">break</span>;
<a name="l01899"></a>01899         <span class="keywordflow">case</span> <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a8031583e5967eecb9ddf9d6a25962e5d">DO_SCREENSHOT</a>:     cmdid = <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a67f4892e5c57cce8f949046681a353e9">ID::Screenshot</a>; <span class="keywordflow">break</span>;
<a name="l01900"></a>01900         <span class="keywordflow">case</span> <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a9b0e09a8a5af3eeda22366ae9a682b06">DO_ADDPATTS</a>:       cmdid = <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a96cb152725348747ab810e2f61fd95b8">ID::AddMyPatterns</a>; <span class="keywordflow">break</span>;
<a name="l01901"></a>01901         <span class="keywordflow">case</span> <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a9df6720475a3f3e52740a0250774dee2">DO_PREFS</a>:          cmdid = wxID_PREFERENCES; <span class="keywordflow">break</span>;
<a name="l01902"></a>01902         <span class="keywordflow">case</span> <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a0d23c152db0c24154c6a13303a6151a4">DO_QUIT</a>:           cmdid = wxID_EXIT; <span class="keywordflow">break</span>;
<a name="l01903"></a>01903         
<a name="l01904"></a>01904         <span class="comment">// Edit menu</span>
<a name="l01905"></a>01905         <span class="keywordflow">case</span> <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a86e6bb0ed1ed8e2b71aeee759d04f751">DO_CUT</a>:            cmdid = wxID_CUT; <span class="keywordflow">break</span>;
<a name="l01906"></a>01906         <span class="keywordflow">case</span> <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a66ab504cb136ee10d90b5041b69b1072">DO_COPY</a>:           cmdid = wxID_COPY; <span class="keywordflow">break</span>;
<a name="l01907"></a>01907         <span class="keywordflow">case</span> <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a57db23febf9d70735b2d5429f9322921">DO_PASTE</a>:          cmdid = wxID_PASTE; <span class="keywordflow">break</span>;
<a name="l01908"></a>01908         <span class="keywordflow">case</span> <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62ad1502fb1fa8a6db8f0d5eab8c5ea1795">DO_CLEAR</a>:          cmdid = wxID_CLEAR; <span class="keywordflow">break</span>;
<a name="l01909"></a>01909         <span class="keywordflow">case</span> <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a5e89d8bab01100c776f98476f132750c">DO_SELALL</a>:         cmdid = wxID_SELECTALL; <span class="keywordflow">break</span>;
<a name="l01910"></a>01910         
<a name="l01911"></a>01911         <span class="comment">// View menu</span>
<a name="l01912"></a>01912         <span class="keywordflow">case</span> <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a14ccfd2e63a339d4172bda3ad550fff2">DO_FULLSCREEN</a>:     cmdid = <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a414589df96055cbbf92f287fc135dcbf">ID::FullScreen</a>; <span class="keywordflow">break</span>;
<a name="l01913"></a>01913         <span class="keywordflow">case</span> <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a4b6a631192c5074db6357ebea2a4caf0">DO_FIT</a>:            cmdid = <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a427c0b326c042c60a407421b66c543fa">ID::FitPattern</a>; <span class="keywordflow">break</span>;
<a name="l01914"></a>01914         <span class="keywordflow">case</span> <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a069bd47d4f1f5762840246bb5a52bebf">DO_WIREFRAME</a>:      cmdid = <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994ac939d32eac9bad1c9c238c92526f6143">ID::Wireframe</a>; <span class="keywordflow">break</span>;
<a name="l01915"></a>01915         <span class="keywordflow">case</span> <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a57a2af46aa8cd3deb36042aa2a05a4f0">DO_PATTERNS</a>:       cmdid = <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994acb63579b388e2e1b0fa5117d6bc55e08">ID::PatternsPane</a>; <span class="keywordflow">break</span>;
<a name="l01916"></a>01916         <span class="keywordflow">case</span> <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a3b10246f0f8338327b892109a70eca29">DO_INFO</a>:           cmdid = <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a9a7b8f50f338bc1f33bbb46a265c66b2">ID::InfoPane</a>; <span class="keywordflow">break</span>;
<a name="l01917"></a>01917         <span class="keywordflow">case</span> <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a150b825efd182d9c95b587c9ef5516b9">DO_HELP</a>:           cmdid = <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994aa793fe9cd53e4212456e78a881d61e73">ID::HelpPane</a>; <span class="keywordflow">break</span>;
<a name="l01918"></a>01918         <span class="keywordflow">case</span> <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62afb76022044b62bb892c1ee65ac4ef721">DO_RESTORE</a>:        cmdid = <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a970f2597ef339a100a5499c8bb8521c8">ID::RestoreDefaultPerspective</a>; <span class="keywordflow">break</span>;
<a name="l01919"></a>01919         <span class="keywordflow">case</span> <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a776300076489934b1008c8d05602a494">DO_CHEMICAL</a>:       cmdid = <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a877fbb5ffc961960113e5daaa2cf81b2">ID::ChangeActiveChemical</a>; <span class="keywordflow">break</span>;
<a name="l01920"></a>01920         
<a name="l01921"></a>01921         <span class="comment">// Action menu</span>
<a name="l01922"></a>01922         <span class="keywordflow">case</span> <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a5b6cbabe6909263c772ceb091fb2edcd">DO_STEP1</a>:          cmdid = <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a29ce194c83647cde2066a129499a28b1">ID::Step1</a>; <span class="keywordflow">break</span>;
<a name="l01923"></a>01923         <span class="keywordflow">case</span> <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62af6d9327fcfb8264f43b07cb94d66ec10">DO_STEPN</a>:          cmdid = <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994aabc39ee10e4d33f32ba11dd7773ad781">ID::StepN</a>; <span class="keywordflow">break</span>;
<a name="l01924"></a>01924         <span class="keywordflow">case</span> <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62ad6773bc2d8b3a475b59775af5afc215c">DO_RUNSTOP</a>:        cmdid = <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a7fa86a9ca58943a68ee72c2278d7091f">ID::RunStop</a>; <span class="keywordflow">break</span>;
<a name="l01925"></a>01925         <span class="keywordflow">case</span> <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a4165bc81d865b678b2f9b7410eed6018">DO_RESET</a>:          cmdid = <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994ae64df26aa1aa17c056626418eeba266c">ID::Reset</a>; <span class="keywordflow">break</span>;
<a name="l01926"></a>01926         <span class="keywordflow">case</span> <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a4fe766d76d47511ceac02eff795a8b58">DO_GENPATT</a>:        cmdid = <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a8b6dde37a380581b5c30d1d5f912f183">ID::GenerateInitialPattern</a>; <span class="keywordflow">break</span>;
<a name="l01927"></a>01927         <span class="keywordflow">case</span> <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a389cee4c4147fecd61a4d134396e2e72">DO_FASTER</a>:         cmdid = <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994ac6fcd8a484e837c655a4dfbbe689c12c">ID::Faster</a>; <span class="keywordflow">break</span>;
<a name="l01928"></a>01928         <span class="keywordflow">case</span> <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a53386a419f01d0b75372910dc9260c7e">DO_SLOWER</a>:         cmdid = <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a9ec4f0f78fdccdd3937c37932871cb31">ID::Slower</a>; <span class="keywordflow">break</span>;
<a name="l01929"></a>01929         <span class="keywordflow">case</span> <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62ae99153a35a4d051301adf666e9263afe">DO_CHANGESPEED</a>:    cmdid = <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a34de4b7050e8e026745a5287938fd874">ID::ChangeRunningSpeed</a>; <span class="keywordflow">break</span>;
<a name="l01930"></a>01930         <span class="keywordflow">case</span> <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62aa4d123ec804f00f2a2e6668d0c3770fe">DO_ADDPARAM</a>:       cmdid = <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a7755c932c23e416eff7e29e82276dc87">ID::AddParameter</a>; <span class="keywordflow">break</span>;
<a name="l01931"></a>01931         <span class="keywordflow">case</span> <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a2d72ebc020c77a64e833c939c6dabbd6">DO_DELPARAM</a>:       cmdid = <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a9377f837fdf3eb370dd4d06d34dd1e29">ID::DeleteParameter</a>; <span class="keywordflow">break</span>;
<a name="l01932"></a>01932         <span class="keywordflow">case</span> <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62acb4c9b11dea3500cc66f3f402c084a2a">DO_DEVICE</a>:         cmdid = <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a82d526382ae3e9f7b1ecf5274d3c265f">ID::SelectOpenCLDevice</a>; <span class="keywordflow">break</span>;
<a name="l01933"></a>01933         <span class="keywordflow">case</span> <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a47d344b75c0413566f55457e40d54914">DO_OPENCL</a>:         cmdid = <a class="code" href="namespaceID.html#ab9317ede1ebbe3a57796376e8f91d994a25785909b339d2424ba3e06092aea24d">ID::OpenCLDiagnostics</a>; <span class="keywordflow">break</span>;
<a name="l01934"></a>01934         
<a name="l01935"></a>01935         <span class="comment">// Help menu</span>
<a name="l01936"></a>01936         <span class="keywordflow">case</span> <a class="code" href="prefs_8hpp.html#a15b03b1d71b001298165979475b1aa62a6c41bc6a32c0c5bb09a732a21cfccf4f">DO_ABOUT</a>:          cmdid = wxID_ABOUT; <span class="keywordflow">break</span>;
<a name="l01937"></a>01937         
<a name="l01938"></a>01938         <span class="keywordflow">default</span>:                <a class="code" href="wxutils_8cpp.html#ad496c0028843186f55032174260d2732">Warning</a>(_(<span class="stringliteral">&quot;Bug detected in ProcessKey!&quot;</span>));
<a name="l01939"></a>01939     }
<a name="l01940"></a>01940    
<a name="l01941"></a>01941     <span class="keywordflow">if</span> (cmdid != 0) {
<a name="l01942"></a>01942         wxCommandEvent cmdevent(wxEVT_COMMAND_MENU_SELECTED, cmdid);
<a name="l01943"></a>01943         cmdevent.SetEventObject(<span class="keyword">this</span>);
<a name="l01944"></a>01944         this-&gt;GetEventHandler()-&gt;ProcessEvent(cmdevent);
<a name="l01945"></a>01945     }
<a name="l01946"></a>01946 }
<a name="l01947"></a>01947 
<a name="l01948"></a>01948 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l01949"></a>01949 
<a name="l01950"></a><a class="code" href="classMyFrame.html#ac0457b9e23e582141215c35e5d42d97c">01950</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#ac0457b9e23e582141215c35e5d42d97c">MyFrame::OnKeyDown</a>(wxKeyEvent&amp; event)
<a name="l01951"></a>01951 {
<a name="l01952"></a>01952 <span class="preprocessor">    #ifdef __WXMAC__</span>
<a name="l01953"></a>01953 <span class="preprocessor"></span>        <span class="comment">// close any open tool tip window (fixes wxMac bug?)</span>
<a name="l01954"></a>01954         wxToolTip::RemoveToolTips();
<a name="l01955"></a>01955 <span class="preprocessor">    #endif</span>
<a name="l01956"></a>01956 <span class="preprocessor"></span>
<a name="l01957"></a>01957     realkey = <span class="keyword">event</span>.GetKeyCode();
<a name="l01958"></a>01958     <span class="keywordtype">int</span> mods = <span class="keyword">event</span>.GetModifiers();
<a name="l01959"></a>01959 
<a name="l01960"></a>01960     <span class="comment">// WARNING: logic must match that in KeyComboCtrl::OnKeyDown in prefs.cpp</span>
<a name="l01961"></a>01961     <span class="keywordflow">if</span> (mods == wxMOD_NONE || realkey == WXK_ESCAPE || realkey &gt; 127) {
<a name="l01962"></a>01962         <span class="comment">// tell OnChar handler to ignore realkey</span>
<a name="l01963"></a>01963         realkey = 0;
<a name="l01964"></a>01964     }
<a name="l01965"></a>01965 
<a name="l01966"></a>01966 <span class="preprocessor">    #ifdef __WXOSX__</span>
<a name="l01967"></a>01967 <span class="preprocessor"></span>        <span class="comment">// pass ctrl/cmd-key combos directly to OnChar</span>
<a name="l01968"></a>01968         <span class="keywordflow">if</span> (realkey &gt; 0 &amp;&amp; ((mods &amp; wxMOD_CONTROL) || (mods &amp; wxMOD_CMD))) {
<a name="l01969"></a>01969             this-&gt;OnChar(event);
<a name="l01970"></a>01970             <span class="keywordflow">return</span>;
<a name="l01971"></a>01971         }
<a name="l01972"></a>01972 <span class="preprocessor">    #endif</span>
<a name="l01973"></a>01973 <span class="preprocessor"></span>    
<a name="l01974"></a>01974 <span class="preprocessor">    #ifdef __WXMSW__</span>
<a name="l01975"></a>01975 <span class="preprocessor"></span>        <span class="comment">// on Windows, OnChar is NOT called for some ctrl-key combos like</span>
<a name="l01976"></a>01976         <span class="comment">// ctrl-0..9 or ctrl-alt-key, so we call OnChar ourselves</span>
<a name="l01977"></a>01977         <span class="keywordflow">if</span> (realkey &gt; 0 &amp;&amp; (mods &amp; wxMOD_CONTROL)) {
<a name="l01978"></a>01978             this-&gt;OnChar(event);
<a name="l01979"></a>01979             <span class="keywordflow">return</span>;
<a name="l01980"></a>01980         }
<a name="l01981"></a>01981 <span class="preprocessor">    #endif</span>
<a name="l01982"></a>01982 <span class="preprocessor"></span>
<a name="l01983"></a>01983 <span class="preprocessor">    #ifdef __WXGTK__</span>
<a name="l01984"></a>01984 <span class="preprocessor"></span>        <span class="keywordflow">if</span> (realkey == <span class="charliteral">&#39; &#39;</span> &amp;&amp; mods == wxMOD_SHIFT) {
<a name="l01985"></a>01985             <span class="comment">// fix wxGTK bug (curiously, the bug isn&#39;t seen in the prefs dialog);</span>
<a name="l01986"></a>01986             <span class="comment">// OnChar won&#39;t see the shift modifier, so set realkey to a special</span>
<a name="l01987"></a>01987             <span class="comment">// value to tell OnChar that shift-space was pressed</span>
<a name="l01988"></a>01988             realkey = -666;
<a name="l01989"></a>01989         }
<a name="l01990"></a>01990 <span class="preprocessor">    #endif</span>
<a name="l01991"></a>01991 <span class="preprocessor"></span>
<a name="l01992"></a>01992     <span class="keyword">event</span>.Skip();
<a name="l01993"></a>01993 }
<a name="l01994"></a>01994 
<a name="l01995"></a>01995 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l01996"></a>01996 
<a name="l01997"></a><a class="code" href="classMyFrame.html#a7d2dd27713dc21ead65462aeca0d0d75">01997</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#a7d2dd27713dc21ead65462aeca0d0d75">MyFrame::OnChar</a>(wxKeyEvent&amp; event)
<a name="l01998"></a>01998 {
<a name="l01999"></a>01999     <span class="keywordtype">int</span> key = <span class="keyword">event</span>.GetKeyCode();
<a name="l02000"></a>02000     <span class="keywordtype">int</span> mods = <span class="keyword">event</span>.GetModifiers();
<a name="l02001"></a>02001 
<a name="l02002"></a>02002     <span class="comment">// WARNING: logic here must match that in KeyComboCtrl::OnChar in prefs.cpp</span>
<a name="l02003"></a>02003     <span class="keywordflow">if</span> (realkey &gt; 0 &amp;&amp; mods != wxMOD_NONE) {
<a name="l02004"></a>02004 <span class="preprocessor">        #ifdef __WXGTK__</span>
<a name="l02005"></a>02005 <span class="preprocessor"></span>            <span class="comment">// sigh... wxGTK returns inconsistent results for shift-comma combos</span>
<a name="l02006"></a>02006             <span class="comment">// so we assume that &#39;&lt;&#39; is produced by pressing shift-comma</span>
<a name="l02007"></a>02007             <span class="comment">// (which might only be true for US keyboards)</span>
<a name="l02008"></a>02008             <span class="keywordflow">if</span> (key == <span class="charliteral">&#39;&lt;&#39;</span> &amp;&amp; (mods &amp; wxMOD_SHIFT)) realkey = <span class="charliteral">&#39;,&#39;</span>;
<a name="l02009"></a>02009 <span class="preprocessor">        #endif</span>
<a name="l02010"></a>02010 <span class="preprocessor"></span><span class="preprocessor">        #ifdef __WXMSW__</span>
<a name="l02011"></a>02011 <span class="preprocessor"></span>            <span class="comment">// sigh... wxMSW returns inconsistent results for some shift-key combos</span>
<a name="l02012"></a>02012             <span class="comment">// so again we assume we&#39;re using a US keyboard</span>
<a name="l02013"></a>02013             <span class="keywordflow">if</span> (key == <span class="charliteral">&#39;~&#39;</span> &amp;&amp; (mods &amp; wxMOD_SHIFT)) realkey = <span class="charliteral">&#39;`&#39;</span>;
<a name="l02014"></a>02014             <span class="keywordflow">if</span> (key == <span class="charliteral">&#39;+&#39;</span> &amp;&amp; (mods &amp; wxMOD_SHIFT)) realkey = <span class="charliteral">&#39;=&#39;</span>;
<a name="l02015"></a>02015 <span class="preprocessor">        #endif</span>
<a name="l02016"></a>02016 <span class="preprocessor"></span>        <span class="keywordflow">if</span> (mods == wxMOD_SHIFT &amp;&amp; key != realkey) {
<a name="l02017"></a>02017             <span class="comment">// use translated key code but remove shift key;</span>
<a name="l02018"></a>02018             <span class="comment">// eg. we want shift-&#39;/&#39; to be seen as &#39;?&#39;</span>
<a name="l02019"></a>02019             mods = wxMOD_NONE;
<a name="l02020"></a>02020         } <span class="keywordflow">else</span> {
<a name="l02021"></a>02021             <span class="comment">// use key code seen by OnKeyDown</span>
<a name="l02022"></a>02022             key = realkey;
<a name="l02023"></a>02023             <span class="keywordflow">if</span> (key &gt;= <span class="charliteral">&#39;A&#39;</span> &amp;&amp; key &lt;= <span class="charliteral">&#39;Z&#39;</span>) key += 32;  <span class="comment">// convert A..Z to a..z</span>
<a name="l02024"></a>02024         }
<a name="l02025"></a>02025     }
<a name="l02026"></a>02026     
<a name="l02027"></a>02027 <span class="preprocessor">    #ifdef __WXGTK__</span>
<a name="l02028"></a>02028 <span class="preprocessor"></span>        <span class="keywordflow">if</span> (realkey == -666) {
<a name="l02029"></a>02029             <span class="comment">// OnKeyDown saw that shift-space was pressed but for some reason</span>
<a name="l02030"></a>02030             <span class="comment">// OnChar doesn&#39;t see the modifier (ie. mods is wxMOD_NONE)</span>
<a name="l02031"></a>02031             key = <span class="charliteral">&#39; &#39;</span>;
<a name="l02032"></a>02032             mods = wxMOD_SHIFT;
<a name="l02033"></a>02033         }
<a name="l02034"></a>02034 <span class="preprocessor">    #endif</span>
<a name="l02035"></a>02035 <span class="preprocessor"></span>    
<a name="l02036"></a>02036     <span class="keywordflow">if</span> (this-&gt;pVTKWindow-&gt;HasFocus()) {
<a name="l02037"></a>02037         ProcessKey(key, mods);
<a name="l02038"></a>02038         <span class="comment">// don&#39;t call default handler (wxVTKRenderWindowInteractor::OnChar)</span>
<a name="l02039"></a>02039         <span class="keywordflow">return</span>;
<a name="l02040"></a>02040     }
<a name="l02041"></a>02041     
<a name="l02042"></a>02042     <span class="keywordflow">if</span> (this-&gt;patterns_panel-&gt;TreeHasFocus()) {
<a name="l02043"></a>02043         <span class="comment">// process keyboard shortcut for patterns panel</span>
<a name="l02044"></a>02044         <span class="keywordflow">if</span> (this-&gt;patterns_panel-&gt;DoKey(key, mods)) <span class="keywordflow">return</span>;
<a name="l02045"></a>02045         <span class="comment">// else call default handler</span>
<a name="l02046"></a>02046         <span class="keyword">event</span>.Skip();
<a name="l02047"></a>02047         <span class="keywordflow">return</span>;
<a name="l02048"></a>02048     }
<a name="l02049"></a>02049     
<a name="l02050"></a>02050     <span class="keywordflow">if</span> (this-&gt;info_panel-&gt;HtmlHasFocus()) {
<a name="l02051"></a>02051         <span class="comment">// process keyboard shortcut for info panel</span>
<a name="l02052"></a>02052         <span class="keywordflow">if</span> (this-&gt;info_panel-&gt;DoKey(key, mods)) <span class="keywordflow">return</span>;
<a name="l02053"></a>02053         <span class="comment">// else call default handler</span>
<a name="l02054"></a>02054         <span class="keyword">event</span>.Skip();
<a name="l02055"></a>02055         <span class="keywordflow">return</span>;
<a name="l02056"></a>02056     }
<a name="l02057"></a>02057     
<a name="l02058"></a>02058     <span class="keywordflow">if</span> (this-&gt;help_panel-&gt;HtmlHasFocus()) {
<a name="l02059"></a>02059         <span class="comment">// process keyboard shortcut for help panel</span>
<a name="l02060"></a>02060         <span class="keywordflow">if</span> (this-&gt;help_panel-&gt;DoKey(key, mods)) <span class="keywordflow">return</span>;
<a name="l02061"></a>02061         <span class="comment">// else call default handler</span>
<a name="l02062"></a>02062         <span class="keyword">event</span>.Skip();
<a name="l02063"></a>02063         <span class="keywordflow">return</span>;
<a name="l02064"></a>02064     }
<a name="l02065"></a>02065 }
<a name="l02066"></a>02066 
<a name="l02067"></a>02067 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l02068"></a>02068 
<a name="l02069"></a><a class="code" href="classMyFrame.html#af2953ecf41133df7b664eeade71aa6a0">02069</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#af2953ecf41133df7b664eeade71aa6a0">MyFrame::InitializeDefaultRenderSettings</a>()
<a name="l02070"></a>02070 {
<a name="l02071"></a>02071     this-&gt;render_settings.DeleteAllProperties();
<a name="l02072"></a>02072     this-&gt;render_settings.AddProperty(<a class="code" href="classProperty.html" title="A &#39;Property&#39; has a type, a name and a value.">Property</a>(<span class="stringliteral">&quot;surface_color&quot;</span>,<span class="stringliteral">&quot;color&quot;</span>,1.0f,1.0f,1.0f)); <span class="comment">// RGB [0,1]</span>
<a name="l02073"></a>02073     this-&gt;render_settings.AddProperty(<a class="code" href="classProperty.html" title="A &#39;Property&#39; has a type, a name and a value.">Property</a>(<span class="stringliteral">&quot;color_low&quot;</span>,<span class="stringliteral">&quot;color&quot;</span>,0.0f,0.0f,1.0f));
<a name="l02074"></a>02074     this-&gt;render_settings.AddProperty(<a class="code" href="classProperty.html" title="A &#39;Property&#39; has a type, a name and a value.">Property</a>(<span class="stringliteral">&quot;color_high&quot;</span>,<span class="stringliteral">&quot;color&quot;</span>,1.0f,0.0f,0.0f));
<a name="l02075"></a>02075     this-&gt;render_settings.AddProperty(<a class="code" href="classProperty.html" title="A &#39;Property&#39; has a type, a name and a value.">Property</a>(<span class="stringliteral">&quot;show_multiple_chemicals&quot;</span>,<span class="keyword">true</span>));
<a name="l02076"></a>02076     this-&gt;render_settings.AddProperty(<a class="code" href="classProperty.html" title="A &#39;Property&#39; has a type, a name and a value.">Property</a>(<span class="stringliteral">&quot;active_chemical&quot;</span>,<span class="stringliteral">&quot;chemical&quot;</span>,<span class="stringliteral">&quot;a&quot;</span>));
<a name="l02077"></a>02077     this-&gt;render_settings.AddProperty(<a class="code" href="classProperty.html" title="A &#39;Property&#39; has a type, a name and a value.">Property</a>(<span class="stringliteral">&quot;low&quot;</span>,0.0f));
<a name="l02078"></a>02078     this-&gt;render_settings.AddProperty(<a class="code" href="classProperty.html" title="A &#39;Property&#39; has a type, a name and a value.">Property</a>(<span class="stringliteral">&quot;high&quot;</span>,1.0f));
<a name="l02079"></a>02079     this-&gt;render_settings.AddProperty(<a class="code" href="classProperty.html" title="A &#39;Property&#39; has a type, a name and a value.">Property</a>(<span class="stringliteral">&quot;vertical_scale_1D&quot;</span>,30.0f));
<a name="l02080"></a>02080     this-&gt;render_settings.AddProperty(<a class="code" href="classProperty.html" title="A &#39;Property&#39; has a type, a name and a value.">Property</a>(<span class="stringliteral">&quot;vertical_scale_2D&quot;</span>,15.0f));
<a name="l02081"></a>02081     this-&gt;render_settings.AddProperty(<a class="code" href="classProperty.html" title="A &#39;Property&#39; has a type, a name and a value.">Property</a>(<span class="stringliteral">&quot;contour_level&quot;</span>,0.25f));
<a name="l02082"></a>02082     this-&gt;render_settings.AddProperty(<a class="code" href="classProperty.html" title="A &#39;Property&#39; has a type, a name and a value.">Property</a>(<span class="stringliteral">&quot;use_wireframe&quot;</span>,<span class="keyword">false</span>));
<a name="l02083"></a>02083     this-&gt;render_settings.AddProperty(<a class="code" href="classProperty.html" title="A &#39;Property&#39; has a type, a name and a value.">Property</a>(<span class="stringliteral">&quot;slice_3D&quot;</span>,<span class="keyword">true</span>));
<a name="l02084"></a>02084     this-&gt;render_settings.AddProperty(<a class="code" href="classProperty.html" title="A &#39;Property&#39; has a type, a name and a value.">Property</a>(<span class="stringliteral">&quot;slice_3D_axis&quot;</span>,<span class="stringliteral">&quot;axis&quot;</span>,<span class="stringliteral">&quot;z&quot;</span>));
<a name="l02085"></a>02085     this-&gt;render_settings.AddProperty(<a class="code" href="classProperty.html" title="A &#39;Property&#39; has a type, a name and a value.">Property</a>(<span class="stringliteral">&quot;slice_3D_position&quot;</span>,0.5f)); <span class="comment">// [0,1]</span>
<a name="l02086"></a>02086     this-&gt;render_settings.AddProperty(<a class="code" href="classProperty.html" title="A &#39;Property&#39; has a type, a name and a value.">Property</a>(<span class="stringliteral">&quot;show_displacement_mapped_surface&quot;</span>,<span class="keyword">true</span>));
<a name="l02087"></a>02087     this-&gt;render_settings.AddProperty(<a class="code" href="classProperty.html" title="A &#39;Property&#39; has a type, a name and a value.">Property</a>(<span class="stringliteral">&quot;use_image_interpolation&quot;</span>,<span class="keyword">true</span>));
<a name="l02088"></a>02088     this-&gt;render_settings.AddProperty(<a class="code" href="classProperty.html" title="A &#39;Property&#39; has a type, a name and a value.">Property</a>(<span class="stringliteral">&quot;timesteps_per_render&quot;</span>,100));
<a name="l02089"></a>02089     <span class="comment">// TODO: allow user to change defaults</span>
<a name="l02090"></a>02090 }
<a name="l02091"></a>02091 
<a name="l02092"></a>02092 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l02093"></a>02093 
<a name="l02094"></a><a class="code" href="classMyFrame.html#ac0763c86a2a0d69253d95c6ea976236a">02094</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#ac0763c86a2a0d69253d95c6ea976236a">MyFrame::SetNumberOfChemicals</a>(<span class="keywordtype">int</span> n)
<a name="l02095"></a>02095 {
<a name="l02096"></a>02096     <span class="keywordflow">try</span> 
<a name="l02097"></a>02097     {
<a name="l02098"></a>02098         this-&gt;system-&gt;SetNumberOfChemicals(n);
<a name="l02099"></a>02099     }
<a name="l02100"></a>02100     <span class="keywordflow">catch</span>(<span class="keyword">const</span> exception&amp; e)
<a name="l02101"></a>02101     {
<a name="l02102"></a>02102         <a class="code" href="classMonospaceMessageBox.html">MonospaceMessageBox</a>(_(<span class="stringliteral">&quot;Changing the number of chemicals caused an error:\n\n&quot;</span>)+wxString(e.what(),wxConvUTF8),_(<span class="stringliteral">&quot;Error&quot;</span>),wxART_ERROR);
<a name="l02103"></a>02103     }
<a name="l02104"></a>02104     <span class="keywordflow">catch</span>(...)
<a name="l02105"></a>02105     {
<a name="l02106"></a>02106         wxMessageBox(_(<span class="stringliteral">&quot;Changing the number of chemicals caused an unknown error&quot;</span>));
<a name="l02107"></a>02107     }
<a name="l02108"></a>02108     <span class="keywordflow">try</span>
<a name="l02109"></a>02109     {
<a name="l02110"></a>02110         this-&gt;system-&gt;GenerateInitialPattern();
<a name="l02111"></a>02111     }
<a name="l02112"></a>02112     <span class="keywordflow">catch</span>(<span class="keyword">const</span> exception&amp; e)
<a name="l02113"></a>02113     {
<a name="l02114"></a>02114         <a class="code" href="classMonospaceMessageBox.html">MonospaceMessageBox</a>(_(<span class="stringliteral">&quot;Generating an initial pattern caused an error:\n\n&quot;</span>)+wxString(e.what(),wxConvUTF8),_(<span class="stringliteral">&quot;Error&quot;</span>),wxART_ERROR);
<a name="l02115"></a>02115     }
<a name="l02116"></a>02116     <span class="keywordflow">catch</span>(...)
<a name="l02117"></a>02117     {
<a name="l02118"></a>02118         wxMessageBox(_(<span class="stringliteral">&quot;Generating an initial pattern caused an unknown error&quot;</span>));
<a name="l02119"></a>02119     }
<a name="l02120"></a>02120     <span class="comment">// (we allow the user to proceed because they might now want to change other things to match)</span>
<a name="l02121"></a>02121     <a class="code" href="vtk__pipeline_8cpp.html#a83eef6bea304823921ff32ce0afb6d2b">InitializeVTKPipeline</a>(this-&gt;pVTKWindow,this-&gt;system,this-&gt;render_settings,<span class="keyword">false</span>);
<a name="l02122"></a>02122     this-&gt;UpdateWindows();
<a name="l02123"></a>02123 }
<a name="l02124"></a>02124 
<a name="l02125"></a>02125 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l02126"></a>02126 
<a name="l02127"></a><a class="code" href="classMyFrame.html#a9e049de0f8adb21c025c4c6984d8297c">02127</a> <span class="keywordtype">bool</span> <a class="code" href="classMyFrame.html#a9e049de0f8adb21c025c4c6984d8297c">MyFrame::SetDimensions</a>(<span class="keywordtype">int</span> x,<span class="keywordtype">int</span> y,<span class="keywordtype">int</span> z)
<a name="l02128"></a>02128 {
<a name="l02129"></a>02129     <span class="keywordflow">try</span> 
<a name="l02130"></a>02130     {
<a name="l02131"></a>02131         <span class="keywordflow">if</span>(x&lt;1 || y&lt;1 || z&lt;1) <span class="keywordflow">throw</span> runtime_error(<span class="stringliteral">&quot;Dimensions must be at least 1&quot;</span>);
<a name="l02132"></a>02132         <span class="comment">// rearrange the dimensions (for visualization we need the z to be 1 for 2D images, and both y and z to be 1 for 1D images)</span>
<a name="l02133"></a>02133         <span class="keywordflow">if</span>( (x==1 &amp;&amp; (y&gt;1 || z&gt;1)) || (y==1 &amp;&amp; z&gt;1) )
<a name="l02134"></a>02134         {
<a name="l02135"></a>02135             <span class="keywordtype">float</span> d[3]={x,y,z};
<a name="l02136"></a>02136             sort(d,d+3);
<a name="l02137"></a>02137             <span class="keywordflow">if</span>(d[2]!=x || d[1]!=y || d[0]!=z) {
<a name="l02138"></a>02138                 x=d[2]; y=d[1]; z=d[0];
<a name="l02139"></a>02139                 wxString msg = _(<span class="stringliteral">&quot;We&#39;ve rearranged the order of the dimensions for visualization. New dimensions: &quot;</span>);
<a name="l02140"></a>02140                 msg &lt;&lt; x &lt;&lt; _T(<span class="stringliteral">&quot; x &quot;</span>) &lt;&lt; y &lt;&lt; _T(<span class="stringliteral">&quot; x &quot;</span>) &lt;&lt; z;
<a name="l02141"></a>02141                 wxMessageBox(msg);
<a name="l02142"></a>02142             }
<a name="l02143"></a>02143         }
<a name="l02144"></a>02144         <span class="comment">// attempt the size change</span>
<a name="l02145"></a>02145         this-&gt;system-&gt;SetDimensions(x,y,z);
<a name="l02146"></a>02146     }
<a name="l02147"></a>02147     <span class="keywordflow">catch</span>(<span class="keyword">const</span> exception&amp; e)
<a name="l02148"></a>02148     {
<a name="l02149"></a>02149         <a class="code" href="classMonospaceMessageBox.html">MonospaceMessageBox</a>(_(<span class="stringliteral">&quot;Dimensions not permitted:\n\n&quot;</span>)+wxString(e.what(),wxConvUTF8),_(<span class="stringliteral">&quot;Error&quot;</span>),wxART_ERROR);
<a name="l02150"></a>02150         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l02151"></a>02151     }
<a name="l02152"></a>02152     <span class="keywordflow">catch</span>(...)
<a name="l02153"></a>02153     {
<a name="l02154"></a>02154         wxMessageBox(_(<span class="stringliteral">&quot;Dimensions not permitted&quot;</span>));
<a name="l02155"></a>02155         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l02156"></a>02156     }
<a name="l02157"></a>02157     this-&gt;system-&gt;GenerateInitialPattern();
<a name="l02158"></a>02158     <a class="code" href="vtk__pipeline_8cpp.html#a83eef6bea304823921ff32ce0afb6d2b">InitializeVTKPipeline</a>(this-&gt;pVTKWindow,this-&gt;system,this-&gt;render_settings,<span class="keyword">true</span>);
<a name="l02159"></a>02159     this-&gt;UpdateWindows();
<a name="l02160"></a>02160     <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l02161"></a>02161 }
<a name="l02162"></a>02162 
<a name="l02163"></a>02163 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l02164"></a>02164 
<a name="l02165"></a><a class="code" href="classMyFrame.html#af360d8e3100aef9da843c91a8b8ed48f">02165</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#af360d8e3100aef9da843c91a8b8ed48f">MyFrame::SetBlockSize</a>(<span class="keywordtype">int</span> x,<span class="keywordtype">int</span> y,<span class="keywordtype">int</span> z)
<a name="l02166"></a>02166 {
<a name="l02167"></a>02167     this-&gt;system-&gt;SetBlockSizeX(x);
<a name="l02168"></a>02168     this-&gt;system-&gt;SetBlockSizeY(y);
<a name="l02169"></a>02169     this-&gt;system-&gt;SetBlockSizeZ(z);
<a name="l02170"></a>02170     this-&gt;system-&gt;GenerateInitialPattern();
<a name="l02171"></a>02171     <a class="code" href="vtk__pipeline_8cpp.html#a83eef6bea304823921ff32ce0afb6d2b">InitializeVTKPipeline</a>(this-&gt;pVTKWindow,this-&gt;system,this-&gt;render_settings,<span class="keyword">false</span>);
<a name="l02172"></a>02172     this-&gt;UpdateWindows();
<a name="l02173"></a>02173 }
<a name="l02174"></a>02174 
<a name="l02175"></a>02175 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l02176"></a>02176 
<a name="l02177"></a><a class="code" href="classMyFrame.html#a07925f9cb2db10ebe3cbf17ba1f69651">02177</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#a07925f9cb2db10ebe3cbf17ba1f69651">MyFrame::RenderSettingsChanged</a>()
<a name="l02178"></a>02178 {
<a name="l02179"></a>02179     <span class="comment">// first do some range checking (not done in InfoPanel::ChangeRenderSetting)</span>
<a name="l02180"></a>02180     <a class="code" href="classProperty.html" title="A &#39;Property&#39; has a type, a name and a value.">Property</a>&amp; prop = this-&gt;render_settings.GetProperty(<span class="stringliteral">&quot;timesteps_per_render&quot;</span>);
<a name="l02181"></a>02181     <span class="keywordflow">if</span> (prop.<a class="code" href="classProperty.html#a72ad7dd41b2d14973cd1788ce3a00c7a">GetInt</a>() &lt; 1) prop.<a class="code" href="classProperty.html#a071003388823285ab1079c3caac957a1">SetInt</a>(1);
<a name="l02182"></a>02182     <span class="keywordflow">if</span> (prop.<a class="code" href="classProperty.html#a72ad7dd41b2d14973cd1788ce3a00c7a">GetInt</a>() &gt; MAX_TIMESTEPS_PER_RENDER) prop.<a class="code" href="classProperty.html#a071003388823285ab1079c3caac957a1">SetInt</a>(MAX_TIMESTEPS_PER_RENDER);
<a name="l02183"></a>02183     
<a name="l02184"></a>02184     <a class="code" href="vtk__pipeline_8cpp.html#a83eef6bea304823921ff32ce0afb6d2b">InitializeVTKPipeline</a>(this-&gt;pVTKWindow,this-&gt;system,this-&gt;render_settings,<span class="keyword">false</span>);
<a name="l02185"></a>02185     this-&gt;UpdateWindows();
<a name="l02186"></a>02186 }
<a name="l02187"></a>02187 
<a name="l02188"></a>02188 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l02189"></a>02189 
<a name="l02190"></a><a class="code" href="classMyFrame.html#abc6a78e56dda70d98b6fd1a1fa43c26e">02190</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#abc6a78e56dda70d98b6fd1a1fa43c26e">MyFrame::OnAddParameter</a>(wxCommandEvent&amp; event)
<a name="l02191"></a>02191 {
<a name="l02192"></a>02192     <a class="code" href="classStringDialog.html">StringDialog</a> dlg(<span class="keyword">this</span>,_(<span class="stringliteral">&quot;Add a parameter&quot;</span>),_(<span class="stringliteral">&quot;Name:&quot;</span>),wxEmptyString,wxDefaultPosition,wxDefaultSize);
<a name="l02193"></a>02193     <span class="keywordflow">if</span>(dlg.ShowModal()!=wxID_OK) <span class="keywordflow">return</span>;
<a name="l02194"></a>02194     this-&gt;GetCurrentRDSystem()-&gt;AddParameter(<span class="keywordtype">string</span>(dlg.<a class="code" href="classStringDialog.html#ac671f4fbd9f65279231f59b65bb32675">GetValue</a>().mb_str()),0.0f);
<a name="l02195"></a>02195     this-&gt;UpdateWindows();
<a name="l02196"></a>02196 }
<a name="l02197"></a>02197 
<a name="l02198"></a>02198 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l02199"></a>02199 
<a name="l02200"></a><a class="code" href="classMyFrame.html#a9dc9cf8ffb512e5f1db6a4c877811437">02200</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#a9dc9cf8ffb512e5f1db6a4c877811437">MyFrame::OnDeleteParameter</a>(wxCommandEvent&amp; event)
<a name="l02201"></a>02201 {
<a name="l02202"></a>02202     wxArrayString as;
<a name="l02203"></a>02203     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;this-&gt;GetCurrentRDSystem()-&gt;GetNumberOfParameters();i++)
<a name="l02204"></a>02204         as.Add(wxString(this-&gt;GetCurrentRDSystem()-&gt;GetParameterName(i).c_str(),wxConvUTF8));
<a name="l02205"></a>02205     wxSingleChoiceDialog dlg(<span class="keyword">this</span>,_(<span class="stringliteral">&quot;Select a parameter to delete:&quot;</span>),_(<span class="stringliteral">&quot;Delete a parameter&quot;</span>),as);
<a name="l02206"></a>02206     <span class="keywordflow">if</span>(dlg.ShowModal()!=wxID_OK) <span class="keywordflow">return</span>;
<a name="l02207"></a>02207     this-&gt;GetCurrentRDSystem()-&gt;DeleteParameter(dlg.GetSelection());
<a name="l02208"></a>02208     this-&gt;UpdateWindows();
<a name="l02209"></a>02209 }
<a name="l02210"></a>02210 
<a name="l02211"></a>02211 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l02212"></a>02212 
<a name="l02213"></a><a class="code" href="classMyFrame.html#a7773545349511c08a616604aebbdf346">02213</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#a7773545349511c08a616604aebbdf346">MyFrame::OnUpdateAddParameter</a>(wxUpdateUIEvent&amp; event)
<a name="l02214"></a>02214 {
<a name="l02215"></a>02215     <span class="keyword">event</span>.Enable(this-&gt;GetCurrentRDSystem()-&gt;HasEditableFormula());
<a name="l02216"></a>02216 }
<a name="l02217"></a>02217 
<a name="l02218"></a>02218 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l02219"></a>02219 
<a name="l02220"></a><a class="code" href="classMyFrame.html#a453b0bf90da968bad87c570d04004642">02220</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#a453b0bf90da968bad87c570d04004642">MyFrame::OnUpdateDeleteParameter</a>(wxUpdateUIEvent&amp; event)
<a name="l02221"></a>02221 {
<a name="l02222"></a>02222     <span class="keyword">event</span>.Enable(this-&gt;GetCurrentRDSystem()-&gt;HasEditableFormula() &amp;&amp;
<a name="l02223"></a>02223                  this-&gt;GetCurrentRDSystem()-&gt;GetNumberOfParameters() &gt; 0);
<a name="l02224"></a>02224 }
<a name="l02225"></a>02225 
<a name="l02226"></a>02226 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l02227"></a>02227 
<a name="l02228"></a><a class="code" href="classMyFrame.html#ab1fd5daf722d8dffba0efa6e197b42d2">02228</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#ab1fd5daf722d8dffba0efa6e197b42d2">MyFrame::OnRunFaster</a>(wxCommandEvent&amp; event)
<a name="l02229"></a>02229 {
<a name="l02230"></a>02230     <a class="code" href="classProperty.html" title="A &#39;Property&#39; has a type, a name and a value.">Property</a>&amp; prop = this-&gt;render_settings.GetProperty(<span class="stringliteral">&quot;timesteps_per_render&quot;</span>);
<a name="l02231"></a>02231     prop.<a class="code" href="classProperty.html#a071003388823285ab1079c3caac957a1">SetInt</a>(prop.<a class="code" href="classProperty.html#a72ad7dd41b2d14973cd1788ce3a00c7a">GetInt</a>() * 2);
<a name="l02232"></a>02232     <span class="comment">// check for overflow, or if beyond limit used in OnChangeRunningSpeed</span>
<a name="l02233"></a>02233     <span class="keywordflow">if</span> (prop.<a class="code" href="classProperty.html#a72ad7dd41b2d14973cd1788ce3a00c7a">GetInt</a>() &lt;= 0 || prop.<a class="code" href="classProperty.html#a72ad7dd41b2d14973cd1788ce3a00c7a">GetInt</a>() &gt; MAX_TIMESTEPS_PER_RENDER) prop.<a class="code" href="classProperty.html#a071003388823285ab1079c3caac957a1">SetInt</a>(MAX_TIMESTEPS_PER_RENDER);
<a name="l02234"></a>02234     this-&gt;UpdateInfoPane();
<a name="l02235"></a>02235 }
<a name="l02236"></a>02236 
<a name="l02237"></a>02237 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l02238"></a>02238 
<a name="l02239"></a><a class="code" href="classMyFrame.html#af47dad61a390a708bc444bdbd449eb05">02239</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#af47dad61a390a708bc444bdbd449eb05">MyFrame::OnRunSlower</a>(wxCommandEvent&amp; event)
<a name="l02240"></a>02240 {
<a name="l02241"></a>02241     <a class="code" href="classProperty.html" title="A &#39;Property&#39; has a type, a name and a value.">Property</a>&amp; prop = this-&gt;render_settings.GetProperty(<span class="stringliteral">&quot;timesteps_per_render&quot;</span>);
<a name="l02242"></a>02242     prop.<a class="code" href="classProperty.html#a071003388823285ab1079c3caac957a1">SetInt</a>(prop.<a class="code" href="classProperty.html#a72ad7dd41b2d14973cd1788ce3a00c7a">GetInt</a>() / 2);
<a name="l02243"></a>02243     <span class="comment">// don&#39;t let timesteps_per_render get to 0 otherwise OnRunFaster can&#39;t double it</span>
<a name="l02244"></a>02244     <span class="keywordflow">if</span> (prop.<a class="code" href="classProperty.html#a72ad7dd41b2d14973cd1788ce3a00c7a">GetInt</a>() &lt; 1) prop.<a class="code" href="classProperty.html#a071003388823285ab1079c3caac957a1">SetInt</a>(1);
<a name="l02245"></a>02245     this-&gt;UpdateInfoPane();
<a name="l02246"></a>02246 }
<a name="l02247"></a>02247 
<a name="l02248"></a>02248 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l02249"></a>02249 
<a name="l02250"></a><a class="code" href="classMyFrame.html#ad068a0c7ad7f3d094ad15bdabc730c11">02250</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#ad068a0c7ad7f3d094ad15bdabc730c11">MyFrame::OnChangeRunningSpeed</a>(wxCommandEvent&amp; event)
<a name="l02251"></a>02251 {
<a name="l02252"></a>02252     <a class="code" href="classIntegerDialog.html">IntegerDialog</a> dlg(<span class="keyword">this</span>, _(<span class="stringliteral">&quot;Running speed&quot;</span>), _(<span class="stringliteral">&quot;New value (timesteps per render):&quot;</span>),
<a name="l02253"></a>02253                       this-&gt;render_settings.GetProperty(<span class="stringliteral">&quot;timesteps_per_render&quot;</span>).GetInt(),
<a name="l02254"></a>02254                       1, MAX_TIMESTEPS_PER_RENDER, wxDefaultPosition, wxDefaultSize);
<a name="l02255"></a>02255     <span class="keywordflow">if</span>(dlg.ShowModal()!=wxID_OK) <span class="keywordflow">return</span>;
<a name="l02256"></a>02256     this-&gt;render_settings.GetProperty(<span class="stringliteral">&quot;timesteps_per_render&quot;</span>).SetInt(dlg.GetValue());
<a name="l02257"></a>02257     this-&gt;UpdateInfoPane();
<a name="l02258"></a>02258 }
<a name="l02259"></a>02259 
<a name="l02260"></a>02260 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l02261"></a>02261 
<a name="l02262"></a><a class="code" href="classMyFrame.html#af033176052c30566f52a90c97386b7f0">02262</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#af033176052c30566f52a90c97386b7f0">MyFrame::OnImportMesh</a>(wxCommandEvent&amp; event)
<a name="l02263"></a>02263 {
<a name="l02264"></a>02264     <span class="comment">// possible uses:</span>
<a name="l02265"></a>02265     <span class="comment">// 1. as MeshRD (to run RD on surface, or internally between 3d cells)</span>
<a name="l02266"></a>02266     <span class="comment">//    - will need to ask user for other pattern to duplicate formula etc. from, or whether to define this later</span>
<a name="l02267"></a>02267     <span class="comment">// 2. as representation of a binary image for ImageRD (e.g. import a 3D logo, then run tip-splitting from that seed)</span>
<a name="l02268"></a>02268     <span class="comment">//    - will need to ask for an existing pattern to load the image into, and whether to clear that image first</span>
<a name="l02269"></a>02269     <span class="comment">//    - will need to ask which chemical(s) to affect, and at what level (overlays engine)</span>
<a name="l02270"></a>02270 
<a name="l02271"></a>02271     wxString mesh_filename = wxFileSelector(_(<span class="stringliteral">&quot;Import a mesh:&quot;</span>),wxEmptyString,wxEmptyString,wxEmptyString,
<a name="l02272"></a>02272         _(<span class="stringliteral">&quot;Supported mesh formats (*.obj;*.vtu;*.vtp)|*.obj;*.vtu;*.vtp&quot;</span>),wxFD_OPEN);
<a name="l02273"></a>02273     <span class="keywordflow">if</span>(mesh_filename.empty()) <span class="keywordflow">return</span>; <span class="comment">// user cancelled</span>
<a name="l02274"></a>02274 
<a name="l02275"></a>02275     wxArrayString choices;
<a name="l02276"></a>02276     choices.Add(_(<span class="stringliteral">&quot;Run a pattern on the surface of this mesh&quot;</span>));
<a name="l02277"></a>02277     choices.Add(_(<span class="stringliteral">&quot;Paint this pattern into a 3D volume image&quot;</span>));
<a name="l02278"></a>02278     <span class="keywordtype">int</span> ret = wxGetSingleChoiceIndex(_(<span class="stringliteral">&quot;What would you like to do with the mesh?&quot;</span>),_(<span class="stringliteral">&quot;Select one of these options:&quot;</span>),choices);
<a name="l02279"></a>02279     <span class="keywordflow">if</span>(ret==-1) <span class="keywordflow">return</span>; <span class="comment">// user cancelled</span>
<a name="l02280"></a>02280 
<a name="l02281"></a>02281     <span class="keywordflow">if</span>(ret!=0) { wxMessageBox(_(<span class="stringliteral">&quot;Not yet implemented.&quot;</span>)); <span class="keywordflow">return</span>; } <span class="comment">// TODO</span>
<a name="l02282"></a>02282 
<a name="l02283"></a>02283     <span class="comment">// for now we give the mesh an inbuilt rule (heat equation) but this should be different</span>
<a name="l02284"></a>02284 
<a name="l02285"></a>02285     <span class="keywordflow">if</span>(mesh_filename.EndsWith(_T(<span class="stringliteral">&quot;vtp&quot;</span>)))
<a name="l02286"></a>02286     {
<a name="l02287"></a>02287         <span class="keywordflow">if</span>(UserWantsToCancelWhenAskedIfWantsToSave()) <span class="keywordflow">return</span>;
<a name="l02288"></a>02288         this-&gt;InitializeDefaultRenderSettings();
<a name="l02289"></a>02289 
<a name="l02290"></a>02290         vtkSmartPointer&lt;vtkXMLPolyDataReader&gt; vtp_reader = vtkSmartPointer&lt;vtkXMLPolyDataReader&gt;::New();
<a name="l02291"></a>02291         vtp_reader-&gt;SetFileName(mesh_filename.mb_str());
<a name="l02292"></a>02292         vtp_reader-&gt;Update();
<a name="l02293"></a>02293         <a class="code" href="classMeshRD.html" title="Base class for mesh-based systems.">MeshRD</a> *rd = <span class="keyword">new</span> <a class="code" href="classHeatEquationMeshRD.html" title="A non-OpenCL mesh implementation, just as an example.">HeatEquationMeshRD</a>();
<a name="l02294"></a>02294         vtkSmartPointer&lt;vtkUnstructuredGrid&gt; ug = vtkSmartPointer&lt;vtkUnstructuredGrid&gt;::New();
<a name="l02295"></a>02295         ug-&gt;SetPoints(vtp_reader-&gt;GetOutput()-&gt;GetPoints());
<a name="l02296"></a>02296         ug-&gt;SetCells(VTK_POLYGON,vtp_reader-&gt;GetOutput()-&gt;GetPolys());
<a name="l02297"></a>02297         rd-&gt;<a class="code" href="classMeshRD.html#a86710329396780b3bf7a6f92e975cdb5">CopyFromMesh</a>(ug);
<a name="l02298"></a>02298         rd-&gt;<a class="code" href="classMeshRD.html#a777f0b9e9f19d1b40e45f38430b6c6fb">SetNumberOfChemicals</a>(1);
<a name="l02299"></a>02299         this-&gt;SetCurrentRDSystem(rd);
<a name="l02300"></a>02300     }
<a name="l02301"></a>02301     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(mesh_filename.EndsWith(_T(<span class="stringliteral">&quot;vtu&quot;</span>)))
<a name="l02302"></a>02302     {
<a name="l02303"></a>02303         <span class="keywordflow">if</span>(UserWantsToCancelWhenAskedIfWantsToSave()) <span class="keywordflow">return</span>;
<a name="l02304"></a>02304         this-&gt;InitializeDefaultRenderSettings();
<a name="l02305"></a>02305 
<a name="l02306"></a>02306         vtkSmartPointer&lt;vtkXMLUnstructuredGridReader&gt; vtu_reader = vtkSmartPointer&lt;vtkXMLUnstructuredGridReader&gt;::New();
<a name="l02307"></a>02307         vtu_reader-&gt;SetFileName(mesh_filename.mb_str());
<a name="l02308"></a>02308         vtu_reader-&gt;Update();
<a name="l02309"></a>02309         <a class="code" href="classMeshRD.html" title="Base class for mesh-based systems.">MeshRD</a> *rd = <span class="keyword">new</span> <a class="code" href="classHeatEquationMeshRD.html" title="A non-OpenCL mesh implementation, just as an example.">HeatEquationMeshRD</a>();
<a name="l02310"></a>02310         rd-&gt;<a class="code" href="classMeshRD.html#a86710329396780b3bf7a6f92e975cdb5">CopyFromMesh</a>(vtu_reader-&gt;GetOutput());
<a name="l02311"></a>02311         rd-&gt;<a class="code" href="classMeshRD.html#a777f0b9e9f19d1b40e45f38430b6c6fb">SetNumberOfChemicals</a>(1);
<a name="l02312"></a>02312         this-&gt;SetCurrentRDSystem(rd);
<a name="l02313"></a>02313     }
<a name="l02314"></a>02314     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(mesh_filename.EndsWith(_T(<span class="stringliteral">&quot;obj&quot;</span>)))
<a name="l02315"></a>02315     {
<a name="l02316"></a>02316         <span class="keywordflow">if</span>(UserWantsToCancelWhenAskedIfWantsToSave()) <span class="keywordflow">return</span>;
<a name="l02317"></a>02317         this-&gt;InitializeDefaultRenderSettings();
<a name="l02318"></a>02318 
<a name="l02319"></a>02319         vtkSmartPointer&lt;vtkOBJReader&gt; obj_reader = vtkSmartPointer&lt;vtkOBJReader&gt;::New();
<a name="l02320"></a>02320         obj_reader-&gt;SetFileName(mesh_filename.mb_str());
<a name="l02321"></a>02321         obj_reader-&gt;Update();
<a name="l02322"></a>02322         <a class="code" href="classMeshRD.html" title="Base class for mesh-based systems.">MeshRD</a> *rd = <span class="keyword">new</span> <a class="code" href="classHeatEquationMeshRD.html" title="A non-OpenCL mesh implementation, just as an example.">HeatEquationMeshRD</a>();
<a name="l02323"></a>02323         vtkSmartPointer&lt;vtkUnstructuredGrid&gt; ug = vtkSmartPointer&lt;vtkUnstructuredGrid&gt;::New();
<a name="l02324"></a>02324         ug-&gt;SetPoints(obj_reader-&gt;GetOutput()-&gt;GetPoints());
<a name="l02325"></a>02325         ug-&gt;SetCells(VTK_POLYGON,obj_reader-&gt;GetOutput()-&gt;GetPolys());
<a name="l02326"></a>02326         rd-&gt;<a class="code" href="classMeshRD.html#a86710329396780b3bf7a6f92e975cdb5">CopyFromMesh</a>(ug);
<a name="l02327"></a>02327         rd-&gt;<a class="code" href="classMeshRD.html#a777f0b9e9f19d1b40e45f38430b6c6fb">SetNumberOfChemicals</a>(1);
<a name="l02328"></a>02328         this-&gt;SetCurrentRDSystem(rd);
<a name="l02329"></a>02329     }
<a name="l02330"></a>02330     <span class="keywordflow">else</span>
<a name="l02331"></a>02331     {
<a name="l02332"></a>02332         wxMessageBox(_(<span class="stringliteral">&quot;Unsupported file type&quot;</span>)); 
<a name="l02333"></a>02333         <span class="keywordflow">return</span>; 
<a name="l02334"></a>02334     }
<a name="l02335"></a>02335 }
<a name="l02336"></a>02336 
<a name="l02337"></a>02337 <span class="comment">// ---------------------------------------------------------------------</span>
<a name="l02338"></a>02338 
<a name="l02339"></a><a class="code" href="classMyFrame.html#a67767cce9137c1282861153b74452339">02339</a> <span class="keywordtype">void</span> <a class="code" href="classMyFrame.html#a67767cce9137c1282861153b74452339">MyFrame::OnExportMesh</a>(wxCommandEvent&amp; event)
<a name="l02340"></a>02340 {
<a name="l02341"></a>02341     <span class="comment">// possible uses: (context dependent)</span>
<a name="l02342"></a>02342     <span class="comment">// 1. output MeshRD surface (although can already use Paraview to convert VTU to OBJ etc.)</span>
<a name="l02343"></a>02343     <span class="comment">// 2. output ImageRD 3d-image contour for active chemical</span>
<a name="l02344"></a>02344     <span class="comment">// 3. output ImageRD 2d-image displacement-mapped surface for active chemical</span>
<a name="l02345"></a>02345 
<a name="l02346"></a>02346     wxString mesh_filename = wxFileSelector(_(<span class="stringliteral">&quot;Export a mesh:&quot;</span>),wxEmptyString,wxEmptyString,wxEmptyString,
<a name="l02347"></a>02347         _(<span class="stringliteral">&quot;Supported mesh formats (*.obj;*.vtp)|*.obj;*.vtp&quot;</span>),wxFD_SAVE|wxFD_OVERWRITE_PROMPT);
<a name="l02348"></a>02348     <span class="keywordflow">if</span>(mesh_filename.empty()) <span class="keywordflow">return</span>; <span class="comment">// user cancelled</span>
<a name="l02349"></a>02349 
<a name="l02350"></a>02350     vtkSmartPointer&lt;vtkPolyData&gt; pd = vtkSmartPointer&lt;vtkPolyData&gt;::New();
<a name="l02351"></a>02351     this-&gt;system-&gt;GetAsMesh(pd,this-&gt;render_settings);
<a name="l02352"></a>02352 
<a name="l02353"></a>02353     <span class="keywordflow">if</span>(mesh_filename.EndsWith(_T(<span class="stringliteral">&quot;obj&quot;</span>)))
<a name="l02354"></a>02354     {
<a name="l02355"></a>02355         wxBusyCursor busy;
<a name="l02356"></a>02356         ofstream out(mesh_filename.mb_str());
<a name="l02357"></a>02357         out &lt;&lt; <span class="stringliteral">&quot;# Output from Ready - http://code.google.com/p/reaction-diffusion\n&quot;</span>;
<a name="l02358"></a>02358         pd-&gt;BuildCells();
<a name="l02359"></a>02359         <span class="keywordflow">for</span>(vtkIdType iPt=0;iPt&lt;pd-&gt;GetNumberOfPoints();iPt++)
<a name="l02360"></a>02360             out &lt;&lt; <span class="stringliteral">&quot;v &quot;</span> &lt;&lt; pd-&gt;GetPoint(iPt)[0] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; pd-&gt;GetPoint(iPt)[1] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; pd-&gt;GetPoint(iPt)[2] &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;
<a name="l02361"></a>02361         <span class="keywordflow">if</span>(pd-&gt;GetPointData()-&gt;GetNormals())
<a name="l02362"></a>02362         {
<a name="l02363"></a>02363             <span class="keywordflow">for</span>(vtkIdType iPt=0;iPt&lt;pd-&gt;GetNumberOfPoints();iPt++)
<a name="l02364"></a>02364                 out &lt;&lt; <span class="stringliteral">&quot;vn &quot;</span> &lt;&lt; pd-&gt;GetPointData()-&gt;GetNormals()-&gt;GetTuple3(iPt)[0] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> 
<a name="l02365"></a>02365                     &lt;&lt; pd-&gt;GetPointData()-&gt;GetNormals()-&gt;GetTuple3(iPt)[1] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> 
<a name="l02366"></a>02366                     &lt;&lt; pd-&gt;GetPointData()-&gt;GetNormals()-&gt;GetTuple3(iPt)[2] &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;
<a name="l02367"></a>02367         }
<a name="l02368"></a>02368         vtkIdType npts,*pts;
<a name="l02369"></a>02369         <span class="keywordflow">for</span>(vtkIdType iCell=0;iCell&lt;pd-&gt;GetPolys()-&gt;GetNumberOfCells();iCell++)
<a name="l02370"></a>02370         {
<a name="l02371"></a>02371             pd-&gt;GetCellPoints(iCell,npts,pts);
<a name="l02372"></a>02372             out &lt;&lt; <span class="stringliteral">&quot;f&quot;</span>;
<a name="l02373"></a>02373             <span class="keywordflow">if</span>(pd-&gt;GetPointData()-&gt;GetNormals())
<a name="l02374"></a>02374             {
<a name="l02375"></a>02375                 <span class="keywordflow">for</span>(vtkIdType iPt=0;iPt&lt;npts;iPt++)
<a name="l02376"></a>02376                     out &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; pts[iPt]+1 &lt;&lt; <span class="stringliteral">&quot;//&quot;</span> &lt;&lt; pts[iPt]+1; <span class="comment">// (OBJ indices are 1-based)</span>
<a name="l02377"></a>02377             }
<a name="l02378"></a>02378             <span class="keywordflow">else</span>
<a name="l02379"></a>02379             {
<a name="l02380"></a>02380                 <span class="keywordflow">for</span>(vtkIdType iPt=0;iPt&lt;npts;iPt++)
<a name="l02381"></a>02381                     out &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; pts[iPt]+1; <span class="comment">// (OBJ indices are 1-based)</span>
<a name="l02382"></a>02382             }
<a name="l02383"></a>02383             out &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;
<a name="l02384"></a>02384         }
<a name="l02385"></a>02385     }
<a name="l02386"></a>02386     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(mesh_filename.EndsWith(_T(<span class="stringliteral">&quot;vtp&quot;</span>)))
<a name="l02387"></a>02387     {
<a name="l02388"></a>02388         wxBusyCursor busy;
<a name="l02389"></a>02389         vtkSmartPointer&lt;vtkXMLPolyDataWriter&gt; writer = vtkSmartPointer&lt;vtkXMLPolyDataWriter&gt;::New();
<a name="l02390"></a>02390         writer-&gt;SetFileName(mesh_filename.mb_str());
<a name="l02391"></a>02391         writer-&gt;SetInput(pd);
<a name="l02392"></a>02392         writer-&gt;Write();
<a name="l02393"></a>02393     }
<a name="l02394"></a>02394     <span class="keywordflow">else</span>
<a name="l02395"></a>02395     {
<a name="l02396"></a>02396         wxMessageBox(_(<span class="stringliteral">&quot;Unsupported file type&quot;</span>)); 
<a name="l02397"></a>02397         <span class="keywordflow">return</span>; 
<a name="l02398"></a>02398     }
<a name="l02399"></a>02399 }
<a name="l02400"></a>02400 
<a name="l02401"></a>02401 <span class="comment">// ---------------------------------------------------------------------</span>
</pre></div></div><!-- contents -->


<hr class="footer"/><address class="footer"><small>
Generated on Fri Apr 27 2012 11:33:02 for Ready by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.0
</small></address>

</body>
</html>
